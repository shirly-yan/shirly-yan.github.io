<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[linux时间]]></title>
      <url>https://shirly-yan.github.io/2017/08/20/system/linux%E6%97%B6%E9%97%B4/</url>
      <content type="html"><![CDATA[<p>linux时间的查看和设置<br><a id="more"></a></p>
<p></p><h2>查看时间</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date</span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>以特定的格式 查看时间</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date <span class="string">"+%Y-%m-%d"</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>根据网络 校准时间</h2><p></p>
<ol>
<li><p>安装ntpdate工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install ntpdate</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置系统时间与网络时间同步</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate cn.pool.ntp.org</span><br></pre></td></tr></table></figure>
</li>
</ol>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[javascript基础(二)]]></title>
      <url>https://shirly-yan.github.io/2017/07/02/js/javascript%E5%9F%BA%E7%A1%80(%E4%BA%8C)/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<h1>数组</h1>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myarray=<span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myarray=<span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">8</span>); <span class="comment">//创建数组，存储8个数据。</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> myarray = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">66</span>,<span class="number">80</span>,<span class="number">90</span>,<span class="number">77</span>,<span class="number">59</span>);<span class="comment">//创建数组同时赋值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myarray = [<span class="number">66</span>,<span class="number">80</span>,<span class="number">90</span>,<span class="number">77</span>,<span class="number">59</span>];<span class="comment">//直接输入一个数组（称 “字面量数组”）</span></span><br></pre></td></tr></table></figure>
<p>注意：<br>1.创建的新数组是空数组，没有值，如输出，则显示undefined。<br>2.虽然创建数组时，指定了长度，但实际上数组都是变长的，也就是说即使指定了长度为8，仍然可以将元素存储在规定长度以外。<br>3.数组存储的数据可以是任何类型（数字、字符、布尔值等）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myarray.length; <span class="comment">//获得数组myarray的长度</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> js </category>
            
        </categories>
        
        
        <tags>
            
            <tag> js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[node安装]]></title>
      <url>https://shirly-yan.github.io/2017/07/01/js/node%E5%AE%89%E8%A3%85/</url>
      <content type="html"><![CDATA[<p>mac下node安装<br><a id="more"></a></p>
<h1>删除node</h1>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">brew uninstall nvm</span><br><span class="line"></span><br><span class="line">brew uninstall node</span><br><span class="line"></span><br><span class="line">rm ~/.nvm</span><br><span class="line"></span><br><span class="line">rm /usr/<span class="built_in">local</span>/bin/node</span><br><span class="line"></span><br><span class="line">/usr/<span class="built_in">local</span>/lib/</span><br></pre></td></tr></table></figure>
<h1>安装nvm</h1>

<p>安装nvm，终端中输入<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.32.1/install.sh | bash</span><br></pre></td></tr></table></figure></p>
<p>在.bash_profile中写入环境配置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########node#########</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">"<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/.rvm/bin"</span> <span class="comment"># Add RVM to PATH for scripting</span></span><br><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">"/Users/shirly/.nvm"</span></span><br><span class="line">[ -s <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span> ] &amp;&amp; . <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span>  <span class="comment"># This loads nvm</span></span><br><span class="line"><span class="comment">########node#########</span></span><br></pre></td></tr></table></figure></p>
<p>应用配置，终端中输入<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> .bash_profile</span><br></pre></td></tr></table></figure></p>
<h1>nvm常用命令</h1>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nvm install &lt;version&gt; <span class="comment">## 安装指定版本，可模糊安装，如：安装v4.4.0，既可nvm install v4.4.0，又可nvm install 4.4</span></span><br><span class="line">nvm uninstall &lt;version&gt; <span class="comment">## 删除已安装的指定版本，语法与install类似</span></span><br><span class="line">nvm use &lt;version&gt; <span class="comment">## 切换使用指定的版本node</span></span><br><span class="line">nvm ls <span class="comment">## 列出所有安装的版本</span></span><br><span class="line">nvm ls-remote <span class="comment">## 列出所以远程服务器的版本（官方node version list）</span></span><br><span class="line">nvm current <span class="comment">## 显示当前的版本</span></span><br><span class="line">nvm <span class="built_in">alias</span> &lt;name&gt; &lt;version&gt; <span class="comment">## 给不同的版本号添加别名</span></span><br><span class="line">nvm <span class="built_in">unalias</span> &lt;name&gt; <span class="comment">## 删除已定义的别名</span></span><br><span class="line">nvm reinstall-packages &lt;version&gt; <span class="comment">## 在当前版本node环境下，重新全局安装指定版本号的npm包</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> js </category>
            
        </categories>
        
        
        <tags>
            
            <tag> js </tag>
            
            <tag> node </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javascript基础(一)]]></title>
      <url>https://shirly-yan.github.io/2017/07/01/js/javascript%E5%9F%BA%E7%A1%80(%E4%B8%80)/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<h1>在html中插入javascript代码</h1>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>script type=”text/javascript”&gt;表示在<script></script>之间的是文本类型(text),javascript是为了告诉浏览器里面的文本是属于JavaScript语言。</p>
<h1>在html中引入javascript文件</h1>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"script.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>就可将JS文件嵌入HTML文件中。</p>
<h1>JavaScript代码放html文件中的位置</h1>

<p>JavaScript代码可以放在html文件中任何位置<br>一般放在网页的head或者body部分。</p>
<h2>放在 head 部分</h2><br>最常用的方式是在页面中head部分放置 script 元素，浏览器解析head部分就会执行这个代码，然后才解析页面的其余部分。<br><br><h2>放在 body 部分</h2><br>JavaScript代码在网页读取到该语句的时候就会执行。<br><br><h1>注释</h1><br><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//单行注释</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">多行注释</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><br><br><h1>变量</h1><br><br>+ 1. 在JS中区分大小写，如变量mychar与myChar是不一样的，表示是两个变量。<br>+ 2. 变量虽然也可以不声明，直接使用，但不规范，需要先声明，后使用<br><br><h2>定义变量</h2>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 变量名</span><br></pre></td></tr></table></figure>
<h2>变量命名规则</h2>

<ul>
<li>1.变量必须使用字母、下划线(_)或者美元符($)开始。</li>
<li>2.然后可以使用任意多个英文字母、数字、下划线(_)或者美元符($)组成。</li>
<li>3.不能使用JavaScript关键词与JavaScript保留字。</li>
</ul>
<h1>判断语句</h1><br><h2>if…else</h2><br><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(条件)</span><br><span class="line">&#123; 条件成立时执行的代码 &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123; 条件不成立时执行的代码 &#125;</span><br></pre></td></tr></table></figure><br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">   <span class="keyword">var</span> myage = <span class="number">18</span>;</span></span><br><span class="line"><span class="javascript">   <span class="keyword">if</span>(myage&gt;=<span class="number">18</span>)  <span class="comment">//myage&gt;=18是判断条件</span></span></span><br><span class="line">   &#123; </span><br><span class="line"><span class="javascript">     <span class="built_in">document</span>.write(<span class="string">"你是成年人。"</span>);</span></span><br><span class="line">   &#125;</span><br><span class="line"><span class="javascript">   <span class="keyword">else</span>  <span class="comment">//否则年龄小于18</span></span></span><br><span class="line">   &#123; </span><br><span class="line"><span class="javascript">     <span class="built_in">document</span>.write(<span class="string">"未满18岁，你不是成年人。"</span>);</span></span><br><span class="line">   &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br><h1>函数</h1>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> 函数名(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     函数代码;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="keyword">var</span> sum = <span class="number">3</span> + <span class="number">2</span>;</span><br><span class="line">   alert(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1>输出内容</h1>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.write();</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.write(mystr+<span class="string">"&lt;br&gt;"</span>);<span class="comment">//输出hello后，输出一个换行符</span></span><br></pre></td></tr></table></figure>
<p>可用于直接向 HTML 输出流写内容。简单的说就是直接在网页中输出内容</p>
<p></p><h1>消息对话框</h1><p></p>
<h2>alert</h2>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(字符串或变量);</span><br></pre></td></tr></table></figure>
<h2>confirm</h2>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">confirm(字符串或变量);</span><br></pre></td></tr></table></figure>
<p>返回值: Boolean值<br>返回值: 当用户点击”确定”按钮时，返回true<br>        当用户点击”取消”按钮时，返回false</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mymessage=    confirm(<span class="string">"你喜欢JavaScript吗?"</span>);    </span><br><span class="line"><span class="keyword">if</span>(mymessage==<span class="literal">true</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">document</span>.write(<span class="string">"你是女士!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">"你是男士!"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2>prompt</h2>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prompt(str1, str2);</span><br></pre></td></tr></table></figure>
<p>参数说明：<br>str1: 要显示在消息对话框中的文本，不可修改<br>str2：文本框中的内容，可以修改</p>
<p>返回值:</p>
<ol>
<li>点击确定按钮，文本框中的内容将作为函数返回值</li>
<li>点击取消按钮，将返回null</li>
</ol>
<p></p><h1>窗口</h1><p></p>
<h2>打开窗口</h2>

<p>open() 方法可以查找一个已经存在或者新建的浏览器窗口</p>
<p>语法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.open([URL], [窗口名称], [参数字符串])</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.open(<span class="string">'http://www.imooc.com'</span>,<span class="string">'_blank'</span>,<span class="string">'width=300,height=200,menubar=no,toolbar=no, status=no,scrollbars=yes'</span>)</span><br></pre></td></tr></table></figure></p>
<p>参数说明:</p>
<ul>
<li>URL：可选参数，在窗口中要显示网页的网址或路径。如果省略这个参数，或者它的值是空字符串，那么窗口就不显示任何文档。</li>
<li>窗口名称：可选参数，被打开窗口的名称。<br>  1.该名称由字母、数字和下划线字符组成。<br>  2.”_top”、”_blank”、”_self”具有特殊意义的名称。<pre><code>_blank：在新窗口显示目标网页
_self：在当前窗口显示目标网页
_top：框架网页中在上部窗口中显示目标网页
</code></pre>  3.相同 name 的窗口只能创建一个，要想创建多个窗口则 name 不能相同。<br>  4.name 不能包含有空格。</li>
<li>参数字符串：可选参数，设置窗口参数，各参数用逗号隔开。</li>
</ul>
<p></p><h2>关闭窗口</h2><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.close();   <span class="comment">//关闭本窗口</span></span><br><span class="line"></span><br><span class="line">&lt;窗口对象&gt;.close();   <span class="comment">//关闭指定的窗口</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> mywin=<span class="built_in">window</span>.open(<span class="string">'http://www.imooc.com'</span>); <span class="comment">//将新打的窗口对象，存储在变量mywin中</span></span><br><span class="line">   mywin.close();</span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> js </category>
            
        </categories>
        
        
        <tags>
            
            <tag> js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Bootstrap(五)]]></title>
      <url>https://shirly-yan.github.io/2017/05/26/css/Bootstrap(%E4%BA%94)/</url>
      <content type="html"><![CDATA[<p>Bootstrap网格系统<br><a id="more"></a></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> css </category>
            
        </categories>
        
        
        <tags>
            
            <tag> bootstrap </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Bootstrap(四)]]></title>
      <url>https://shirly-yan.github.io/2017/05/26/css/Bootstrap(%E5%9B%9B)/</url>
      <content type="html"><![CDATA[<p>Bootstrap表单<br><a id="more"></a></p>
<h1>表单</h1>

<p></p><h2>垂直表单(默认)</h2><br><img src="/images/55.png" width="300" height="186"><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"exampleInputEmail1"</span>&gt;</span>邮箱：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"exampleInputEmail1"</span> <span class="attr">placeholder</span>=<span class="string">"请输入您的邮箱地址"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"exampleInputPassword1"</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"exampleInputPassword1"</span> <span class="attr">placeholder</span>=<span class="string">"请输入您的邮箱密码"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span> 记住密码</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span>&gt;</span>进入邮箱<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>水平表单</h2><br><img src="/images/56.png" width="300" height="138"><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inputEmail3"</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>邮箱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputEmail3"</span> <span class="attr">placeholder</span>=<span class="string">"请输入您的邮箱地址"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inputPassword3"</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputPassword3"</span> <span class="attr">placeholder</span>=<span class="string">"请输入您的邮箱密码"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-offset-2 col-sm-10"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span> 记住密码</span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-offset-2 col-sm-10"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span>&gt;</span>进入邮箱<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>内联表单</h2><br><img src="/images/6.png" width="300" height="50"><br>在label标签运用了一个类名“sr-only”，标签没显示就是这个样式将标签隐藏了。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-inline"</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"sr-only"</span> <span class="attr">for</span>=<span class="string">"exampleInputEmail2"</span>&gt;</span>邮箱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"exampleInputEmail2"</span> <span class="attr">placeholder</span>=<span class="string">"请输入你的邮箱地址"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"sr-only"</span> <span class="attr">for</span>=<span class="string">"exampleInputPassword2"</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"exampleInputPassword2"</span> <span class="attr">placeholder</span>=<span class="string">"请输入你的邮箱密码"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>记住密码</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btnbtn-default"</span>&gt;</span>进入邮箱<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>输入框input</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Enter email"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>下拉选择框select</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>1<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>2<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>3<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>4<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>5<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">multiple</span> <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>1<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>2<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>3<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>4<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>5<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>文本域textarea</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">rows</span>=<span class="string">"3"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>(复选框checkbox和单选择按钮radio</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h3</span>&gt;</span>案例1<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">      记住密码</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"radio"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"optionsRadios"</span> <span class="attr">id</span>=<span class="string">"optionsRadios1"</span> <span class="attr">value</span>=<span class="string">"love"</span> <span class="attr">checked</span>&gt;</span></span><br><span class="line">      喜欢</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"radio"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"optionsRadios"</span> <span class="attr">id</span>=<span class="string">"optionsRadios2"</span> <span class="attr">value</span>=<span class="string">"hate"</span>&gt;</span></span><br><span class="line">      不喜欢</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>复选框和单选按钮水平排列</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"checkbox-inline"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>  <span class="attr">value</span>=<span class="string">"option1"</span>&gt;</span>游戏</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"checkbox-inline"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>  <span class="attr">value</span>=<span class="string">"option2"</span>&gt;</span>摄影</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"checkbox-inline"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>  <span class="attr">value</span>=<span class="string">"option3"</span>&gt;</span>旅游</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span>  <span class="attr">value</span>=<span class="string">"option1"</span> <span class="attr">name</span>=<span class="string">"sex"</span>&gt;</span>男性</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span>  <span class="attr">value</span>=<span class="string">"option2"</span> <span class="attr">name</span>=<span class="string">"sex"</span>&gt;</span>女性</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span>  <span class="attr">value</span>=<span class="string">"option3"</span> <span class="attr">name</span>=<span class="string">"sex"</span>&gt;</span>中性</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>表单控件大小</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control input-lg"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"添加.input-lg，控件变大"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"正常大小"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control input-sm"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"添加.input-sm，控件变小"</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>表单控件状态</h2><p></p>
<p></p><h3>禁用状态</h3><br>在相应的表单控件上添加属性“disabled”<br>在Bootstrap框架中，如果fieldset设置了disabled属性，整个域都将处于被禁用状态。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"表单已禁用，不能输入"</span> <span class="attr">disabled</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>验证状态</h3><br>在Bootstrap框架中同样提供这几种效果。<p></p>
<ul>
<li>1、.has-warning: 警告状态（黄色）</li>
<li>2、.has-error：错误状态（红色）</li>
<li>3、.has-success：成功状态（绿色）<br>使用的时候只需要在form-group容器上对应添加状态类名。</li>
</ul>
<p>如果你想让表单在对应的状态下显示 icon 出来，只需要在对应的状态下添加类名“has-feedback”。请注意，此类名要与“has-error”、“has-warning”和“has-success”在一起：<br>而且必须在表单中添加了一个 span 元素：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphiconglyphicon-warning-sign form-control-feedback"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/images/57.png" width="800" height="734"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>示例1<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-success"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputSuccess1"</span>&gt;</span>成功状态<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputSuccess1"</span> <span class="attr">placeholder</span>=<span class="string">"成功状态"</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-warning"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputWarning1"</span>&gt;</span>警告状态<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputWarning1"</span> <span class="attr">placeholder</span>=<span class="string">"警告状态"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-error"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputError1"</span>&gt;</span>错误状态<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputError1"</span> <span class="attr">placeholder</span>=<span class="string">"错误状态"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>示例2<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-success has-feedback"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputSuccess1"</span>&gt;</span>成功状态<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputSuccess1"</span> <span class="attr">placeholder</span>=<span class="string">"成功状态"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-ok form-control-feedback"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-warning has-feedback"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputWarning1"</span>&gt;</span>警告状态<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputWarning1"</span> <span class="attr">placeholder</span>=<span class="string">"警告状态"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-warning-sign form-control-feedback"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-error has-feedback"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputError1"</span>&gt;</span>错误状态<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputError1"</span> <span class="attr">placeholder</span>=<span class="string">"错误状态"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-remove form-control-feedback"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h3>提示信息</h3><br>在Bootstrap框架中也提供了不同的提示信息的效果。使用了一个”help-block”样式，将提示信息以块状显示，并且显示在控件底部。<br><img src="/images/58.png" width="300" height="160"><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-success has-feedback"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputSuccess1"</span>&gt;</span>成功状态<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputSuccess1"</span> <span class="attr">placeholder</span>=<span class="string">"成功状态"</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span>你输入的信息是正确的<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphiconglyphicon-ok form-control-feedback"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>按钮</h2><p></p>
<p></p><h3>制作按钮</h3><br>虽然在Bootstrap框架中使用任何标签元素都可以实现按钮风格，但个人并不建议这样使用，为了避免浏览器兼容性问题，个人强烈建议使用button或a标签来制作按钮。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>button标签按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">value</span>=<span class="string">"input标签按钮"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"##"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span>&gt;</span>a标签按钮<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span>&gt;</span>span标签按钮<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span>&gt;</span>div标签按钮<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p><img src="/images/61.png" width="250" height="69"></p>
<p></p><h3>按钮风格</h3><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>基础按钮.btn<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>默认按钮.btn-default<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>主要按钮.btn-primary<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-success"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>成功按钮.btn-success<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-info"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>信息按钮.btn-info<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-warning"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>警告按钮.btn-warning<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>危险按钮.btn-danger<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-link"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>链接按钮.btn-link<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p><img src="/images/62.png" width="800" height="331"><br><img src="/images/63.png" width="800" height="808"></p>
<p></p><h3>按钮大小</h3><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-lg"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>大型按钮.btn-lg<span class="tag">&lt;/<span class="name">button</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>正常按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>小型按钮.btn-sm<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-xs"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>超小型按钮.btn-xs<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p><img src="/images/64.png" width="800" height="708"></p>
<p></p><h3>按钮状态</h3><p></p>
<p></p><h4>活动状态</h4><br>Bootstrap按钮的活动状态主要包括按钮的<p></p>
<ul>
<li>悬浮状态(:hover)</li>
<li>点击状态(:active)</li>
<li>焦点状态(:focus)</li>
</ul>
<p></p><h4>禁用状态</h4><br>在Bootstrap框架中，要禁用按钮有两种实现方式：<p></p>
<ul>
<li>方法1：在标签中添加disabled属性</li>
<li>方法2：在元素标签中添加类名“disabled”</li>
</ul>
<p><img src="/images/65.png" width="300" height="119"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btnbtn-primary btn-lgbtn-block"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">disabled</span>=<span class="string">"disabled"</span>&gt;</span>通过disabled属性禁用按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btnbtn-primary btn-block disabled"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>通过添加类名disabled禁用按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btnbtn-primary btn-smbtn-block"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>未禁用的按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h3>基本按钮</h3><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>基本按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p><img src="/images/59.png" width="300" height="90"></p>
<p></p><h3>默认按钮</h3><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>默认按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p><img src="/images/60.png" width="200" height="114"></p>
<h1>图像</h1>

<p>在Bootstrap框架中对于图像的样式风格提供以下几种风格：</p>
<ul>
<li>1、img-responsive：响应式图片，主要针对于响应式设计</li>
<li>2、img-rounded：圆角图片</li>
<li>3、img-circle：圆形图片</li>
<li>4、img-thumbnail：缩略图片</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span>  <span class="attr">alt</span>=<span class="string">"140x140"</span> <span class="attr">src</span>=<span class="string">"http://placehold.it/140x140"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span>  <span class="attr">class</span>=<span class="string">"img-rounded"</span> <span class="attr">alt</span>=<span class="string">"140x140"</span> <span class="attr">src</span>=<span class="string">"http://placehold.it/140x140"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span>  <span class="attr">class</span>=<span class="string">"img-circle"</span> <span class="attr">alt</span>=<span class="string">"140x140"</span> <span class="attr">src</span>=<span class="string">"http://placehold.it/140x140"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span>  <span class="attr">class</span>=<span class="string">"img-thumbnail"</span> <span class="attr">alt</span>=<span class="string">"140x140"</span> <span class="attr">src</span>=<span class="string">"http://placehold.it/140x140"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span>  <span class="attr">class</span>=<span class="string">"img-responsive"</span> <span class="attr">alt</span>=<span class="string">"140x140"</span> <span class="attr">src</span>=<span class="string">"http://placehold.it/140x140"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/66.png" width="300" height="140"></p>
<h1>图标</h1>

<p>所有图标名称<br><a href="http://getbootstrap.com/components/#glyphicons" target="_blank" rel="noopener">http://getbootstrap.com/components/#glyphicons</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-search"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-asterisk"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-plus"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-cloud"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> css </category>
            
        </categories>
        
        
        <tags>
            
            <tag> bootstrap </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Bootstrap(三)]]></title>
      <url>https://shirly-yan.github.io/2017/05/25/css/Bootstrap(%E4%B8%89)/</url>
      <content type="html"><![CDATA[<p>Bootstrap表格<br><a id="more"></a></p>
<h1>表格</h1>

<p>Bootstrap为表格提供了1种基础样式和4种附加样式以及1个支持响应式的表格。在使用Bootstrap的表格过程中，只需要添加对应的类名就可以得到不同的表格风格</p>
<ul>
<li>.table：基础表格</li>
<li>.table-striped：斑马线表格</li>
<li>.table-bordered：带边框的表格</li>
<li>.table-hover：鼠标悬停高亮的表格</li>
<li>.table-condensed：紧凑型表格</li>
<li>.table-responsive：响应式表格</li>
</ul>
<p></p><h2>表格行的类</h2><br>Bootstrap还为表格的行元素<tr>提供了五种不同的类名，每种类名控制了行的不同背景颜色<br><img src="/images/54.png" width="800" height="554"><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-bordered"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>类名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>描述<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>.active<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表示当前活动的信息<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">class</span>=<span class="string">"success"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>.success<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表示成功或者正确的行为<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">class</span>=<span class="string">"info"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>.info<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表示中立的信息或行为<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">class</span>=<span class="string">"warning"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>.warning<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表示警告，需要特别注意<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">class</span>=<span class="string">"danger"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>.danger<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表示危险或者可能是错误的行为<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>基础表格</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>斑马线表格</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-striped"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>带边框的表格</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-bordered"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>鼠标悬停高亮的表格</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>紧凑型表格</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-condensed"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>响应式表格</h2><br>Bootstrap提供了一个容器，并且此容器设置类名“.table-responsive”,此容器就具有响应式效果，然后将<table class="table">置于这个容器当中，这样表格也就具有响应式效果。<br>Bootstrap中响应式表格效果表现为：当你的浏览器可视区域小于768px时，表格底部会出现水平滚动条。当你的浏览器可视区域大于768px时，表格底部水平滚动条就会消失。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"table-responsive"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-bordered"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">th</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>表格单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
</table></tr>]]></content>
      
        <categories>
            
            <category> css </category>
            
        </categories>
        
        
        <tags>
            
            <tag> bootstrap </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Bootstrap(二)]]></title>
      <url>https://shirly-yan.github.io/2017/05/24/css/Bootstrap(%E4%BA%8C)/</url>
      <content type="html"><![CDATA[<p>Bootstrap列表 代码块<br><a id="more"></a></p>
<h1>列表</h1>

<p>Bootstrap根据平时的使用情形提供了六种形式的列表：</p>
<ul>
<li>普通列表</li>
<li>有序列表</li>
<li>去点列表</li>
<li>内联列表</li>
<li>描述列表</li>
<li>水平描述列表</li>
</ul>
<p></p><h2>无序列表</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>列表项目<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>列表项目<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>列表项目<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>列表项目<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>列表项目<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>有序列表</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>项目列表一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>项目列表二<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>项目列表三<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>去点列表</h2><br>添加类名“.list-unstyled”<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>有序项目列表一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>有序项目列表二</span><br><span class="line">      <span class="tag">&lt;<span class="name">ol</span> <span class="attr">class</span>=<span class="string">"list-unstyled"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>有序二级项目列表一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>有序二级项目列表二<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>无序三级项目列表一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>无序三级项目列表二</span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list-unstyled"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span>&gt;</span>无序四级项目列表一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span>&gt;</span>无序四级项目列表二<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>无序三级项目列表三<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>有序项目列表三<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>内联列表</h2><br>添加类名“.list-inline”<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list-inline"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>南京<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>厦门<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>定义列表</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>北京是中国的首都，是政治文化集中地<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>上海号称东方的巴黎<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>水平定义列表</h2><br>给<dl>添加类名“.dl-horizontal”给定义列表实现水平显示效果<br>宽屏下的效果（屏幕大于768px）：<br><img src="/images/52.png" width="800" height="107"><br>当你缩小你的浏览器屏幕时，水平定义列表将回复到原始的状态。<br><img src="/images/53.png" width="800" height="222"><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span> <span class="attr">class</span>=<span class="string">"dl-horizontal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>W3cplus<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>一个致力于推广国内前端行业的技术博客。它以探索为己任，不断活跃在行业技术最前沿，努力提供高质量前端技术博文<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>慕课网<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>一个专业的，真心实意在做培训的网站<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>我来测试一个标题，我来测试一个标题<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>我在写一个水平定义列表的效果，我在写一个水平定义列表的效果<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<h1>代码</h1>

<p>Bootstrap主要提供了三种代码风格：</p>
<ul>
<li>1、使用&lt;code&gt;&lt;/code&gt;来显示单行内联代码</li>
<li>2、使用&lt;pre&gt;&lt;/pre&gt;来显示多行块代码</li>
<li>3、使用&lt;kbd&gt;&lt;/kbd&gt;来显示用户输入代码<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Bootstrap的代码风格有三种：<span class="tag">&lt;<span class="name">code</span>&gt;</span><span class="symbol">&amp;lt;</span>code<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">code</span>&gt;</span>、<span class="tag">&lt;<span class="name">code</span>&gt;</span><span class="symbol">&amp;lt;</span>pre<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">code</span>&gt;</span>和<span class="tag">&lt;<span class="name">code</span>&gt;</span><span class="symbol">&amp;lt;</span>kbd<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">pre风格：</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pre</span>&gt;</span></span><br><span class="line"><span class="symbol">&amp;lt;</span>ul<span class="symbol">&amp;gt;</span></span><br><span class="line"><span class="symbol">&amp;lt;</span>li<span class="symbol">&amp;gt;</span>...<span class="symbol">&amp;lt;</span>/li<span class="symbol">&amp;gt;</span></span><br><span class="line"><span class="symbol">&amp;lt;</span>li<span class="symbol">&amp;gt;</span>...<span class="symbol">&amp;lt;</span>/li<span class="symbol">&amp;gt;</span></span><br><span class="line"><span class="symbol">&amp;lt;</span>li<span class="symbol">&amp;gt;</span>...<span class="symbol">&amp;lt;</span>/li<span class="symbol">&amp;gt;</span></span><br><span class="line"><span class="symbol">&amp;lt;</span>/ul<span class="symbol">&amp;gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">kbd风格：</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>请输入<span class="tag">&lt;<span class="name">kbd</span>&gt;</span>ctrl+c<span class="tag">&lt;/<span class="name">kbd</span>&gt;</span>来复制代码，然后使用<span class="tag">&lt;<span class="name">kbd</span>&gt;</span>ctrl+v<span class="tag">&lt;/<span class="name">kbd</span>&gt;</span>来粘贴代码<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p></p><h2>控制代码块区域最大高度为340px</h2><br>在pre标签上添加类名“.pre-scrollable”<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">pre</span> <span class="attr">class</span>=<span class="string">"pre-scrollable"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>....<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
</dl>]]></content>
      
        <categories>
            
            <category> css </category>
            
        </categories>
        
        
        <tags>
            
            <tag> bootstrap </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Bootstrap(一)]]></title>
      <url>https://shirly-yan.github.io/2017/05/24/css/Bootstrap(%E4%B8%80)/</url>
      <content type="html"><![CDATA[<p>Bootstrap中标题 文本<br><a id="more"></a></p>
<h1>标题</h1>

<h2>主标题</h2><br><img src="/images/6.png" width="800" height="349"><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Bootstrap标题一<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Bootstrap标题二<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>Bootstrap标题三<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>Bootstrap标题四<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h5</span>&gt;</span>Bootstrap标题五<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h6</span>&gt;</span>Bootstrap标题六<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"h1"</span>&gt;</span>Bootstrap标题一<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"h2"</span>&gt;</span>Bootstrap标题二<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"h3"</span>&gt;</span>Bootstrap标题三<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"h4"</span>&gt;</span>Bootstrap标题四<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"h5"</span>&gt;</span>Bootstrap标题五<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"h6"</span>&gt;</span>Bootstrap标题六<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br><h2>副标题</h2><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Bootstrap标题一<span class="tag">&lt;<span class="name">small</span>&gt;</span>我是副标题<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Bootstrap标题二<span class="tag">&lt;<span class="name">small</span>&gt;</span>我是副标题<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>Bootstrap标题三<span class="tag">&lt;<span class="name">small</span>&gt;</span>我是副标题<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>Bootstrap标题四<span class="tag">&lt;<span class="name">small</span>&gt;</span>我是副标题<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h5</span>&gt;</span>Bootstrap标题五<span class="tag">&lt;<span class="name">small</span>&gt;</span>我是副标题<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h6</span>&gt;</span>Bootstrap标题六<span class="tag">&lt;<span class="name">small</span>&gt;</span>我是副标题<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br><h1>文本</h1><br><br><h2>段落</h2>

<ul>
<li>1、全局文本字号为14px(font-size)</li>
<li>2、行高为1.42857143（line-height），大约是20px(大家看到一串的小数或许会有疑惑，其实他是通过LESS编译器计算出来的，当然Sass也有这样的功能)</li>
<li>3、颜色为深灰色（#333）</li>
<li>4、字体为”Helvetica Neue”, Helvetica, Arial, sans-serif;（font-family）<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我是一个段落，你猜我在Bootstrap是以什么样的风格显示。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p></p><h2>强调内容</h2><br>添加类名“.lead”实现<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>第一个是普通的内容：“我是一个普通的段落，我不需要强调显示”。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"lead"</span>&gt;</span></span><br><span class="line">第二个是强调的内容：“这部分内容需要特别的强调，我和别人长得不一样”。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>粗体</h2><br>可以使用<b>和<strong>标签让文本直接加粗<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我在学习<span class="tag">&lt;<span class="name">strong</span>&gt;</span>Bootstrap<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>，我要掌握<span class="tag">&lt;<span class="name">strong</span>&gt;</span>Bootstrap<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>的所有知识。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>斜体</h2><br>使用标签<em>或<i><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我正在学习<span class="tag">&lt;<span class="name">em</span>&gt;</span>Bootstrap<span class="tag">&lt;/<span class="name">em</span>&gt;</span>。我发现<span class="tag">&lt;<span class="name">i</span>&gt;</span>Bootstrap<span class="tag">&lt;/<span class="name">i</span>&gt;</span>真的好强大。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>强调类</h2><p></p>
<ul>
<li>.text-muted：提示，使用浅灰色（#999）</li>
<li>.text-primary：主要，使用蓝色（#428bca）</li>
<li>.text-success：成功，使用浅绿色(#3c763d)</li>
<li>.text-info：通知信息，使用浅蓝色（#31708f）</li>
<li>.text-warning：警告，使用黄色（#8a6d3b）</li>
<li>.text-danger：危险，使用褐色（#a94442）</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text-muted"</span>&gt;</span>.text-muted 效果<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text-primary"</span>&gt;</span>.text-primary效果<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text-success"</span>&gt;</span>.text-success效果<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"text-info"</span>&gt;</span>.text-info效果<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"text-warning"</span>&gt;</span>.text-warning效果<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"text-danger"</span>&gt;</span>.text-danger效果<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text-danger"</span>&gt;</span>我是一段危险信息，请用Bootstrap框架中的危险风格显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h2>对齐风格</h2><br>Bootstrap通过定义四个类名来控制文本的对齐风格：<p></p>
<ul>
<li>.text-left：左对齐</li>
<li>.text-center：居中对齐</li>
<li>.text-right：右对齐</li>
<li>.text-justify：两端对齐<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text-left"</span>&gt;</span>我居左<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span>我居中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text-right"</span>&gt;</span>我居右<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text-justify"</span>&gt;</span>两端对齐<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
</i></em></strong></b>]]></content>
      
        <categories>
            
            <category> css </category>
            
        </categories>
        
        
        <tags>
            
            <tag> bootstrap </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Bootstrap模板]]></title>
      <url>https://shirly-yan.github.io/2017/05/24/css/Bootstrap%E6%A8%A1%E6%9D%BF/</url>
      <content type="html"><![CDATA[<p>Bootstrap模板<br><a id="more"></a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Bootstrap --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--[if lt IE 9]&gt;</span></span><br><span class="line"><span class="comment">&lt;script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="comment">&lt;script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="comment">&lt;![endif]--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- bootstrap --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- jquery --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- jquery --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- bootstrap --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- bootstrap --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> css </category>
            
        </categories>
        
        
        <tags>
            
            <tag> bootstrap </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[mysql]]></title>
      <url>https://shirly-yan.github.io/2017/05/09/database/mysql/</url>
      <content type="html"><![CDATA[<p>mac上mysql配置和使用<br><a id="more"></a></p>
<p></p><h2>安装mysql</h2><br><a href="https://dev.mysql.com/downloads/file/?id=469584" target="_blank" rel="noopener">官网下载社区版本</a><p></p>
<p></p><h2>完全删除mysql</h2><br>执行下面全部命令才能完全卸载干净<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ sudo rm -rf /usr/<span class="built_in">local</span>/*mysql*</span><br><span class="line">$ sudo rm -rf /usr/<span class="built_in">local</span>/var/*mysql*</span><br><span class="line">$ sudo rm -rf /Library/StartupItems/*MySQL*</span><br><span class="line">$ sudo rm -rf /Library/PreferencePanes/*MySQL*</span><br><span class="line">$ sudo rm -rf ~/Library/PreferencePanes/*MySQL*</span><br><span class="line">$ sudo rm -rf /Library/Receipts/*mysql*</span><br><span class="line">$ sudo rm -rf /Library/Receipts/*MySQL*</span><br><span class="line">$ sudo rm -rf /private/var/db/receipts/*mysql*</span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>mysql命令</h2><p></p>
<p></p><h3>登录</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u root -p</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>重置密码</h3><br>登录进入mysql后 重置密码<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PASSWORD FOR 'root'@'localhost' = PASSWORD('password');</span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> mysql </category>
            
        </categories>
        
        
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[phpmyadmin]]></title>
      <url>https://shirly-yan.github.io/2017/05/01/php/phpmyadmin/</url>
      <content type="html"><![CDATA[<p>mac下phpmyadmin的配置和使用<br><a id="more"></a></p>
<p></p><h3>下载</h3><br><a href="http://www.phpmyadmin.net/home_page/downloads.php" target="_blank" rel="noopener">官网下载</a><p></p>
<p></p><h3>安装</h3><br>将下载下来的解压放在<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /Library/WebServer/Documents/</span><br></pre></td></tr></table></figure><p></p>
<p>目录下，完整的目录为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /Library/WebServer/Documents/phpmyadmin/</span><br></pre></td></tr></table></figure></p>
<p></p><h3>配置</h3><br>终端进入phpmyadmin目录<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /Library/WebServer/Documents/phpmyadmin/</span><br></pre></td></tr></table></figure><p></p>
<p>生成配置文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cp config.sample.inc.php config.inc.php</span><br></pre></td></tr></table></figure></p>
<p>修改配置文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ vim config.inc.php </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">按照下面进行修改：</span><br></pre></td></tr></table></figure></p>
<p>$cfg[‘blowfish_secret’] = ‘’;//用于Cookie加密，随意的长字符串<br>$cfg[‘Servers’][$i][‘host’] = ‘127.0.0.1’;//MySQL守护程序做了IP绑定<br><code>`</code></p>
<p>现在可以在浏览器中输入URL:<br><a href="http://localhost/phpmyadmin/" target="_blank" rel="noopener">http://localhost/phpmyadmin/</a></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
        <tags>
            
            <tag> phpmyadmin </tag>
            
            <tag> php </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[File]]></title>
      <url>https://shirly-yan.github.io/2017/04/01/ruby/File/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>Use:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">File.open(<span class="string">"out.txt"</span>, [your-option-string]) &#123;<span class="params">|f|</span> f.write(<span class="string">"write your stuff here"</span>) &#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">out_file = File.new(<span class="string">"out.txt"</span>, <span class="string">"w"</span>)</span><br><span class="line">out_file.puts(<span class="string">"write your stuff here"</span>)</span><br><span class="line">out_file.close</span><br></pre></td></tr></table></figure>
<p>where your options are:</p>
<ul>
<li>r - Read only. The file must exist.</li>
<li>w - Create an empty file for writing.</li>
<li>a - Append to a file.The file is created if it does not exist.</li>
<li>r+ - Open a file for update both reading and writing. The file must exist.</li>
<li>w+ - Create an empty file for both reading and writing.</li>
<li>a+ - Open a file for reading and appending. The file is created if it does not exist.</li>
</ul>
<p>读取<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">File.open(<span class="string">"out.txt"</span>) <span class="keyword">do</span> <span class="params">|file|</span></span><br><span class="line">  <span class="keyword">while</span> line = file.gets</span><br><span class="line">    puts line</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<p>文件重命名：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">File.rename( <span class="string">"new_file.js"</span>, <span class="string">"new.js"</span> )<span class="comment">#原来的文件名，新的文件名</span></span><br></pre></td></tr></table></figure></p>
<p>删除文件<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">File.delete( <span class="string">"new.js"</span> )<span class="comment">#原来的文件名</span></span><br></pre></td></tr></table></figure></p>
<p>目录操作：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dir.mkdir(<span class="string">"new"</span>)<span class="comment">#创建一个新文件夹</span></span><br><span class="line">Dir.rmdir(<span class="string">"new"</span>)<span class="comment">#删除指定的文件夹</span></span><br></pre></td></tr></table></figure></p>
<p>将一个文件拷贝到目标目标：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'fileutils'</span></span><br><span class="line">FileUtils.cp <span class="string">'new.js'</span>, <span class="string">'new'</span></span><br></pre></td></tr></table></figure></p>
<p>将一个文件移动到目标目标：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'fileutils'</span></span><br><span class="line">FileUtils.mv <span class="string">'new.js'</span>, <span class="string">'new'</span></span><br></pre></td></tr></table></figure></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> file </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[指针跟随手指转动的钟表]]></title>
      <url>https://shirly-yan.github.io/2017/03/31/oc/%E6%8C%87%E9%92%88%E8%B7%9F%E9%9A%8F%E6%89%8B%E6%8C%87%E8%BD%AC%E5%8A%A8%E7%9A%84%E9%92%9F%E8%A1%A8/</url>
      <content type="html"><![CDATA[<p>指针跟随手指转动的钟表<br><a id="more"></a></p>
<p><a href="https://github.com/yqzh186/YQClock" target="_blank" rel="noopener">源码</a></p>
<p><img src="/gifs/2.gif" width="300" height="573"></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> oc </category>
            
        </categories>
        
        
        <tags>
            
            <tag> oc效果 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[标题自动旋转滚动效果]]></title>
      <url>https://shirly-yan.github.io/2017/03/31/oc/%E6%A0%87%E9%A2%98%E8%87%AA%E5%8A%A8%E6%97%8B%E8%BD%AC%E6%BB%9A%E5%8A%A8%E6%95%88%E6%9E%9C/</url>
      <content type="html"><![CDATA[<p>标题自动旋转滚动效果<br><a id="more"></a></p>
<p><a href="https://github.com/yqzh186/YQScrollText" target="_blank" rel="noopener">源码</a></p>
<p><img src="/gifs/1.gif" width="300" height="573"></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> oc </category>
            
        </categories>
        
        
        <tags>
            
            <tag> oc效果 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[wifi]]></title>
      <url>https://shirly-yan.github.io/2017/03/22/security/wifi/</url>
      <content type="html"><![CDATA[<p>wifi<br><a id="more"></a></p>
<p></p><h3>查看局域网内所有的ip</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fping -asg 192.168.0.1/24</span><br></pre></td></tr></table></figure><p></p>
<p>例出局域网中存活的主机<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fping -asg 192.168.0.1/24 2&gt;dev/null</span><br></pre></td></tr></table></figure></p>
<p></p><h3>arp断网</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arpspoof -i 网卡 -t 目标ip 网关</span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arpspoof -i eth0 -t 192.168.0.151 192.168.0.1</span><br></pre></td></tr></table></figure>
<p>从网关出去<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 1 &gt;/proc/sys/net/ipv4/ip_forward</span><br></pre></td></tr></table></figure></p>
<p></p><h3>获取本机网卡的图片信息</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driftnet -i eth0</span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> Security </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Security </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[linux环境变量]]></title>
      <url>https://shirly-yan.github.io/2017/03/21/system/linux%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/</url>
      <content type="html"><![CDATA[<p>linux环境变量<br><a id="more"></a></p>
<p></p><h2>命令</h2><p></p>
<p></p><h3>source 命令</h3><br>重新加载配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source 配置文件</span><br></pre></td></tr></table></figure><p></p>
<p>或<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. 配置文件</span><br></pre></td></tr></table></figure></p>
<ul>
<li>.  代表 source</li>
<li>./ 代表 当前目录</li>
</ul>
<p></p><h3>umask 命令</h3><br>查看系统默认权限<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">umask</span></span><br></pre></td></tr></table></figure><p></p>
<ul>
<li>r 4</li>
<li>w 2</li>
<li>x 1</li>
</ul>
<p></p><h2>登录后的配置文件</h2><p></p>
<ul>
<li>/etc/profile         对所有用户起作用</li>
<li>/etc/profile.d/*.sh  对所有用户起作用</li>
<li>/etc/bashrc          对所有用户起作用</li>
<li>~./bash_profile      对所属的用户起作用</li>
<li>~./bashrc            对所属的用户起作用</li>
</ul>
<p></p><h2>退出登录后的配置文件</h2><p></p>
<ul>
<li>~./bash_logout      对所属的用户起作用</li>
</ul>
<p></p><h2>配置文件加载顺序</h2><br><img src="/images/47.png" width="800" height="363"><p></p>
<p></p><h3>正常过程</h3><br><img src="/images/48.png" width="800" height="363"><p></p>
<p></p><h3>su切换过程</h3><br><img src="/images/49.png" width="800" height="363"><p></p>
<p></p><h2>/etc/profile 的作用</h2><p></p>
<ul>
<li>user变量</li>
<li>logname变量</li>
<li>mail变量</li>
<li>path变量</li>
<li>hostname变量</li>
<li>histsize变量</li>
<li>umask</li>
<li>调用/etc/profile.d/*.sh文件</li>
</ul>
<p></p><h2>/etc/bashrc 的作用</h2><p></p>
<ul>
<li>ps1变量</li>
<li>umask</li>
<li>path变量</li>
<li>调用/etc/profile.d/*.sh文件</li>
</ul>
<p></p><h2>/etc/issue</h2><br><img src="/images/50.png" width="800" height="460"><p></p>
<p></p><h2>shell中的变量</h2><p></p>
<ul>
<li>脚本 中的 自定义变量</li>
<li>环境变量 中的 局部环境变量</li>
<li>环境变量 中的 全局环境变量</li>
</ul>
<p></p><h3>自定义变量</h3><p></p>
<ul>
<li>合法字符：字符 数字 下划线</li>
<li>字符数量&lt;=20</li>
<li><font color="#FF6666">区分大小写</font>

</li>
</ul>
<p></p><h4>声明变量</h4><br>变量名 = 变量值<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var = 2</span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>变量值得类型</h4><br>自动分配 数字 字符串 日期 数组<p></p>
<p></p><h4>调用方式</h4><br>$+变量名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$var</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>作用范围</h4><br>脚本生存期内<p></p>
<p></p><h3>环境变量</h3><br>查看所有的环境变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env</span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ruby属性]]></title>
      <url>https://shirly-yan.github.io/2017/02/24/ruby/ruby%E5%B1%9E%E6%80%A7/</url>
      <content type="html"><![CDATA[<p>ruby中attr_accessor，attr_reader，attr_writer<br><a id="more"></a></p>
<p></p><h3>attr_accessor</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">attr_accessor</span> <span class="symbol">:x</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">x</span></span></span><br><span class="line">  @x</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">x=</span><span class="params">(x)</span></span></span><br><span class="line">  @x = x</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>attr_reader</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">attr_reader</span> <span class="symbol">:x</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">x</span></span></span><br><span class="line">  @x</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>attr_writer</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">attr_writer</span> <span class="symbol">:x</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">x=</span><span class="params">(x)</span></span></span><br><span class="line">  @x = x</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[rvm]]></title>
      <url>https://shirly-yan.github.io/2017/02/04/ruby/rvm/</url>
      <content type="html"><![CDATA[<p>rvm<br><a id="more"></a></p>
<h2>Ruby 的安装与切换</h2>

<p>列出已知的 Ruby 版本<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rvm list known</span><br></pre></td></tr></table></figure></p>
<p>安装一个 Ruby 版本<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rvm install <span class="number">2.2</span>.<span class="number">0</span> --disable-binary</span><br></pre></td></tr></table></figure></p>
<p>这里安装了最新的 2.2.0, rvm list known 列表里面的都可以拿来安装。</p>
<p>切换 Ruby 版本<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rvm use <span class="number">2.2</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p>如果想设置为默认版本，这样一来以后新打开的控制台默认的 Ruby 就是这个版本<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rvm use <span class="number">2.2</span>.<span class="number">0</span> --default</span><br></pre></td></tr></table></figure></p>
<p>查询已经安装的ruby<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rvm list</span><br></pre></td></tr></table></figure></p>
<p>卸载一个已安装版本<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rvm remove <span class="number">1.8</span>.<span class="number">7</span></span><br></pre></td></tr></table></figure></p>
<p></p><h2>gemset</h2><br>列出当前 Ruby 的 gemset<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rvm gemset list</span><br></pre></td></tr></table></figure><p></p>
<p>建立 gemset<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rvm use <span class="number">1.8</span>.<span class="number">7</span></span><br><span class="line">rvm gemset create rails23</span><br></pre></td></tr></table></figure></p>
<p>删除一个 gemset<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rvm gemset delete rails2-<span class="number">3</span></span><br></pre></td></tr></table></figure></p>
<p>use 可以用来切换语言或者 gemset<br>前提是他们已经被安装(或者建立)。并可以在 list 命令中看到。<br>然后所有安装的 Gem 都是安装在这个 gemset 之下。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rvm use <span class="number">1.8</span>.<span class="number">7</span></span><br><span class="line">rvm use <span class="number">1.8</span>.<span class="number">7</span>@rails23</span><br></pre></td></tr></table></figure></p>
<p>清空 gemset 中的 Gem<br>如果你想清空一个 gemset 的所有 Gem, 想重新安装所有 Gem，可以这样<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rvm gemset empty <span class="number">1.8</span>.<span class="number">7</span>@rails23</span><br></pre></td></tr></table></figure></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> rvm </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[excel]]></title>
      <url>https://shirly-yan.github.io/2017/02/02/system/excel/</url>
      <content type="html"><![CDATA[<p>excel<br><a id="more"></a></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> office </category>
            
        </categories>
        
        
        <tags>
            
            <tag> excel </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[用string或symbol访问hash]]></title>
      <url>https://shirly-yan.github.io/2017/01/04/ruby/%E7%94%A8string%E6%88%96symbol%E8%AE%BF%E9%97%AEhash/</url>
      <content type="html"><![CDATA[<p>用string或symbol访问hash<br><a id="more"></a><br>Accessing a hash with either string or symbol keys<br>For a normal Ruby hash, the following code is true:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = &#123;<span class="string">"key1"</span> =&gt; <span class="string">"value1"</span>&#125;</span><br><span class="line">x[<span class="string">"key1"</span>] <span class="comment">#=&gt; "value1"</span></span><br><span class="line">x[<span class="symbol">:key1</span>] <span class="comment">#=&gt; nil</span></span><br></pre></td></tr></table></figure></p>
<p>What if we want to use either x[:key1] or x[“key1”] and get the same result?<br>Rails gives us a new Hash called HashWithIndifferentAccess that does just that. If we have a normal hash and we want to convert it into HashWithIndifferentAccess, we do the following:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = &#123;<span class="string">"key1"</span> =&gt; <span class="string">"val1"</span>&#125;</span><br><span class="line">x = x.with_indifferent_access</span><br><span class="line">x[<span class="symbol">:key1</span>] <span class="comment">#=&gt; "val1"</span></span><br><span class="line">x[<span class="string">"key1"</span>] <span class="comment">#=&gt; "val1"</span></span><br></pre></td></tr></table></figure></p>
<p>To instantiate a HashWithIndifferentAccess from the beginning we do the following:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x = HashWithIndifferentAccess.new <span class="comment">#=&gt; &#123;&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>将hash中string类型的key全部转为symbol<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hash = &#123;<span class="string">"apple"</span> =&gt; <span class="string">"banana"</span>, <span class="string">"coconut"</span> =&gt; <span class="string">"domino"</span>&#125;</span><br><span class="line">hash = Hash[hash.map&#123; <span class="params">|k, v|</span> [k.to_sym, v] &#125;]</span><br></pre></td></tr></table></figure></p>
<p>将hash中string类型的key全部转为symbol<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hash.deep_symbolize_keys</span><br><span class="line">hash.deep_symbolize_keys!</span><br></pre></td></tr></table></figure></p>
<p>将hash中symbol类型的key全部转为string<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hash.deep_stringify_keys</span><br><span class="line">hash.deep_stringify_keys!</span><br></pre></td></tr></table></figure></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> rails </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[rails下信鸽推送]]></title>
      <url>https://shirly-yan.github.io/2016/12/20/ruby/rails%E4%B8%8B%E4%BF%A1%E9%B8%BD%E6%8E%A8%E9%80%81/</url>
      <content type="html"><![CDATA[<p>rails下信鸽推送<br><a id="more"></a></p>
<p>使用的gem包</p>
 <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gem <span class="string">'httparty'</span></span><br><span class="line">gem <span class="string">'ruby-for-xinge'</span>, <span class="string">'~&gt; 0.1.4'</span></span><br></pre></td></tr></table></figure>
<p> <a href="https://rubygems.org/gems/ruby-for-xinge/versions/0.1.4?locale=zh-CN" target="_blank" rel="noopener">rubygem地址</a></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> rails </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[rake任务]]></title>
      <url>https://shirly-yan.github.io/2016/12/20/ruby/rake%E4%BB%BB%E5%8A%A1/</url>
      <content type="html"><![CDATA[<p>rails中创建使用rake任务<br><a id="more"></a><br>转自<a href="http://xiaocuixt.github.io/rails/2016/04/18/rails中创建rake任务/?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="noopener">http://xiaocuixt.github.io/rails/2016/04/18/rails中创建rake任务/?utm_source=tuicool&amp;utm_medium=referral</a></p>
<p>在rails中，rake用来编写任务脚本，让我们在cli中可以执行，提供了良好的任务编写结构，并且方便执行相互依赖的任务</p>
<p>rails项目中，rake文件存放位置：lib/tasks/user.rake</p>
<h3>&gt;1.without namespace:</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">task <span class="symbol">:sayhi</span> <span class="keyword">do</span></span><br><span class="line">  puts <span class="string">"hi"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">执行 rake sayhi 即可</span><br></pre></td></tr></table></figure><br><br><h3>2.with namespace</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">namespace <span class="symbol">:user</span> <span class="keyword">do</span></span><br><span class="line">   desc <span class="string">"genertate users"</span>    <span class="comment">#描述性文字</span></span><br><span class="line">   task <span class="symbol">:generate</span> =&gt; <span class="symbol">:environment</span> <span class="keyword">do</span>   <span class="comment">#environment表示可指定环境 RAILS_ENV=production rake user:generate</span></span><br><span class="line">       u = User.new([&#123;<span class="symbol">name:</span> <span class="string">"tom"</span>&#125;,&#123;<span class="symbol">name:</span> <span class="string">"jack"</span>&#125;])</span><br><span class="line">       u.save</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br><br>这样直接运行rake user:generate 即可执行生成user数据的任务<br><br><h3>3.调用外部的rake方法</h3>

<p>#lib/tasks/hello.rake<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">namespace <span class="symbol">:say</span> <span class="keyword">do</span></span><br><span class="line">  task <span class="symbol">:hello</span> <span class="keyword">do</span></span><br><span class="line">    puts <span class="string">"hello xiaocui"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<p>#lib/tasks/hi.rake<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">namespace <span class="symbol">:say</span> <span class="keyword">do</span></span><br><span class="line">  task <span class="symbol">:hi</span> <span class="keyword">do</span></span><br><span class="line">    Rake::Task[<span class="string">'say:hello'</span>].invoke   <span class="comment">#调用外部的task</span></span><br><span class="line">    puts <span class="string">"hi xiaocui"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<p>执行 rake say:hi 将打印出 “hello xiaocui” 和 “hi xiaocui”</p>
<h3>4.单次执行多个方法</h3>

<p>#lib/myweekend.rake<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">task <span class="symbol">:morning</span> <span class="keyword">do</span></span><br><span class="line">  puts <span class="string">"get up"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">task <span class="symbol">:afternoon</span> <span class="keyword">do</span></span><br><span class="line">  puts <span class="string">"go shopping"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">task <span class="symbol">:evening</span> <span class="keyword">do</span></span><br><span class="line">  puts <span class="string">"have supper"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">task <span class="symbol">:my_weekend</span> =&gt; [<span class="symbol">:morning</span>, <span class="symbol">:afternoon</span>, <span class="symbol">:evening</span>] <span class="keyword">do</span></span><br><span class="line">   puts <span class="string">"This is my whole day on my weekend"</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<p>执行rake my_weekend 将依次打印每个方法的内容:</p>
<p>get up<br>go shopping<br>have supper<br>This is my whole day on my weekend</p>
<p></p><h3>5.rake支持默认的任务</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">task <span class="symbol">:default</span> =&gt; <span class="string">'say:hello'</span></span><br></pre></td></tr></table></figure><p></p>
<p>执行rake 即可运行该任务，很少用。</p>
<p>﻿适用场景:</p>
<p>1.调整线上的数据,执行rake脚本可以修改production数据库数据</p>
<p>2.创建开发用的测试数据</p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> rake </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[virtualbox共享文件夹]]></title>
      <url>https://shirly-yan.github.io/2016/11/27/system/virtualbox%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sh ./VBoxLinuxAdditions.run</span><br><span class="line"></span><br><span class="line">mount -t vboxsf share<span class="emphasis">_with_</span>deiban  /mnt/shared</span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-cache search linux-headers-$(uname -r)</span><br><span class="line"></span><br><span class="line">apt-get install linux-headers-$(uname -r)</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[nginx]]></title>
      <url>https://shirly-yan.github.io/2016/11/25/system/nginx/</url>
      <content type="html"><![CDATA[<p>nginx<br><a id="more"></a></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">apt-get install nginx</span><br><span class="line">service nginx start</span><br><span class="line">service nginx stop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">apt-get install openssl</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[I18n]]></title>
      <url>https://shirly-yan.github.io/2016/11/23/ruby/I18n/</url>
      <content type="html"><![CDATA[<p>I18n<br><a id="more"></a></p>
<p></p><h3>设置默认语言</h3><br>config/application.rb<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config.i18n.default_locale = <span class="string">'zh-CN'</span></span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[rspec]]></title>
      <url>https://shirly-yan.github.io/2016/11/22/ruby/rspec/</url>
      <content type="html"><![CDATA[<p>rspec<br><a id="more"></a><br>Gemfile中加<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem <span class="string">'rspec-rails'</span></span><br></pre></td></tr></table></figure></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> rspec </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[grape]]></title>
      <url>https://shirly-yan.github.io/2016/11/22/ruby/grape/</url>
      <content type="html"><![CDATA[<p>grape<br><a id="more"></a></p>
<p></p><h2>Gemfile中加</h2><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem <span class="string">'grape'</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>资源路径</h2><br>/resources/:resource<br>/resources/:resource/:action<p></p>
<p>例<br>/users/1<br>/users/1/logout<br>路径嵌套<br>/users/1/posts/2/like</p>
<p></p><h2>请求参数</h2><p></p>
<ul>
<li>header</li>
<li>param( queryparam pathparam fieldparam) </li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">params <span class="keyword">do</span></span><br><span class="line">   requires <span class="symbol">:year</span>, <span class="symbol">type:</span> Integer</span><br><span class="line">   optional <span class="symbol">:month</span>, <span class="symbol">type:</span> String, <span class="symbol">default:</span> <span class="string">'may'</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p></p><h2>相应</h2><p></p>
<h3>资源的表述方式</h3><br>+ json<br>+ xml<br><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">format <span class="symbol">:json</span></span><br></pre></td></tr></table></figure><br><br><h3>标准时间戳</h3>

<h3>响应码</h3><br>200 ：get请求完成<br>201 ：post，put,delete请求完成<br>202 ：post，delete，请求提交成功，稍后将异步的进行处理<br>400 ：bad request请求无效，请求参数包含错误<br>401 ：unauthorized请求无效，因为用户没有进行认证<br>403 ：forbidden请求无效，因为用户被认定没有访问特定资源的权限<br>429 ：too many requests,请求频率超配，稍后再试<br>500 ：internal server error,服务器出错了，检查网站的状态，或者报告的问题<br><br><h3>错误信息</h3>


<p>例：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User::API</span> &lt; Grape::API</span></span><br><span class="line">  format <span class="symbol">:json</span></span><br><span class="line"></span><br><span class="line">  resources <span class="string">':users'</span> <span class="keyword">do</span></span><br><span class="line">    get <span class="string">'test'</span> <span class="keyword">do</span></span><br><span class="line">      data = &#123;</span><br><span class="line">          <span class="symbol">:time</span> =&gt; Time.new,</span><br><span class="line">          <span class="symbol">:ip</span> =&gt; request.ip,</span><br><span class="line">      &#125;</span><br><span class="line">      present data</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    resources <span class="string">':user_id'</span> <span class="keyword">do</span></span><br><span class="line">      get <span class="keyword">do</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="symbol">:users</span> =&gt; params[<span class="symbol">:users</span>],</span><br><span class="line">            <span class="symbol">:user_id</span> =&gt; params[<span class="symbol">:user_id</span>],</span><br><span class="line">            <span class="symbol">:time</span> =&gt; Time.new,</span><br><span class="line">            <span class="symbol">:ip</span> =&gt; request.ip,</span><br><span class="line">        &#125;</span><br><span class="line">        present data</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      params <span class="keyword">do</span></span><br><span class="line">        requires <span class="symbol">:year</span>, <span class="symbol">type:</span> Integer</span><br><span class="line">        optional <span class="symbol">:month</span>, <span class="symbol">type:</span> String, <span class="symbol">default:</span> <span class="string">'may'</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      get <span class="string">'logout'</span> <span class="keyword">do</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="symbol">:year</span> =&gt; params[<span class="symbol">:year</span>],</span><br><span class="line">            <span class="symbol">:month</span> =&gt; params[<span class="symbol">:month</span>],</span><br><span class="line">            <span class="symbol">:type</span> =&gt; <span class="string">'get'</span>,</span><br><span class="line">            <span class="symbol">:time</span> =&gt; Time.new,</span><br><span class="line">            <span class="symbol">:ip</span> =&gt; request.ip,</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        present data</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      post <span class="string">'logout'</span> <span class="keyword">do</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="symbol">:day</span> =&gt; params[<span class="symbol">:day</span>],</span><br><span class="line">            <span class="symbol">:app_version</span> =&gt; headers[<span class="string">'App-Version'</span>],</span><br><span class="line">            <span class="symbol">:token</span> =&gt; headers[<span class="string">'Token'</span>],</span><br><span class="line">            <span class="symbol">:type</span> =&gt; <span class="string">'post'</span>,</span><br><span class="line">            <span class="symbol">:users</span> =&gt; params[<span class="symbol">:users</span>],</span><br><span class="line">            <span class="symbol">:user_id</span> =&gt; params[<span class="symbol">:user_id</span>],</span><br><span class="line">            <span class="symbol">:time</span> =&gt; Time.new,</span><br><span class="line">            <span class="symbol">:ip</span> =&gt; request.ip,</span><br><span class="line">        &#125;</span><br><span class="line">        present data</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[postgresql]]></title>
      <url>https://shirly-yan.github.io/2016/11/18/system/postgresql/</url>
      <content type="html"><![CDATA[<p>postgresql<br><a id="more"></a></p>
<p></p><h3>允许远程访问</h3><p></p>
<p></p><h4>一</h4><br>postgresql.conf<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">修改</span><br><span class="line"><span class="section">#listen_addresses ='localhost'为</span></span><br><span class="line">listen_addresses ='*'</span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>二</h4><br>pg_hba.conf<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">添加一行</span><br><span class="line">host    all    all    0.0.0.0/0    md5</span><br><span class="line">这样就是允许全部ip的任意访问了</span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install pg -- --with-pg-config=/Applications/Postgres.app/Contents/Version‌​s/9.6/bin/pg_config</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[rails]]></title>
      <url>https://shirly-yan.github.io/2016/11/18/ruby/rails/</url>
      <content type="html"><![CDATA[<p>rails<br><a id="more"></a></p>
<p></p><h2>常用命令</h2><p></p>
<p></p><h3>创建</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails new name</span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails new name --skip-bundle</span><br></pre></td></tr></table></figure>
<p></p><h3>开启服务</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails server</span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails server -p 2000</span><br></pre></td></tr></table></figure>
<p></p><h2>bundle</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundle install</span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>路由routes</h2><p></p>
<p></p><h3>查看所有路由信息</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake routes</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>设置根路由</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root <span class="string">'controller_name#action_name'</span></span><br></pre></td></tr></table></figure><p></p>
<p>`</p>
<p></p><h3>一般路由</h3><br>创建<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get <span class="string">'names/:id'</span>, <span class="symbol">:to</span> =&gt; <span class="string">'names#actionname'</span></span><br></pre></td></tr></table></figure><p></p>
<p>调用<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= link_to <span class="string">'xxxxxxx'</span>,&#123;<span class="symbol">:controller</span> =&gt; <span class="string">'names'</span>, <span class="symbol">:action</span> =&gt; <span class="string">'actionname'</span>, <span class="symbol">:id</span> =&gt; <span class="number">1</span>&#125; %&gt;</span><br></pre></td></tr></table></figure></p>
<p></p><h3>命名路由</h3><br>创建<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get <span class="string">'names/:id'</span>, <span class="symbol">:to</span> =&gt; <span class="string">'names#actionname'</span>, <span class="symbol">:as</span> =&gt; <span class="string">'names_actionname'</span></span><br></pre></td></tr></table></figure><p></p>
<p>调用<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= link_to <span class="string">'xxxxxxx'</span>,names_actionname_path(<span class="number">1</span>) %&gt;</span><br><span class="line">&lt;%= link_to <span class="string">'xxxxxxx'</span>,names_actionname_path %&gt;</span><br></pre></td></tr></table></figure></p>
<p></p><h3>资源路由resources</h3><br>        请求  URL<p></p>
<ul>
<li>index get  /books</li>
<li>creat post /books</li>
<li>show  get  /books/[:id]  </li>
<li>new   get  /books/new</li>
</ul>
<p>设置<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resources <span class="symbol">:names</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resources <span class="symbol">:names</span>, <span class="symbol">:except</span> =&gt; <span class="symbol">:show</span></span><br></pre></td></tr></table></figure>
<p></p><h4>集合路由</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">resources <span class="symbol">:posts</span> <span class="keyword">do</span></span><br><span class="line">  get <span class="string">'recent'</span>, <span class="symbol">:on</span> =&gt; <span class="symbol">:collection</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">resources <span class="symbol">:posts</span> <span class="keyword">do</span></span><br><span class="line">  collection <span class="keyword">do</span></span><br><span class="line">    get <span class="string">'recent'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p></p><h4>成员路由</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">resources <span class="symbol">:posts</span> <span class="keyword">do</span></span><br><span class="line">  get <span class="string">'recent'</span>, <span class="symbol">:on</span> =&gt; <span class="symbol">:member</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  member <span class="keyword">do</span></span><br><span class="line">    get <span class="string">'recent'</span> <span class="comment">#post/:id/recent</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">resources <span class="symbol">:posts</span> <span class="keyword">do</span></span><br><span class="line">  collection <span class="keyword">do</span></span><br><span class="line">    get <span class="string">'recent'</span> <span class="comment">#post/recent</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  member <span class="keyword">do</span></span><br><span class="line">    get <span class="string">'recent'</span> <span class="comment">#post/:id/recent</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p></p><h2>db</h2><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake <span class="symbol">db:</span>migrate</span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>generate</h2><p></p>
<p></p><h3>scaffold</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails generate scaffold name</span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails generate scaffold product name <span class="symbol">price:</span>decimal <span class="symbol">description:</span>text</span><br></pre></td></tr></table></figure>
<p></p><h3>controller</h3><br>生成<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails generate controller controllername</span><br></pre></td></tr></table></figure><p></p>
<p>删除<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails destroy controller controllername</span><br></pre></td></tr></table></figure></p>
<p>生成<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails generate controller controllername actionname1 actionname2</span><br></pre></td></tr></table></figure></p>
<p></p><h3>model</h3><br>生成<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails generate model modelname name1 <span class="symbol">name2:</span>string</span><br></pre></td></tr></table></figure><p></p>
<p>添加关联字段<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails generate migration add_user_id_to_posts <span class="symbol">user_id:</span>id</span><br></pre></td></tr></table></figure></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[gem]]></title>
      <url>https://shirly-yan.github.io/2016/11/17/ruby/gem/</url>
      <content type="html"><![CDATA[<p>gem常用命令<br><a id="more"></a></p>
<p></p><h3>gem源</h3><br>查看当前gem源<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources --l</span><br></pre></td></tr></table></figure><p></p>
<p>移除gem源<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources --remove url</span><br></pre></td></tr></table></figure></p>
<p>添加gem源<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources -a url</span><br></pre></td></tr></table></figure></p>
<p>可以用 Bundler 的 Gem 源代码镜像命令。这样不用改Gemfile 的 source。<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundle config mirror.https://rubygems.org https://gems.ruby-china.org</span><br></pre></td></tr></table></figure></p>
<p></p><h3>gem常用命令</h3><br>安装gem包<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install name</span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[supervisor]]></title>
      <url>https://shirly-yan.github.io/2016/11/17/system/supervisor/</url>
      <content type="html"><![CDATA[<p>supervisor<br><a id="more"></a><br><a href="http://liyangliang.me/posts/2015/06/using-supervisor/" target="_blank" rel="noopener">http://liyangliang.me/posts/2015/06/using-supervisor/</a></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[docker]]></title>
      <url>https://shirly-yan.github.io/2016/11/15/docker/docker/</url>
      <content type="html"><![CDATA[<p>docker<br><a id="more"></a><br>docker是一个容器引擎，提供了一套完整的容器解决方案<br>基于linux容器技术，操作系统级别的虚拟化，依赖于linux内核的Namespace和Cgroups</p>
<p><a href="http://www.docker.com" target="_blank" rel="noopener">Docker官网</a></p>
<p></p><h3>安装docker</h3><br>安装<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># apt-get install curl</span></span><br><span class="line"></span><br><span class="line"><span class="section"># curl -sSL https://get.docker.com/ | sh</span></span><br><span class="line"></span><br><span class="line"><span class="section"># usermod -aG docker deploy</span></span><br></pre></td></tr></table></figure><p></p>
<p>查看信息<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="section"># docker version</span></span><br><span class="line"></span><br><span class="line"><span class="section"># ps axf |grep docker</span></span><br></pre></td></tr></table></figure></p>
<p></p><h3>docker命令</h3><br>停止<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker stop</span><br></pre></td></tr></table></figure><p></p>
<p>启动<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker start</span><br></pre></td></tr></table></figure></p>
<p>运行容器<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run</span><br></pre></td></tr></table></figure></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> docker </category>
            
        </categories>
        
        
        <tags>
            
            <tag> docker </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[apt]]></title>
      <url>https://shirly-yan.github.io/2016/11/15/system/apt/</url>
      <content type="html"><![CDATA[<p>apt<br><a id="more"></a></p>
<p></p><h2>apt源</h2><p></p>
<p></p><h3>中科大</h3><br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">deb http://ftp.cn.debian.org/debian jessie main contrib non-free</span><br><span class="line">deb-src http://ftp.cn.debian.org/debian jessie main contrib non-free</span><br><span class="line"></span><br><span class="line">deb http://ftp.cn.debian.org/debian jessie-updates main contrib non-free</span><br><span class="line">deb-src http://ftp.cn.debian.org/debian jessie-updates main contrib non-free</span><br><span class="line"></span><br><span class="line">deb http://ftp.cn.debian.org/debian-security/ jessie/updates main contrib non-free</span><br><span class="line">deb-src http://ftp.cn.debian.org/debian-security/ jessie/updates main contrib non-free</span><br><span class="line"></span><br><span class="line">deb http://security.debian.org jessie/updates main contrib non-free</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>163</h3><br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirrors.163.com/debian jessie main non-free contrib</span><br><span class="line">deb http://mirrors.163.com/debian jessie-proposed-updates main contrib non-free</span><br><span class="line"></span><br><span class="line">deb-src http://mirrors.163.com/debian jessie main non-free contrib</span><br><span class="line">deb-src http://mirrors.163.com/debian jessie-proposed-updates main contrib non-free</span><br><span class="line"></span><br><span class="line">deb http://mirrors.163.com/debian-security jessie/updates main contrib non-free </span><br><span class="line">deb-src http://mirrors.163.com/debian-security jessie/updates main contrib non-free </span><br><span class="line"></span><br><span class="line">deb http://security.debian.org jessie/updates main contrib non-free</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>常用命令</h3><br>apt-cache search packagename 搜索包<br>apt-cache show packagename 获取包的相关信息，如说明、大小、版本等<br>apt-get install packagename 安装包<br>apt-get install packagename –reinstall 重新安装包<br>apt-get -f install 修复安装”-f = –fix-missing”<br>apt-get remove packagename 删除包<br>apt-get remove packagename –purge 删除包，包括删除配置文件等<br>apt-get update 更新源<br>apt-get upgrade 更新已安装的包<br>apt-get dist-upgrade 升级系统<br>apt-get dselect-upgrade 使用 dselect 升级<br>apt-cache depends packagename 了解使用依赖<br>apt-cache rdepends packagename 是查看该包被哪些包依赖<br>apt-get build-dep packagename 安装相关的编译环境<br>apt-get source packagename 下载该包的源代码<br>apt-get clean 清理无用的包<br>apt-get autoclean 清理无用的包<br>apt-get check 检查是否有损坏的依赖<p></p>
<p>apt卸载nginx方法<br>卸载方法1.</p>
<h1 id="删除nginx，保留配置文件"><a href="#删除nginx，保留配置文件" class="headerlink" title="删除nginx，保留配置文件"></a>删除nginx，保留配置文件</h1><p>sudo apt-get remove nginx</p>
<p>#删除配置文件<br>rm -rf /etc/nginx</p>
<p>卸载方法2.</p>
<p>#删除nginx连带配置文件<br>sudo apt-get purge nginx # Removes everything.</p>
<p>#卸载不再需要的nginx依赖程序<br>sudo apt-get autoremove</p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
            <tag> apt </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ssh]]></title>
      <url>https://shirly-yan.github.io/2016/11/15/system/ssh/</url>
      <content type="html"><![CDATA[<p>debian下的ssh<br><a id="more"></a></p>
<p></p><h3>开启ssh服务</h3><br>默认请况下，ubuntu是不允许远程登陆的。（因为服务没有开，可以这么理解。）<br>想要用ssh登陆的话，要在需要登陆的系统上启动服务。即，安装ssh的服务器端<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># apt-get install openssh-server</span></span><br></pre></td></tr></table></figure><p></p>
<p>然后，启动服务。<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># service ssh start</span></span><br></pre></td></tr></table></figure></p>
<p>或者是：<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># /etc/init.d/ssh restart</span></span><br></pre></td></tr></table></figure></p>
<p></p><h3>开机自动开启ssh服务</h3><br>修改配置文件/etc/rc.local<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/rc.local</span><br></pre></td></tr></table></figure><p></p>
<p>加入<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service ssh start</span><br></pre></td></tr></table></figure></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[bootstrap]]></title>
      <url>https://shirly-yan.github.io/2016/11/14/html/bootstrap/</url>
      <content type="html"><![CDATA[<p>bootstrap<br><a id="more"></a><br><a href="http://getbootstrap.com/" target="_blank" rel="noopener">bootstrap官网</a><br><a href="http://v3.bootcss.com/" target="_blank" rel="noopener">bootstrap中文文档</a></p>
<p><a href="http://bootswatch.com" target="_blank" rel="noopener">bootswatch官网</a></p>
<p>gemfile中加<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gem 'therubyracer'</span><br><span class="line">gem 'bootstrap-sass'</span><br><span class="line">gem 'bootswatch-rails'</span><br></pre></td></tr></table></figure></p>
<p>application.js加<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//= require bootstrap</span><br></pre></td></tr></table></figure></p>
<p>改application.css为application.css.scss，内容改为<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 示例：使用bootswatch免费主题： 'Cerulean' bootswatch</span><br><span class="line">// 首先导入变量</span><br><span class="line">@import "bootswatch/cerulean/variables";</span><br><span class="line"></span><br><span class="line">// 导入bootstrap</span><br><span class="line">@import "bootstrap";</span><br><span class="line"></span><br><span class="line">// 最后导入需要的bootswatch主题</span><br><span class="line">@import "bootswatch/cerulean/bootswatch";</span><br></pre></td></tr></table></figure></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> html </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[rake]]></title>
      <url>https://shirly-yan.github.io/2016/11/14/ruby/rake/</url>
      <content type="html"><![CDATA[<p>rake<br><a id="more"></a></p>
<ul>
<li>rake -T 查看所有的rake任务</li>
</ul>
<p></p><h3>和数据库相关的</h3><p></p>
<ul>
<li>rake db:create  #创建数据库</li>
<li>rake db:migrate #更新数据库，更新的文件来自db/migrate/</li>
<li>rake db:seed    #执行seed.rb文件，通常是创建一个默认的数据</li>
<li>rake db:drop    #删除数据库</li>
</ul>
<p>生产环境下 加前缀 RAILS_ENV=protucion </p>
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> rake </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[编程思想]]></title>
      <url>https://shirly-yan.github.io/2016/11/12/system/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/</url>
      <content type="html"><![CDATA[<p>编程思想<br><a id="more"></a></p>
<ul>
<li>POP 面向过程编程 process oriented programming</li>
<li>OOP 面向对象编程 object oriented programming</li>
</ul>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[java中的spring]]></title>
      <url>https://shirly-yan.github.io/2016/11/02/java/java%E4%B8%AD%E7%9A%84spring/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p></p><h3>资源</h3><br><a href="http://spring.io/" target="_blank" rel="noopener">http://spring.io/</a><br><a href="http://projects.spring.io/spring-framework/" target="_blank" rel="noopener">http://projects.spring.io/spring-framework/</a><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[linux网络管理]]></title>
      <url>https://shirly-yan.github.io/2016/10/23/system/Ubuntu%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86/</url>
      <content type="html"><![CDATA[<p>linux网络管理<br><a id="more"></a></p>
<p></p><h2>iso/osi七层模型</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iso : 国际标准化组织</span><br><span class="line">osi : 开放系统互联模型</span><br><span class="line">ios ：苹果操作系统</span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">                                    数据单位</span><br><span class="line">              应用层协议</span><br><span class="line">7  应用层   &lt;-------------&gt;  应用层   APDU</span><br><span class="line">              表示层协议</span><br><span class="line">6  表示层   &lt;-------------&gt;  表示层   PPDU</span><br><span class="line">              会话层协议</span><br><span class="line">5  会话层   &lt;-------------&gt;  会话层   SPDU</span><br><span class="line">              传输层协议</span><br><span class="line">4  传输层   &lt;-------------&gt;  传输层   TPDU</span><br><span class="line">              网络层协议</span><br><span class="line">3  网络层   &lt;-------------&gt;  网络层    报文</span><br><span class="line">             数据链路层协议</span><br><span class="line">2 数据链路层 &lt;-------------&gt; 数据链路层  帧</span><br><span class="line">              物理层协议</span><br><span class="line">1  物理层   &lt;-------------&gt;  物理层    比特</span><br></pre></td></tr></table></figure>
<p>1 2 3 4 实际进行数据传输<br>5 6 7   给用户提供服务的</p>
<p>mac地址负责局域网通信<br>ip地址负责外网通信</p>
<p>应用层：用户接口<br>表示层：数据的表现形式、特定功能的实现如加密<br>会话层：对应用会话的管理、同步<br>传输层：可靠与不可靠的传输、传输前的错误检测、流控<br>网络层：提供逻辑地址、选路<br>数据链路层：成帧、用mac地址访问媒介、错误监测与纠正<br>物理层：设备之间的比特流的传输、物理接口、电气特性等</p>
<p></p><h2>TCP/IP协议4层模型</h2><p></p>
<p></p><h3>TCP/IP模型与OSI模型的对应</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">OSI7层模型  TCP/IP4层模型</span><br><span class="line"> 应用层    |</span><br><span class="line"> 表示层    &#125;  应用层</span><br><span class="line"> 会话层    |</span><br><span class="line"> 传输层    &#125;  传输层</span><br><span class="line"> 网络层    &#125;  网络互联层</span><br><span class="line">数据链路层  &#125;  网络接口层</span><br><span class="line"> 物理层    |</span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>IP地址</h2><p></p>
<p></p><h3>数据封装过程</h3><br><img src="/images/37.png" width="800" height="406"><p></p>
<p></p><h3>IP包头</h3><br><img src="/images/36.png" width="800" height="406"><p></p>
<p></p><h3>IP地址分类</h3><br><img src="/images/38.png" width="800" height="406"><p></p>
<p></p><h2>端口号</h2><p></p>
<p></p><h3>TCP协议包头</h3><br><img src="/images/39.png" width="800" height="406"><p></p>
<p></p><h3>UDP协议包头</h3><br><img src="/images/40.png" width="800" height="406"><p></p>
<p></p><h3>常见端口号</h3><br><img src="/images/41.png" width="800" height="406"><p></p>
<p></p><h2>DNS</h2><br>DNS Domain Name System<p></p>
<p></p><h2>查看网络信息</h2><p></p>
<p></p><h3>查看网络信息</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ifconfig</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>重启网络</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/networking restart</span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[centos与ubuntu不同]]></title>
      <url>https://shirly-yan.github.io/2016/10/23/system/centos%E4%B8%8Eubuntu%E4%B8%8D%E5%90%8C/</url>
      <content type="html"><![CDATA[<p>centos与ubuntu不同<br><a id="more"></a></p>
<p>1.关于登录用户<br>centos可以使用root登录  ubuntu不能使用root登录<br>centos普通用户默认不能通过sudo取得root权限执行命令， ubuntu可以，centos需要sudo时需要修改/etc/sudoers文件<br>2.关于网络配置<br>  ubuntu的网络配置文件是在/etc/network/interface文件中，所有网卡都使用一个文件就可以了<br>  centos的配置文件在/etc/sysconfig/network-scripts下，而且一个网卡一个配置文件，分别是ifcfg-eth0,ifcfg-eth1 …..<br>  ubuntu重启网络的脚本是/etc/init.d/networking [start|stop|restart],centos是 /etc/init.d/network [start|stop|restart]</p>
<ol start="3">
<li>自动安装软件<br>ubuntu使用apt-get  centos使用yum<br>4.关于启动项<br>ubuntu的启动机制分析<br>据说ubuntu使用upstart机制实现服务的启动，upstart是个什么玩意，我不知道，但我认真分析了一下ubuntu的各种启动文件发现的这样的一些关系<br>/etc/init.d/ 这个目录里放置了ubuntu下得所有启动项，与centos不同的是，这些不是脚本，而只是一个连接到了/lib/init/upstart-job下，<br>upstart-job脚本执行了类似 $command $JOB的命令<br>当用户执行 service MySQL stop时<br>$command 就是stop $JOB就是mysql<br>相当于执行了stop mysql<br>stop又是/sbin/initctl的一个软连接<br>这就相当于执行了initctl这个程序，用来启动关闭mysql<br>单mysql究竟去哪里找，是一个elf文件还是一个脚本，这个实在不清楚</li>
</ol>
<p>4.关于安装mysql的区别<br> centos上使用yum install mysql就可以安装mysql了<br> 安装后启动文件分别是：<br>/etc/init.d/mysqld 是服务启动脚本<br>/usr/bin/mysqld_safe是一个守护脚本<br>/usr/libexec/mysqld 是mysql的服务程序<br>yum install 安装后mysql初次登录不需要密吗</p>
<p>apt-get 安装mysql在安装的过程中要求输入密码</p>
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[linux文件]]></title>
      <url>https://shirly-yan.github.io/2016/10/20/system/linux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/</url>
      <content type="html"><![CDATA[<p>linux文件<br><a id="more"></a></p>
<h2>文件读写</h2><br><h3>读取</h3><br>显示前n行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head -n</span><br></pre></td></tr></table></figure><br><br><h2>文件权限</h2>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">drwxr-xr-x 4 shirly shirly 4096 Oct 20 17:16 Desktop</span><br><span class="line">文件类型和权限 i-node连接数 所有者 所属用户组 文件大小 文件ctime或者mtime 文件名</span><br><span class="line"></span><br><span class="line">第一组 d     文件类型               </span><br><span class="line">第二组 rwx   所有者权限                           </span><br><span class="line">第三组 r-x   所属组权限</span><br><span class="line">第四组 r-x   其他人权限</span><br></pre></td></tr></table></figure>
<p>r 读 w写 x执行</p>
<p></p><h2>chmod</h2><br>Linux/Unix 的文件调用权限分为三级 : 文件拥有者、群组、其他。利用 chmod 可以藉以控制文件如何被他人所调用。<br>使用权限 : 所有使用者<br>语法<p></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod [-cfvR] [--<span class="built_in">help</span>] [--version] mode file...</span><br></pre></td></tr></table></figure>
<p>参数说明<br>mode : 权限设定字串，格式如下 :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ugoa...][[+-=][rwxX]...][,...]</span><br></pre></td></tr></table></figure>
<p>其中：</p>
<ul>
<li>u 表示该文件的拥有者，g 表示与该文件的拥有者属于同一个群体(group)者，o 表示其他以外的人，a 表示这三者皆是。</li>
<li><ul>
<li>表示增加权限、- 表示取消权限、= 表示唯一设定权限。</li>
</ul>
</li>
<li>r 表示可读取，w 表示可写入，x 表示可执行，X 表示只有当该文件是个子目录或者该文件已经被设定过为可执行。</li>
<li>-c : 若该文件权限确实已经更改，才显示其更改动作</li>
<li>-f : 若该文件权限无法被更改也不要显示错误讯息</li>
<li>-v : 显示权限变更的详细资料</li>
<li>-R : 对目前目录下的所有文件与子目录进行相同的权限变更(即以递回的方式逐个变更)</li>
<li>–help : 显示辅助说明</li>
<li>–version : 显示版本<br>实例</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">将文件 file1.txt 设为所有人皆可读取 :</span><br><span class="line">chmod ugo+r file1.txt</span><br><span class="line">将文件 file1.txt 设为所有人皆可读取 :</span><br><span class="line">chmod a+r file1.txt</span><br><span class="line">将文件 file1.txt 与 file2.txt 设为该文件拥有者，与其所属同一个群体者可写入，但其他以外的人则不可写入 :</span><br><span class="line">chmod ug+w,o-w file1.txt file2.txt</span><br><span class="line">将 ex1.py 设定为只有该文件拥有者可以执行 :</span><br><span class="line">chmod u+x ex1.py</span><br><span class="line">将目前目录下的所有文件与子目录皆设为任何人可读取 :</span><br><span class="line">chmod -R a+r *</span><br></pre></td></tr></table></figure>
<p>此外chmod也可以用数字来表示权限如 :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 file</span><br></pre></td></tr></table></figure>
<p>语法为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod abc file</span><br></pre></td></tr></table></figure>
<p>其中a,b,c各为一个数字，分别表示User、Group、及Other的权限。<br>r=4，w=2，x=1<br>若要rwx属性则4+2+1=7；<br>若要rw-属性则4+2=6；<br>若要r-x属性则4+1=5。<br>chmod a=rwx file<br>和<br>chmod 777 file<br>效果相同<br>chmod ug=rwx,o=x file<br>和<br>chmod 771 file</p>
<p>若用chmod 4755 filename可使此程序具有root的权限</p>
<p>使用chown命令可以修改文件或目录所属的用户：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">命令：chown 用户 目录或文件名</span><br><span class="line">例如：chown qq /home/qq  (把home目录下的qq目录的拥有者改为qq用户)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用chgrp命令可以修改文件或目录所属的组：</span><br><span class="line">命令：chgrp 组 目录或文件名</span><br><span class="line">例如：chgrp qq /home/qq  (把home目录下的qq目录的所属组改为qq组)</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[debian安装sudo]]></title>
      <url>https://shirly-yan.github.io/2016/10/20/system/debian%E5%AE%89%E8%A3%85sudo/</url>
      <content type="html"><![CDATA[<p>debian安装sudo命令<br><a id="more"></a><br>这条命令在ubuntu下可是每日必备、在debian下就要自己安装了、首先切换到root用户、su命令然后输入root密码登录root身份、再执行apt-get install sudo、这个冬冬不明白为什么一定要cd1才能安装、不解不解、那就插入cd1的光碟吧、安装完成后还要修改一下sudoers的文件不然会出现”xxx is not in the sudoers file. This incident will be reported.“的提示</p>
<p>我们只要修改一下/etc/sudoers文件就行了。下面是修改方 法：</p>
<p>1）进入超级用户模式。也就是输入”su -“,系统会让你输入超级用户密码，输入密码后就进入了超级用户模式。（当然，你也可以直接用root用）<br>2）添加文件的写权限。也就是输入命令”chmod u+w /etc/sudoers”。<br>3） 编辑/etc/sudoers文件。也就是输入命令”vi /etc/sudoers”,输入”i”进入编辑模式，找到这一 行：”root ALL=(ALL) ALL”在起下面添加”xxx ALL=(ALL) ALL”(这里的xxx是你的用户名)，然后保存（就是先按一 下Esc键，然后输入”:wq”）退出。<br>4）撤销文件的写权限。也就是输入命令”chmod u-w /etc/sudoers”。</p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[linux用户管理]]></title>
      <url>https://shirly-yan.github.io/2016/10/20/system/linux%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/</url>
      <content type="html"><![CDATA[<p>linux用户管理<br><a id="more"></a></p>
<h2>查看所有的用户组</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/group</span><br></pre></td></tr></table></figure><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deploy :    x       : 1000  :</span><br><span class="line">组名称  : 组密码占位符 : 组编号 : 组中用户名列表</span><br></pre></td></tr></table></figure><br><br><h2>查看所有的用户组组密码</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/gshadow</span><br></pre></td></tr></table></figure><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deploy :   ！  :         :</span><br><span class="line">组名称  : 组密码 : 组管理者 : 组中用户名列表</span><br></pre></td></tr></table></figure><br><br><h2>查看所有的用户</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd</span><br></pre></td></tr></table></figure><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deploy :    x     :   1000  :  1000    :     ,,,    : /home/deploy : /bin/bash</span><br><span class="line"> 用户名 : 密码占位符 : 用户编号 : 用户组编号 : 用户注释信息 : 用户主目录    : shell类型</span><br></pre></td></tr></table></figure><br><br><h2>查看所有的用户密码</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/shadow</span><br></pre></td></tr></table></figure><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">deploy : $6$L :17095:0:99999:7:::</span><br><span class="line"></span><br><span class="line"> 用户名 : 密码 :      : :     : :::</span><br></pre></td></tr></table></figure><br><br><h2>添加用户组</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd groupname</span><br></pre></td></tr></table></figure><br><br>指定用户组编号<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd -g groupnumber groupname</span><br></pre></td></tr></table></figure><br><br><h2>修改用户组组名</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupmod -n newgroupname oldgroupname</span><br></pre></td></tr></table></figure><br><br><h2>修改用户组编号</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupmod -g groupnumber groupname</span><br></pre></td></tr></table></figure><br><br><h2>删除用户组</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupdel groupname</span><br></pre></td></tr></table></figure><br><br><h2>添加用户</h2>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">useradd username</span><br><span class="line">adduser username 推荐</span><br></pre></td></tr></table></figure>
<p>Ubuntu系列linux useradd命令创建的用户属于三无用户 ，不能登录图形界面，在/home/下创建用户所属者所属组的同名目录，就可登录图形界面</p>
<p>指定用户组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -g groupname username</span><br></pre></td></tr></table></figure>
<p>指定用户个人文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -d /home/xxx username</span><br></pre></td></tr></table></figure>
<p></p><h2>修改用户信息</h2><br>修改用户名<p></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -l newUserName oldUserName</span><br></pre></td></tr></table></figure>
<p>修改用户的用户组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -g groupname username</span><br></pre></td></tr></table></figure>
<p>修改用户文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -d /home/xxx usernaem</span><br></pre></td></tr></table></figure>
<p>修改用户注释信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -c userinfo username</span><br></pre></td></tr></table></figure>
<p></p><h2>删除用户</h2><br>只删除用户保留用户文件<p></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userdel username</span><br></pre></td></tr></table></figure>
<p>删除用户及用户相关文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userdel -r username</span><br></pre></td></tr></table></figure>
<p></p><h2>禁止root用户以外的用户登录</h2><br>touch /etc/nologin<p></p>
<p></p><h2>锁定账户</h2><br>passwd -l username<p></p>
<p></p><h2>解锁账户</h2><br>passwd -u username<p></p>
<p></p><h2>清除账户密码</h2><br>passwd -d username<br>可以无密码登录<p></p>
<p></p><h2>设置密码</h2><br>passwd username<p></p>
<p></p><h2>添加附属组</h2><br>gpasswd -a username groupname<p></p>
<p></p><h2>删除附属组</h2><br>gpasswd -d username groupname<p></p>
<p></p><h2>切换组</h2><br>newgrp groupname <p></p>
<p></p><h2>改变组密码</h2><br>gpasswd groupname<p></p>
<p></p><h2>切换用户</h2><br>su username<p></p>
<p></p><h2>显示当前的用户名</h2><br>whoami<p></p>
<p></p><h2>显示用户信息</h2><br>id username<p></p>
<p></p><h2>显示用户所在的所有组</h2><br>groups username<p></p>
<p></p><h2>修改用户详细资料</h2><br>chfn username<p></p>
<p></p><h2>显示用户详细资料</h2><br>finger username<p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[linux系统目录结构]]></title>
      <url>https://shirly-yan.github.io/2016/10/20/system/linux%E7%B3%BB%E7%BB%9F%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/</url>
      <content type="html"><![CDATA[<p>linux系统目录结构<br><a id="more"></a></p>
<p><img src="/images/35.png" width="800" height="368"></p>
<ul>
<li>/bin：bin是Binary的缩写, 这个目录存放着最经常使用的命令。</li>
<li>/boot：这里存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件。</li>
<li>/dev ：dev是Device(设备)的缩写, 该目录下存放的是Linux的外部设备，在Linux中访问设备的方式和访问文件的方式是相同的。</li>
<li>/etc：这个目录用来存放所有的系统管理所需要的配置文件和子目录。</li>
<li>/home：用户的主目录，在Linux中，每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的。</li>
<li>/lib：这个目录里存放着系统最基本的动态连接共享库，其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。</li>
<li>/lost+found：<br>这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件。</li>
<li>/media linux系统会自动识别一些设备，例如U盘、光驱等等，当识别后，linux会把识别的设备挂载到这个目录下。</li>
<li>/mnt：系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将光驱挂载在/mnt/上，然后进入该目录就可以查看光驱里的内容了。</li>
<li>/opt：这是给主机额外安装软件所摆放的目录。比如你安装一个ORACLE数据库则就可以放到这个目录下。默认是空的。</li>
<li>/proc：这个目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。这个目录的内容不在硬盘上而是在内存里，我们也可以直接修改里面的某些文件，比如可以通过下面的命令来屏蔽主机的ping命令，使别人无法ping你的机器：<br>echo 1 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_all</li>
<li>/root：该目录为系统管理员，也称作超级权限者的用户主目录。</li>
<li>/sbin：s就是SuperUser的意思，这里存放的是系统管理员使用的系统管理程序。</li>
<li>/selinux：这个目录是Redhat/CentOS所特有的目录，Selinux是一个安全机制，类似于windows的防火墙，但是这套机制比较复杂，这个目录就是存放selinux相关的文件的。</li>
<li>/srv：该目录存放一些服务启动之后需要提取的数据。</li>
<li>/sys：这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统 sysfs 。<br>sysfs文件系统集成了下面3种文件系统的信息：针对进程信息的proc文件系统、针对设备的devfs文件系统以及针对伪终端的devpts文件系统。<br>该文件系统是内核设备树的一个直观反映。<br>当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中被创建。</li>
<li>/tmp：这个目录是用来存放一些临时文件的。</li>
<li>/usr：这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似与windows下的program files目录。</li>
<li>/usr/bin：<br>系统用户使用的应用程序。</li>
<li>/usr/sbin：<br>超级用户使用的比较高级的管理程序和系统守护程序。</li>
<li>/usr/src：内核源代码默认的放置目录。</li>
<li>/var：这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。<br>在linux系统中，有几个目录是比较重要的，平时需要注意不要误删除或者随意更改内部文件。<br>/etc： 上边也提到了，这个是系统中的配置文件，如果你更改了该目录下的某个文件可能会导致系统不能启动。<br>/bin, /sbin, /usr/bin, /usr/sbin: 这是系统预设的执行文件的放置目录，比如 ls 就是在/bin/ls 目录下的。<br>值得提出的是，/bin, /usr/bin 是给系统用户使用的指令（除root外的通用户），而/sbin, /usr/sbin 则是给root使用的指令。<br>/var： 这是一个非常重要的目录，系统上跑了很多程序，那么每个程序都会有相应的日志产生，而这些日志就被记录到这个目录下，具体在/var/log 目录下，另外mail的预设放置也是在这里。</li>
</ul>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[linux命令]]></title>
      <url>https://shirly-yan.github.io/2016/10/20/system/linux%E5%91%BD%E4%BB%A4/</url>
      <content type="html"><![CDATA[<p>linux常用命令<br><a id="more"></a></p>
<h2>关机与重启</h2>

<h3>关机</h3><br>立即关机<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown -h now</span><br></pre></td></tr></table></figure><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poweroff 不推荐</span><br></pre></td></tr></table></figure><br><br><h3>重启</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown -r</span><br></pre></td></tr></table></figure><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure><br><br>后台执行5点30重启<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown -r 05:30 &amp;</span><br></pre></td></tr></table></figure><br><br><h3>取消前一个关机命令</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown -c</span><br></pre></td></tr></table></figure><br><br><h2>init</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0  关机</span><br><span class="line">1  单用户</span><br><span class="line">2  不完全多用户，不含NFS服务</span><br><span class="line">3  完全多用户</span><br><span class="line">4  未分配</span><br><span class="line">5  图形界面</span><br><span class="line">6  重启</span><br></pre></td></tr></table></figure><br><br><h3>查询系统运行级别</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runlevel</span><br></pre></td></tr></table></figure><br><br><h3>系统默认运行级别</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/inittab</span><br></pre></td></tr></table></figure><br><br><h3>退出登录命令</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logout 退出系统</span><br></pre></td></tr></table></figure><br><br><h2>压缩与解压缩</h2><br>压缩格式 .zip .gz .bz2 .tar.gz .tar.bz2<br><br><h3>安装压缩解压缩工具</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install zip</span><br></pre></td></tr></table></figure><br><br><h3>.zip</h3><br><h4>压缩.zip</h4><br>压缩文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip 压缩文件名 压缩文件</span><br></pre></td></tr></table></figure><br><br>压缩目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip -r 压缩文件名 目录名</span><br></pre></td></tr></table></figure><br><br><h4>解压缩.zip</h4><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip 压缩文件名</span><br></pre></td></tr></table></figure><br><br><h3>.gz</h3><br><h4>压缩.gz</h4><br>不保留源文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip 压缩文件</span><br></pre></td></tr></table></figure><br><br>保留源文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -c 源文件 &gt; 压缩文件</span><br></pre></td></tr></table></figure><br><br>压缩目录下的所有子文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -r 目录</span><br></pre></td></tr></table></figure><br><br><h4>解压缩.gz</h4><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -d 压缩文件名</span><br></pre></td></tr></table></figure><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gunzip 压缩文件名</span><br></pre></td></tr></table></figure><br><br>解压缩目录下的所有文件<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gunzip -r 目录名</span><br></pre></td></tr></table></figure><br><br><h3>.bz2</h3><br><h4>压缩.bz2</h4><br>bzip2不能压缩目录<br><br>不保留源文件<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bzip2 源文件</span><br></pre></td></tr></table></figure><br><br>保留源文件<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bzip2 -k 源文件</span><br></pre></td></tr></table></figure><br><br><h4>解压缩.bz2</h4><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bunzip2 压缩文件</span><br></pre></td></tr></table></figure><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bzip2 -d 压缩文件</span><br></pre></td></tr></table></figure><br><br>-k保留压缩文件<br><br><h3>tar打包命令</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar -cvf 打包文件名 源文件</span><br><span class="line">选项：</span><br><span class="line">    -c: 打包</span><br><span class="line">    -v: 显示过程</span><br><span class="line">    -f: 指定打包后的文件名</span><br><span class="line">例：</span><br><span class="line">tar -cvf test.tar test</span><br></pre></td></tr></table></figure><br><br><h3>.tar.gz</h3><br><h4>压缩.tar.gz</h4><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zcvf 压缩包名.tar.gz 源文件</span><br></pre></td></tr></table></figure><br><br><h4>解压缩.tar.gz</h4><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf 压缩包名.tar.gz</span><br></pre></td></tr></table></figure><br><br><h3>.tar.bz2</h3><br><h4>压缩.tar.bz2</h4><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -jcvf 压缩包名.tar.bz2 源文件</span><br></pre></td></tr></table></figure><br><br><h4>解压缩.tar.bz2</h4><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -jxvf 压缩包名.tar.bz2</span><br></pre></td></tr></table></figure><br><br><h2>帮助命令</h2><br><h3>man的级别</h3>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1 ：常看命令的帮助</span><br><span class="line">2 ：查看可被内核调用的函数的帮助</span><br><span class="line">3 ：查看函数和函数库的帮助</span><br><span class="line">4 ：查看特殊文件的帮助（主要是/dev目录下的文件）</span><br><span class="line">5 ：查看配置文件的帮助</span><br><span class="line">6 ：查看游戏的帮助</span><br><span class="line">7 ：查看其它杂项的帮助</span><br><span class="line">8 ：查看系统管理员可用命令的帮助</span><br><span class="line">9 ：查看和内核相关文件的帮助</span><br></pre></td></tr></table></figure>
<h3>显示命令帮助</h3>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man 命令</span><br></pre></td></tr></table></figure>
<h4>显示命令帮助等级</h4>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man -f 命令</span><br></pre></td></tr></table></figure>
<p>相当于</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whatis 命令</span><br></pre></td></tr></table></figure>
<h4>调用相应等级的帮助</h4>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man -等级 命令</span><br></pre></td></tr></table></figure>
<h4>查看和命令相关的所有帮助</h4>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man -k 命令</span><br></pre></td></tr></table></figure>
<p>相当于</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apropos 命令</span><br></pre></td></tr></table></figure>
<p></p><h3>选项帮助</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">命令 --help</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>shell内部命令帮助</h3><p></p>
<p></p><h4>确定是否是shell命令</h4><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whereis 命令</span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>获取内部命令帮助</h4><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help shell内部命令</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>详细命令帮助info</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">info 命令</span><br><span class="line">- 回车 : 进入子帮助页面（带有*号标记）</span><br><span class="line">- u   : 进入上层页面</span><br><span class="line">- n   : 进入下一个帮助小节</span><br><span class="line">- p   : 进入上一个帮助小节</span><br><span class="line">- q   : 退出</span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>目录</h2><p></p>
<p></p><h3>建立目录</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir 目录名</span><br></pre></td></tr></table></figure><p></p>
<p>递归创建</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p 目录名/目录名</span><br></pre></td></tr></table></figure>
<p></p><h3>切换目录</h3><br>进入当前用户的家目录<p></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br></pre></td></tr></table></figure>
<p></p><h3>清屏</h3><br>control + l<p></p>
<p></p><h3>查看debian版本</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more /etc/debian_version</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>查看内核版本</h3><br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[virtualbox安装debian]]></title>
      <url>https://shirly-yan.github.io/2016/10/19/system/virtualbox%E5%AE%89%E8%A3%85debian/</url>
      <content type="html"><![CDATA[<p>mac系统下安装virtualbox virtualbox中安装debian<br><a id="more"></a></p>
<p></p><h2>下载virtualbox</h2><br><a href="https://www.virtualbox.org/" target="_blank" rel="noopener">官网下载</a><p></p>
<p></p><h2>安装virtualbox</h2><p></p>
<h3>打开 双击VirtualBox.pkg</h3><br><img src="/images/9.png" width="800" height="465"><br><br><h3>运行一个测试程序 点击继续</h3><br><img src="/images/10.png" width="800" height="465"><br>一路继续 安装完成<br><br><h2>新建一个虚拟电脑</h2><br><h3>点击新建 命名 选择相应的类型和版本</h3><br><img src="/images/11.png" width="800" height="586"><br><br><h3>内存大小</h3><br><img src="/images/12.png" width="800" height="586"><br><br><h3>虚拟硬盘</h3><br><img src="/images/13.png" width="800" height="586"><br><br><h3>虚拟硬盘文件类型</h3><br><img src="/images/14.png" width="800" height="586"><br><br><h3>动态分配</h3><br><img src="/images/15.png" width="800" height="586"><br><br><h3>保存的位置</h3><br><img src="/images/16.png" width="800" height="586"><br>这是虚拟电脑就一创建成功<br><br><h2>安装debian系统</h2><br><h3>下载debian镜像</h3><br><a href="https://www.debian.org/index.zh-cn.html" target="_blank" rel="noopener">官网下载</a><br><br>选择<font color="#FF6666"> 取得 Debian </font>下的<font color="#FF6666"> CD/USB ISO 映像</font><br><br>选择<font color="#FF6666"> 通过 BitTorrent 下载光盘映像文件</font><br><br>选择<font color="#FF6666">CD</font>下的<font color="#FF6666">amd64</font><br><br>选择<font color="#FF6666"> debian-8.6.0-amd64-xfce-CD-1.iso.torrent</font><br><br><h3>选择虚拟盘</h3><br><img src="/images/17.png" width="800" height="586"><br><br><h3>启动</h3>

<h3>Graphical install</h3><br><img src="/images/18.png" width="800" height="648"><br><br><h3>设置语言</h3><br><img src="/images/19.png" width="800" height="648"><br><br><h3>设置位置</h3><br><img src="/images/20.png" width="800" height="648"><br><br><h3>设置键盘</h3><br><img src="/images/21.png" width="800" height="648"><br><br><h3>设置网络 可不变</h3><br><img src="/images/22.png" width="800" height="648"><br><br><h3>设置网络 可不填</h3><br><img src="/images/23.png" width="800" height="648"><br><br><h3>设置root用户密码</h3><br><img src="/images/24.png" width="800" height="648"><br><br><h3>创建一个新用户</h3><br><img src="/images/25.png" width="800" height="648"><br><br><h3>确认新用户名字</h3>

<p></p><h3>设置新用户用户密码</h3><br><img src="/images/26.png" width="800" height="648"><p></p>
<p><img src="/images/27.png" width="800" height="648"><br><img src="/images/28.png" width="800" height="648"><br><img src="/images/29.png" width="800" height="648"><br><img src="/images/30.png" width="800" height="648"><br><img src="/images/31.png" width="800" height="648"><br><img src="/images/32.png" width="800" height="648"><br><img src="/images/33.png" width="800" height="648"><br><img src="/images/34.png" width="800" height="648"></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php图形操作]]></title>
      <url>https://shirly-yan.github.io/2016/10/17/php/php%E5%9B%BE%E5%BD%A2%E6%93%8D%E4%BD%9C/</url>
      <content type="html"><![CDATA[<p>php图形操作<br><a id="more"></a><br>GD指的是Graphic Device，PHP的GD库是用来处理图形的扩展库，通过GD库提供的一系列API，可以对图像进行处理或者直接生成新的图片。<br>PHP除了能进行文本处理以外，通过GD库，可以对JPG、PNG、GIF、SWF等图片进行处理。GD库常用在图片加水印，验证码生成等方面。<br>PHP默认已经集成了GD库，只需要在安装的时候开启就行。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">"content-type: image/png"</span>);</span><br><span class="line">$img=imagecreatetruecolor(<span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">$red=imagecolorallocate($img, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>);</span><br><span class="line">imagefill($img, <span class="number">0</span>, <span class="number">0</span>, $red);</span><br><span class="line">imagepng($img);</span><br><span class="line">imagedestroy($img);</span><br></pre></td></tr></table></figure>
<p></p><h2>绘制线条</h2><br>要对图形进行操作，首先要新建一个画布，通过imagecreatetruecolor函数可以创建一个真彩色的空白图片：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$img = imagecreatetruecolor(<span class="number">100</span>, <span class="number">100</span>);</span><br></pre></td></tr></table></figure>
<p>GD库中对于画笔所用的颜色，需要通过imagecolorallocate函数进行分配，通过参数设定RGB的颜色值来确定画笔的颜色：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$red = imagecolorallocate($img, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>);</span><br></pre></td></tr></table></figure>
<p>然后我们通过调用绘制线段函数imageline进行线条的绘制，通过指定起点跟终点来最终得到线条。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imageline($img, <span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">100</span>, $red);</span><br></pre></td></tr></table></figure>
<p>线条绘制好以后，通过header与imagepng进行图像的输出。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">"content-type: image/png"</span>);</span><br><span class="line">imagepng($img);</span><br></pre></td></tr></table></figure>
<p>最后可以调用imagedestroy释放该图片占用的内存。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imagedestroy($img);</span><br></pre></td></tr></table></figure>
<p>通过上面的步骤，可以发现PHP绘制图形非常的简单，但很多时候我们不只是需要输出图片，可能我们还需要得到一个图片文件，可以通过imagepng函数指定文件名将绘制后的图像保存到文件中。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imagepng($img, <span class="string">'img.png'</span>);</span><br></pre></td></tr></table></figure>
<p></p><h2>生成图像验证码</h2><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$img = imagecreatetruecolor(<span class="number">100</span>, <span class="number">40</span>);</span><br><span class="line">$black = imagecolorallocate($img, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>);</span><br><span class="line">$green = imagecolorallocate($img, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>);</span><br><span class="line">$white = imagecolorallocate($img, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>);</span><br><span class="line">imagefill($img,<span class="number">0</span>,<span class="number">0</span>,$white);</span><br><span class="line"><span class="comment">//生成随机的验证码</span></span><br><span class="line">$code = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">4</span>; $i++) &#123;</span><br><span class="line">    $code .= rand(<span class="number">0</span>, <span class="number">9</span>);</span><br><span class="line">&#125;</span><br><span class="line">imagestring($img, <span class="number">5</span>, <span class="number">10</span>, <span class="number">10</span>, $code, $black);</span><br><span class="line"><span class="comment">//加入噪点干扰</span></span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;<span class="number">50</span>;$i++) &#123;</span><br><span class="line">  imagesetpixel($img, rand(<span class="number">0</span>, <span class="number">100</span>) , rand(<span class="number">0</span>, <span class="number">100</span>) , $black); </span><br><span class="line">  imagesetpixel($img, rand(<span class="number">0</span>, <span class="number">100</span>) , rand(<span class="number">0</span>, <span class="number">100</span>) , $green);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出验证码</span></span><br><span class="line">header(<span class="string">"content-type: image/png"</span>);</span><br><span class="line">imagepng($img);</span><br><span class="line">imagedestroy($img);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php日期和时间]]></title>
      <url>https://shirly-yan.github.io/2016/10/17/php/php%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4/</url>
      <content type="html"><![CDATA[<p>php日期和时间<br><a id="more"></a></p>
<p></p><h2>取得当前的Unix时间戳</h2><br>UNIX 时间戳（英文叫做：timestamp）是 PHP 中关于时间与日期的一个很重要的概念，它表示从 1970年1月1日 00:00:00 到当前时间的秒数之和。<br>PHP提供了内置函数 time() 来取得服务器当前时间的时间戳。那么获取当前的UNIX时间戳就很简单了。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$time = time();</span><br><span class="line"><span class="keyword">echo</span> $time;<span class="comment">//1396193923，这个数字表示从1970年1月1日 00:00:00 到我输出这个脚本时经历了1396193923秒</span></span><br></pre></td></tr></table></figure>
<p></p><h2>取得当前的日期</h2><br>php内置了date()函数，来取得当前的日期。<br>函数说明：date(时间戳的格式, 规定时间戳【默认是当前的日期和时间，可选】)<br>返回值：函数日期和时间<br>例子：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//date函数，第二个参数取默认值的情况</span></span><br><span class="line"><span class="keyword">echo</span> date(<span class="string">"Y-m-d"</span>);<span class="comment">//2014-03-30</span></span><br><span class="line"><span class="comment">//date函数，第二个参数有值的情况</span></span><br><span class="line"><span class="keyword">echo</span> date(<span class="string">"Y-m-d"</span>,<span class="string">'1396193923'</span>);<span class="comment">//2014-03-30,1396193923表示2014-03-30的unix时间戳</span></span><br></pre></td></tr></table></figure>
<p></p><h2>取得日期的Unix时间戳</h2><br>PHP提供了内置函数strtotime实现功能：获取某个日期的时间戳，或获取某个时间的时间戳。例如：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> strtotime(<span class="string">'2014-04-29'</span>);<span class="comment">//1398700800，这个数字表示从1970年1月1日 00:00:00 到2014年4月29号经历了1398700800秒</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> strtotime(<span class="string">'2014-04-29 00:00:01'</span>);<span class="comment">//1398700801，这个数字表示从1970年1月1日 00:00:00 到2014-04-29 00:00:01时经历了1398700801秒</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//大家发现上面的规律了吗，其实strtotime('2014-04-29')相当于strtotime('2014-04-29 00:00:00')</span></span><br></pre></td></tr></table></figure>
<p></p><h2>将格式化的日期字符串转换为Unix时间戳</h2><br>strtotime函数预期接受一个包含美国英语日期格式的字符串并尝试将其解析为 Unix 时间戳。<br>函数说明：strtotime(要解析的时间字符串, 计算返回值的时间戳【默认是当前的时间，可选】)<br>返回值：成功则返回时间戳，否则返回 FALSE<br>比如<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> strtotime(<span class="string">"now"</span>);<span class="comment">//相当于将英文单词now直接等于现在的日期和时间，并把这个日期时间转化为unix时间戳。这个效果跟echo time();一样。</span></span><br><span class="line"><span class="keyword">echo</span> strtotime(<span class="string">"+1 seconds"</span>);<span class="comment">//相当于将现在的日期和时间加上了1秒，并把这个日期时间转化为unix时间戳。这个效果跟echo time()+1;一样。</span></span><br><span class="line"><span class="keyword">echo</span> strtotime(<span class="string">"+1 day"</span>);<span class="comment">//相当于将现在的日期和时间加上了1天。</span></span><br><span class="line"><span class="keyword">echo</span> strtotime(<span class="string">"+1 week"</span>);<span class="comment">//相当于将现在的日期和时间加上了1周。</span></span><br><span class="line"><span class="keyword">echo</span> strtotime(<span class="string">"+1 week 3 days 7 hours 5 seconds"</span>);<span class="comment">//相当于将现在的日期和时间加上了1周3天7小时5秒。</span></span><br></pre></td></tr></table></figure>
<p></p><h2>格式化格林威治（GMT）标准时间</h2><br>gmdate函数能格式化一个GMT的日期和时间，返回的是格林威治标准时（GMT）。<br>举个例子，我们现在所在的中国时区是东八区，领先格林威治时间8个小时，有时候也叫GMT+8，那么服务器运行以下脚本返回的时间应该是这样的：<br>当前时间假定是2014-05-01 15:15:22<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> date(<span class="string">'Y-m-d H:i:s'</span>, time()); <span class="comment">//输出为：2014-05-01 15:15:22 </span></span><br><span class="line"><span class="keyword">echo</span> gmdate(<span class="string">'Y-m-d H:i:s'</span>, time()); <span class="comment">//输出为：2014-05-01 07:15:22 因为格林威治时间是现在中国时区的时间减去8个小时，所以相对于现在时间要少8个小时</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php文件系统]]></title>
      <url>https://shirly-yan.github.io/2016/10/17/php/php%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/</url>
      <content type="html"><![CDATA[<p>php文件系统<br><a id="more"></a></p>
<p></p><h2>读取文件内容</h2><br>PHP具有丰富的文件操作函数，最简单的读取文件的函数为file_get_contents，可以将整个文件全部读取到一个字符串中。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$content = file_get_contents(<span class="string">'./test.txt'</span>);</span><br></pre></td></tr></table></figure>
<p>file_get_contents也可以通过参数控制读取内容的开始点以及长度。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$content = file_get_contents(<span class="string">'./test.txt'</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="number">100</span>, <span class="number">500</span>);</span><br></pre></td></tr></table></figure>
<p>PHP也提供类似于C语言操作文件的方法，使用fopen，fgets，fread等方法，fgets可以从文件指针中读取一行，freads可以读取指定长度的字符串。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$fp = fopen(<span class="string">'./text.txt'</span>, <span class="string">'rb'</span>);</span><br><span class="line"><span class="keyword">while</span>(!feof($fp)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> fgets($fp); <span class="comment">//读取一行</span></span><br><span class="line">&#125;</span><br><span class="line">fclose($fp);</span><br><span class="line"> </span><br><span class="line">$fp = fopen(<span class="string">'./text.txt'</span>, <span class="string">'rb'</span>);</span><br><span class="line">$contents = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">while</span>(!feof($fp)) &#123;</span><br><span class="line">    $contents .= fread($fp, <span class="number">4096</span>); <span class="comment">//一次读取4096个字符</span></span><br><span class="line">&#125;</span><br><span class="line">fclose($fp);</span><br></pre></td></tr></table></figure>
<p>使用fopen打开的文件，最好使用fclose关闭文件指针，以避免文件句柄被占用。</p>
<p></p><h2>判断文件是否存在</h2><br>一般情况下在对文件进行操作的时候需要先判断文件是否存在，PHP中常用来判断文件存在的函数有两个is_file与file_exists.<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$filename = <span class="string">'./test.txt'</span>;</span><br><span class="line"><span class="keyword">if</span> (file_exists($filename)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents($filename);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果只是判断文件存在，使用file_exists就行，file_exists不仅可以判断文件是否存在，同时也可以判断目录是否存在，从函数名可以看出，is_file是确切的判断给定的路径是否是一个文件。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$filename = <span class="string">'./test.txt'</span>;</span><br><span class="line"><span class="keyword">if</span> (is_file($filename)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents($filename);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>更加精确的可以使用is_readable与is_writeable在文件是否存在的基础上，判断文件是否可读与可写。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$filename = <span class="string">'./test.txt'</span>;</span><br><span class="line"><span class="keyword">if</span> (is_writeable($filename)) &#123;</span><br><span class="line">    file_put_contents($filename, <span class="string">'test'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (is_readable($filename)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents($filename);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p></p><h2>取得文件的修改时间</h2><br>文件有很多元属性，包括：文件的所有者、创建时间、修改时间、最后的访问时间等。<p></p>
<ul>
<li>fileowner：获得文件的所有者</li>
<li>filectime：获取文件的创建时间</li>
<li>filemtime：获取文件的修改时间</li>
<li>fileatime：获取文件的访问时间<br>其中最常用的是文件的修改时间，通过文件的修改时间，可以判断文件的时效性，经常用在静态文件或者缓存数据的更新。</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$mtime = filemtime($filename);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'修改时间：'</span>.date(<span class="string">'Y-m-d H:i:s'</span>, filemtime($filename));</span><br></pre></td></tr></table></figure>
<p></p><h2>取得文件的大小</h2><br>通过filesize函数可以取得文件的大小，文件大小是以字节数表示的。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$filename = <span class="string">'/data/webroot/usercode/resource/test.txt'</span>;</span><br><span class="line">$size = filesize($filename);</span><br></pre></td></tr></table></figure>
<p>如果要转换文件大小的单位，可以自己定义函数来实现。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getsize</span><span class="params">($size, $format = <span class="string">'kb'</span>)</span> </span>&#123;</span><br><span class="line">    $p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ($format == <span class="string">'kb'</span>) &#123;</span><br><span class="line">        $p = <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">elseif</span> ($format == <span class="string">'mb'</span>) &#123;</span><br><span class="line">        $p = <span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">elseif</span> ($format == <span class="string">'gb'</span>) &#123;</span><br><span class="line">        $p = <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $size /= pow(<span class="number">1024</span>, $p);</span><br><span class="line">    <span class="keyword">return</span> number_format($size, <span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$filename = <span class="string">'/data/webroot/usercode/code/resource/test.txt'</span>;</span><br><span class="line">$size = filesize($filename);</span><br><span class="line"></span><br><span class="line">$size = getsize($size, <span class="string">'kb'</span>); <span class="comment">//进行单位转换</span></span><br><span class="line"><span class="keyword">echo</span> $size.<span class="string">'kb'</span>;</span><br></pre></td></tr></table></figure>
<p>值得注意的是，没法通过简单的函数来取得目录的大小，目录的大小是该目录下所有子目录以及文件大小的总和，因此需要通过递归的方法来循环计算目录的大小。</p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[会话控制（session与cookie）]]></title>
      <url>https://shirly-yan.github.io/2016/10/17/php/%E4%BC%9A%E8%AF%9D%E6%8E%A7%E5%88%B6%EF%BC%88session%E4%B8%8Ecookie%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>会话控制（session与cookie）<br><a id="more"></a></p>
<p></p><h2>cookie</h2><br>Cookie是存储在客户端浏览器中的数据，我们通过Cookie来跟踪与存储用户数据。一般情况下，Cookie通过HTTP headers从服务端返回到客户端。多数web程序都支持Cookie的操作，因为Cookie是存在于HTTP的标头之中，所以必须在其他信息输出以前进行设置，类似于header函数的使用限制。<br>PHP通过setcookie函数进行Cookie的设置，任何从浏览器发回的Cookie，PHP都会自动的将他存储在$_COOKIE的全局变量之中，因此我们可以通过$_COOKIE[‘key’]的形式来读取某个Cookie值。<br>PHP中的Cookie具有非常广泛的使用，经常用来存储用户的登录信息，购物车等，且在使用会话Session时通常使用Cookie来存储会话id来识别用户，Cookie具备有效期，当有效期结束之后，Cookie会自动的从客户端删除。同时为了进行安全控制，Cookie还可以设置域跟路径，我们会在稍后的章节中详细的讲解他们。<p></p>
<p></p><h3>设置Cookie</h3><br>PHP设置Cookie最常用的方法就是使用setcookie函数，setcookie具有7个可选参数，我们常用到的为前5个：<p></p>
<ul>
<li>name（ Cookie名）可以通过$_COOKIE[‘name’] 进行访问</li>
<li>value（Cookie的值）</li>
<li>expire（过期时间）Unix时间戳格式，默认为0，表示浏览器关闭即失效</li>
<li>path（有效路径）如果路径设置为’/‘，则整个网站都有效</li>
<li>domain（有效域）默认整个域名都有效，如果设置了’<a href="http://www.imooc.com&#39;,则只在www子域中有效" target="_blank" rel="noopener">www.imooc.com&#39;,则只在www子域中有效</a></li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$value = <span class="string">'test'</span>;</span><br><span class="line">setcookie(<span class="string">"TestCookie"</span>, $value);</span><br><span class="line">setcookie(<span class="string">"TestCookie"</span>, $value, time()+<span class="number">3600</span>);  <span class="comment">//有效期一小时</span></span><br><span class="line">setcookie(<span class="string">"TestCookie"</span>, $value, time()+<span class="number">3600</span>, <span class="string">"/path/"</span>, <span class="string">"imooc.com"</span>); <span class="comment">//设置路径与域</span></span><br></pre></td></tr></table></figure>
<p>PHP中还有一个设置Cookie的函数setrawcookie，setrawcookie跟setcookie基本一样，唯一的不同就是value值不会自动的进行urlencode，因此在需要的时候要手动的进行urlencode。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setrawcookie(<span class="string">'cookie_name'</span>, rawurlencode($value), time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">365</span>); </span><br><span class="line"><span class="comment">//因为Cookie是通过HTTP标头进行设置的，所以也可以直接使用header方法进行设置。</span></span><br><span class="line">header(<span class="string">"Set-Cookie:cookie_name=value"</span>);</span><br></pre></td></tr></table></figure>
<p></p><h3>cookie的删除与过期时间</h3><br>setcookie(‘test’, ‘’, time()-1);<br>可以看到将cookie的过期时间设置到当前时间之前，则该cookie会自动失效，也就达到了删除cookie的目的。之所以这么设计是因为cookie是通过HTTP的标头来传递的，客户端根据服务端返回的Set-Cookie段来进行cookie的设置，如果删除cookie需要使用新的Del-Cookie来实现，则HTTP头就会变得复杂，实际上仅通过Set-Cookie就可以简单明了的实现Cookie的设置、更新与删除。<br>了解原理以后，我们也可以直接通过header来删除cookie。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">"Set-Cookie:test=1393832059; expires="</span>.gmdate(<span class="string">'D, d M Y H:i:s \G\M\T'</span>, time()<span class="number">-1</span>));</span><br></pre></td></tr></table></figure>
<p>这里用到了gmdate，用来生成格林威治标准时间，以便排除时差的影响。</p>
<p></p><h3>cookie的有效路径</h3><br>cookie中的路径用来控制设置的cookie在哪个路径下有效，默认为’/‘，在所有路径下都有，当设定了其他路径之后，则只在设定的路径以及子路径下有效，例如：<br>setcookie(‘test’, time(), 0, ‘/path’);<br>上面的设置会使test在/path以及子路径/path/abc下都有效，但是在根目录下就读取不到test的cookie值。<br>一般情况下，大多是使用所有路径的，只有在极少数有特殊需求的时候，会设置路径，这种情况下只在指定的路径中才会传递cookie值，可以节省数据的传输，增强安全性以及提高性能。<br>当我们设置了有效路径的时候，不在当前路径的时候则看不到当前cookie。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setcookie(<span class="string">'test'</span>, <span class="string">'1'</span>,<span class="number">0</span>, <span class="string">'/path'</span>);  </span><br><span class="line">var_dump($_COOKIE[<span class="string">'test'</span>]);</span><br></pre></td></tr></table></figure>
<p></p><h3>session</h3><p></p>
<p></p><h3>session与cookie的异同</h3><br>cookie将数据存储在客户端，建立起用户与服务器之间的联系，通常可以解决很多问题，但是cookie仍然具有一些局限：<br>cookie相对不是太安全，容易被盗用导致cookie欺骗<p></p>
<p><font color="#FF6666">单个cookie的值最大只能存储4k</font><br>每次请求都要进行网络传输，占用带宽<br>session是将用户的会话数据存储在服务端，没有大小限制，通过一个session_id进行用户识别，PHP默认情况下session id是通过cookie来保存的，因此从某种程度上来说，seesion依赖于cookie。但这不是绝对的，session id也可以通过参数来实现，只要能将session id传递到服务端进行识别的机制都可以使用session。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//开始使用session</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="comment">//设置一个session</span></span><br><span class="line">$_SESSION[<span class="string">'test'</span>] = time();</span><br><span class="line"><span class="comment">//显示当前的session_id</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"session_id:"</span>.session_id();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取session值</span></span><br><span class="line"><span class="keyword">echo</span> $_SESSION[<span class="string">'test'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//销毁一个session</span></span><br><span class="line"><span class="keyword">unset</span>($_SESSION[<span class="string">'test'</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">var_dump($_SESSION);</span><br></pre></td></tr></table></figure>
<p></p><h3>使用session</h3><br>在PHP中使用session非常简单，先执行session_start方法开启session，然后通过全局变量$_SESSION进行session的读写。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">session_start();</span><br><span class="line">$_SESSION[<span class="string">'test'</span>] = time();</span><br><span class="line">var_dump($_SESSION);</span><br></pre></td></tr></table></figure>
<p>session会自动的对要设置的值进行encode与decode，因此session可以支持任意数据类型，包括数据与对象等。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">session_start();</span><br><span class="line">$_SESSION[<span class="string">'ary'</span>] = <span class="keyword">array</span>(<span class="string">'name'</span> =&gt; <span class="string">'jobs'</span>);</span><br><span class="line">$_SESSION[<span class="string">'obj'</span>] = <span class="keyword">new</span> stdClass();</span><br><span class="line">var_dump($_SESSION);</span><br></pre></td></tr></table></figure>
<p>默认情况下，session是以文件形式存储在服务器上的，因此当一个页面开启了session之后，会独占这个session文件，这样会导致当前用户的其他并发访问无法执行而等待。可以采用缓存或者数据库的形式存储来解决这个问题，</p>
<p></p><h3>删除与销毁session</h3><br>删除某个session值可以使用PHP的unset函数，删除后就会从全局变量$_SESSION中去除，无法访问。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">session_start();</span><br><span class="line">$_SESSION[<span class="string">'name'</span>] = <span class="string">'jobs'</span>;</span><br><span class="line"><span class="keyword">unset</span>($_SESSION[<span class="string">'name'</span>]);</span><br><span class="line"><span class="keyword">echo</span> $_SESSION[<span class="string">'name'</span>]; <span class="comment">//提示name不存在</span></span><br></pre></td></tr></table></figure>
<p>如果要删除所有的session，可以使用session_destroy函数销毁当前session，session_destroy会删除所有数据，但是session_id仍然存在。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">session_start();</span><br><span class="line">$_SESSION[<span class="string">'name'</span>] = <span class="string">'jobs'</span>;</span><br><span class="line">$_SESSION[<span class="string">'time'</span>] = time();</span><br><span class="line">session_destroy();</span><br></pre></td></tr></table></figure>
<p>值得注意的是，session_destroy并不会立即的销毁全局变量$_SESSION中的值，只有当下次再访问的时候，$_SESSION才为空，因此如果需要立即销毁$_SESSION，可以使用unset函数。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">session_start();</span><br><span class="line">$_SESSION[<span class="string">'name'</span>] = <span class="string">'jobs'</span>;</span><br><span class="line">$_SESSION[<span class="string">'time'</span>] = time();</span><br><span class="line"><span class="keyword">unset</span>($_SESSION);</span><br><span class="line">session_destroy(); </span><br><span class="line">var_dump($_SESSION); <span class="comment">//此时已为空</span></span><br></pre></td></tr></table></figure>
<p>如果需要同时销毁cookie中的session_id，通常在用户退出的时候可能会用到，则还需要显式的调用setcookie方法删除session_id的cookie值。</p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[正则表达式]]></title>
      <url>https://shirly-yan.github.io/2016/10/17/php/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>正则表达式<br><a id="more"></a><br>PHP使用PCRE库函数来进行正则处理，通过设定好模式，然后调用相关的处理函数来取得匹配结果。</p>
<p></p><h2>preg_match</h2><br>preg_match用来执行一个匹配，可以简单的用来判断模式是否匹配成功，或者取得一个匹配结果，他的返回值是匹配成功的次数0或者1，在匹配到1次以后就会停止搜索。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$subject = <span class="string">"abcdef"</span>;</span><br><span class="line">$pattern = <span class="string">'/def/'</span>;</span><br><span class="line">preg_match($pattern, $subject, $matches);</span><br><span class="line">print_r($matches); <span class="comment">//结果为：Array ( [0] =&gt; def )</span></span><br></pre></td></tr></table></figure>
<p>上面的代码简单的执行了一个匹配，简单的判断def是否能匹配成功，但是正则表达式的强大的地方是进行模式匹配，因此更多的时候，会使用模式：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$subject = <span class="string">"abcdef"</span>;</span><br><span class="line">$pattern = <span class="string">'/a(.*?)d/'</span>;</span><br><span class="line">preg_match($pattern, $subject, $matches);</span><br><span class="line">print_r($matches); <span class="comment">//结果为：Array ( [0] =&gt; abcd [1] =&gt; bc )</span></span><br></pre></td></tr></table></figure>
<p>通过正则表达式可以匹配一个模式，得到更多的有用的数据。</p>
<p></p><h2>preg_match_all</h2><br>preg_match_all可以循环获取一个列表的匹配结果数组。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$p = <span class="string">"|&lt;[^&gt;]+&gt;(.*?)&lt;/[^&gt;]+&gt;|i"</span>;</span><br><span class="line">$str = <span class="string">"&lt;b&gt;example: &lt;/b&gt;&lt;div align=left&gt;this is a test&lt;/div&gt;"</span>;</span><br><span class="line">preg_match_all($p, $str, $matches);</span><br><span class="line">print_r($matches);</span><br></pre></td></tr></table></figure>
<p>可以使用preg_match_all匹配一个表格中的数据：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$p = <span class="string">"/&lt;tr&gt;&lt;td&gt;(.*?)&lt;\/td&gt;\s*&lt;td&gt;(.*?)&lt;\/td&gt;\s*&lt;\/tr&gt;/i"</span>;</span><br><span class="line">$str = <span class="string">"&lt;table&gt; &lt;tr&gt;&lt;td&gt;Eric&lt;/td&gt;&lt;td&gt;25&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;John&lt;/td&gt;&lt;td&gt;26&lt;/td&gt;&lt;/tr&gt; &lt;/table&gt;"</span>;</span><br><span class="line">preg_match_all($p, $str, $matches);</span><br><span class="line">print_r($matches);</span><br><span class="line">$matches结果排序为$matches[<span class="number">0</span>]保存完整模式的所有匹配, $matches[<span class="number">1</span>] 保存第一个子组的所有匹配，以此类推。</span><br></pre></td></tr></table></figure>
<p></p><h2>正则表达式的基本语法</h2><br>PCRE库函数中，正则匹配模式使用分隔符与元字符组成，分隔符可以是非数字、非反斜线、非空格的任意字符。经常使用的分隔符是正斜线(/)、hash符号(#) 以及取反符号(~)，例如：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/foo bar/</span><br><span class="line"><span class="comment">#^[^0-9]$#</span></span><br><span class="line">~php~</span><br></pre></td></tr></table></figure>
<p>如果模式中包含分隔符，则分隔符需要使用反斜杠（\）进行转义。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/http:\/\<span class="comment">//</span></span><br></pre></td></tr></table></figure>
<p>如果模式中包含较多的分割字符，建议更换其他的字符作为分隔符，也可以采用preg_quote进行转义。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$p = <span class="string">'http://'</span>;</span><br><span class="line">$p = <span class="string">'/'</span>.preg_quote($p, <span class="string">'/'</span>).<span class="string">'/'</span>;</span><br><span class="line"><span class="keyword">echo</span> $p;</span><br><span class="line">分隔符后面可以使用模式修饰符，模式修饰符包括：i, m, s, x等，例如使用i修饰符可以忽略大小写匹配：</span><br><span class="line">$str = <span class="string">"Http://www.imooc.com/"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">'/http/i'</span>, $str)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'匹配成功'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p></p><h2>元字符与转义</h2><br>正则表达式中具有特殊含义的字符称之为元字符，常用的元字符有：<p></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">\ 一般用于转义字符</span><br><span class="line">^ 断言目标的开始位置(或在多行模式下是行首)</span><br><span class="line">$ 断言目标的结束位置(或在多行模式下是行尾)</span><br><span class="line">. 匹配除换行符外的任何字符(默认)</span><br><span class="line">[ 开始字符类定义</span><br><span class="line">] 结束字符类定义</span><br><span class="line">| 开始一个可选分支</span><br><span class="line">( 子组的开始标记</span><br><span class="line">) 子组的结束标记</span><br><span class="line">? 作为量词，表示 0 次或 1 次匹配。位于量词后面用于改变量词的贪婪特性。 (查阅量词)</span><br><span class="line">* 量词，0 次或多次匹配</span><br><span class="line">+ 量词，1 次或多次匹配</span><br><span class="line">&#123; 自定义量词开始标记</span><br><span class="line">&#125; 自定义量词结束标记</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//下面的\s匹配任意的空白符，包括空格，制表符，换行符。[^\s]代表非空白符。[^\s]+表示一次或多次匹配非空白符。</span></span><br><span class="line">$p = <span class="string">'/^我[^\s]+(苹果|香蕉)$/'</span>;</span><br><span class="line">$str = <span class="string">"我喜欢吃苹果"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match($p, $str)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'匹配成功'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>元字符具有两种使用场景，一种是可以在任何地方都能使用，另一种是只能在方括号内使用，在方括号内使用的有：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\ 转义字符</span><br><span class="line">^ 仅在作为第一个字符(方括号内)时，表明字符类取反</span><br><span class="line">- 标记字符范围</span><br></pre></td></tr></table></figure>
<p>其中^在反括号外面，表示断言目标的开始位置，但在方括号内部则代表字符类取反，方括号内的减号-可以标记字符范围，例如0-9表示0到9之间的所有数字。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//下面的\w匹配字母或数字或下划线。</span></span><br><span class="line">$p = <span class="string">'/[\w\.\-]+@[a-z0-9\-]+\.(com|cn)/'</span>;</span><br><span class="line">$str = <span class="string">"我的邮箱是Spark.eric@imooc.com"</span>;</span><br><span class="line">preg_match($p, $str, $match);</span><br><span class="line"><span class="keyword">echo</span> $match[<span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<p></p><h2>贪婪模式与懒惰模式</h2><br>正则表达式中每个元字符匹配一个字符，当使用+之后将会变的贪婪，它将匹配尽可能多的字符，但使用问号?字符时，它将尽可能少的匹配字符，既是懒惰模式。<br>贪婪模式：在可匹配与可不匹配的时候，优先匹配<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//下面的\d表示匹配数字</span></span><br><span class="line">$p = <span class="string">'/\d+\-\d+/'</span>;</span><br><span class="line">$str = <span class="string">"我的电话是010-12345678"</span>;</span><br><span class="line">preg_match($p, $str, $match);</span><br><span class="line"><span class="keyword">echo</span> $match[<span class="number">0</span>]; <span class="comment">//结果为：010-12345678</span></span><br></pre></td></tr></table></figure>
<p>懒惰模式：在可匹配与可不匹配的时候，优先不匹配</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$p = <span class="string">'/\d?\-\d?/'</span>;</span><br><span class="line">$str = <span class="string">"我的电话是010-12345678"</span>;</span><br><span class="line">preg_match($p, $str, $match);</span><br><span class="line"><span class="keyword">echo</span> $match[<span class="number">0</span>];  <span class="comment">//结果为：0-1</span></span><br></pre></td></tr></table></figure>
<p>当我们确切的知道所匹配的字符长度的时候，可以使用{}指定匹配字符数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$p = <span class="string">'/\d&#123;3&#125;\-\d&#123;8&#125;/'</span>;</span><br><span class="line">$str = <span class="string">"我的电话是010-12345678"</span>;</span><br><span class="line">preg_match($p, $str, $match);</span><br><span class="line"><span class="keyword">echo</span> $match[<span class="number">0</span>]; <span class="comment">//结果为：010-12345678</span></span><br></pre></td></tr></table></figure>
<p></p><h2>正则表达式的搜索和替换</h2><br>正则表达式的搜索与替换在某些方面具有重要用途，比如调整目标字符串的格式，改变目标字符串中匹配字符串的顺序等。<br>例如我们可以简单的调整字符串的日期格式：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$string = <span class="string">'April 15, 2014'</span>;</span><br><span class="line">$pattern = <span class="string">'/(\w+) (\d+), (\d+)/i'</span>;</span><br><span class="line">$replacement = <span class="string">'$3, $&#123;1&#125; $2'</span>;</span><br><span class="line"><span class="keyword">echo</span> preg_replace($pattern, $replacement, $string); <span class="comment">//结果为：2014, April 15</span></span><br></pre></td></tr></table></figure>
<p>其中${1}与$1的写法是等效的，表示第一个匹配的字串，$2代表第二个匹配的。<br>通过复杂的模式，我们可以更加精确的替换目标字符串的内容。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$patterns = <span class="keyword">array</span> (<span class="string">'/(19|20)(\d&#123;2&#125;)-(\d&#123;1,2&#125;)-(\d&#123;1,2&#125;)/'</span>,</span><br><span class="line">                   <span class="string">'/^\s*&#123;(\w+)&#125;\s*=/'</span>);</span><br><span class="line">$replace = <span class="keyword">array</span> (<span class="string">'\3/\4/\1\2'</span>, <span class="string">'$\1 ='</span>);</span><br><span class="line"><span class="comment">//\3等效于$3,\4等效于$4，依次类推</span></span><br><span class="line"><span class="keyword">echo</span> preg_replace($patterns, $replace, <span class="string">'&#123;startDate&#125; = 1999-5-27'</span>); </span><br><span class="line"><span class="comment">//结果为：$startDate = 5/27/1999</span></span><br><span class="line"><span class="comment">//详细解释下结果：(19|20)表示取19或者20中任意一个数字，(\d&#123;2&#125;)表示两个数字，(\d&#123;1,2&#125;)表示1个或2个数字，(\d&#123;1,2&#125;)表示1个或2个数字。^\s*&#123;(\w+)\s*=&#125;表示以任意空格开头的，并且包含在&#123;&#125;中的字符，并且以任意空格结尾的，最后有个=号的。</span></span><br></pre></td></tr></table></figure>
<p>用正则替换来去掉多余的空格与字符：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="string">'one     two'</span>;</span><br><span class="line">$str = preg_replace(<span class="string">'/\s+/'</span>, <span class="string">' '</span>, $str);</span><br><span class="line"><span class="keyword">echo</span> $str; <span class="comment">// 结果改变为'one two'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$user = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'name'</span> =&gt; <span class="string">'spark1985'</span>,</span><br><span class="line">    <span class="string">'email'</span> =&gt; <span class="string">'spark@imooc.com'</span>,</span><br><span class="line">    <span class="string">'mobile'</span> =&gt; <span class="string">'13312345678'</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//进行一般性验证</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>($user)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'用户信息不能为空'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (strlen($user[<span class="string">'name'</span>]) &lt; <span class="number">6</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'用户名长度最少为6位'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//用户名必须为字母、数字与下划线</span></span><br><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">'/^\w+$/i'</span>, $user[<span class="string">'name'</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'用户名不合法'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//验证邮箱格式是否正确</span></span><br><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">'/^[\w\.]+@\w+\.\w+$/i'</span>, $user[<span class="string">'email'</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'邮箱不合法'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//手机号必须为11位数字，且为1开头</span></span><br><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">'/^1\d&#123;10&#125;$/i'</span>, $user[<span class="string">'mobile'</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'手机号不合法'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'用户信息验证成功'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php字符串]]></title>
      <url>https://shirly-yan.github.io/2016/10/14/php/php%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
      <content type="html"><![CDATA[<p>php字符串<br><a id="more"></a></p>
<p></p><h2>字符串的定义</h2><br>一个字符串 通过下面的3种方法来定义：<br>1、单引号<br>2、双引号<br>3、heredoc语法结构<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//单引号定义的字符串</span></span><br><span class="line">$hello = <span class="string">'hello world'</span>;</span><br><span class="line"><span class="comment">//双引号定义的字符串</span></span><br><span class="line">$hello = <span class="string">"hello world"</span>;</span><br><span class="line"><span class="comment">//heredoc语法结构定义的字符串</span></span><br><span class="line">$hello = <span class="string">&lt;&lt;&lt;TAG</span></span><br><span class="line"><span class="string">hello world</span></span><br><span class="line"><span class="string">TAG;</span></span><br></pre></td></tr></table></figure>
<p>PHP允许我们在双引号串中直接包含字串变量。<br>而单引号串中的内容总被认为是普通字符。<br>比如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$str=<span class="string">'hello'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"str is $str"</span>; <span class="comment">//运行结果: str is hello</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'str is $str'</span>; <span class="comment">//运行结果: str is $str</span></span><br></pre></td></tr></table></figure>
<p></p><h2>字符串的连接</h2><br>PHP中用英文的点号.来连接两个字符串。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$hello=<span class="string">'hello'</span>;</span><br><span class="line"></span><br><span class="line">$world=<span class="string">' world'</span>;</span><br><span class="line"></span><br><span class="line">$hi = $hello.$world;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $hi;<span class="comment">//我们可以用echo函数输出一下这个字符串连接。</span></span><br></pre></td></tr></table></figure>
<p></p><h2>去除字符串首尾的空格</h2><br>PHP中有三个函数可以去掉字符串的空格<p></p>
<ul>
<li>trim去除一个字符串两端空格。</li>
<li>rtrim是去除一个字符串右部空格，其中的r是right的缩写。</li>
<li>ltrim是去除一个字符串左部空格，其中的l是left的缩写。</li>
</ul>
<p>例子如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> trim(<span class="string">" 空格 "</span>).<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> rtrim(<span class="string">" 空格 "</span>).<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> ltrim(<span class="string">" 空格 "</span>).<span class="string">"&lt;br&gt;"</span>;</span><br></pre></td></tr></table></figure>
<p></p><h2>获取字符串的长度</h2><br>函数strlen()<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="string">'hello'</span>;</span><br><span class="line">$len = strlen($str);</span><br><span class="line"><span class="keyword">echo</span> $len;<span class="comment">//输出结果是5</span></span><br></pre></td></tr></table></figure>
<p>strlen函数对于计算英文字符是非常的擅长，但是如果有中文汉字，要计算长度该怎么办？<br>可以使用mb_strlen()函数获取字符串中中文长度。<br>例子如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="string">"我爱你"</span>;</span><br><span class="line"><span class="keyword">echo</span> mb_strlen($str,<span class="string">"UTF8"</span>);<span class="comment">//结果：3，此处的UTF8表示中文编码是UTF8格式，中文一般采用UTF8编码</span></span><br></pre></td></tr></table></figure>
<p></p><h2>字符串的截取</h2><p></p>
<ul>
<li>英文字符串的截取函数substr()</li>
<li>中文字符串的截取函数mb_substr()</li>
</ul>
<p>英文字符串的截取函数substr()<br>函数说明：substr(字符串变量,开始截取的位置,截取个数）<br>例如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$str=<span class="string">'i love you'</span>;</span><br><span class="line"><span class="comment">//截取love这几个字母</span></span><br><span class="line"><span class="keyword">echo</span> substr($str, <span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line"><span class="comment">//为什么开始位置是2呢，因为substr函数计算字符串位置是从0开始的，也就是0的位置是i,1的位置是空格，l的位置是2。从位置2开始取4个字符，就是love。</span></span><br></pre></td></tr></table></figure>
<p>中文字符串的截取函数mb_substr()<br>函数说明：mb_substr(字符串变量,开始截取的位置，截取个数, 网页编码）<br>例如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$str=<span class="string">'我爱你，中国'</span>;</span><br><span class="line"><span class="comment">//截取中国两个字</span></span><br><span class="line"><span class="keyword">echo</span> mb_substr($str, <span class="number">4</span>, <span class="number">2</span>, <span class="string">'utf8'</span>);</span><br><span class="line"><span class="comment">//为什么开始位置是4呢，和上一个例子一样，因为mb_substr函数计算汉字位置是从0开始的，也就是0的位置是我,1的位置是爱，4的位置是中。从位置4开始取2个汉字，就是中国。中文编码一般是utf8格式</span></span><br></pre></td></tr></table></figure>
<p></p><h2>查找字符串</h2><br>查找字符串函数strpos();<br>函数说明：strpos(要处理的字符串, 要定位的字符串, 定位的起始位置[可选])<br>例子：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="string">'I want to study at imooc'</span>;</span><br><span class="line">$pos = strpos($str, <span class="string">'imooc'</span>);</span><br><span class="line"><span class="keyword">echo</span> $pos;<span class="comment">//结果显示19，表示从位置0开始，imooc在第19个位置开始出现</span></span><br></pre></td></tr></table></figure>
<p></p><h2>替换字符串</h2><br>替换函数str_replace()<br>函数说明：str_replace(要查找的字符串, 要替换的字符串, 被搜索的字符串, 替换进行计数[可选])<br>例子：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="string">'I want to learn js'</span>;</span><br><span class="line">$replace = str_replace(<span class="string">'js'</span>, <span class="string">'php'</span>, $str);</span><br><span class="line"><span class="keyword">echo</span> $replace;<span class="comment">//结果显示I want to learn php</span></span><br></pre></td></tr></table></figure>
<p></p><h2>格式化字符串</h2><br>格式化字符串函数sprintf()<br>函数说明：sprintf(格式, 要转化的字符串)<br>返回：格式化好的字符串<br>例子：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="string">'99.9'</span>;</span><br><span class="line">$result = sprintf(<span class="string">'%01.2f'</span>, $str);</span><br><span class="line"><span class="keyword">echo</span> $result;<span class="comment">//结果显示99.90</span></span><br></pre></td></tr></table></figure>
<p></p><h2>字符串的合并</h2><br>字符串合并函数implode()<br>函数说明：implode(分隔符[可选], 数组)<br>返回值：把数组元素组合为一个字符串<br>例子：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$arr = <span class="keyword">array</span>(<span class="string">'Hello'</span>, <span class="string">'World!'</span>);</span><br><span class="line">$result = implode(<span class="string">''</span>, $arr);</span><br><span class="line">print_r($result);<span class="comment">//结果显示Hello World!</span></span><br></pre></td></tr></table></figure>
<p></p><h2>字符串的分隔</h2><br>字符串分隔函数explode()<br>函数说明：explode(分隔符[可选], 字符串)<br>返回值：函数返回由字符串组成的数组<br>例子：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="string">'apple,banana'</span>;</span><br><span class="line">$result = explode(<span class="string">','</span>, $str);</span><br><span class="line">print_r($result);<span class="comment">//结果显示array('apple','banana')</span></span><br></pre></td></tr></table></figure>
<p></p><h2>字符串的转义</h2><br>字符串转义函数addslashes()<br>函数说明：用于对特殊字符加上转义字符，返回一个字符串<br>返回值：一个经过转义后的字符串<br>例子：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="string">"what's your name?"</span>;</span><br><span class="line"><span class="keyword">echo</span> addslashes($str);<span class="comment">//输出：what\'s your name?</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php静态关键字static]]></title>
      <url>https://shirly-yan.github.io/2016/10/14/php/php%E9%9D%99%E6%80%81%E5%85%B3%E9%94%AE%E5%AD%97static/</url>
      <content type="html"><![CDATA[<p>php静态关键字static<br><a id="more"></a><br>静态属性与方法可以在不实例化类的情况下调用，直接使用类名::方法名的方式进行调用。静态属性不允许对象使用-&gt;操作符调用。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $speed = <span class="number">10</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::$speed;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> Car::getSpeed();  <span class="comment">//调用静态方法</span></span><br></pre></td></tr></table></figure>
<p>静态方法也可以通过变量来进行动态调用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$func = <span class="string">'getSpeed'</span>;</span><br><span class="line">$className = <span class="string">'Car'</span>;</span><br><span class="line"><span class="keyword">echo</span> $className::$func();  <span class="comment">//动态调用静态方法</span></span><br></pre></td></tr></table></figure>
<p>静态方法中，$this伪变量不允许使用。可以使用self，parent，static在内部调用静态方法与属性。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $speed = <span class="number">10</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::$speed;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">speedUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::$speed+=<span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BigCar</span> <span class="keyword">extends</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">parent</span>::speedUp();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BigCar::start();</span><br><span class="line"><span class="keyword">echo</span> BigCar::getSpeed();</span><br></pre></td></tr></table></figure>
<p>如果构造函数定义成了私有方法，则不允许直接实例化对象了，这时候一般通过静态方法进行实例化，在设计模式中会经常使用这样的方法来控制对象的创建，比如单例模式只允许有一个全局唯一的对象。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'object create'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $_object = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="keyword">self</span>::$_object)) &#123;</span><br><span class="line">            <span class="keyword">self</span>::$_object = <span class="keyword">new</span> Car(); <span class="comment">//内部方法可以调用私有方法，因此这里可以创建对象</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::$_object;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$car = new Car(); //这里不允许直接实例化对象</span></span><br><span class="line">$car = Car::getInstance(); <span class="comment">//通过静态方法来获得一个实例</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php类]]></title>
      <url>https://shirly-yan.github.io/2016/10/14/php/php%E7%B1%BB/</url>
      <content type="html"><![CDATA[<p>php类<br><a id="more"></a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//定义一个类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $name = <span class="string">'汽车'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实例化一个car对象</span></span><br><span class="line">$car = <span class="keyword">new</span> Car();</span><br><span class="line">$car-&gt;name = <span class="string">'奥迪A6'</span>; <span class="comment">//设置对象的属性值</span></span><br><span class="line"><span class="keyword">echo</span> $car-&gt;getName();  <span class="comment">//调用对象的方法 输出对象的名字</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h2>属性</h2><br>在类中定义的变量称之为属性，通常属性跟数据库中的字段有一定的关联，因此也可以称作“字段”。属性声明是由关键字 public，protected 或者 private 开头，后面跟一个普通的变量声明来组成。属性的变量可以设置初始化的默认值，默认值必须是常量。<br>访问控制的关键字代表的意义为：<p></p>
<ul>
<li>public：公开的</li>
<li>protected：受保护的</li>
<li>private：私有的</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="comment">//定义公共属性</span></span><br><span class="line">    <span class="keyword">public</span> $name = <span class="string">'汽车'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义受保护的属性</span></span><br><span class="line">    <span class="keyword">protected</span> $corlor = <span class="string">'白色'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义私有属性</span></span><br><span class="line">    <span class="keyword">private</span> $price = <span class="string">'100000'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>默认都为public，外部可以访问。一般通过-&gt;对象操作符来访问对象的属性或者方法，对于静态属性则使用::双冒号进行访问。当在类成员方法内部调用的时候，可以使用$this伪变量调用当前对象的属性。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$car = <span class="keyword">new</span> Car();</span><br><span class="line"><span class="keyword">echo</span> $car-&gt;name;   <span class="comment">//调用对象的属性</span></span><br><span class="line"><span class="keyword">echo</span> $car-&gt;color;  <span class="comment">//错误 受保护的属性不允许外部调用</span></span><br><span class="line"><span class="keyword">echo</span> $car-&gt;price;  <span class="comment">//错误 私有属性不允许外部调用</span></span><br></pre></td></tr></table></figure>
<p>受保护的属性与私有属性不允许外部调用，在类的成员方法内部是可以调用的。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $price = <span class="string">'1000'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;price; <span class="comment">//内部访问私有属性</span></span><br><span class="line">​    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p></p><h2>方法</h2><br>方法就是在类中的function，很多时候我们分不清方法与函数有什么差别，在面向过程的程序设计中function叫做函数，在面向对象中function则被称之为方法。<br>同属性一样，类的方法也具有public，protected 以及 private 的访问控制。<br>访问控制的关键字代表的意义为：<br>public：公开的<br>protected：受保护的<br>private：私有的<br>我们可以这样定义方法：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'汽车'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​&#125;</span><br><span class="line">$car = <span class="keyword">new</span> Car();</span><br><span class="line"><span class="keyword">echo</span> $car-&gt;getName();</span><br></pre></td></tr></table></figure>
<p>使用关键字static修饰的，称之为静态方法，静态方法不需要实例化对象，可以通过类名直接调用，操作符为双冒号::。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'汽车'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​&#125;</span><br><span class="line"><span class="keyword">echo</span> Car::getName(); <span class="comment">//结果为“汽车”</span></span><br></pre></td></tr></table></figure>
<p></p><h2>构造函数和析构函数</h2><br>PHP5可以在类中使用__construct()定义一个构造函数，具有构造函数的类，会在每次对象创建的时候调用该函数，因此常用来在对象创建的时候进行一些初始化工作。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">print</span> <span class="string">"构造函数被调用\n"</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">$car = <span class="keyword">new</span> Car(); <span class="comment">//实例化的时候 会自动调用构造函数__construct，这里会输出一个字符串</span></span><br></pre></td></tr></table></figure>
<p>在子类中如果定义了<strong>construct则不会调用父类的</strong>construct，如果需要同时调用父类的构造函数，需要使用parent::__construct()显式的调用。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">print</span> <span class="string">"父类构造函数被调用\n"</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Truck</span> <span class="keyword">extends</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">print</span> <span class="string">"子类构造函数被调用\n"</span>;</span><br><span class="line">       <span class="keyword">parent</span>::__construct();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">$car = <span class="keyword">new</span> Truck();</span><br></pre></td></tr></table></figure>
<p>同样，PHP5支持析构函数，使用__destruct()进行定义，析构函数指的是当某个对象的所有引用被删除，或者对象被显式的销毁时会执行的函数。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">print</span> <span class="string">"构造函数被调用 \n"</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">print</span> <span class="string">"析构函数被调用 \n"</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">$car = <span class="keyword">new</span> Car(); <span class="comment">//实例化时会调用构造函数</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'使用后，准备销毁car对象 \n'</span>;</span><br><span class="line"><span class="keyword">unset</span>($car); <span class="comment">//销毁时会调用析构函数</span></span><br></pre></td></tr></table></figure>
<p>当PHP代码执行完毕以后，会自动回收与销毁对象，因此一般情况下不需要显式的去销毁对象。</p>
<p></p><h2>重载</h2><br>HP中的重载指的是动态的创建属性与方法，是通过魔术方法来实现的。属性的重载通过<strong>set，</strong>get，<strong>isset，</strong>unset来分别实现对不存在属性的赋值、读取、判断属性是否设置、销毁属性。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $ary = <span class="keyword">array</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span><span class="params">($key, $val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ary[$key] = $val;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;ary[$key])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;ary[$key];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span><span class="params">($key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;ary[$key])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span><span class="params">($key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;ary[$key]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$car = <span class="keyword">new</span> Car();</span><br><span class="line">$car-&gt;name = <span class="string">'汽车'</span>;  <span class="comment">//name属性动态创建并赋值</span></span><br><span class="line"><span class="keyword">echo</span> $car-&gt;name;</span><br></pre></td></tr></table></figure>
<p>方法的重载通过<strong>call来实现，当调用不存在的方法的时候，将会转为参数调用</strong>call方法，当调用不存在的静态方法时会使用__callStatic重载。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $speed = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($name, $args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($name == <span class="string">'speedUp'</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;speed += <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$car = <span class="keyword">new</span> Car();</span><br><span class="line">$car-&gt;speedUp(); <span class="comment">//调用不存在的方法会使用重载</span></span><br><span class="line"><span class="keyword">echo</span> $car-&gt;speed;</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php函数]]></title>
      <url>https://shirly-yan.github.io/2016/10/14/php/php%E5%87%BD%E6%95%B0/</url>
      <content type="html"><![CDATA[<p>php函数<br><a id="more"></a><br>PHP内置了超过1000个函数，因此函数使得PHP成为一门非常强大的语言。大多数时候我们j使用系统的内置函数就可以满足需求，但是自定义函数通过将一组代码封装起来，使代码进行复用，程序结构与逻辑更加清晰。</p>
<p></p><h2>自定义函数</h2><br>PHP函数的定义方式：<p></p>
<ul>
<li>1.使用关键字“function”开始</li>
<li>2.函数名可以是字母或下划线开头：function name()</li>
<li>3.在大括号中编写函数体：</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'hello world'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在这里调用函数</span></span><br><span class="line">say();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span><span class="params">($a, $b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> $a + $b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在这里调用函数计算1+2的值</span></span><br><span class="line">sum(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span><span class="params">($a, $b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $a+$b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在这里调用函数取得返回值</span></span><br><span class="line">$s = sum(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">print_r($s);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h3>可变函数</h3><br>所谓可变函数，即通过变量的值来调用函数，因为变量的值是可变的，所以可以通过改变一个变量的值来实现调用不同的函数。经常会用在回调函数、函数列表，或者根据动态参数来调用不同的函数。可变函数的调用方法为变量名加括号。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'my function called.'</span>;</span><br><span class="line">&#125;</span><br><span class="line">$name = <span class="string">'func'</span>;</span><br><span class="line"><span class="comment">//调用可变函数</span></span><br><span class="line"></span><br><span class="line">$name();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h2>内置函数</h2><br>内置函数指的是PHP默认支持的函数，PHP内置了很多标准的常用的处理函数，包括字符串处理、数组函数、文件处理、session与cookie处理等。<br>另外一些函数是通过其他扩展来支持的，比如mysql数据库处理函数，GD图像处理函数，邮件处理函数等，PHP默认加载了一些常用的扩展库，我们可以安装或者加载其他扩展库来增加PHP的处理函数。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$str = <span class="string">'苹果很好吃。'</span>;</span><br><span class="line"><span class="comment">//请将变量$str中的苹果替换成香蕉</span></span><br><span class="line">$str = str_replace(<span class="string">'苹果'</span>,<span class="string">'香蕉'</span>,$str);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h2>判断函数是否存在</h2><br>为了确保程序调用的函数是存在的，先使用function_exists判断一下函数是否存在。同样的method_exists可以用来检测类的方法是否存在。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'exists'</span>;</span><br><span class="line">&#125;</span><br><span class="line">$name = <span class="string">'func'</span>;</span><br><span class="line"><span class="keyword">if</span> (function_exists(<span class="string">'func'</span>)) &#123; <span class="comment">//判断函数是否存在</span></span><br><span class="line">    $name();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php数组]]></title>
      <url>https://shirly-yan.github.io/2016/10/14/php/php%E6%95%B0%E7%BB%84/</url>
      <content type="html"><![CDATA[<p>php数组<br><a id="more"></a><br>PHP有两种数组：</p>
<ul>
<li>索引数组</li>
<li>关联数组<br>索引和关联两个词都是针对数组的键而言的。<br>先介绍下索引数组，索引数组是指数组的键是整数的数组，并且键的整数顺序是从0开始，依次类推。</li>
</ul>
<p></p><h2>定义</h2><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$arr = <span class="keyword">array</span>();</span><br><span class="line"><span class="comment">//表示创建一个空数组，并把创建的空数组赋值给变量$arr。</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>索引数组</h2><p></p>
<p></p><h3>索引数组初始化</h3><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//创建一个索引数组，索引数组的键是“0”，值是“苹果”</span></span><br><span class="line">$fruit = <span class="keyword">array</span>(<span class="string">"苹果"</span>,<span class="string">"香蕉"</span>,<span class="string">"菠萝"</span>);</span><br><span class="line">print_r($fruit);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line"><span class="keyword">Array</span></span><br><span class="line">( </span><br><span class="line">	[<span class="number">0</span>] =&gt; 苹果 </span><br><span class="line">	[<span class="number">1</span>] =&gt; 香蕉 </span><br><span class="line">	[<span class="number">2</span>] =&gt; 菠萝 </span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>索引数组赋值</h3><br>索引数组赋值有三种方式:<p></p>
<ul>
<li>第一种：用数组变量的名字后面跟一个中括号的方式赋值，当然，索引数组中，中括号内的键一定是整数。比如，$arr[0]=’苹果’;</li>
<li>第二种：用array()创建一个空数组，使用=&gt;符号来分隔键和值，左侧表示键，右侧表示值。当然，索引数组中，键一定是整数。比如，array(‘0’=&gt;’苹果’);</li>
<li>第三种：用array()创建一个空数组，直接在数组里用英文的单引号’或者英文的双引号”赋值，数组会默认建立从0开始的整数的键。比如array(‘苹果’);这个数组相当于array(‘0’=&gt;’苹果’);</li>
</ul>
<p></p><h3>索引数组访问</h3><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//从数组变量$arr中，读取键为0的值</span></span><br><span class="line">$arr = <span class="keyword">array</span>(<span class="string">'苹果'</span>,<span class="string">'香蕉'</span>);</span><br><span class="line">$arr0 = $arr[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>($arr0) ) &#123;print_r($arr0);&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$fruit=<span class="keyword">array</span>(<span class="string">'苹果'</span>,<span class="string">'香蕉'</span>,<span class="string">'菠萝'</span>);</span><br><span class="line"><span class="keyword">for</span>($index=<span class="number">0</span>; $index&lt;<span class="number">3</span>; $index++)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;br&gt;数组第'</span>.$index.<span class="string">'值是：'</span>.$fruit[$index];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$fruit=<span class="keyword">array</span>(<span class="string">'苹果'</span>,<span class="string">'香蕉'</span>,<span class="string">'菠萝'</span>);</span><br><span class="line"><span class="keyword">foreach</span>($fruit <span class="keyword">as</span> $key=&gt;$value)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;br&gt;第'</span>.$key.<span class="string">'值是：'</span>.$value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>关联数组</h2><p></p>
<p></p><h3>关联数组初始化</h3><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//创建一个关联数组，关联数组的键“orange”，值是“橘子”</span></span><br><span class="line">$fruit = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'apple'</span>=&gt;<span class="string">"苹果"</span>,</span><br><span class="line">    <span class="string">"banana"</span>=&gt;<span class="string">"香蕉"</span>,</span><br><span class="line">    <span class="string">"pineapple"</span>=&gt;<span class="string">"菠萝"</span>,</span><br><span class="line">    );</span><br><span class="line">    print_r($fruit);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>关联数组赋值</h3><p></p>
<ul>
<li><p>第一种：用数组变量的名字后面跟一个中括号的方式赋值，当然，关联数组中，中括号内的键一定是字符串。比如，$arr[‘apple’]=’苹果’;</p>
</li>
<li><p>第二种：用array()创建一个空数组，使用=&gt;符号来分隔键和值，左侧表示键，右侧表示值。当然，关联数组中，键一定是字符串。比如，array(‘apple’=&gt;’苹果’);</p>
</li>
</ul>
<p></p><h3>关联数组访问</h3><br>用数组变量的名字后跟中括号+键的方式来访问数组中的值，键使用单引号或者双引号括起来。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//从数组变量$arr中，读取键为apple的值</span></span><br><span class="line">$arr = <span class="keyword">array</span>(<span class="string">'apple'</span>=&gt;<span class="string">"苹果"</span>,<span class="string">'banana'</span>=&gt;<span class="string">"香蕉"</span>,<span class="string">'pineapple'</span>=&gt;<span class="string">"菠萝"</span>);</span><br><span class="line">$arr0 = $arr[<span class="string">'apple'</span>];</span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>($arr0) ) &#123;print_r($arr0);&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>foreach循环可以将数组里的所有值都访问到，下面我们展示下，用foreach循环访问关联数组里的值。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$fruit=<span class="keyword">array</span>(<span class="string">'apple'</span>=&gt;<span class="string">"苹果"</span>,<span class="string">'banana'</span>=&gt;<span class="string">"香蕉"</span>,<span class="string">'pineapple'</span>=&gt;<span class="string">"菠萝"</span>);</span><br><span class="line"><span class="keyword">foreach</span>($fruit <span class="keyword">as</span> $key=&gt;$value)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;br&gt;键是：'</span>.$key.<span class="string">'，对应的值是：'</span>.$value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php结构语句]]></title>
      <url>https://shirly-yan.github.io/2016/10/14/php/php%E7%BB%93%E6%9E%84%E8%AF%AD%E5%8F%A5/</url>
      <content type="html"><![CDATA[<p>顺序结构 条件结构 循环结构<br><a id="more"></a></p>
<h2>顺序结构</h2><br>顺序结构就像一条直线，按着顺序一直往下执行。我们编写的代码默认都是按照顺序结构执行的。<br><br><h2>条件结构</h2>

<p></p><h3>if else</h3><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(条件)&#123;</span><br><span class="line">     <span class="comment">//分配服务器干的任务A</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="comment">//分配服务器干的任务B</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(条件一)&#123;</span><br><span class="line">     <span class="comment">//分配服务器干的任务A</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(条件二)&#123;</span><br><span class="line">     <span class="comment">//分配服务器干的任务B</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(条件一)&#123;</span><br><span class="line">     <span class="comment">//分配服务器干的任务A</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(条件二)&#123;</span><br><span class="line">     <span class="comment">//分配服务器干的任务B</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="comment">//分配服务器干的任务C</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>switch</h3><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">switch</span> (条件)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> 条件值一:</span><br><span class="line">  <span class="comment">//任务一</span></span><br><span class="line">  <span class="keyword">break</span>; </span><br><span class="line"><span class="keyword">case</span> 条件值二:</span><br><span class="line">  <span class="comment">//任务二</span></span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">  <span class="comment">//默认任务</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="keyword">break</span>的作用是阻止代码进入下一个<span class="keyword">case</span> 中继续执行</span><br></pre></td></tr></table></figure><p></p>
<h2>循环结构</h2>

<p></p><h3>while</h3><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">while</span>(条件)&#123; </span><br><span class="line">     <span class="comment">//执行任务</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>do while</h3><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">do</span>&#123; </span><br><span class="line">     <span class="comment">//执行任务</span></span><br><span class="line">&#125;<span class="keyword">while</span>(条件)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>for</h3><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span>(初始化;循环条件;递增项)&#123;</span><br><span class="line">      <span class="comment">//执行任务</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>foreach</h3><br>在PHP中foreach循环语句，常用于遍历数组，一般有两种使用方式:<p></p>
<ul>
<li>不取下标</li>
<li>取下标</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>）只取值，不取下标</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">foreach</span> (数组 <span class="keyword">as</span> 值)&#123;</span><br><span class="line"><span class="comment">//执行的任务</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">（<span class="number">2</span>）同时取下标和值</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">foreach</span> (数组 <span class="keyword">as</span> 下标 =&gt; 值)&#123;</span><br><span class="line"> <span class="comment">//执行的任务</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$students = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">'2010'</span>=&gt;<span class="string">'令狐冲'</span>,</span><br><span class="line"><span class="string">'2011'</span>=&gt;<span class="string">'林平之'</span>,</span><br><span class="line"><span class="string">'2012'</span>=&gt;<span class="string">'曲洋'</span>,</span><br><span class="line"><span class="string">'2013'</span>=&gt;<span class="string">'任盈盈'</span>,</span><br><span class="line"><span class="string">'2014'</span>=&gt;<span class="string">'向问天'</span>,</span><br><span class="line"><span class="string">'2015'</span>=&gt;<span class="string">'任我行'</span>,</span><br><span class="line"><span class="string">'2016'</span>=&gt;<span class="string">'冲虚'</span>,</span><br><span class="line"><span class="string">'2017'</span>=&gt;<span class="string">'方正'</span>,</span><br><span class="line"><span class="string">'2018'</span>=&gt;<span class="string">'岳不群'</span>,</span><br><span class="line"><span class="string">'2019'</span>=&gt;<span class="string">'宁中则'</span>,</span><br><span class="line">);<span class="comment">//10个学生的学号和姓名，用数组存储</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用循环结构遍历数组,获取学号和姓名  </span></span><br><span class="line"><span class="keyword">foreach</span>($students <span class="keyword">as</span>  $v)</span><br><span class="line">&#123; </span><br><span class="line">    <span class="keyword">echo</span> $v;<span class="comment">//输出（打印）姓名</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">令狐冲</span><br><span class="line">林平之</span><br><span class="line">曲洋</span><br><span class="line">任盈盈</span><br><span class="line">向问天</span><br><span class="line">任我行</span><br><span class="line">冲虚</span><br><span class="line">方正</span><br><span class="line">岳不群</span><br><span class="line">宁中则</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$students = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">'2010'</span>=&gt;<span class="string">'令狐冲'</span>,</span><br><span class="line"><span class="string">'2011'</span>=&gt;<span class="string">'林平之'</span>,</span><br><span class="line"><span class="string">'2012'</span>=&gt;<span class="string">'曲洋'</span>,</span><br><span class="line"><span class="string">'2013'</span>=&gt;<span class="string">'任盈盈'</span>,</span><br><span class="line"><span class="string">'2014'</span>=&gt;<span class="string">'向问天'</span>,</span><br><span class="line"><span class="string">'2015'</span>=&gt;<span class="string">'任我行'</span>,</span><br><span class="line"><span class="string">'2016'</span>=&gt;<span class="string">'冲虚'</span>,</span><br><span class="line"><span class="string">'2017'</span>=&gt;<span class="string">'方正'</span>,</span><br><span class="line"><span class="string">'2018'</span>=&gt;<span class="string">'岳不群'</span>,</span><br><span class="line"><span class="string">'2019'</span>=&gt;<span class="string">'宁中则'</span>,</span><br><span class="line">);<span class="comment">//10个学生的学号和姓名，用数组存储</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用循环结构遍历数组,获取学号和姓名  </span></span><br><span class="line"><span class="keyword">foreach</span>($students <span class="keyword">as</span> $key =&gt;$v)</span><br><span class="line">&#123; </span><br><span class="line">    <span class="keyword">echo</span> $key.<span class="string">":"</span>.$v;<span class="comment">//输出（打印）学号：姓名</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line"><span class="number">2010</span>:令狐冲</span><br><span class="line"><span class="number">2011</span>:林平之</span><br><span class="line"><span class="number">2012</span>:曲洋</span><br><span class="line"><span class="number">2013</span>:任盈盈</span><br><span class="line"><span class="number">2014</span>:向问天</span><br><span class="line"><span class="number">2015</span>:任我行</span><br><span class="line"><span class="number">2016</span>:冲虚</span><br><span class="line"><span class="number">2017</span>:方正</span><br><span class="line"><span class="number">2018</span>:岳不群</span><br><span class="line"><span class="number">2019</span>:宁中则</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php运算符]]></title>
      <url>https://shirly-yan.github.io/2016/10/12/php/php%E8%BF%90%E7%AE%97%E7%AC%A6/</url>
      <content type="html"><![CDATA[<p>php算数运算符 赋值运算符 比较运算符<br><a id="more"></a></p>
<p></p><h2>算数运算符</h2><br><img src="/images/7.png" width="530" height="240"><p></p>
<p></p><h2>赋值运算符</h2><br>PHP的赋值运算符有两种，分别是：<p></p>
<ul>
<li>=：把右边表达式的值赋给左边的运算数。它将右边表达式值复制一份，交给左边的运算数。换而言之，首先给左边的运算数申请了一块内存，然后把复制的值放到这个内存中。</li>
<li>&amp;：引用赋值，意味着两个变量都指向同一个数据。它将使两个变量共享一块内存，如果这个内存存储的数据变了，那么两个变量的值都会发生变化。</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    $a = <span class="string">"我在慕课网学习PHP！"</span>;</span><br><span class="line">	$b = $a;</span><br><span class="line">    $c = &amp;$a;</span><br><span class="line">	$a = <span class="string">"我天天在慕课网学习PHP！"</span>;</span><br><span class="line">	<span class="keyword">echo</span> $b.<span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span> $c.<span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">我在慕课网学习PHP！</span><br><span class="line">我天天在慕课网学习PHP！</span><br></pre></td></tr></table></figure>
<p></p><h2>比较运算符</h2><br><img src="/images/8.png" width="660" height="409"><p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">    $a = <span class="number">1</span>;</span><br><span class="line">    $b = <span class="string">"1"</span>;</span><br><span class="line">	var_dump($a == $b);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	var_dump($a === $b);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	var_dump($a != $b);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	var_dump($a &lt;&gt; $b);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	var_dump($a !== $b);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	var_dump($a &lt; $b);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br /&gt;111&lt;br /&gt;"</span>;</span><br><span class="line">	$c = <span class="number">5</span>;</span><br><span class="line">	var_dump($a &lt; $c);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	var_dump($a &gt; $c);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	var_dump($a &lt;= $c);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	var_dump($a &gt;= $b);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	var_dump($a &gt;= $b);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">bool(<span class="keyword">true</span>) </span><br><span class="line">bool(<span class="keyword">false</span>) </span><br><span class="line">bool(<span class="keyword">false</span>) </span><br><span class="line">bool(<span class="keyword">false</span>) </span><br><span class="line">bool(<span class="keyword">true</span>) </span><br><span class="line">bool(<span class="keyword">false</span>) </span><br><span class="line"></span><br><span class="line"><span class="number">111</span></span><br><span class="line">bool(<span class="keyword">true</span>) </span><br><span class="line">bool(<span class="keyword">false</span>) </span><br><span class="line">bool(<span class="keyword">true</span>) </span><br><span class="line">bool(<span class="keyword">true</span>) </span><br><span class="line">bool(<span class="keyword">true</span>)</span><br></pre></td></tr></table></figure>
<p></p><h2>三元运算符</h2><br>(“?:”)三元运算符也是一个比较运算符，对于表达式(expr1)?(expr2):(expr3)，如果expr1的值为true，则此表达式的值为expr2，否则为expr3。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    $a = <span class="number">78</span>;<span class="comment">//成绩</span></span><br><span class="line">	$b = $a &gt;= <span class="number">60</span> ? <span class="string">"及格"</span>: <span class="string">"不及格"</span>; </span><br><span class="line">	<span class="keyword">echo</span> $b;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">及格</span><br></pre></td></tr></table></figure>
<p></p><h2>逻辑运算符</h2><p></p>
<ul>
<li>逻辑与：都为真 则为真</li>
<li>逻辑或：有一个为真 则为真</li>
<li>逻辑非：真为假 假为真</li>
<li>逻辑异或：有且只有一个为真 则为真</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    $a = <span class="keyword">TRUE</span>; </span><br><span class="line">    $b = <span class="keyword">TRUE</span>; </span><br><span class="line">	$c = <span class="keyword">FALSE</span>; </span><br><span class="line">	$d = <span class="keyword">FALSE</span>; </span><br><span class="line">	<span class="keyword">echo</span> ($a <span class="keyword">and</span> $b)?<span class="string">"通过"</span>:<span class="string">"不通过"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span>($a <span class="keyword">or</span> $c)?<span class="string">"通过"</span>:<span class="string">"不通过"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span> ($a <span class="keyword">xor</span> $c <span class="keyword">xor</span> $d)?<span class="string">"通过"</span>:<span class="string">"不通过"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span> !$c?<span class="string">"通过"</span>:<span class="string">"不通过"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> $a &amp;&amp; $d?<span class="string">"通过"</span>:<span class="string">"不通过"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span> $b || $c || $d?<span class="string">"通过"</span>:<span class="string">"不通过"</span>;</span><br><span class="line">	</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">通过</span><br><span class="line">通过</span><br><span class="line">通过</span><br><span class="line">通过</span><br><span class="line">不通过</span><br><span class="line">通过</span><br></pre></td></tr></table></figure>
<p></p><h2>字符串连接运算符</h2><br>字符串连接运算符是为了将两个字符串进行连接，PHP中提供的字符串连<p></p>
<ul>
<li>连接运算符<font color="#FF6666">.</font>：它返回将右参数附加到左参数后面所得的字符串。</li>
<li>连接赋值运算符<font color="#FF6666">.=</font>：它将右边参数附加到左边的参数后。</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    $a = <span class="string">"张先生"</span>;</span><br><span class="line">	$tip = $a.<span class="string">",欢迎您在慕课网学习PHP！"</span>;</span><br><span class="line">	</span><br><span class="line">    $b = <span class="string">"东边日出西边雨"</span>;	</span><br><span class="line">    $b .= <span class="string">",道是无晴却有晴"</span>;</span><br><span class="line">    </span><br><span class="line">	$c = <span class="string">"东边日出西边雨"</span>;	</span><br><span class="line">    $c = $c.<span class="string">",道是无晴却有晴"</span>;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">echo</span>  $tip.<span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span>  $b.<span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span>  $c.<span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">张先生,欢迎您在慕课网学习PHP！</span><br><span class="line">东边日出西边雨,道是无晴却有晴</span><br><span class="line">东边日出西边雨,道是无晴却有晴</span><br></pre></td></tr></table></figure>
<p></p><h2>错误控制运算符</h2><br>PHP中提供了一个错误控制运算符“@”，对于一些可能会在运行过程中出错的表达式时，我们不希望出错的时候给客户显示错误信息，这样对用户不友好。于是，可以将@放置在一个PHP表达式之前，该表达式可能产生的任何错误信息都被忽略掉；<br>如果激活了track_error（这个玩意在php.ini中设置）特性，表达式所产生的任何错误信息都被存放在变量$php_errormsg中，此变量在每次出错时都会被覆盖，所以如果想用它的话必须尽早检查。<br>需要注意的是：错误控制前缀“@”不会屏蔽解析错误的信息，不能把它放在函数或类的定义之前，也不能用于条件结构例如if和foreach等。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"> $conn = @mysql_connect(<span class="string">"localhost"</span>,<span class="string">"username"</span>,<span class="string">"password"</span>);</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">"出错了，错误原因是："</span>.$php_errormsg;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php常量]]></title>
      <url>https://shirly-yan.github.io/2016/10/12/php/php%E5%B8%B8%E9%87%8F/</url>
      <content type="html"><![CDATA[<p>php常量的分类和定义<br><a id="more"></a><br>常量可以理解为值不变的量（如圆周率）；或者是常量值被定义后，在脚本的其他任何地方都不可以被改变。<br>PHP中的常量分为</p>
<ul>
<li>自定义常量</li>
<li>系统常量<br>常量主要功效是可以避免重复定义，篡改变量值。在我们进行团队开发时，或者代码量很大的时候，对于一些第一次定义后不改变的量，如果我们使用变量，在不知情的情况下，使用同一变量名时，变量值就会被替换掉，从而会引发服务器执行错误的任务。</li>
</ul>
<p></p><h2>自定义常量</h2><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">define()函数的语法格式为：</span><br><span class="line">bool define(string $constant_name, mixed $value[, $case_sensitive = <span class="keyword">true</span>])</span><br><span class="line"><span class="comment">//参数</span></span><br><span class="line"><span class="comment">//“constant_name”  必选参数 常量名称</span></span><br><span class="line"><span class="comment">//即标志符，常量的命名规则与变量的一致，但是要注意哦，它可不带美元符号哦。</span></span><br><span class="line"><span class="comment">//“value”          必选参数 常量的值</span></span><br><span class="line"><span class="comment">//“case_sensitive” 可选参数 指定是否大小写敏感，</span></span><br><span class="line"><span class="comment">//设定为true表示不敏感，一般不指定第三个参数的情况下，默认第三个参数的值为false。</span></span><br><span class="line">（注： string表示参数类型为字符串类型，mixed表示参数类型可以接受为多种不同的类型，case_sensitive = <span class="keyword">true</span>表示默认为布尔类型<span class="keyword">TRUE</span>）</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">define(<span class="string">"PI"</span>,<span class="number">3.14</span>);</span><br><span class="line"><span class="keyword">echo</span> PI;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"></span><br><span class="line">$p = <span class="string">"PII"</span>;</span><br><span class="line">define($p,<span class="number">3.14</span>);</span><br><span class="line"><span class="keyword">echo</span> PII;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line"><span class="number">3.14</span></span><br><span class="line"><span class="number">3.14</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>系统常量</h2><br>系统常量是PHP已经定义好的常量，我们可以直接拿来使用，常见的系统常量有：<br>（1）<strong>FILE</strong> :php程序文件名。它可以帮助我们获取当前文件在服务器的物理位置。<br>（2）<strong>LINE</strong> :PHP程序文件行数。它可以告诉我们，当前代码在第几行。<br>（3）PHP_VERSION<br>:当前解析器的版本号。它可以告诉我们当前PHP解析器的版本号，我们可以提前知道我们的PHP代码是否可被该PHP解析器解析。<br>（4）PHP_OS<br>：执行当前PHP版本的操作系统名称。它可以告诉我们服务器所用的操作系统名称，我们可以根据该操作系统优化我们的代码。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">__FILE__</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">__LINE__</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_VERSION;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_OS;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">/Library/WebServer/Documents/test.php</span><br><span class="line"><span class="number">13</span></span><br><span class="line"><span class="number">5.5</span><span class="number">.36</span></span><br><span class="line">Darwin</span><br></pre></td></tr></table></figure>
<p></p><h2>常量取值</h2><p></p>
<ul>
<li>常量名直接获取值</li>
<li>使用constant()函数<br>它和直接使用常量名输出的效果是一样的，但函数可以动态的输出不同的常量，在使用上要灵活、方便，其语法格式如下</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">define(<span class="string">"PI"</span>,<span class="number">3.14</span>);</span><br><span class="line">$r=<span class="number">1</span>;</span><br><span class="line">$area = PI*$r*$r; <span class="comment">//计算圆的面积</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$p=<span class="string">""</span>;</span><br><span class="line"><span class="comment">//定义圆周率的两种取值</span></span><br><span class="line">define(<span class="string">"PI1"</span>,<span class="number">3.14</span>);</span><br><span class="line">define(<span class="string">"PI2"</span>,<span class="number">3.142</span>);</span><br><span class="line"><span class="comment">//定义值的精度</span></span><br><span class="line">$height = <span class="string">"中"</span>;</span><br><span class="line"><span class="comment">//根据精度返回常量名，将常量变成了一个可变的常量</span></span><br><span class="line"><span class="keyword">if</span>($height == <span class="string">"中"</span>)&#123;</span><br><span class="line">    $p = <span class="string">"PI1"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($height == <span class="string">"低"</span>)&#123;</span><br><span class="line">	$p = <span class="string">"PI2"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$r=<span class="number">1</span>;</span><br><span class="line">$area= constant($p)*$r*$r;</span><br><span class="line"><span class="keyword">echo</span> $area;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h2>如何判定常量是否被定义</h2><br>defined()函数判断一个常量是否已经定义<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">其语法格式为：</span><br><span class="line">bool defined(string constants_name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">define(<span class="string">"PI1"</span>,<span class="number">3.14</span>);</span><br><span class="line">$p = <span class="string">"PI1"</span>;</span><br><span class="line">$is1 = defined($p);</span><br><span class="line">$is2 = defined(<span class="string">"PI2"</span>);</span><br><span class="line">var_dump($is1);</span><br><span class="line">var_dump($is2);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">bool(<span class="keyword">true</span>) bool(<span class="keyword">false</span>)</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[html字符实体]]></title>
      <url>https://shirly-yan.github.io/2016/10/12/html/html%E5%AD%97%E7%AC%A6%E5%AE%9E%E4%BD%93/</url>
      <content type="html"><![CDATA[<p>html中的字符实体对应的实体名称和对应的实体编号<br><a id="more"></a></p>
<table>
<thead>
<tr>
<th style="text-align:center">显示结果</th>
<th style="text-align:center">描述</th>
<th style="text-align:center">实体名称</th>
<th style="text-align:center">实体编号</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">空格</td>
<td style="text-align:center">&amp;nbsp;</td>
<td style="text-align:center">&amp;#160;</td>
</tr>
<tr>
<td style="text-align:center">&lt;</td>
<td style="text-align:center">小于号</td>
<td style="text-align:center">&amp;lt;</td>
<td style="text-align:center">&amp;#60;</td>
</tr>
<tr>
<td style="text-align:center">&gt;</td>
<td style="text-align:center">大于号</td>
<td style="text-align:center">&amp;gt;</td>
<td style="text-align:center">&amp;#62;</td>
</tr>
<tr>
<td style="text-align:center">&amp;</td>
<td style="text-align:center">和号</td>
<td style="text-align:center">&amp;amp;</td>
<td style="text-align:center">&amp;#38;</td>
</tr>
<tr>
<td style="text-align:center">“</td>
<td style="text-align:center">引号</td>
<td style="text-align:center">&amp;quot;</td>
<td style="text-align:center">&amp;#34;</td>
</tr>
<tr>
<td style="text-align:center">‘</td>
<td style="text-align:center">撇号</td>
<td style="text-align:center">&amp;apos;(IE不支持)</td>
<td style="text-align:center">&amp;#39;</td>
</tr>
<tr>
<td style="text-align:center">￠</td>
<td style="text-align:center">分</td>
<td style="text-align:center">&amp;cent;</td>
<td style="text-align:center">&amp;#162;</td>
</tr>
<tr>
<td style="text-align:center">£</td>
<td style="text-align:center">镑</td>
<td style="text-align:center">&amp;pound;</td>
<td style="text-align:center">&amp;#163;</td>
</tr>
<tr>
<td style="text-align:center">¥</td>
<td style="text-align:center">日圆</td>
<td style="text-align:center">&amp;yen;</td>
<td style="text-align:center">&amp;#165;</td>
</tr>
<tr>
<td style="text-align:center">€</td>
<td style="text-align:center">欧元</td>
<td style="text-align:center">&amp;euro;</td>
<td style="text-align:center">&amp;#8364;</td>
</tr>
<tr>
<td style="text-align:center">§</td>
<td style="text-align:center">小节</td>
<td style="text-align:center">&amp;sect;</td>
<td style="text-align:center">&amp;#167;</td>
</tr>
<tr>
<td style="text-align:center">©</td>
<td style="text-align:center">版权</td>
<td style="text-align:center">&amp;copy;</td>
<td style="text-align:center">&amp;#169;</td>
</tr>
<tr>
<td style="text-align:center">®</td>
<td style="text-align:center">注册商标</td>
<td style="text-align:center">&amp;reg;</td>
<td style="text-align:center">&amp;#174;</td>
</tr>
<tr>
<td style="text-align:center">™</td>
<td style="text-align:center">商标</td>
<td style="text-align:center">&amp;trade;</td>
<td style="text-align:center">&amp;#8482;</td>
</tr>
<tr>
<td style="text-align:center">×</td>
<td style="text-align:center">乘号</td>
<td style="text-align:center">&amp;times;</td>
<td style="text-align:center">&amp;#215;</td>
</tr>
<tr>
<td style="text-align:center">÷</td>
<td style="text-align:center">除号</td>
<td style="text-align:center">&amp;divide;</td>
<td style="text-align:center">&amp;#247;</td>
</tr>
</tbody>
</table>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> html </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[markdown转义字符]]></title>
      <url>https://shirly-yan.github.io/2016/10/12/markdown/markdown%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6/</url>
      <content type="html"><![CDATA[<p>markdown中显示反斜杠 反引号 星号 下划线等 需要使用转义字符<br><a id="more"></a><br>Markdown中的转义字符为\，可以转义的有：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">\\ 反斜杠</span><br><span class="line">\` 反引号</span><br><span class="line">\* 星号</span><br><span class="line">\_ 下划线</span><br><span class="line">\&#123;\&#125; 大括号</span><br><span class="line">\[\] 中括号</span><br><span class="line">\(\) 小括号</span><br><span class="line">\# 井号</span><br><span class="line">\+ 加号</span><br><span class="line">\- 减号</span><br><span class="line">\. 英文句号</span><br><span class="line">\! 感叹号</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> markdown </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php变量]]></title>
      <url>https://shirly-yan.github.io/2016/10/12/php/php%E5%8F%98%E9%87%8F/</url>
      <content type="html"><![CDATA[<p>变量的声明 变量的数据类型<br><a id="more"></a></p>
<p></p><h2>变量</h2><p></p>
<p></p><h3>变量声明</h3><br>1、变量名需要<font color="#FF6666">$</font>进行标识<br>2、变量名必须以字母或下划线<font color="#FF6666">_</font>开头<br>3、变量名只能由字母、数字、以及下划线<font color="#FF6666">_</font>组成，<p></p>
<font color="#FF6666">PHP中变量名是区分大小写的</font>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$var_name = <span class="string">"苹果"</span>;</span><br><span class="line">$n = <span class="number">10</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h3>变量的数据类型</h3><br>在php中，支持8种原始类型，其中包括四种标量类型、两种复合类型和两种特殊类型。php是一门松散类型的语言，不必向php声明变量的数据类型，php会自动把变量转换为自动的数据类型，<br>var_dump()函数获取变量的数据<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"> $string = <span class="string">"就"</span>;</span><br><span class="line"> var_dump($string);</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"> $string = <span class="number">9494</span>; </span><br><span class="line"> var_dump($string);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">结果</span><br><span class="line">string(<span class="number">3</span>) <span class="string">"就"</span> </span><br><span class="line">int(<span class="number">9494</span>)</span><br></pre></td></tr></table></figure>
<p></p><h3>标量类型—布尔类型</h3><br>布尔类型（boolean）：只有两个值，一个是<font color="#FF6666">TRUE</font>,另一个<font color="#FF6666">FALSE</font>,<br>它不区分大小写，也就是说”TRUE”和“true”效果是一样的<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    $man = <span class="string">"男"</span>;</span><br><span class="line">	$flag = $man == <span class="string">"男"</span>;</span><br><span class="line">	<span class="keyword">echo</span> $flag ;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span> ;</span><br><span class="line">	var_dump($flag);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">结果</span><br><span class="line"><span class="number">1</span></span><br><span class="line">bool(<span class="keyword">true</span>)</span><br></pre></td></tr></table></figure>
<p></p><h3>标量类型—整型</h3><br>整型（integer）：类似于常见的整数。它可以用十进制、八进制、十六进制指定。十进制就是日常使用的数字；八进制，数字前必须加上<font color="#FF6666">0</font>(这个<font color="#FF6666">0</font>是阿拉伯数字<font color="#FF6666">0</font>，可不是英文字母“欧”哦)；十六进制，数字前必须加<font color="#FF6666">0x</font> (这个<font color="#FF6666">0</font>也是阿拉伯数字<font color="#FF6666">0</font>，不是“欧”哦)。如：<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	$data_int1 = <span class="number">123</span>;</span><br><span class="line">	<span class="keyword">echo</span> $data_int1;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	$data_int2 = <span class="number">-123</span>;</span><br><span class="line">	<span class="keyword">echo</span> $data_int2;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	$data_int3 = <span class="number">0123</span>;</span><br><span class="line">	<span class="keyword">echo</span> $data_int3;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">	$data_int4 = <span class="number">0x123</span>;</span><br><span class="line">	<span class="keyword">echo</span> $data_int4;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">结果</span><br><span class="line"><span class="number">123</span></span><br><span class="line"><span class="number">-123</span></span><br><span class="line"><span class="number">83</span></span><br><span class="line"><span class="number">291</span></span><br></pre></td></tr></table></figure>
<p></p><h3>标量类型—浮点型</h3><br>浮点型（浮点数、双精度数或实数），也就是通常说的小数，可以用小数点或者科学计数法表示。科学计数法可以使用小写的e，也可以使用大写的E<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$num_float = <span class="number">1.234</span>;    <span class="comment">//小数点  </span></span><br><span class="line">$num_float = <span class="number">1.2e3</span>;    <span class="comment">//科学计数法，小写e  </span></span><br><span class="line">$num_float = <span class="number">7.0E-10</span>;  <span class="comment">//科学计数法，大写E  </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line"><span class="number">1.234</span></span><br><span class="line"><span class="number">1200</span></span><br><span class="line"><span class="number">0.007</span></span><br></pre></td></tr></table></figure>
<font color="#FF6666">e3是10的三次方，E-3是10的-3次方</font>

<p></p><h3>标量类型—字符串</h3><br>字符串是由一系列字符组成，在PHP中，字符和字节一样，也就是说，一共有256种不同字符的可能性。字符串型可以用三种方法定义：单引号形式、双引号形式和Heredoc结构形式。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$str_string1 = <span class="string">'我是字符串'</span>; </span><br><span class="line">$str_string2 = <span class="string">"我也是字符串哦"</span>;</span><br><span class="line"><span class="keyword">echo</span> $str_string1;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> $str_string2;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">我是字符串</span><br><span class="line">我也是字符串哦</span><br></pre></td></tr></table></figure>
<p></p><h4>字符串中包括引号</h4><br>单引号中嵌入双引号，直接嵌入<br>双引号中嵌入单引号，直接嵌入<br>单引号中嵌入单引号，使用转义字符<font color="#FF6666">\’</font><br>双引号中嵌入双引号，使用转义字符<font color="#FF6666">\”</font><p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$str_string1 = <span class="string">'甲问："你在哪里学的PHP？"'</span>;<span class="comment">//单引号中嵌入双引号，直接嵌入</span></span><br><span class="line">$str_string2 = <span class="string">"乙毫不犹豫地回答：'当然是慕课网咯！'"</span>;<span class="comment">//双引号中嵌入单引号，直接嵌入</span></span><br><span class="line">$str_string3 = <span class="string">'甲问:\'能告诉我网址吗？\''</span>;<span class="comment">//单引号中嵌入单引号，使用转义字符\'</span></span><br><span class="line">$str_string4 = <span class="string">"乙答道:\"www.imooc.com\""</span>;<span class="comment">//双引号中嵌入双引号，使用转义字符\"</span></span><br><span class="line"><span class="keyword">echo</span> $str_string1;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> $str_string2;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> $str_string3;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> $str_string4;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">甲问：<span class="string">"你在哪里学的PHP？"</span></span><br><span class="line">乙毫不犹豫地回答：<span class="string">'当然是慕课网咯！'</span></span><br><span class="line">甲问:<span class="string">'能告诉我网址吗？'</span></span><br><span class="line">乙答道:<span class="string">"www.imooc.com"</span></span><br></pre></td></tr></table></figure>
<p></p><h4>当引号遇到美元符号标识的变量</h4><br>当双引号中包含变量时，变量会与双引号中的内容连接在一起；<br>当单引号中包含变量时，变量会被当做字符串输出。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$love = <span class="string">"I love you!"</span>; </span><br><span class="line">$string1 = <span class="string">"慕课网,$love"</span>;</span><br><span class="line">$string2 = <span class="string">'慕课网,$love'</span>;</span><br><span class="line"><span class="keyword">echo</span> $string1;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> $string2;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">慕课网,I love you!</span><br><span class="line">慕课网,$love</span><br></pre></td></tr></table></figure>
<p></p><h4>字符串很长</h4><br>我们可以使用Heredoc结构形式<br>以<font color="#FF6666">&lt;&lt;&lt;GOD</font>开头<br>️以<font color="#FF6666">GOD</font>结尾<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$string = <span class="string">&lt;&lt;&lt;GOD</span></span><br><span class="line"><span class="string">我有一只小毛驴，我从来也不骑。</span></span><br><span class="line"><span class="string">有一天我心血来潮，骑着去赶集。</span></span><br><span class="line"><span class="string">我手里拿着小皮鞭，我心里正得意。</span></span><br><span class="line"><span class="string">不知怎么哗啦啦啦啦，我摔了一身泥.</span></span><br><span class="line"><span class="string">GOD;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $string;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">我有一只小毛驴，我从来也不骑。 有一天我心血来潮，骑着去赶集。 我手里拿着小皮鞭，我心里正得意。 不知怎么哗啦啦啦啦，我摔了一身泥.</span><br></pre></td></tr></table></figure>
<p></p><h3>特殊类型—资源</h3><br>资源（resource）：资源是由专门的函数来建立和使用的，例如打开文件、数据连接、图形画布。我们可以对资源进行操作（创建、使用和释放）。任何资源，在不需要的时候应该被及时释放。如果我们忘记了释放资源，系统自动启用垃圾回收机制，在页面执行完毕后回收资源，以避免内存被消耗殆尽。<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$file=fopen(<span class="string">"f.txt"</span>,<span class="string">"r"</span>);   <span class="comment">//打开文件</span></span><br><span class="line">$con=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);  <span class="comment">//连接数据库</span></span><br><span class="line">$img=imagecreate(<span class="number">100</span>,<span class="number">100</span>);<span class="comment">//图形画布</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">//首先采用“fopen”函数打开文件，得到返回值的就是资源类型。</span></span><br><span class="line">$file_handle = fopen(<span class="string">"http://127.0.0.1/test.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line"><span class="keyword">if</span> ($file_handle)&#123;</span><br><span class="line">    <span class="comment">//接着采用while循环（后面语言结构语句中的循环结构会详细介绍）一行行地读取文件，然后输出每行的文字</span></span><br><span class="line">    <span class="keyword">while</span> (!feof($file_handle)) &#123; <span class="comment">//判断是否到最后一行</span></span><br><span class="line">        $line = fgets($file_handle); <span class="comment">//读取一行文本</span></span><br><span class="line">        <span class="keyword">echo</span> $line; <span class="comment">//输出一行文本</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>; <span class="comment">//换行</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">fclose($file_handle);<span class="comment">//关闭文件</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">我是第一行 </span><br><span class="line">我是第二行 </span><br><span class="line">我是第三行 </span><br><span class="line">我是第四行 </span><br><span class="line">我是第五行</span><br></pre></td></tr></table></figure>
<p></p><h3>特殊类型—空类型</h3><br>NULL（NULL）：NULL是空类型，对大小写不敏感，NULL类型只有一个取值，表示一个变量没有值，<p></p>
<ul>
<li>当被赋值为NULL</li>
<li>未被赋值</li>
<li>被unset()<br>这三种情况下变量被认为为NULL。</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"> $var;</span><br><span class="line"> var_dump($var);</span><br><span class="line"> $var1 = <span class="keyword">null</span>;</span><br><span class="line"> var_dump($var1);</span><br><span class="line"> $var2 = <span class="keyword">NULL</span>;</span><br><span class="line"> var_dump($var2);</span><br><span class="line"> $var3 = <span class="string">"节日快乐！"</span>;</span><br><span class="line"> <span class="keyword">unset</span>($var3);</span><br><span class="line"> var_dump($var3);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line"><span class="keyword">NULL</span> <span class="keyword">NULL</span> <span class="keyword">NULL</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[php基本语法格式]]></title>
      <url>https://shirly-yan.github.io/2016/10/11/php/php%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>php基本语法格式的记录，对于有基础的人试用<br><a id="more"></a></p>
<p></p><h2>基本格式</h2><br>以 <font color="#ff6666">&lt;?php</font>开头<br>以 <font color="#ff6666">?&gt;</font> 结尾<p></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"hello world"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>每条语句以 <font color="#ff6666">;</font> 结尾</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"hello world"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>注释<br>单行注释<font color="#ff6666">//</font><br>多行注释<font color="#ff6666">/**/</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//这是单行注释</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">这是多行注释</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"hello world"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[sublime text3]]></title>
      <url>https://shirly-yan.github.io/2016/10/11/system/sublime%20text3/</url>
      <content type="html"><![CDATA[<p>关于sublime text的使用 插件配置<br><a id="more"></a></p>
<h2 id="sublime-text-安装"><a href="#sublime-text-安装" class="headerlink" title="sublime text 安装"></a>sublime text 安装</h2><p><a href="https://www.sublimetext.com/" target="_blank" rel="noopener">官网下载https://www.sublimetext.com/</a></p>
<h2 id="convertToUTF8和ColorPicker快捷键冲突"><a href="#convertToUTF8和ColorPicker快捷键冲突" class="headerlink" title="convertToUTF8和ColorPicker快捷键冲突"></a>convertToUTF8和ColorPicker快捷键冲突</h2><p>convertoUTF8的默认转换GBK的快捷键 和 ColorPicker打开调色板的快捷键都是ctrl+shift+c 。<br>当装了2个插件后小伙伴就会发现都不好使了</p>
<p>解决方法是修改冲突的快捷键<br>打开Sublime Text –&gt; Preferences –&gt; Browse Packages，找到ConvertToUTF8文件夹并进入，根据系统修改相应的keymap文件<br><img src="/images/6.png" width="800" height="263"></p>
]]></content>
      
        <categories>
            
            <category> sublime text </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[mac下的php环境配置]]></title>
      <url>https://shirly-yan.github.io/2016/10/10/php/mac%E4%B8%8B%E7%9A%84php%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<p>mac下配置php环境的方法注意事项<br><a id="more"></a></p>
<h2 id="服务器-Apache"><a href="#服务器-Apache" class="headerlink" title="服务器 Apache"></a>服务器 Apache</h2><p>Mac OS自带Apache，只需要启动Apache就行。<br>打开终端，输入命令：sudo apachectl start<br>打开浏览器，在地址栏中输入localhost或者127.0.0.1，出现It Works字符串，就说明Apache已经成功启动<br><img src="/images/2.png" width="500" height="200"> </p>
<p>Apache的常用命令<br>启动Apache服务<br>sudo apachectl start<br>重启Apache服务<br>sudo apachectl restart<br>停止Apache服务<br>sudo apachectl stop<br>查看Apache版本<br>httpd -v<br><img src="/images/1.png" alt>  </p>
<p>Apache的网站服务器根目录在/Library/WebServer/Documents路径下</p>
<h2 id="配置PHP"><a href="#配置PHP" class="headerlink" title="配置PHP"></a>配置PHP</h2><p>Mac OS 同样自带PHP，只需要在Apache的配置文件中添加Apache对PHP的支持就好了</p>
<p>打开apache的配置文件<br>/etc/apache2/httpd.conf</p>
<p>前往指定文件夹的快捷键<br>command + shift + g</p>
<p>去掉此行的注释<br>LoadModule php5_module libexec/apache2/libphp5.so<br>然后保存<br><img src="/images/3.png" alt><br>重启Apache服务<br>sudo apachectl restart</p>
<p>创建test.php 放入Apache的网站服务器根目录/Library/WebServer/Documents路径下<br><img src="/images/4.png" width="300" height="300"> </p>
<p><img src="/images/5.png" width="842" height="230"> </p>
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[mac下升级php]]></title>
      <url>https://shirly-yan.github.io/2016/10/10/php/mac%E4%B8%8B%E5%8D%87%E7%BA%A7php/</url>
      <content type="html"><![CDATA[<p>mac下升级php<br><a id="more"></a></p>
<p></p><h3>安装</h3><br><a href="https://php-osx.liip.ch" target="_blank" rel="noopener">参考链接</a><p></p>
<p>安装php5.6<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -s http://php-osx.liip.ch/install.sh | bash -s 5.6</span><br></pre></td></tr></table></figure></p>
<p>安装php7.1<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -s http://php-osx.liip.ch/install.sh | bash -s 7.1</span><br></pre></td></tr></table></figure></p>
<p></p><h3>配置Apache支持php7</h3><br>终端输入<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/apache2/httpd.conf</span><br></pre></td></tr></table></figure><p></p>
<p>注释掉对php5的支持<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#LoadModule php5_module libexec/apache2/libphp5.so</span><br></pre></td></tr></table></figure></p>
<p>加入对php7的支持<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#########php7###########</span><br><span class="line">LoadModule php7_module   /usr/local/php5/libphp7.so</span><br><span class="line"></span><br><span class="line">&lt;IfModule mod_php7.c&gt;</span><br><span class="line"></span><br><span class="line">    AddType application/x-httpd-php .php</span><br><span class="line">    AddType application/x-httpd-php-source .phps</span><br><span class="line"></span><br><span class="line">    &lt;IfModule mod_dir.c&gt;</span><br><span class="line">        DirectoryIndex index.html index.php</span><br><span class="line">    &lt;/IfModule&gt;</span><br><span class="line"></span><br><span class="line">&lt;/IfModule&gt;</span><br><span class="line">#########php7###########</span><br></pre></td></tr></table></figure></p>
<p>重启Apache<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apachectl  restart</span><br></pre></td></tr></table></figure></p>
<p></p><h3>删除php</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo rm -rf /usr/<span class="built_in">local</span>/*php*</span><br><span class="line">$ sudo rm -rf /usr/<span class="built_in">local</span>/var/*php*</span><br></pre></td></tr></table></figure><p></p>
]]></content>
      
        <categories>
            
            <category> php </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Core Data]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/Core%20Data/</url>
      <content type="html"><![CDATA[<p>Core Data是iOS5之后才出现的一个框架，它提供了对象-关系映射(ORM)的功能，即能够将OC对象转化成数据，保存在SQLite数据库文件中，也能够将保存在数据库中的数据还原成OC对象。<br><a id="more"></a><br>在此数据操作期间，我们不需要编写任何SQL语句，这个有点类似于著名的Hibernate持久化框架，不过功能肯定是没有Hibernate强大的。简单地用下图描述下它的作用：<br><img src="http://img.my.csdn.net/uploads/201302/01/1359705997_4313.png" alt="abc"><br>左边是关系模型，即数据库，数据库里面有张person表，person表里面有id、name、age三个字段，而且有2条记录；<br>右边是对象模型，可以看到，有2个OC对象；<br>利用Core Data框架，我们就可以轻松地将数据库里面的2条记录转换成2个OC对象，也可以轻松地将2个OC对象保存到数据库中，变成2条表记录，而且不用写一条SQL语句。</p>
<p>#<a href></a>模型文件<br>  在Core Data，需要进行映射的对象称为实体(entity)，而且需要使用Core<br> Data的模型文件来描述app中的所有实体和实体属性。这里以Person(人)和Card(身份证)2个实体为例子，先看看实体属性和实体之间的关联关系：<br><img src="http://img.my.csdn.net/uploads/201302/01/1359707024_5895.png" alt="abc"><br>Person实体中有：name（姓名）、age（年龄）、card（身份证）三个属性<br>Card实体中有：no（号码）、person（人）两个属性</p>
<p>接下来看看创建模型文件的过程：<br>1.选择模板<br><img src="http://img.my.csdn.net/uploads/201302/01/1359707426_5763.png" alt="abc"><img src="http://img.my.csdn.net/uploads/201302/01/1359707501_8695.png" alt="abc"></p>
<p>2.添加实体<br><img src="http://img.my.csdn.net/uploads/201302/01/1359707563_9302.png" alt></p>
<p>3.添加Person的2个基本属性<br><img src="http://img.my.csdn.net/uploads/201302/01/1359707773_7614.png" alt></p>
<p>4.添加Card的1个基本属性<br><img src="http://img.my.csdn.net/uploads/201302/01/1359707796_4561.png" alt></p>
<p>5.建立Card和Person的关联关系<img src="http://img.my.csdn.net/uploads/201302/01/1359708105_6064.png" alt>        <img src="http://img.my.csdn.net/uploads/201302/01/1359708115_5772.png" alt><br>右图中的<img src="http://img.my.csdn.net/uploads/201302/01/1359708186_1349.png" alt>表示Card中有个Person类型的person属性，目的就是建立Card跟Person之间的一对一关联关系(建议补上这一项)，在Person中加上Inverse属性后，你会发现Card中Inverse属性也自动补上了<br><img src="http://img.my.csdn.net/uploads/201302/01/1359708436_2378.png" alt></p>
<hr>
<p>#<a href></a>了解NSManagedObject</p>
<p>1.通过Core Data从数据库取出的对象，默认情况下都是NSManagedObject对象<br><img src="http://img.my.csdn.net/uploads/201302/01/1359708744_9527.png" alt>  <img src="http://img.my.csdn.net/uploads/201302/01/1359708756_9809.png" alt></p>
<p>2.NSManagedObject的工作模式有点类似于NSDictionary对象，通过键-值对来存取所有的实体属性1&gt; setValue:forKey:存储属性值(属性名为key)<br>2&gt; valueForKey:获取属性值(属性名为key)</p>
<p><em>**</em>#<a href></a>CoreData中的核心对象</p>
<p><img src="http://img.my.csdn.net/uploads/201302/01/1359708878_8041.png" alt><br>注：黑色表示类名，红色表示类里面的一个属性<br>开发步骤总结：<br>1.初始化NSManagedObjectModel对象，加载模型文件，读取app中的所有实体信息<br>2.初始化NSPersistentStoreCoordinator对象，添加持久化库(这里采取SQLite数据库)<br>3.初始化NSManagedObjectContext对象，拿到这个上下文对象操作实体，进行CRUD操作</p>
<p><em>**</em>#<a href></a>代码实现<br>先添加CoreData.framework和导入主头文件&lt;CoreData/CoreData.h&gt;<br><img src="http://img.my.csdn.net/uploads/201302/01/1359710937_3208.png" alt></p>
<p>1.搭建上下文环境<br><strong>[java]</strong> <a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="copy" target="_blank" rel="noopener">copy</a>1. // 从应用程序包中加载模型文件  </p>
<ol start="2">
<li>NSManagedObjectModel *model = [NSManagedObjectModel mergedModelFromBundles:nil];  </li>
<li>// 传入模型对象，初始化NSPersistentStoreCoordinator  </li>
<li>NSPersistentStoreCoordinator *psc = [[[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:model] autorelease];  </li>
<li>// 构建SQLite数据库文件的路径  </li>
<li>NSString *docs = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];  </li>
<li>NSURL *url = [NSURL fileURLWithPath:[docs stringByAppendingPathComponent:@”person.data”]];  </li>
<li>// 添加持久化存储库，这里使用SQLite作为存储库  </li>
<li>NSError *error = nil;  </li>
<li>NSPersistentStore *store = [psc addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:url options:nil error:&amp;error];  </li>
<li>if (store == nil) { // 直接抛异常  </li>
<li>[NSException raise:@”添加数据库错误” format:@”%@”, [error localizedDescription]];  </li>
<li>}  </li>
<li>// 初始化上下文，设置persistentStoreCoordinator属性  </li>
<li>NSManagedObjectContext *context = [[NSManagedObjectContext alloc] init];  </li>
<li>context.persistentStoreCoordinator = psc;  </li>
<li>// 用完之后，记得要[context release];  </li>
</ol>
<p>2.添加数据到数据库<br><strong>[java]</strong> <a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="copy" target="_blank" rel="noopener">copy</a>1. // 传入上下文，创建一个Person实体对象  </p>
<ol start="2">
<li>NSManagedObject *person = [NSEntityDescription insertNewObjectForEntityForName:@”Person” inManagedObjectContext:context];  </li>
<li>// 设置Person的简单属性  </li>
<li>[person setValue:@”MJ” forKey:@”name”];  </li>
<li>[person setValue:[NSNumber numberWithInt:27] forKey:@”age”];  </li>
<li>// 传入上下文，创建一个Card实体对象  </li>
<li>NSManagedObject *card = [NSEntityDescription insertNewObjectForEntityForName:@”Card” inManagedObjectContext:context];  </li>
<li>[card setValue:@”4414241933432” forKey:@”no”];  </li>
<li>// 设置Person和Card之间的关联关系  </li>
<li>[person setValue:card forKey:@”card”];  </li>
<li>// 利用上下文对象，将数据同步到持久化存储库  </li>
<li>NSError *error = nil;  </li>
<li>BOOL success = [context save:&amp;error];  </li>
<li>if (!success) {  </li>
<li>[NSException raise:@”访问数据库错误” format:@”%@”, [error localizedDescription]];  </li>
<li>}  </li>
<li>// 如果是想做更新操作：只要在更改了实体对象的属性后调用[context save:&amp;error]，就能将更改的数据同步到数据库  </li>
</ol>
<p>3.从数据库中查询数据<br><strong>[java]</strong> <a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="copy" target="_blank" rel="noopener">copy</a>1. // 初始化一个查询请求  </p>
<ol start="2">
<li>NSFetchRequest *request = [[[NSFetchRequest alloc] init] autorelease];  </li>
<li>// 设置要查询的实体  </li>
<li>request.entity = [NSEntityDescription entityForName:@”Person” inManagedObjectContext:context];  </li>
<li>// 设置排序（按照age降序）  </li>
<li>NSSortDescriptor *sort = [NSSortDescriptor sortDescriptorWithKey:@”age” ascending:NO];  </li>
<li>request.sortDescriptors = [NSArray arrayWithObject:sort];  </li>
<li>// 设置条件过滤(搜索name中包含字符串”Itcast-1”的记录，注意：设置条件过滤时，数据库SQL语句中的%要用<em>来代替，所以%Itcast-1%应该写成</em>Itcast-1*)  </li>
<li>NSPredicate <em>predicate = [NSPredicate predicateWithFormat:@”name like %@”, @”</em>Itcast-1*”];  </li>
<li>request.predicate = predicate;  </li>
<li>// 执行请求  </li>
<li>NSError *error = nil;  </li>
<li>NSArray *objs = [context executeFetchRequest:request error:&amp;error];  </li>
<li>if (error) {  </li>
<li>[NSException raise:@”查询错误” format:@”%@”, [error localizedDescription]];  </li>
<li>}  </li>
<li>// 遍历数据  </li>
<li>for (NSManagedObject *obj in objs) {  </li>
<li>NSLog(@”name=%@”, [obj valueForKey:@”name”]  </li>
<li>}  </li>
</ol>
<p>注：Core Data不会根据实体中的关联关系立即获取相应的关联对象，比如通过Core Data取出Person实体时，并不会立即查询相关联的Card实体；当应用真的需要使用Card时，才会再次查询数据库，加载Card实体的信息。这个就是Core Data的延迟加载机制</p>
<p>4.删除数据库中的数据<br><strong>[java]</strong> <a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="copy" target="_blank" rel="noopener">copy</a>1. // 传入需要删除的实体对象  </p>
<ol start="2">
<li>[context deleteObject:managedObject];  </li>
<li>// 将结果同步到数据库  </li>
<li>NSError *error = nil;  </li>
<li>[context save:&amp;error];  </li>
<li>if (error) {  </li>
<li>[NSException raise:@”删除错误” format:@”%@”, [error localizedDescription]];  </li>
<li>}  </li>
</ol>
<p><strong><em>**</em></strong>#<a href></a>打开CoreData的SQL语句输出开关<br>1.打开Product，点击EditScheme…<br>2.点击Arguments，在ArgumentsPassed On Launch中添加2项<br>1&gt; -com.apple.CoreData.SQLDebug<br>2&gt; 1<br><img src="http://img.my.csdn.net/uploads/201302/01/1359711942_1857.png" alt><img src="http://img.my.csdn.net/uploads/201302/01/1359711964_1550.png" alt></p>
<p><strong><em>**</em></strong>#<a href></a>创建NSManagedObject的子类<br>默认情况下，利用Core Data取出的实体都是NSManagedObject类型的，能够利用键-值对来存取数据。但是一般情况下，实体在存取数据的基础上，有时还需要添加一些业务方法来完成一些其他任务，那么就必须创建NSManagedObject的子类<br><img src="http://img.my.csdn.net/uploads/201302/01/1359712054_3978.png" alt></p>
<p>选择模型文件<br><img src="http://img.my.csdn.net/uploads/201302/01/1359712079_5045.png" alt></p>
<p>选择需要创建子类的实体<br><img src="http://img.my.csdn.net/uploads/201302/01/1359712094_5888.png" alt></p>
<p>创建完毕后，多了2个子类<br><img src="http://img.my.csdn.net/uploads/201302/01/1359712116_3772.png" alt></p>
<p>文件内容展示：<br>Person.h<br><strong>[java]</strong> <a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="copy" target="_blank" rel="noopener">copy</a>1. #import &lt;Foundation/Foundation.h&gt;  </p>
<ol start="2">
<li>#import &lt;CoreData/CoreData.h&gt;  </li>
<li></li>
<li>@class Card;  </li>
<li></li>
<li>@interface Person : NSManagedObject  </li>
<li></li>
<li>@property (nonatomic, retain) NSString * name;  </li>
<li>@property (nonatomic, retain) NSNumber * age;  </li>
<li>@property (nonatomic, retain) Card *card;  </li>
<li></li>
<li>@end  </li>
</ol>
<p>Person.m<br><strong>[java]</strong> <a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="copy" target="_blank" rel="noopener">copy</a>1. #import “Person.h”  </p>
<ol start="2">
<li></li>
<li>@implementation Person  </li>
<li></li>
<li>@dynamic name;  </li>
<li>@dynamic age;  </li>
<li>@dynamic card;  </li>
<li></li>
<li>@end  </li>
</ol>
<p>Card.h<br><strong>[java]</strong> <a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="copy" target="_blank" rel="noopener">copy</a>1. #import &lt;Foundation/Foundation.h&gt;  </p>
<ol start="2">
<li>#import &lt;CoreData/CoreData.h&gt;  </li>
<li></li>
<li>@class Person;  </li>
<li></li>
<li>@interface Card : NSManagedObject  </li>
<li></li>
<li>@property (nonatomic, retain) NSString * no;  </li>
<li>@property (nonatomic, retain) Person *person;  </li>
<li></li>
<li>@end  </li>
</ol>
<p>Card.m<br><strong>[java]</strong> <a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="copy" target="_blank" rel="noopener">copy</a>1. #import “Card.h”  </p>
<ol start="2">
<li>#import “Person.h”  </li>
<li></li>
<li>@implementation Card  </li>
<li></li>
<li>@dynamic no;  </li>
<li>@dynamic person;  </li>
<li></li>
<li>@end  </li>
</ol>
<p>那么往数据库中添加数据的时候就应该写了：<br><strong>[java]</strong> <a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/q199109106q/article/details/8563438/#" title="copy" target="_blank" rel="noopener">copy</a>1. Person *person = [NSEntityDescription insertNewObjectForEntityForName:@”Person” inManagedObjectContext:context];  </p>
<ol start="2">
<li>person.name = @”MJ”;  </li>
<li>person.age = [NSNumber numberWithInt:27];  </li>
<li></li>
<li>Card *card = [NSEntityDescription insertNewObjectForEntityForName:@”Card” inManagedObjectContext:context];  </li>
<li>card.no = @”4414245465656”;  </li>
<li>person.card = card;  </li>
<li>// 最后调用[context save&amp;error];保存数据  </li>
</ol>
<p>说到这里，整个Core Data框架的入门就结束了，其实Core Data还远不止这些功能，它还支持自动撤销机制，一对多关联等，这里就不一一介绍了</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[shell或bash中判断文件是否存在]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/shell/%E5%88%A4%E6%96%AD%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E7%9A%84%E8%84%9A%E6%9C%AC%E8%AF%AD%E6%B3%95/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>Conditional Logic on Files<br>-a file exists.<br>-b file exists and is a block special file.<br>-c file exists and is a character special file.<br>-d file exists and is a directory.<br>-e file exists (just the same as -a).<br>-f file exists and is a regular file.<br>-g file exists and has its setgid(2) bit set.<br>-G file exists and has the same group ID as this process.<br>-k file exists and has its sticky bit set.<br>-L file exists and is a symbolic link.<br>-n string length is not zero.<br>-o Named option is set on.<br>-O file exists and is owned by the user ID of this process.<br>-p file exists and is a first in, first out (FIFO) special file or<br>named pipe.<br>-r file exists and is readable by the current process.<br>-s file exists and has a size greater than zero.<br>-S file exists and is a socket.<br>-t file descriptor number fildes is open and associated with a<br>terminal device.<br>-u file exists and has its setuid(2) bit set.<br>-w file exists and is writable by the current process.<br>-x file exists and is executable by the current process.<br>-z string length is zero.</p>
<p>myPath=”/var/log/httpd/“<br>myFile=”/var /log/httpd/access.log”</p>
<h1 id="这里的-x-参数判断-myPath是否存在并且是否具有可执行权限"><a href="#这里的-x-参数判断-myPath是否存在并且是否具有可执行权限" class="headerlink" title="这里的-x 参数判断$myPath是否存在并且是否具有可执行权限"></a>这里的-x 参数判断$myPath是否存在并且是否具有可执行权限</h1><p>if [ ! -x “$myPath”]; then<br>  mkdir “$myPath”<br>fi</p>
<h1 id="这里的-d-参数判断-myPath是否存在"><a href="#这里的-d-参数判断-myPath是否存在" class="headerlink" title="这里的-d 参数判断$myPath是否存在"></a>这里的-d 参数判断$myPath是否存在</h1><p>if [ ! -d “$myPath”]; then<br> mkdir “$myPath”<br>fi</p>
<h1 id="这里的-f参数判断-myFile是否存在"><a href="#这里的-f参数判断-myFile是否存在" class="headerlink" title="这里的-f参数判断$myFile是否存在"></a>这里的-f参数判断$myFile是否存在</h1><p>if [ ! -f “$myFile” ]; then<br> touch “$myFile”<br>fi</p>
<h1 id="其他参数还有-n-n是判断一个变量是否是否有值"><a href="#其他参数还有-n-n是判断一个变量是否是否有值" class="headerlink" title="其他参数还有-n,-n是判断一个变量是否是否有值"></a>其他参数还有-n,-n是判断一个变量是否是否有值</h1><p>if [ ! -n “$myVar” ]; then<br> echo “$myVar is empty”<br> exit 0<br>fi</p>
<h1 id="两个变量判断是否相等"><a href="#两个变量判断是否相等" class="headerlink" title="两个变量判断是否相等"></a>两个变量判断是否相等</h1><p>if [ “$var1” = “$var2” ]; then<br> echo ‘$var1 eq $var2’<br>else<br> echo ‘$var1 not eq $var2’<br>fi</p>
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS7使用原生API进行二维码和条形码的扫描]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/IOS7%E4%BD%BF%E7%94%A8%E5%8E%9F%E7%94%9FAPI%E8%BF%9B%E8%A1%8C%E4%BA%8C%E7%BB%B4%E7%A0%81%E5%92%8C%E6%9D%A1%E5%BD%A2%E7%A0%81%E7%9A%84%E6%89%AB%E6%8F%8F/</url>
      <content type="html"><![CDATA[<p>iOS7之前，开发者进行扫码编程时，一般会借助第三方库。常用的是ZBarSDK，IOS7之后，系统的AVMetadataObject类中，为我们提供了解析二维码的接口。经过测试，使用原生API扫描和处理的效率非常高，远远高于第三方库。<br><a id="more"></a></p>
<p>#转自：<a href="http://my.oschina.net/u/2340880/blog/405847" target="_blank" rel="noopener">http://my.oschina.net/u/2340880/blog/405847</a></p>
<p>##使用IOS7原生API进行二维码条形码的扫描</p>
<p>###一、使用方法示例</p>
<p>官方提供的接口非常简单，代码如下：</p>
<p><a href="http://my.oschina.net/u/2340880/blog/405847#" target="_blank" rel="noopener">?</a>123456789101112131415161718192021222324252627282930313233343536<code>@interface ViewController ()&lt;AVCaptureMetadataOutputObjectsDelegate&gt;`</code>//用于处理采集信息的代理<code>{</code>    <code>AVCaptureSession * session;</code>//输入输出的中间桥梁<code>}</code>@end<code>@implementation ViewController` `- (</code>void<code>)viewDidLoad {</code>    <code>[super viewDidLoad];</code>    <code>// Do any additional setup after loading the view, typically from a nib.</code>    <code>//获取摄像设备</code>    <code>AVCaptureDevice * device = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];</code>    <code>//创建输入流</code>    <code>AVCaptureDeviceInput * input = [AVCaptureDeviceInput deviceInputWithDevice:device error:nil];</code>    <code>//创建输出流</code>    <code>AVCaptureMetadataOutput * output = [[AVCaptureMetadataOutput alloc]init];</code>    <code>//设置代理 在主线程里刷新</code>    <code>[output setMetadataObjectsDelegate:self queue:dispatch_get_main_queue()];</code>    <code></code>    <code>//初始化链接对象</code>    <code>session = [[AVCaptureSession alloc]init];</code>    <code>//高质量采集率</code>    <code>[session setSessionPreset:AVCaptureSessionPresetHigh];</code>    <code></code>    <code>[session addInput:input];</code>    <code>[session addOutput:output];</code>    <code>//设置扫码支持的编码格式(如下设置条形码和二维码兼容)</code>    <code>output.metadataObjectTypes=@[AVMetadataObjectTypeQRCode,AVMetadataObjectTypeEAN13Code, AVMetadataObjectTypeEAN8Code, AVMetadataObjectTypeCode128Code];</code>       <code></code>    <code>AVCaptureVideoPreviewLayer * layer = [AVCaptureVideoPreviewLayer layerWithSession:session];</code>    <code>layer.videoGravity=AVLayerVideoGravityResizeAspectFill;</code>    <code>layer.frame=self.view.layer.bounds;</code>    <code>[self.view.layer insertSublayer:layer atIndex:0];</code>    <code>//开始捕获</code>    <code>[session startRunning];</code>}`之后我们的UI上已经可以看到摄像头捕获的内容，只要实现代理中的方法，就可以完成二维码条形码的扫描：</p>
<p><a href="http://my.oschina.net/u/2340880/blog/405847#" target="_blank" rel="noopener">?</a>12345678<code>-(`</code>void<code>)captureOutput:(AVCaptureOutput *)captureOutput didOutputMetadataObjects:(NSArray *)metadataObjects fromConnection:(AVCaptureConnection *)connection{</code>    <code>if` `(metadataObjects.count&gt;0) {</code>        <code>//[session stopRunning];</code>        <code>AVMetadataMachineReadableCodeObject * metadataObject = [metadataObjects objectAtIndex : 0 ];</code>        <code>//输出扫描字符串</code>        <code>NSLog(@</code>“%@”<code>,metadataObject.stringValue);</code>    <code>}</code>}`###二、一些优化</p>
<p>通过上面的代码测试，我们可以发现系统的解析处理效率是相当的高，IOS官方提供的API也确实非常强大，然而，我们可以做进一步的优化，将效率更加提高：</p>
<p>首先，AVCaptureMetadataOutput类中有一个这样的属性(在IOS7.0之后可用)：<br>@property(nonatomic) CGRect rectOfInterest;<br>这个属性大致意思就是告诉系统它需要注意的区域，大部分APP的扫码UI中都会有一个框，提醒你将条形码放入那个区域，这个属性的作用就在这里，它可以设置一个范围，只处理在这个范围内捕获到的图像的信息。如此一来，可想而知，我们代码的效率又会得到很大的提高，在使用这个属性的时候。需要几点注意：</p>
<p>1、这个CGRect参数和普通的Rect范围不太一样，它的四个值的范围都是0-1，表示比例。<br>2、经过测试发现，这个参数里面的x对应的恰恰是距离左上角的垂直距离，y对应的是距离左上角的水平距离。<br>3、宽度和高度设置的情况也是类似。<br>3、举个例子如果我们想让扫描的处理区域是屏幕的下半部分，我们这样设置<br><a href="http://my.oschina.net/u/2340880/blog/405847#" target="_blank" rel="noopener">?</a>1<code>output.rectOfInterest=CGRectMake(0.5,0,0.5, 1);</code>具体apple为什么要设计成这样，或者是这个参数我的用法那里不对，还需要了解的朋友给个指导。</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[NSUserDefaults 简介，使用 NSUserDefaults 存储自定义对象]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/NSUserDefaults%20%E7%AE%80%E4%BB%8B%EF%BC%8C%E4%BD%BF%E7%94%A8%20NSUserDefaults%20%E5%AD%98%E5%82%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%B9%E8%B1%A1/</url>
      <content type="html"><![CDATA[<p>NSUserDefaults适合存储轻量级的本地数据，一些简单的数据（NSString类型的）例如密码，网址等，NSUserDefaults肯定是首选，但是如果我们自定义了一个对象，对象保存的是一些信息，这时候就不能直接存储到NSUserDefaults了<br><a id="more"></a><br>一、了解NSUserDefaults以及它可以直接存储的类型</p>
<pre><code>NSUserDefaults是一个单例，在整个程序中只有一个实例对象，他可以用于数据的永久保存，而且简单实用，这是它可以让数据自由传递的一个前提，也是大家喜欢用它保存简单数据的一个主要原因。     

使用 NSUserDefaults 存储自定义对象的最初，我们必须认识NSUserDefaults可以存储哪一些类型的数据，下面一一列出：
</code></pre><p>NSUserDefaults支持的数据类型有：NSNumber（NSInteger、float、double），NSString，NSDate，NSArray，NSDictionary，BOOL.<br>如果想要将上述数据类型的数据永久保存到NSUserDefaults中去，只需要简单的操作(一个Value 一个Key ),例如，想要保存一个NSString的对象，代码实现为：</p>
<pre><code>//将NSString 对象存储到 NSUserDefaults 中
NSString *passWord = @&quot;1234567&quot;;
NSUserDefaults *user = [NSUserDefaults standardUserDefaults];
[user setObject:passWord forKey:@&quot;userPassWord&quot;];


将数据取出也很简单，只需要取出key 对应的值就好了，代码如下：

NSUserDefaults *user = [NSUserDefaults standardUserDefaults];
NSString *passWord = [ user objectForKey:@&quot;userPassWord&quot;];
</code></pre><p>注意：对相同的Key赋值约等于一次覆盖，要保证每一个Key的唯一性</p>
<p>值得注意的是：</p>
<pre><code>    NSUserDefaults 存储的对象全是不可变的（这一点非常关键，弄错的话程序会出bug），例如，如果我想要存储一个 NSMutableArray 对象，我必须先创建一个不可变数组（NSArray）再将它存入NSUserDefaults中去，代码如下：



NSMutableArray *mutableArray = [NSMutableArray arrayWithObjects:@&quot;123&quot;,@&quot;234&quot;, nil];
NSArray * array = [NSArray arrayWithArray:mutableArray];

NSUserDefaults *user = [NSUserDefaults standardUserDefaults];
[user setObject:array forKey:@&quot;记住存放的一定是不可变的&quot;];
</code></pre><p>取出数据是一样的，想要用NSUserDefaults中的数据给可变数组赋值</p>
<p>先给出一个错误的写法：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/*-------------------------错误的赋值方法-------------------*/</span></span><br><span class="line">    <span class="built_in">NSUserDefaults</span> *user = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//这样写后，mutableArray 就变成了不可变数组了，如果你要在数组中添加或删除数据就会出现bug</span></span><br><span class="line">    <span class="built_in">NSMutableArray</span> *mutableArray = [user objectForKey:<span class="string">@"记住存放的一定是不可变的"</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">正确的写法：</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*-------------------------正确的赋值方法-------------------*/</span></span><br><span class="line">    <span class="built_in">NSUserDefaults</span> *user = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//可以用alloc 方法代替</span></span><br><span class="line">    <span class="built_in">NSMutableArray</span> *mutableArray = [<span class="built_in">NSMutableArray</span> arrayWithArray:[user objectForKey:<span class="string">@"记住存放的一定是不可变的"</span>]];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">二、使用 <span class="built_in">NSUserDefaults</span> 存储自定义对象</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、将自定义类型转换为<span class="built_in">NSData</span>类型</span><br><span class="line"></span><br><span class="line">      当数据重复而且多的时候（例如想存储全班同学的学号，姓名，性别（这个数据量可能太大了 ）），如果不用SQLite 存储 （多数据最好还是用这个），你可以选择使用归档，再将文件写入本地，但是这种方式和 <span class="built_in">NSUserDefaults</span> 比起来麻烦多了（因为<span class="built_in">NSFileManage</span> 本来就挺复杂） ，但是问题是，<span class="built_in">NSUserDefaults</span> 本身不支持自定义对象的存储，不过它支持<span class="built_in">NSData</span>的类型，下面举一个例子来介绍。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">我们先建立一个叫Student 的类，这个类里有三个属性（学号，姓名，性别）,如图：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">我们要做的就是将Student类型变成<span class="built_in">NSData</span>类型 ，那么就必须实现归档：</span><br><span class="line"></span><br><span class="line">这里要实现 在.h 文件中申明 <span class="built_in">NSCoding</span> 协议，再 在 .m 中实现 encodeWithCoder 方法 和 </span><br><span class="line"></span><br><span class="line">initWithCoder 方法就可以了 ： </span><br><span class="line"></span><br><span class="line">.h 中修改文件如图 ：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.m中加入代码 ：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">这样做就可以将自定义类型转变为<span class="built_in">NSData</span>类型了</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、将自定义类型数据存入 <span class="built_in">NSUserDefaults</span> 中</span><br><span class="line"></span><br><span class="line">    如果要存储全班同学的信息，我们可以建一个<span class="built_in">NSMutableArray</span> 来存放全班同学的信息（里面存储的全是<span class="built_in">NSData</span>对象）在需要存储的地方加入代码：</span><br><span class="line"></span><br><span class="line"><span class="comment">//首先，要建立一个可变数组来存储 NSDate对象</span></span><br><span class="line"></span><br><span class="line">     Student *student = [[Student alloc] ini];</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//下面进行的是对student对象的 name ， studentNumber ，sex 的赋值</span></span><br><span class="line">    student.name = <span class="string">@"lady-奕奕"</span>;</span><br><span class="line">    student.studentNumber = <span class="string">@"3100104006"</span>;</span><br><span class="line">    student.sex = <span class="string">@"女"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//这是一个存放全班同学的数组</span></span><br><span class="line">    <span class="built_in">NSMutableArray</span> * dataArray = [<span class="built_in">NSMutableArray</span> arrayWithCapacity:<span class="number">50</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//将student类型变为NSData类型</span></span><br><span class="line">    <span class="built_in">NSData</span> *data = [<span class="built_in">NSKeyedArchiver</span> archivedDataWithRootObject:student];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//存放数据的数组将data加入进去</span></span><br><span class="line">    [dataArray addObject:data];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">如果你只想存一个人的信息，你可以直接将<span class="built_in">NSData</span>存入<span class="built_in">NSUserDefaults</span>中 :</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSData</span> *data = [<span class="built_in">NSKeyedArchiver</span> archivedDataWithRootObject:student];   </span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSUserDefaults</span> *user = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line">    [user setObject:data forKey:<span class="string">@"oneStudent"</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">如果你想存储全班同学的信息，你还要用一个<span class="keyword">for</span>循环将data 放入 dataArray中，这里具体的操作就不实现了，只给出存放的代码：</span><br><span class="line"></span><br><span class="line">   <span class="comment">//记住要转换成不可变数组类型</span></span><br><span class="line">    <span class="built_in">NSArray</span> * array = [<span class="built_in">NSArray</span> arrayWithArray:dataArray];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSUserDefaults</span> *user = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line">    [user setObject:array forKey:<span class="string">@"allStudent"</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">从<span class="built_in">NSUserDefaults</span>中取出数据在还原也很简单</span><br><span class="line"></span><br><span class="line">例如还原一个学生的数据：</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSUserDefaults</span> *user = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line"> </span><br><span class="line"> <span class="built_in">NSdData</span> *data = [user objectForKey:<span class="string">@"oneStudent"</span>];</span><br><span class="line">    </span><br><span class="line"> Student *student = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithData:data];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">总之，<span class="built_in">NSUserDefaults</span> 在我们编写代码中是最常用的一个永久保存数据的方法，也是最简单的。</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS开发系列--通知与消息机制]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS%E5%BC%80%E5%8F%91%E7%B3%BB%E5%88%97--%E9%80%9A%E7%9F%A5%E4%B8%8E%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6/</url>
      <content type="html"><![CDATA[<p>在多数移动应用中任何时候都只能有一个应用程序处于活跃状态，如果其他应用此刻发生了一些用户感兴趣的那么通过通知机制就可以告诉用户此时发生的事情。iOS中通知机制又叫消息机制，其包括两类：一类是本地通知；另一类是推送通知，也叫远程通知。两种通知在iOS中的表现一致，可以通过横幅或者弹出提醒两种形式告诉用户，并且点击通知可以会打开应用程序，但是实现原理却完全不同。今天就和大家一块去看一下如何在iOS中实现这两种机制，并且在文章后面会补充通知中心的内容避免初学者对两种概念的混淆。<br><a id="more"></a><br>来自：http://<br>blog.csdn.net/jianxin160/article/details/47753239</p>
<p>本地通知<br>推送通知<br>补充–iOS开发证书、秘钥<br>补充–通知中心<br>本地通知<br>本地通知是由本地应用触发的，它是基于时间行为的一种通知形式，例如闹钟定时、待办事项提醒，又或者一个应用在一段时候后不使用通常会提示用户使用此应用等都是本地通知。创建一个本地通知通常分为以下几个步骤：<br>创建UILocalNotification。<br>设置处理通知的时间fireDate。<br>配置通知的内容：通知主体、通知声音、图标数字等。<br>配置通知传递的自定义数据参数userInfo（这一步可选）。<br>调用通知，可以使用scheduleLocalNotification:按计划调度一个通知，也可以使用presentLocalNotificationNow立即调用通知。<br>下面就以一个程序更新后用户长期没有使用的提醒为例对本地通知做一个简单的了解。在这个过程中并没有牵扯太多的界面操作，所有的逻辑都在AppDelegate中：进入应用后如果没有注册通知，需要首先注册通知请求用户允许通知；一旦调用完注册方法，无论用户是否选择允许通知此刻都会调用应用程序的- (void)application:(UIApplication <em>)application didRegisterUserNotificationSettings:(UIUserNotificationSettings </em>)notificationSettings代理方法，在这个方法中根据用户的选择：如果是允许通知则会按照前面的步骤创建通知并在一定时间后执行。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">```objc</span><br></pre></td></tr></table></figure></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br></pre></td><td class="code"><pre><span class="line">AppDelegate.m</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  AppDelegate.m</span></span><br><span class="line"><span class="comment">//  LocalNotification</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/28.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 Kenshin Cui. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"AppDelegate.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCMainViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AppDelegate</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AppDelegate</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 应用代理方法</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions &#123;</span><br><span class="line">    </span><br><span class="line">    _window=[[<span class="built_in">UIWindow</span> alloc]initWithFrame:[<span class="built_in">UIScreen</span> mainScreen].bounds];</span><br><span class="line">    </span><br><span class="line">    _window.backgroundColor =[<span class="built_in">UIColor</span> colorWithRed:<span class="number">249</span>/<span class="number">255.0</span> green:<span class="number">249</span>/<span class="number">255.0</span> blue:<span class="number">249</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置全局导航条风格和颜色</span></span><br><span class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setBarTintColor:[<span class="built_in">UIColor</span> colorWithRed:<span class="number">23</span>/<span class="number">255.0</span> green:<span class="number">180</span>/<span class="number">255.0</span> blue:<span class="number">237</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>]];</span><br><span class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setBarStyle:<span class="built_in">UIBarStyleBlack</span>];</span><br><span class="line">    </span><br><span class="line">    KCMainViewController *mainController=[[KCMainViewController alloc]init];</span><br><span class="line">    _window.rootViewController=mainController;</span><br><span class="line">    </span><br><span class="line">    [_window makeKeyAndVisible];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果已经获得发送通知的授权则创建本地通知，否则请求授权(注意：如果不请求授权在设置中是没有对应的通知设置项的，也就是说如果从来没有发送过请求，即使通过设置也打不开消息允许设置)</span></span><br><span class="line">    <span class="keyword">if</span> ([[<span class="built_in">UIApplication</span> sharedApplication]currentUserNotificationSettings].types!=<span class="built_in">UIUserNotificationTypeNone</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span> addLocalNotification];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        [[<span class="built_in">UIApplication</span> sharedApplication]registerUserNotificationSettings:[<span class="built_in">UIUserNotificationSettings</span> settingsForTypes:<span class="built_in">UIUserNotificationTypeAlert</span>|<span class="built_in">UIUserNotificationTypeBadge</span>|<span class="built_in">UIUserNotificationTypeSound</span>  categories:<span class="literal">nil</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 调用过用户注册通知方法之后执行（也就是调用完registerUserNotificationSettings:方法之后执行）</span></span><br><span class="line">-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didRegisterUserNotificationSettings:(<span class="built_in">UIUserNotificationSettings</span> *)notificationSettings&#123;</span><br><span class="line">    <span class="keyword">if</span> (notificationSettings.types!=<span class="built_in">UIUserNotificationTypeNone</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span> addLocalNotification];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 进入前台后设置消息信息</span></span><br><span class="line">-(<span class="keyword">void</span>)applicationWillEnterForeground:(<span class="built_in">UIApplication</span> *)application&#123;</span><br><span class="line">    [[<span class="built_in">UIApplication</span> sharedApplication]setApplicationIconBadgeNumber:<span class="number">0</span>];<span class="comment">//进入前台取消应用消息图标</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 添加本地通知</span></span><br><span class="line">-(<span class="keyword">void</span>)addLocalNotification&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//定义本地通知对象</span></span><br><span class="line">    <span class="built_in">UILocalNotification</span> *notification=[[<span class="built_in">UILocalNotification</span> alloc]init];</span><br><span class="line">    <span class="comment">//设置调用时间</span></span><br><span class="line">    notification.fireDate=[<span class="built_in">NSDate</span> dateWithTimeIntervalSinceNow:<span class="number">10.0</span>];<span class="comment">//通知触发的时间，10s以后</span></span><br><span class="line">    notification.repeatInterval=<span class="number">2</span>;<span class="comment">//通知重复次数</span></span><br><span class="line">    <span class="comment">//notification.repeatCalendar=[NSCalendar currentCalendar];//当前日历，使用前最好设置时区等信息以便能够自动同步时间</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置通知属性</span></span><br><span class="line">    notification.alertBody=<span class="string">@"最近添加了诸多有趣的特性，是否立即体验？"</span>; <span class="comment">//通知主体</span></span><br><span class="line">    notification.applicationIconBadgeNumber=<span class="number">1</span>;<span class="comment">//应用程序图标右上角显示的消息数</span></span><br><span class="line">    notification.alertAction=<span class="string">@"打开应用"</span>; <span class="comment">//待机界面的滑动动作提示</span></span><br><span class="line">    notification.alertLaunchImage=<span class="string">@"Default"</span>;<span class="comment">//通过点击通知打开应用时的启动图片,这里使用程序启动图片</span></span><br><span class="line">    <span class="comment">//notification.soundName=UILocalNotificationDefaultSoundName;//收到通知时播放的声音，默认消息声音</span></span><br><span class="line">    notification.soundName=<span class="string">@"msg.caf"</span>;<span class="comment">//通知声音（需要真机才能听到声音）</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置用户信息</span></span><br><span class="line">    notification.userInfo=@&#123;<span class="string">@"id"</span>:@<span class="number">1</span>,<span class="string">@"user"</span>:<span class="string">@"Kenshin Cui"</span>&#125;;<span class="comment">//绑定到通知上的其他附加信息</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//调用通知</span></span><br><span class="line">    [[<span class="built_in">UIApplication</span> sharedApplication] scheduleLocalNotification:notification];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 移除本地通知，在不需要此通知时记得移除</span></span><br><span class="line">-(<span class="keyword">void</span>)removeNotification&#123;</span><br><span class="line">    [[<span class="built_in">UIApplication</span> sharedApplication] cancelAllLocalNotifications];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">请求获得用户允许通知的效果：</span><br><span class="line"> LocalNotification_Request</span><br><span class="line">应用退出到后弹出通知的效果：</span><br><span class="line"> LocalNotification_Notification</span><br><span class="line">锁屏状态下的通知效果(从这个界面可以看到alertAction配置为“打开应用”)：</span><br><span class="line">LocalNotification_Lock</span><br><span class="line">注意：</span><br><span class="line">在使用通知之前必须注册通知类型，如果用户不允许应用程序发送通知，则以后就无法发送通知，除非用户手动到iOS设置中打开通知。</span><br><span class="line">本地通知是有操作系统统一调度的，只有在应用退出到后台或者关闭才能收到通知。(注意：这一点对于后面的推送通知也是完全适用的。 ）</span><br><span class="line">通知的声音是由iOS系统播放的，格式必须是Linear PCM、MA4（IMA/ADPCM）、µLaw、aLaw中的一种，并且播放时间必须在<span class="number">30</span>s内，否则将被系统声音替换，同时自定义声音文件必须放到main boundle中。</span><br><span class="line">本地通知的数量是有限制的，最近的本地通知最多只能有<span class="number">64</span>个，超过这个数量将被系统忽略。</span><br><span class="line">如果想要移除本地通知可以调用<span class="built_in">UIApplication</span>的cancelLocalNotification:或cancelAllLocalNotifications移除指定通知或所有通知。</span><br><span class="line">从上面的程序可以看到userInfo这个属性我们设置了参数，那么这个参数如何接收呢？</span><br><span class="line">在iOS中如果点击一个弹出通知（或者锁屏界面滑动查看通知），默认会自动打开当前应用。由于通知由系统调度那么此时进入应用有两种情况：如果应用程序已经完全退出那么此时会调用- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions方法；如果此时应用程序还在运行（无论是在前台还是在后台）则会调用-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didReceiveLocalNotification:(<span class="built_in">UILocalNotification</span> *)notification方法接收消息参数。当然如果是后者自然不必多说，因为参数中已经可以拿到notification对象，只要读取userInfo属性即可。如果是前者的话则可以访问launchOptions中键为<span class="built_in">UIApplicationLaunchOptionsLocalNotificationKey</span>的对象，这个对象就是发送的通知，由此对象再去访问userInfo。为了演示这个过程在下面的程序中将userInfo的内容写入文件以便模拟关闭程序后再通过点击通知打开应用获取userInfo的过程。</span><br><span class="line">AppDelegate.m</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  AppDelegate.m</span></span><br><span class="line"><span class="comment">//  LocalNotification</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/28.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 Kenshin Cui. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"AppDelegate.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCMainViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AppDelegate</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AppDelegate</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 应用代理方法</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions &#123;</span><br><span class="line">    </span><br><span class="line">    _window=[[<span class="built_in">UIWindow</span> alloc]initWithFrame:[<span class="built_in">UIScreen</span> mainScreen].bounds];</span><br><span class="line">    </span><br><span class="line">    _window.backgroundColor =[<span class="built_in">UIColor</span> colorWithRed:<span class="number">249</span>/<span class="number">255.0</span> green:<span class="number">249</span>/<span class="number">255.0</span> blue:<span class="number">249</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置全局导航条风格和颜色</span></span><br><span class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setBarTintColor:[<span class="built_in">UIColor</span> colorWithRed:<span class="number">23</span>/<span class="number">255.0</span> green:<span class="number">180</span>/<span class="number">255.0</span> blue:<span class="number">237</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>]];</span><br><span class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setBarStyle:<span class="built_in">UIBarStyleBlack</span>];</span><br><span class="line">    </span><br><span class="line">    KCMainViewController *mainController=[[KCMainViewController alloc]init];</span><br><span class="line">    _window.rootViewController=mainController;</span><br><span class="line">    </span><br><span class="line">    [_window makeKeyAndVisible];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加通知</span></span><br><span class="line">    [<span class="keyword">self</span> addLocalNotification];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接收通知参数</span></span><br><span class="line">    <span class="built_in">UILocalNotification</span> *notification=[launchOptions valueForKey:<span class="built_in">UIApplicationLaunchOptionsLocalNotificationKey</span>];</span><br><span class="line">    <span class="built_in">NSDictionary</span> *userInfo= notification.userInfo;</span><br><span class="line">    </span><br><span class="line">    [userInfo writeToFile:<span class="string">@"/Users/kenshincui/Desktop/didFinishLaunchingWithOptions.txt"</span> atomically:<span class="literal">YES</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"didFinishLaunchingWithOptions:The userInfo is %@."</span>,userInfo);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 接收本地通知时触发</span></span><br><span class="line">-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didReceiveLocalNotification:(<span class="built_in">UILocalNotification</span> *)notification&#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *userInfo=notification.userInfo;</span><br><span class="line">    [userInfo writeToFile:<span class="string">@"/Users/kenshincui/Desktop/didReceiveLocalNotification.txt"</span> atomically:<span class="literal">YES</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"didReceiveLocalNotification:The userInfo is %@"</span>,userInfo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 调用过用户注册通知方法之后执行（也就是调用完registerUserNotificationSettings:方法之后执行）</span></span><br><span class="line">-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didRegisterUserNotificationSettings:(<span class="built_in">UIUserNotificationSettings</span> *)notificationSettings&#123;</span><br><span class="line">    <span class="keyword">if</span> (notificationSettings.types!=<span class="built_in">UIUserNotificationTypeNone</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span> addLocalNotification];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 进入前台后设置消息信息</span></span><br><span class="line">-(<span class="keyword">void</span>)applicationWillEnterForeground:(<span class="built_in">UIApplication</span> *)application&#123;</span><br><span class="line">    [[<span class="built_in">UIApplication</span> sharedApplication]setApplicationIconBadgeNumber:<span class="number">0</span>];<span class="comment">//进入前台取消应用消息图标</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 添加本地通知</span></span><br><span class="line">-(<span class="keyword">void</span>)addLocalNotification&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//定义本地通知对象</span></span><br><span class="line">    <span class="built_in">UILocalNotification</span> *notification=[[<span class="built_in">UILocalNotification</span> alloc]init];</span><br><span class="line">    <span class="comment">//设置调用时间</span></span><br><span class="line">    notification.fireDate=[<span class="built_in">NSDate</span> dateWithTimeIntervalSinceNow:<span class="number">10.0</span>];<span class="comment">//通知触发的时间，10s以后</span></span><br><span class="line">    notification.repeatInterval=<span class="number">2</span>;<span class="comment">//通知重复次数</span></span><br><span class="line">    <span class="comment">//notification.repeatCalendar=[NSCalendar currentCalendar];//当前日历，使用前最好设置时区等信息以便能够自动同步时间</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置通知属性</span></span><br><span class="line">    notification.alertBody=<span class="string">@"最近添加了诸多有趣的特性，是否立即体验？"</span>; <span class="comment">//通知主体</span></span><br><span class="line">    notification.applicationIconBadgeNumber=<span class="number">1</span>;<span class="comment">//应用程序图标右上角显示的消息数</span></span><br><span class="line">    notification.alertAction=<span class="string">@"打开应用"</span>; <span class="comment">//待机界面的滑动动作提示</span></span><br><span class="line">    notification.alertLaunchImage=<span class="string">@"Default"</span>;<span class="comment">//通过点击通知打开应用时的启动图片</span></span><br><span class="line">    <span class="comment">//notification.soundName=UILocalNotificationDefaultSoundName;//收到通知时播放的声音，默认消息声音</span></span><br><span class="line">    notification.soundName=<span class="string">@"msg.caf"</span>;<span class="comment">//通知声音（需要真机）</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置用户信息</span></span><br><span class="line">    notification.userInfo=@&#123;<span class="string">@"id"</span>:@<span class="number">1</span>,<span class="string">@"user"</span>:<span class="string">@"Kenshin Cui"</span>&#125;;<span class="comment">//绑定到通知上的其他额外信息</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//调用通知</span></span><br><span class="line">    [[<span class="built_in">UIApplication</span> sharedApplication] scheduleLocalNotification:notification];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">上面的程序可以分为两种情况去运行：一种是启动程序关闭程序，等到接收到通知之后点击通知重新进入程序；另一种是启动程序后，进入后台（其实在前台也可以，但是为了明显的体验这个过程建议进入后台），接收到通知后点击通知进入应用。另种情况会分别按照前面说的情况调用不同的方法接收到userInfo写入本地文件系统。有了userInfo一般来说就可以根据这个信息进行一些处理，例如可以根据不同的参数信息导航到不同的界面，假设是更新的通知则可以导航到更新内容界面等。</span><br><span class="line">推送通知</span><br><span class="line">和本地通知不同，推送通知是由应用服务提供商发起的，通过苹果的APNs（Apple Push Notification Server）发送到应用客户端。下面是苹果官方关于推送通知的过程示意图：</span><br><span class="line">PushNotification_FlowChart</span><br><span class="line">推送通知的过程可以分为以下几步：</span><br><span class="line">应用服务提供商从服务器端把要发送的消息和设备令牌（device token）发送给苹果的消息推送服务器APNs。</span><br><span class="line">APNs根据设备令牌在已注册的设备（iPhone、iPad、iTouch、mac等）查找对应的设备，将消息发送给相应的设备。</span><br><span class="line">客户端设备接将接收到的消息传递给相应的应用程序，应用程序根据用户设置弹出通知消息。</span><br><span class="line">当然，这只是一个简单的流程，有了这个流程我们还无从下手编写程序，将上面的流程细化可以得到如下流程图（图片来自互联网），在这个过程中会也会提到如何在程序中完成这些步骤：</span><br><span class="line">PushNotification_FlowChartDetail</span><br><span class="line"><span class="number">1.</span>应用程序注册APNs推送消息。</span><br><span class="line">说明：</span><br><span class="line">a.只有注册过的应用才有可能接收到消息，程序中通常通过<span class="built_in">UIApplication</span>的registerUserNotificationSettings:方法注册，iOS8中通知注册的方法发生了改变，如果是iOS7及之前版本的iOS请参考其他代码。</span><br><span class="line">b.注册之前有两个前提条件必须准备好：开发配置文件（provisioning profile，也就是.mobileprovision后缀的文件）的App ID不能使用通配ID必须使用指定APP ID并且生成配置文件中选择Push Notifications服务，一般的开发配置文件无法完成注册；应用程序的Bundle Identifier必须和生成配置文件使用的APP ID完全一致。</span><br><span class="line"><span class="number">2.</span>iOS从APNs接收device token，在应用程序获取device token。</span><br><span class="line">说明：</span><br><span class="line">a.在<span class="built_in">UIApplication</span>的-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didRegisterForRemoteNotificationsWithDeviceToken:(<span class="built_in">NSData</span> *)deviceToken代理方法中获取令牌，此方法发生在注册之后。</span><br><span class="line">b.如果无法正确获得device token可以在<span class="built_in">UIApplication</span>的-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didFailToRegisterForRemoteNotificationsWithError:(<span class="built_in">NSError</span> *)error代理方法中查看详细错误信息，此方法发生在获取device token失败之后。</span><br><span class="line">c.必须真机调试，模拟器无法获取device token。</span><br><span class="line"><span class="number">3.</span>iOS应用将device token发送给应用程序提供商，告诉服务器端当前设备允许接收消息。</span><br><span class="line">说明：</span><br><span class="line">a.device token的生成算法只有Apple掌握，为了确保算法发生变化后仍然能够正常接收服务器端发送的通知，每次应用程序启动都重新获得device token（注意：device token的获取不会造成性能问题，苹果官方已经做过优化）。</span><br><span class="line">b.通常可以创建一个网络连接发送给应用程序提供商的服务器端， 在这个过程中最好将上一次获得的device token存储起来，避免重复发送，一旦发现device token发生了变化最好将原有的device token一块发送给服务器端，服务器端删除原有令牌存储新令牌避免服务器端发送无效消息。</span><br><span class="line"><span class="number">4.</span>应用程序提供商在服务器端根据前面发送过来的device token组织信息发送给APNs。</span><br><span class="line">说明：</span><br><span class="line">a.发送时指定device token和消息内容，并且完全按照苹果官方的消息格式组织消息内容，通常情况下可以借助其他第三方消息推送框架来完成。</span><br><span class="line"><span class="number">5.</span>APNs根据消息中的device token查找已注册的设备推送消息。</span><br><span class="line">说明：</span><br><span class="line">a.正常情况下可以根据device token将消息成功推送到客户端设备中，但是也不排除用户卸载程序的情况，此时推送消息失败，APNs会将这个错误消息通知服务器端以避免资源浪费（服务器端此时可以根据错误删除已经存储的device token，下次不再发送）。</span><br><span class="line">下面将简单演示一下推送通知的简单流程:</span><br><span class="line">首先，看一下iOS客户端代码：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  AppDelegate.m</span></span><br><span class="line"><span class="comment">//  pushnotification</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/27.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 Kenshin Cui. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"AppDelegate.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCMainViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AppDelegate</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AppDelegate</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 应用程序代理方法</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 应用程序启动之后</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions &#123;</span><br><span class="line">    </span><br><span class="line">    _window=[[<span class="built_in">UIWindow</span> alloc]initWithFrame:[<span class="built_in">UIScreen</span> mainScreen].bounds];</span><br><span class="line">    </span><br><span class="line">    _window.backgroundColor =[<span class="built_in">UIColor</span> colorWithRed:<span class="number">249</span>/<span class="number">255.0</span> green:<span class="number">249</span>/<span class="number">255.0</span> blue:<span class="number">249</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置全局导航条风格和颜色</span></span><br><span class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setBarTintColor:[<span class="built_in">UIColor</span> colorWithRed:<span class="number">23</span>/<span class="number">255.0</span> green:<span class="number">180</span>/<span class="number">255.0</span> blue:<span class="number">237</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>]];</span><br><span class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setBarStyle:<span class="built_in">UIBarStyleBlack</span>];</span><br><span class="line">    </span><br><span class="line">    KCMainViewController *mainController=[[KCMainViewController alloc]init];</span><br><span class="line">    _window.rootViewController=mainController;</span><br><span class="line">    </span><br><span class="line">    [_window makeKeyAndVisible];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//注册推送通知（注意iOS8注册方法发生了变化）</span></span><br><span class="line">    [application registerUserNotificationSettings:[<span class="built_in">UIUserNotificationSettings</span> settingsForTypes:<span class="built_in">UIUserNotificationTypeAlert</span>|<span class="built_in">UIUserNotificationTypeBadge</span>|<span class="built_in">UIUserNotificationTypeSound</span> categories:<span class="literal">nil</span>]];</span><br><span class="line">    [application registerForRemoteNotifications];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 注册推送通知之后</span></span><br><span class="line"><span class="comment">//在此接收设备令牌</span></span><br><span class="line">-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didRegisterForRemoteNotificationsWithDeviceToken:(<span class="built_in">NSData</span> *)deviceToken&#123;</span><br><span class="line">    [<span class="keyword">self</span> addDeviceToken:deviceToken];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"device token:%@"</span>,deviceToken);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 获取device token失败后</span></span><br><span class="line">-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didFailToRegisterForRemoteNotificationsWithError:(<span class="built_in">NSError</span> *)error&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"didFailToRegisterForRemoteNotificationsWithError:%@"</span>,error.localizedDescription);</span><br><span class="line">    [<span class="keyword">self</span> addDeviceToken:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 接收到推送通知之后</span></span><br><span class="line">-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didReceiveRemoteNotification:(<span class="built_in">NSDictionary</span> *)userInfo&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"receiveRemoteNotification,userInfo is %@"</span>,userInfo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  添加设备令牌到服务器端</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param deviceToken 设备令牌</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addDeviceToken:(<span class="built_in">NSData</span> *)deviceToken&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *key=<span class="string">@"DeviceToken"</span>;</span><br><span class="line">    <span class="built_in">NSData</span> *oldToken= [[<span class="built_in">NSUserDefaults</span> standardUserDefaults]objectForKey:key];</span><br><span class="line">    <span class="comment">//如果偏好设置中的已存储设备令牌和新获取的令牌不同则存储新令牌并且发送给服务器端</span></span><br><span class="line">    <span class="keyword">if</span> (![oldToken isEqualToData:deviceToken]) &#123;</span><br><span class="line">        [[<span class="built_in">NSUserDefaults</span> standardUserDefaults] setObject:deviceToken forKey:key];</span><br><span class="line">        [<span class="keyword">self</span> sendDeviceTokenWidthOldDeviceToken:oldToken newDeviceToken:deviceToken];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)sendDeviceTokenWidthOldDeviceToken:(<span class="built_in">NSData</span> *)oldToken newDeviceToken:(<span class="built_in">NSData</span> *)newToken&#123;</span><br><span class="line">    <span class="comment">//注意一定确保真机可以正常访问下面的地址</span></span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=<span class="string">@"http://192.168.1.101/RegisterDeviceToken.aspx"</span>;</span><br><span class="line">    urlStr=[urlStr stringByAddingPercentEscapesUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line">    <span class="built_in">NSMutableURLRequest</span> *requestM=[<span class="built_in">NSMutableURLRequest</span> requestWithURL:url cachePolicy:<span class="number">0</span> timeoutInterval:<span class="number">10.0</span>];</span><br><span class="line">    [requestM setHTTPMethod:<span class="string">@"POST"</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *bodyStr=[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"oldToken=%@&amp;newToken=%@"</span>,oldToken,newToken];</span><br><span class="line">    <span class="built_in">NSData</span> *body=[bodyStr dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    [requestM setHTTPBody:body];</span><br><span class="line">    <span class="built_in">NSURLSession</span> *session=[<span class="built_in">NSURLSession</span> sharedSession];</span><br><span class="line">    <span class="built_in">NSURLSessionDataTask</span> *dataTask= [session dataTaskWithRequest:requestM completionHandler:^(<span class="built_in">NSData</span> *data, <span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSError</span> *error) &#123;</span><br><span class="line">        <span class="keyword">if</span> (error) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Send failure,error is :%@"</span>,error.localizedDescription);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Send Success!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">    [dataTask resume];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">iOS客户端代码的代码比较简单，注册推送通知，获取device token存储到偏好设置中，并且如果新获取的device token不同于偏好设置中存储的数据则发送给服务器端，更新服务器端device token列表。</span><br><span class="line">其次，由于device token需要发送给服务器端，这里使用一个Web应用作为服务器端接收device token，这里使用了ASP.NET程序来处理令牌接收注册工作，当然你使用其他技术同样没有问题。下面是对应的后台代码：</span><br><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line">using <span class="built_in">CMJ</span>.Framework.Data;</span><br><span class="line"></span><br><span class="line">namespace WebServer</span><br><span class="line">&#123;</span><br><span class="line">    public partial <span class="keyword">class</span> RegisterDeviceToken : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        private string _appID = <span class="string">@"com.cmjstudio.pushnotification"</span>;</span><br><span class="line">        private SqlHelper _helper = new SqlHelper();</span><br><span class="line">        protected <span class="keyword">void</span> Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            try</span><br><span class="line">            &#123;</span><br><span class="line">                string oldToken = Request[<span class="string">"oldToken"</span>] + <span class="string">""</span>;</span><br><span class="line">                string newToken = Request[<span class="string">"newToken"</span>] + <span class="string">""</span>;</span><br><span class="line">                string sql = <span class="string">""</span>;</span><br><span class="line">                <span class="comment">//如果传递旧的设备令牌则删除旧令牌添加新令牌</span></span><br><span class="line">                <span class="keyword">if</span> (oldToken != <span class="string">""</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    sql = string.Format(<span class="string">"DELETE FROM dbo.Device WHERE AppID='&#123;0&#125;' AND DeviceToken='&#123;1&#125;';"</span>, _appID, oldToken);</span><br><span class="line">                &#125;</span><br><span class="line">                sql += string.Format(<span class="string">@"IF NOT EXISTS (SELECT ID FROM dbo.Device WHERE AppID='&#123;0&#125;' AND DeviceToken='&#123;1&#125;')</span></span><br><span class="line"><span class="string">                                        INSERT INTO dbo.Device ( AppID, DeviceToken ) VALUES ( N'&#123;0&#125;', N'&#123;1&#125;');"</span>, _appID, newToken);</span><br><span class="line">                _helper.ExecuteNonQuery(sql);</span><br><span class="line">                Response.Write(<span class="string">"注册成功！"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            catch(Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                Response.Write(<span class="string">"注册失败，错误详情："</span>+ex.ToString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">这个过程主要就是保存device token到数据库中，当然如果同时传递旧的设备令牌还需要先删除就的设备令牌，这里简单的在数据库中创建了一张Device表来保存设备令牌，其中记录了应用程序Id和设备令牌。</span><br><span class="line">第三步就是服务器端发送消息，如果要给APNs发送消息就必须按照Apple的标准消息格式组织消息内容。但是好在目前已经有很多开源的第三方类库供我们使用，具体消息如何包装完全不用自己组织，这里使用一个开源的类库Push Sharp来给APNs发送消息 ,除了可以给Apple设备推送消息，Push Sharp还支持Android、Windows Phone等多种设备，更多详细内容大家可以参照官方说明。前面说过如果要开发消息推送应用不能使用一般的开发配置文件，这里还需要注意：如果服务器端要给APNs发送消息其秘钥也必须是通过APNs Development iOS类型的证书来导出的，一般的iOS Development 类型的证书导出的秘钥无法用作服务器端发送秘钥。下面通过在一个简单的WinForm程序中调用Push Sharp给APNs发送消息，这里读取之前Device表中的所有设备令牌循环发送消息：</span><br><span class="line">using System;</span><br><span class="line">using System.IO;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.ComponentModel;</span><br><span class="line">using System.Data;</span><br><span class="line">using System.Drawing;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Windows.Forms;</span><br><span class="line">using PushSharp;</span><br><span class="line">using PushSharp.Apple;</span><br><span class="line">using <span class="built_in">CMJ</span>.Framework.Data;</span><br><span class="line">using <span class="built_in">CMJ</span>.Framework.Logging;</span><br><span class="line">using <span class="built_in">CMJ</span>.Framework.Windows.Forms;</span><br><span class="line"></span><br><span class="line">namespace PushNotificationServer</span><br><span class="line">&#123;</span><br><span class="line">    public partial <span class="keyword">class</span> frmMain : PersonalizeForm</span><br><span class="line">    &#123;</span><br><span class="line">        private string _appID = <span class="string">@"com.cmjstudio.pushnotification"</span>;</span><br><span class="line">        private SqlHelper _helper = new SqlHelper();</span><br><span class="line">        public frmMain()</span><br><span class="line">        &#123;</span><br><span class="line">            InitializeComponent();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private <span class="keyword">void</span> btnClose_Click(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.Close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private <span class="keyword">void</span> btnSend_Click(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;string&gt; deviceTokens = GetDeviceToken();</span><br><span class="line">            SendMessage(deviceTokens, tbMessage.Text);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#region 发送消息</span></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 取得所有设备令牌</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;returns&gt;设备令牌&lt;/returns&gt;</span></span><br><span class="line">        private List&lt;string&gt; GetDeviceToken()</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;string&gt; deviceTokens = new List&lt;string&gt;();</span><br><span class="line">            string sql = string.Format(<span class="string">"SELECT DeviceToken FROM dbo.Device WHERE AppID='&#123;0&#125;'"</span>,_appID);</span><br><span class="line">            DataTable dt = _helper.GetDataTable(sql);</span><br><span class="line">            <span class="keyword">if</span>(dt.Rows.Count&gt;<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                foreach(DataRow dr <span class="keyword">in</span> dt.Rows)</span><br><span class="line">                &#123;</span><br><span class="line">                    deviceTokens.Add((dr[<span class="string">"DeviceToken"</span>]+<span class="string">""</span>).TrimStart(<span class="string">'&lt;'</span>).TrimEnd(<span class="string">'&gt;'</span>).Replace(<span class="string">" "</span>,<span class="string">""</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> deviceTokens;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 发送消息</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;param name="deviceToken"&gt;设备令牌&lt;/param&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;param name="message"&gt;消息内容&lt;/param&gt;</span></span><br><span class="line">        private <span class="keyword">void</span> SendMessage(List&lt;string&gt; deviceToken, string message)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//创建推送对象</span></span><br><span class="line">            var pusher = new PushBroker();</span><br><span class="line">            pusher.OnNotificationSent += pusher_OnNotificationSent;<span class="comment">//发送成功事件</span></span><br><span class="line">            pusher.OnNotificationFailed += pusher_OnNotificationFailed;<span class="comment">//发送失败事件</span></span><br><span class="line">            pusher.OnChannelCreated += pusher_OnChannelCreated;</span><br><span class="line">            pusher.OnChannelDestroyed += pusher_OnChannelDestroyed;</span><br><span class="line">            pusher.OnChannelException += pusher_OnChannelException;</span><br><span class="line">            pusher.OnDeviceSubscriptionChanged += pusher_OnDeviceSubscriptionChanged;</span><br><span class="line">            pusher.OnDeviceSubscriptionExpired += pusher_OnDeviceSubscriptionExpired;</span><br><span class="line">            pusher.OnNotificationRequeue += pusher_OnNotificationRequeue;</span><br><span class="line">            pusher.OnServiceException += pusher_OnServiceException;</span><br><span class="line">            <span class="comment">//注册推送服务</span></span><br><span class="line">            byte[] certificateData = File.ReadAllBytes(<span class="string">@"E:\KenshinCui_Push.p12"</span>);</span><br><span class="line">            pusher.RegisterAppleService(new ApplePushChannelSettings(certificateData, <span class="string">"123"</span>));</span><br><span class="line">            foreach (string token <span class="keyword">in</span> deviceToken)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//给指定设备发送消息</span></span><br><span class="line">                pusher.QueueNotification(new AppleNotification()</span><br><span class="line">                    .ForDeviceToken(token)</span><br><span class="line">                    .WithAlert(message) </span><br><span class="line">                    .WithBadge(<span class="number">1</span>)</span><br><span class="line">                    .WithSound(<span class="string">"default"</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> pusher_OnServiceException(object sender, Exception error)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"消息发送失败，错误详情："</span> + error.ToString());</span><br><span class="line">            PersonalizeMessageBox.Show(<span class="keyword">this</span>, <span class="string">"消息发送失败，错误详情："</span> + error.ToString(), <span class="string">"系统提示"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> pusher_OnNotificationRequeue(object sender, PushSharp.Core.NotificationRequeueEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"pusher_OnNotificationRequeue"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> pusher_OnDeviceSubscriptionExpired(object sender, string expiredSubscriptionId, DateTime expirationDateUtc, PushSharp.Core.INotification notification)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"pusher_OnDeviceSubscriptionChanged"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> pusher_OnDeviceSubscriptionChanged(object sender, string oldSubscriptionId, string newSubscriptionId, PushSharp.Core.INotification notification)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"pusher_OnDeviceSubscriptionChanged"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> pusher_OnChannelException(object sender, PushSharp.Core.IPushChannel pushChannel, Exception error)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"消息发送失败，错误详情："</span> + error.ToString());</span><br><span class="line">            PersonalizeMessageBox.Show(<span class="keyword">this</span>, <span class="string">"消息发送失败，错误详情："</span> + error.ToString(), <span class="string">"系统提示"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> pusher_OnChannelDestroyed(object sender)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"pusher_OnChannelDestroyed"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> pusher_OnChannelCreated(object sender, PushSharp.Core.IPushChannel pushChannel)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"pusher_OnChannelCreated"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> pusher_OnNotificationFailed(object sender, PushSharp.Core.INotification notification, Exception error)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"消息发送失败，错误详情："</span> + error.ToString());</span><br><span class="line">            PersonalizeMessageBox.Show(<span class="keyword">this</span>, <span class="string">"消息发送失败，错误详情："</span>+error.ToString(), <span class="string">"系统提示"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> pusher_OnNotificationSent(object sender, PushSharp.Core.INotification notification)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"消息发送成功！"</span>);</span><br><span class="line">            PersonalizeMessageBox.Show(<span class="keyword">this</span>, <span class="string">"消息发送成功！"</span>, <span class="string">"系统提示"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#endregion</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">服务器端消息发送应用运行效果：</span><br><span class="line">PushNotification_ServerClient</span><br><span class="line">iOS客户端接收的消息的效果：</span><br><span class="line">PushNotification_iOSApp</span><br><span class="line">到目前为止通过服务器端应用可以顺利发送消息给APNs并且iOS应用已经成功接收推送消息。</span><br><span class="line">补充--iOS开发证书、秘钥</span><br><span class="line">iOS开发过程中如果需要进行真机调试、发布需要注册申请很多证书，对于初学者往往迷惑不解，再加上今天的文章中会牵扯到一些特殊配置，这里就简单的对iOS开发的常用证书和秘钥等做一说明。</span><br><span class="line">证书</span><br><span class="line">iOS常用的证书包括开发证书和发布证书，无论是真机调试还是最终发布应用到App Store这两个证书都是必须的，它是iOS开发的基本证书。</span><br><span class="line">a.开发证书：开发证书又分为普通开发证书和推送证书，如果仅仅是一般的应用则前者即可满足，但是如果开发推送应用则必须使用推送证书。</span><br><span class="line">b.发布证书：发布证书又可以分为普通发布证书、推送证书、Pass Type ID证书、站点发布证书、VoIP服务证书、苹果支付证书。同样的，对于需要使用特殊服务的应用则必须选择对应的证书。</span><br><span class="line">应用标识</span><br><span class="line">App ID,应用程序的唯一标识，对应iOS应用的Bundle Identifier，App ID在苹果开发者中心中分为通配应用ID和明确的应用ID,前者一般用于普通应用开发，一个ID可以适用于多个不同标识的应用；但是对于使用消息推送、Passbook、站点发布、iCloud等服务的应用必须配置明确的应用ID。</span><br><span class="line">设备标识</span><br><span class="line">UDID,用于标识每一台硬件设备的标示符。注意它不是device token，device token是根据UDID使用一个只有Apple自己才知道的算法生成的一组标示符。</span><br><span class="line">配置简介</span><br><span class="line">Provisioning Profiles,平时又称为PP文件。将UDID、App ID、开发证书打包在一起的配置文件，同样分为开发和发布两类配置文件。</span><br><span class="line">秘钥</span><br><span class="line">在申请开发证书时必须要首先提交一个秘钥请求文件，对于生成秘钥请求文件的mac，如果要做开发则只需要下载证书和配置简介即可开发。但是如果要想在其他机器上做开发则必须将证书中的秘钥导出（导出之后是一个.p12文件），然后导入其他机器。同时对于类似于推送服务器端应用如果要给APNs发送消息，同样需要使用.p12秘钥文件，并且这个秘钥文件需要是推送证书导出的对应秘钥。</span><br><span class="line">补充--通知中心</span><br><span class="line">对于很多初学者往往会把iOS中的本地通知、推送通知和iOS通知中心的概念弄混。其实二者之间并没有任何关系，事实上它们都不属于一个框架，前者属于<span class="built_in">UIKit</span>框架，后者属于Foundation框架。</span><br><span class="line">通知中心实际上是iOS程序内部之间的一种消息广播机制，主要为了解决应用程序内部不同对象之间解耦而设计。它是基于观察者模式设计的，不能跨应用程序进程通信，当通知中心接收到消息之后会根据内部的消息转发表，将消息发送给订阅者。下面是一个简单的流程示意图：</span><br><span class="line">image</span><br><span class="line">了解通知中心需要熟悉<span class="built_in">NSNotificationCenter</span>和<span class="built_in">NSNotification</span>两个类：</span><br><span class="line"><span class="built_in">NSNotificationCenter</span>：是通知系统的中心，用于注册和发送通知，下表列出常用的方法。</span><br><span class="line">方法	说明</span><br><span class="line">- (<span class="keyword">void</span>)addObserver:(<span class="keyword">id</span>)observer selector:(SEL)aSelector name:(<span class="built_in">NSString</span> *)aName object:(<span class="keyword">id</span>)anObject	添加监听，参数：</span><br><span class="line">observer:监听者</span><br><span class="line">selector:监听方法（监听者监听到通知后执行的方法）</span><br><span class="line">  name:监听的通知名称</span><br><span class="line">object:通知的发送者（如果指定<span class="literal">nil</span>则监听任何对象发送的通知）</span><br><span class="line">- (<span class="keyword">id</span> &lt;<span class="built_in">NSObject</span>&gt;)addObserverForName:(<span class="built_in">NSString</span> *)name object:(<span class="keyword">id</span>)obj queue:(<span class="built_in">NSOperationQueue</span> *)queue usingBlock:(<span class="keyword">void</span> (^)(<span class="built_in">NSNotification</span> *note))block	添加监听，参数：</span><br><span class="line">name:监听的通知名称</span><br><span class="line">object:通知的发送者（如果指定<span class="literal">nil</span>则监听任何对象发送的通知）</span><br><span class="line">queue:操作队列，如果制定非主队线程队列则可以异步执行block</span><br><span class="line">block:监听到通知后执行的操作</span><br><span class="line">- (<span class="keyword">void</span>)postNotification:(<span class="built_in">NSNotification</span> *)notification	发送通知，参数：</span><br><span class="line">notification：通知对象</span><br><span class="line">- (<span class="keyword">void</span>)postNotificationName:(<span class="built_in">NSString</span> *)aName object:(<span class="keyword">id</span>)anObject	发送通知，参数：</span><br><span class="line">aName：通知名称</span><br><span class="line">anObject：通知发送者</span><br><span class="line">- (<span class="keyword">void</span>)postNotificationName:(<span class="built_in">NSString</span> *)aName object:(<span class="keyword">id</span>)anObject userInfo:(<span class="built_in">NSDictionary</span> *)aUserInfo	发送通知，参数：</span><br><span class="line">aName：通知名称</span><br><span class="line">anObject：通知发送者</span><br><span class="line">aUserInfo：通知参数</span><br><span class="line">- (<span class="keyword">void</span>)removeObserver:(<span class="keyword">id</span>)observer	移除监听，参数：</span><br><span class="line">observer：监听对象</span><br><span class="line">- (<span class="keyword">void</span>)removeObserver:(<span class="keyword">id</span>)observer name:(<span class="built_in">NSString</span> *)aName object:(<span class="keyword">id</span>)anObject	移除监听，参数：</span><br><span class="line">observer：监听对象</span><br><span class="line">aName：通知名称</span><br><span class="line">anObject：通知发送者</span><br><span class="line"><span class="built_in">NSNotification</span>：代表通知内容的载体，主要有三个属性：name代表通知名称，object代表通知的发送者，userInfo代表通知的附加信息。</span><br><span class="line">虽然前面的文章中从未提到过通知中心，但是其实通知中心我们并不陌生，前面文章中很多内容都是通过通知中心来进行应用中各个组件通信的，只是没有单独拿出来说而已。例如前面的文章中讨论的应用程序生命周期问题，当应用程序启动后、进入后台、进入前台、获得焦点、失去焦点，窗口大小改变、隐藏等都会发送通知。这个通知可以通过前面<span class="built_in">NSNotificationCenter</span>进行订阅即可接收对应的消息，下面的示例演示了如何添加监听获得<span class="built_in">UIApplication</span>的进入后台和获得焦点的通知：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  KCMainViewController.m</span></span><br><span class="line"><span class="comment">//  NotificationCenter</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/27.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCMainViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">KCMainViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">KCMainViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> addObserverToNotificationCenter];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 添加监听</span></span><br><span class="line">-(<span class="keyword">void</span>)addObserverToNotificationCenter&#123;</span><br><span class="line">    <span class="comment">/*添加应用程序进入后台监听</span></span><br><span class="line"><span class="comment">     * observer:监听者</span></span><br><span class="line"><span class="comment">     * selector:监听方法（监听者监听到通知后执行的方法）</span></span><br><span class="line"><span class="comment">     * name:监听的通知名称(下面的UIApplicationDidEnterBackgroundNotification是一个常量)</span></span><br><span class="line"><span class="comment">     * object:通知的发送者（如果指定nil则监听任何对象发送的通知）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(applicationEnterBackground) name:<span class="built_in">UIApplicationDidEnterBackgroundNotification</span> object:[<span class="built_in">UIApplication</span> sharedApplication]];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 添加应用程序获得焦点的通知监听</span></span><br><span class="line"><span class="comment">     * name:监听的通知名称</span></span><br><span class="line"><span class="comment">     * object:通知的发送者（如果指定nil则监听任何对象发送的通知）</span></span><br><span class="line"><span class="comment">     * queue:操作队列，如果制定非主队线程队列则可以异步执行block</span></span><br><span class="line"><span class="comment">     * block:监听到通知后执行的操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">NSOperationQueue</span> *operationQueue=[[<span class="built_in">NSOperationQueue</span> alloc]init];</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserverForName:<span class="built_in">UIApplicationDidBecomeActiveNotification</span> object:[<span class="built_in">UIApplication</span> sharedApplication] queue:operationQueue usingBlock:^(<span class="built_in">NSNotification</span> *note) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Application become active."</span>);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 应用程序启动监听方法</span></span><br><span class="line">-(<span class="keyword">void</span>)applicationEnterBackground&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Application enter background."</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">当然很多时候使用通知中心是为了添加自定义通知，并获得自定义通知消息。在前面的文章“iOS开发系列--视图切换”中提到过如何进行多视图之间参数传递，其实利用自定义通知也可以进行参数传递。通常一个应用登录后会显示用户信息，而登录信息可以通过登录界面获取。下面就以这样一种场景为例，在主界面中添加监听，在登录界面发送通知，一旦登录成功将向通知中心发送成功登录的通知，此时主界面中由于已经添加通知监听所以会收到通知并更新UI界面。</span><br><span class="line">主界面KCMainViewController.m：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  KCMainViewController.m</span></span><br><span class="line"><span class="comment">//  NotificationCenter</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/27</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCMainViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCLoginViewController.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UPDATE_LGOGIN_INFO_NOTIFICATION @<span class="meta-string">"updateLoginInfo"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">KCMainViewController</span> ()</span>&#123;</span><br><span class="line">    <span class="built_in">UILabel</span> *_lbLoginInfo;</span><br><span class="line">    <span class="built_in">UIButton</span> *_btnLogin;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">KCMainViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> setupUI];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)setupUI&#123;</span><br><span class="line">    <span class="built_in">UILabel</span> *label =[[<span class="built_in">UILabel</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">100</span>,<span class="number">320</span> ,<span class="number">30</span>)];</span><br><span class="line">    label.textAlignment=<span class="built_in">NSTextAlignmentCenter</span>;</span><br><span class="line">    label.textColor=[<span class="built_in">UIColor</span> colorWithRed:<span class="number">23</span>/<span class="number">255.0</span> green:<span class="number">180</span>/<span class="number">255.0</span> blue:<span class="number">237</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>];</span><br><span class="line">    _lbLoginInfo=label;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:label];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIButton</span> *button=[<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeSystem</span>];</span><br><span class="line">    button.frame=<span class="built_in">CGRectMake</span>(<span class="number">60</span>, <span class="number">200</span>, <span class="number">200</span>, <span class="number">25</span>);</span><br><span class="line">    [button setTitle:<span class="string">@"登录"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [button addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(loginOut) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">    _btnLogin=button;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:button];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)loginOut&#123;</span><br><span class="line">    <span class="comment">//添加监听</span></span><br><span class="line">    [<span class="keyword">self</span> addObserverToNotification];</span><br><span class="line">    </span><br><span class="line">    KCLoginViewController *loginController=[[KCLoginViewController alloc]init];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> presentViewController:loginController animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  添加监听</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addObserverToNotification&#123;</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(updateLoginInfo:) name:UPDATE_LGOGIN_INFO_NOTIFICATION object:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  更新登录信息,注意在这里可以获得通知对象并且读取附加信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)updateLoginInfo:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *userInfo=notification.userInfo;</span><br><span class="line">    _lbLoginInfo.text=userInfo[<span class="string">@"loginInfo"</span>];</span><br><span class="line">    _btnLogin.titleLabel.text=<span class="string">@"注销"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)dealloc&#123;</span><br><span class="line">    <span class="comment">//移除监听</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">登录界面KCLoginViewController.m：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  KCLoginViewController.m</span></span><br><span class="line"><span class="comment">//  NotificationCenter</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/27.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCLoginViewController.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UPDATE_LGOGIN_INFO_NOTIFICATION @<span class="meta-string">"updateLoginInfo"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">KCLoginViewController</span> ()</span>&#123;</span><br><span class="line">    <span class="built_in">UITextField</span> *_txtUserName;</span><br><span class="line">    <span class="built_in">UITextField</span> *_txtPassword;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">KCLoginViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> setupUI];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  UI布局</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)setupUI&#123;</span><br><span class="line">    <span class="comment">//用户名</span></span><br><span class="line">    <span class="built_in">UILabel</span> *lbUserName=[[<span class="built_in">UILabel</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">150</span>, <span class="number">100</span>, <span class="number">30</span>)];</span><br><span class="line">    lbUserName.text=<span class="string">@"用户名："</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:lbUserName];</span><br><span class="line">    </span><br><span class="line">    _txtUserName=[[<span class="built_in">UITextField</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">120</span>, <span class="number">150</span>, <span class="number">150</span>, <span class="number">30</span>)];</span><br><span class="line">    _txtUserName.borderStyle=<span class="built_in">UITextBorderStyleRoundedRect</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:_txtUserName];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//密码</span></span><br><span class="line">    <span class="built_in">UILabel</span> *lbPassword=[[<span class="built_in">UILabel</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">200</span>, <span class="number">100</span>, <span class="number">30</span>)];</span><br><span class="line">    lbPassword.text=<span class="string">@"密码："</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:lbPassword];</span><br><span class="line">    </span><br><span class="line">    _txtPassword=[[<span class="built_in">UITextField</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">120</span>, <span class="number">200</span>, <span class="number">150</span>, <span class="number">30</span>)];</span><br><span class="line">    _txtPassword.secureTextEntry=<span class="literal">YES</span>;</span><br><span class="line">    _txtPassword.borderStyle=<span class="built_in">UITextBorderStyleRoundedRect</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:_txtPassword];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//登录按钮</span></span><br><span class="line">    <span class="built_in">UIButton</span> *btnLogin=[<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeSystem</span>];</span><br><span class="line">    btnLogin.frame=<span class="built_in">CGRectMake</span>(<span class="number">70</span>, <span class="number">270</span>, <span class="number">80</span>, <span class="number">30</span>);</span><br><span class="line">    [btnLogin setTitle:<span class="string">@"登录"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:btnLogin];</span><br><span class="line">    [btnLogin addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(login) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//取消登录按钮</span></span><br><span class="line">    <span class="built_in">UIButton</span> *btnCancel=[<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeSystem</span>];</span><br><span class="line">    btnCancel.frame=<span class="built_in">CGRectMake</span>(<span class="number">170</span>, <span class="number">270</span>, <span class="number">80</span>, <span class="number">30</span>);</span><br><span class="line">    [btnCancel setTitle:<span class="string">@"取消"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:btnCancel];</span><br><span class="line">    [btnCancel addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(cancel) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 登录操作</span></span><br><span class="line">-(<span class="keyword">void</span>)login&#123;</span><br><span class="line">    <span class="keyword">if</span> ([_txtUserName.text isEqualToString:<span class="string">@"kenshincui"</span>] &amp;&amp; [_txtPassword.text isEqualToString:<span class="string">@"123"</span>] ) &#123;</span><br><span class="line">        <span class="comment">//发送通知</span></span><br><span class="line">        [<span class="keyword">self</span> postNotification];</span><br><span class="line">        [<span class="keyword">self</span> dismissViewControllerAnimated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//登录失败弹出提示信息</span></span><br><span class="line">        <span class="built_in">UIAlertView</span> *alertView=[[<span class="built_in">UIAlertView</span> alloc]initWithTitle:<span class="string">@"系统信息"</span> message:<span class="string">@"用户名或密码错误，请重新输入！"</span> delegate:<span class="literal">nil</span> cancelButtonTitle:<span class="string">@"取消"</span> otherButtonTitles:<span class="literal">nil</span>];</span><br><span class="line">        [alertView show];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 点击取消</span></span><br><span class="line">-(<span class="keyword">void</span>)cancel&#123;</span><br><span class="line">    [<span class="keyword">self</span> dismissViewControllerAnimated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  添加通知，注意这里设置了附加信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)postNotification&#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *userInfo=@&#123;<span class="string">@"loginInfo"</span>:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"Hello,%@!"</span>,_txtUserName.text]&#125;;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,userInfo);</span><br><span class="line">    <span class="built_in">NSNotification</span> *notification=[<span class="built_in">NSNotification</span> notificationWithName:UPDATE_LGOGIN_INFO_NOTIFICATION object:<span class="keyword">self</span> userInfo:userInfo];</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotification:notification];</span><br><span class="line"><span class="comment">//也可直接采用下面的方法</span></span><br><span class="line"><span class="comment">//    [[NSNotificationCenter defaultCenter] postNotificationName:UPDATE_LGOGIN_INFO_NOTIFICATION object:self userInfo:userInfo];</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">运行效果：</span><br><span class="line">NotificationCenter_CustomNotification</span><br><span class="line">注意：</span><br><span class="line">通过上面的介绍大家应该可以发现其实通知中心是一种低耦合设计，和前面文章中提到的代理模式有异曲同工之妙。相对于后者而言，通知中心可以将一个通知发送给多个监听者，而每个对象的代理却只能有一个。当然代理也有其优点，例如使用代理代码分布结构更加清晰，它不像通知一样随处都可以添加订阅等，实际使用过程中需要根据实际情况而定。</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[mac显示隐藏文件夹]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/system/mac%E6%98%BE%E7%A4%BA%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%A4%B9/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>打开终端，输入：defaults write com.apple.finder AppleShowAllFiles -bool true 此命令显示隐藏文件defaults write com.apple.finder AppleShowAllFiles -bool false 此命令关闭显示隐藏文件<br>命令运行之后需要重新加载Finder：快捷键option+command+esc，选中Finder，重新启动即可</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[删除Xcode插件]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/system/%E5%88%A0%E9%99%A4Xcode%E6%8F%92%E4%BB%B6/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<pre><code>直接进入插件所在的目录，将插件删除即可。
</code></pre><p>插件路径为：~/Library/Application Support/Developer/Shared/Xcode/Plug-ins    Library文件夹（即资源库）默认是隐藏的，所以你可以使用一下方法打开该路径：</p>
<p>Finder 前往-&gt;前往文件夹(快捷键cmd+Shift+G)，输入以上路径，回车，找到Fuzzy Aotocomplete插件，删除。</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[移动UI/UX设计师和PM使用的原型工具]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/system/%E7%A7%BB%E5%8A%A8UIUX%E8%AE%BE%E8%AE%A1%E5%B8%88%E5%92%8CPM%E4%BD%BF%E7%94%A8%E7%9A%84%E5%8E%9F%E5%9E%8B%E5%B7%A5%E5%85%B7/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>【编者按】本文转载自个人博客—<a href="http://www.zhangping.name/" target="_blank" rel="noopener">羽化博客</a>，原作者通过对页面原型设计的理解来介绍四款原型设计工具。<br>与一般针对产品功能的介绍不同，本文以亲身的设计需求为出发点，通过对产品整理和提供相关的链接，帮助解决从业人群对做产品页面原型的直接需求。可以为做产品设计的童鞋提供一些参考和下载帮助。<br>天天和产品打交道，不时要做一些页面原型、离不开各种工具，工欲善其事必先利其器，好的工具软件可以大大提高工作效率，工具各有优劣，大家按需取之。原型设计工具我暂时把它分为两类，Web应用原型设计工具及软件应用原型设计工具、微软的visio就不说了：<br>Web应用原型设计工具：先来看看这个几个：<a href="http://www.axure.com/" target="_blank" rel="noopener">Axure RP</a> 、<a href="http://www.balsamiq.com/" target="_blank" rel="noopener">Balsamiq Mockups</a> 、 <a href="http://pencil.evolus.vn/en-US/Home.aspx" target="_blank" rel="noopener">Pencil<br> Project</a> 以及<a href="http://www.omnigroup.com/" target="_blank" rel="noopener">OmniGraffle</a>试用感觉：</p>
<p>###<strong>第一个、Axure RP：</strong><br><a href="http://www.leiphone.com/wp-content/uploads/2012/06/Axure-RP.jpg" target="_blank" rel="noopener"><img src="http://7te8bu.com1.z0.glb.clouddn.com/uploads/2012/06/Axure-RP.jpg" alt title="Axure-RP"></a><br>来这里看看视频简介：<a href="http://www.axure.com/tour.aspx" target="_blank" rel="noopener">http://www.axure.com/tour.aspx</a></p>
<ul>
<li>Axure的发音是”Ack-sure”，RP则是”Rapid Prototyping”快速原型的缩写。Axure RP Pro是美国Axure Software Solution公司的精心杰作，可以说Axure是Windows上最出色的原型设计软件，亦是web产品前期设计的首选，原因是：够简单、上手快，能帮助网站需求设计者，快捷而简便的创建 基于目录组织的原型文档、功能说明、交互界面以及带注释的wireframe网页，并可自动生成用于演示的网页文件和word文档，以提供演示与开发；</li>
<li>Axure RP六合一功能：网站构架图、示意图、流程图、交互设计、自动输出网站原型、自动输出word格式规格文件；</li>
<li>国内都有很多教程了，看看这些：<a href="http://cn.userxper.com/axure_tutorial" target="_blank" rel="noopener">悠识网站的教程</a></li>
<li>Windows版：<a href="http://axure.cachefly.net/AxureRP-Pro-Setup.exe" target="_blank" rel="noopener">http://axure.cachefly.net/AxureRP-Pro-Setup.exe</a><br>MAC版：<a href="http://axure.cachefly.net/AxureRP-Pro-Setup.dmg" target="_blank" rel="noopener">http://axure.cachefly.net/AxureRP-Pro-Setup.dmg</a><br>Axure6.5汉化语言包下载地址：<a href="http://www.axure.us/283/" target="_blank" rel="noopener">http://www.axure.us/283/</a></li>
</ul>
<p>###<strong>第二个、Balsamiq Mockups：</strong><br><strong> <a href="http://www.leiphone.com/wp-content/uploads/2012/06/Balsamiq-Mockups.jpg" target="_blank" rel="noopener"><img src="http://7te8bu.com1.z0.glb.clouddn.com/uploads/2012/06/Balsamiq-Mockups.jpg" alt title="Balsamiq-Mockups"></a></strong><br><strong> </strong><a href="http://www.balsamiq.com/products/mockups" target="_blank" rel="noopener">Balsamiq Mockups 视频简介</a></p>
<ul>
<li>Balsamiq Mokups是用Flex和Air实现的，在Mac OS, Linux和Windows下都能使用，有桌面版本、Confluence，JIRA，和XWiki中的版本；</li>
<li>涂鸦风格、使用起来也很简单、各模块工具也很齐全，详细说明可见官方博客：<a href="http://www.balsamiq.com/blogs" target="_blank" rel="noopener">http://www.balsamiq.com/blogs</a></li>
</ul>
<p><a href="http://www.leiphone.com/wp-content/uploads/2012/06/iphonedemo.jpg" target="_blank" rel="noopener"><img src="http://7te8bu.com1.z0.glb.clouddn.com/uploads/2012/06/iphonedemo.jpg" alt title="iphonedemo"></a><br><a href="http://www.leiphone.com/wp-content/uploads/2012/06/iphoneexamples.png" target="_blank" rel="noopener"><img src="http://7te8bu.com1.z0.glb.clouddn.com/uploads/2012/06/iphoneexamples.png" alt title="iphoneexamples"></a></p>
<ul>
<li>有人提到不能输入中文的问题，很简单：在Mockups的菜单里选择 View -&gt; Use System Font 就可以了；</li>
<li>该软件的桌面版售价78美刀。作者意大利人Peldi说这款软件的设计就是用它自己来设计的，满足自己的需求。而在经济寒冷的2008年，从1,322位付费用户那获得了162,302美元的收入（其中12月份就有39,000美元）;</li>
<li>windows版本下载地址 <a href="http://www.balsamiq.com/download" target="_blank" rel="noopener">http://www.balsamiq.com/download</a></li>
</ul>
<p>###<strong><br>第三个、Pencil Project：</strong><br><a href="http://www.leiphone.com/wp-content/uploads/2012/06/pencil-project.jpg" target="_blank" rel="noopener"><img src="http://7te8bu.com1.z0.glb.clouddn.com/uploads/2012/06/pencil-project.jpg" alt title="pencil-project"></a>- 查看官网简介：<a href="http://www.evolus.vn/Pencil/Screenshots.html" target="_blank" rel="noopener">http://www.evolus.vn/Pencil/Screenshots.html</a></p>
<ul>
<li>一个firefox插件，比较小的工具，画简单的界面基本上可以满足了；</li>
<li>安装地址：<a href="https://addons.mozilla.org/en-US/firefox/addon/8487" target="_blank" rel="noopener">https://addons.mozilla.org/en-US/firefox/addon/8487</a></li>
</ul>
<p>###<strong>第四个、OmniGraffle</strong><br><a href="http://www.leiphone.com/wp-content/uploads/2012/06/OmniGraffle.png" target="_blank" rel="noopener"><img src="http://7te8bu.com1.z0.glb.clouddn.com/uploads/2012/06/OmniGraffle.png" alt title="OmniGraffle"></a></p>
<ul>
<li>很不幸的是，这个软件只有Mac版；</li>
<li><a href="http://www.omnigroup.com/" target="_blank" rel="noopener">Omni Group</a>这家只有<a href="http://www.omnigroup.com/company/people/" target="_blank" rel="noopener">26个人</a>的小公司，他们人数虽少，但却产出了像<a href="http://www.omnigroup.com/applications/omniweb/" target="_blank" rel="noopener">OmniWeb</a>、<a href="http://www.omnigroup.com/applications/omnigraffle/" target="_blank" rel="noopener">OmniGraffle</a>、<a href="http://www.omnigroup.com/applications/omniplan/" target="_blank" rel="noopener">OmniPlan</a>和<a href="http://www.omnigroup.com/applications/omnioutliner/" target="_blank" rel="noopener">OmniOutliner</a>等等一系列深受用户欢迎的精品软件，实力绝对不容小觑；</li>
<li>漂亮的界面、能轻而易举的绘制出漂亮的图形、丰富、精致的模板（Stencil/Template）、辅助对齐和尺寸调整功能；</li>
<li>下载地址 <a href="http://www.omnigroup.com/applications/omnigraffle/" target="_blank" rel="noopener">http://www.omnigroup.com/applications/omnigraffle/</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[欢迎使用CSDN-markdown编辑器]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/system/%E6%AC%A2%E8%BF%8E%E4%BD%BF%E7%94%A8CSDN-markdown%E7%BC%96%E8%BE%91%E5%99%A8/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>安装soucetree后，启动<br>1添加账户.<br><img src="http://img.blog.csdn.net/20151214154736709" alt="这里写图片描述"><br>设置托管主机，用户名，密码，协议方式<br><img src="http://img.blog.csdn.net/20151214154943293" alt="这里写图片描述"><br>2.克隆到本地<br>点击远程，这时就可以看见远程仓库中内容<br><img src="http://img.blog.csdn.net/20151214155310766" alt="这里写图片描述"><br>点击克隆，选择要克隆的目标路径，与克隆名称，点击克隆<br><img src="http://img.blog.csdn.net/20151214155442212" alt="这里写图片描述"><br>3.在本地管理项目<br>点击已经克隆到本地的项目<br><img src="http://img.blog.csdn.net/20151214155652034" alt="这里写图片描述"><br>此时是在主分支master分支下<br>双击一条远程分支<br><img src="http://img.blog.csdn.net/20151214155957907" alt="这里写图片描述"><br>将其他的远程分支克隆到本地</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[APP间的调用]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/APP%E9%97%B4%E7%9A%84%E8%B0%83%E7%94%A8/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">被调用的App：</span><br><span class="line"><span class="number">1.</span>在appdelegate里实现方法</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)app openURL:(<span class="built_in">NSURL</span> *)url options:(<span class="built_in">NSDictionary</span>&lt;<span class="built_in">NSString</span> *,<span class="keyword">id</span>&gt; *)options</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,app);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,url);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,options);</span><br><span class="line">    <span class="keyword">return</span>  <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>配置Info.plist文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">调用方法：</span><br><span class="line"></span><br><span class="line">    <span class="comment">//打开另一个APP的方法</span></span><br><span class="line">    <span class="comment">//a另一个APP的openurl</span></span><br><span class="line">    <span class="comment">//aaaaaaaaa参数</span></span><br><span class="line">    [[<span class="built_in">UIApplication</span> sharedApplication] openURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"a:aaaaaaa"</span>]];</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[AVAudioPlayer]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/AVAudioPlayer/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化三个按钮</span></span><br><span class="line">   </span><br><span class="line">    <span class="comment">//play</span></span><br><span class="line">    <span class="built_in">UIButton</span> * button = [<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeCustom</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:button];</span><br><span class="line">    button.backgroundColor = [<span class="built_in">UIColor</span> yellowColor];</span><br><span class="line">    [button setFrame:<span class="built_in">CGRectMake</span>(<span class="number">100</span>, <span class="number">100</span> + <span class="number">64</span>, <span class="number">60</span>, <span class="number">40</span>)];</span><br><span class="line">    [button setTitle:<span class="string">@"play"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [button setTitleColor:[<span class="built_in">UIColor</span> blackColor] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [button addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(play) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">//pause暂停</span></span><br><span class="line">    <span class="built_in">UIButton</span> * button1 = [<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeCustom</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:button1];</span><br><span class="line">    button1.backgroundColor = [<span class="built_in">UIColor</span> yellowColor];</span><br><span class="line">    [button1 setFrame:<span class="built_in">CGRectMake</span>(<span class="number">100</span>, <span class="number">150</span> + <span class="number">64</span>, <span class="number">60</span>, <span class="number">40</span>)];</span><br><span class="line">    [button1 setTitle:<span class="string">@"pause"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [button1 setTitleColor:[<span class="built_in">UIColor</span> blackColor] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [button1 addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(pause) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">//stop</span></span><br><span class="line">    <span class="built_in">UIButton</span> * button2 = [<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeCustom</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:button1];</span><br><span class="line">    button2.backgroundColor = [<span class="built_in">UIColor</span> yellowColor];</span><br><span class="line">    [button2 setFrame:<span class="built_in">CGRectMake</span>(<span class="number">100</span>, <span class="number">200</span> + <span class="number">64</span>, <span class="number">60</span>, <span class="number">40</span>)];</span><br><span class="line">    [button2 setTitle:<span class="string">@"stop"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [button2 setTitleColor:[<span class="built_in">UIColor</span> blackColor] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [button2 addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(stop) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:button2];</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 从bundle路径下读取音频文件</span></span><br><span class="line">    <span class="built_in">NSString</span> * string = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"凭什么说-刘心"</span> ofType:<span class="string">@"mp3"</span>];</span><br><span class="line">    <span class="comment">// 把音频文件转换成url格式</span></span><br><span class="line">    <span class="built_in">NSURL</span> * url = [<span class="built_in">NSURL</span> fileURLWithPath:string];</span><br><span class="line">    <span class="comment">// 初始化音频类 并且添加播放文件</span></span><br><span class="line">    <span class="keyword">self</span>.avAudioPlayer = [[<span class="built_in">AVAudioPlayer</span> alloc] initWithContentsOfURL:url error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="comment">// 设置代理</span></span><br><span class="line">    [<span class="keyword">self</span>.avAudioPlayer setDelegate:<span class="keyword">self</span>];</span><br><span class="line">    <span class="comment">// 设置初始音量大小</span></span><br><span class="line">    [<span class="keyword">self</span>.avAudioPlayer setVolume:<span class="number">1</span>];</span><br><span class="line">    <span class="comment">// 设置音乐播放次数 -1为一直循环</span></span><br><span class="line">    [<span class="keyword">self</span>.avAudioPlayer setNumberOfLoops:<span class="number">-1</span>];</span><br><span class="line">    <span class="comment">// 预播放</span></span><br><span class="line">    [<span class="keyword">self</span>.avAudioPlayer prepareToPlay];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 初始化一个播放进度条</span></span><br><span class="line">    <span class="keyword">self</span>.progressV = [[<span class="built_in">UIProgressView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">80</span>, <span class="number">100</span>, <span class="number">200</span>, <span class="number">20</span>)];</span><br><span class="line">    [<span class="keyword">self</span>.progressV setProgressTintColor:[<span class="built_in">UIColor</span> redColor]];</span><br><span class="line">    [<span class="keyword">self</span>.progressV setTrackTintColor:[<span class="built_in">UIColor</span> blueColor]];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:<span class="keyword">self</span>.progressV];</span><br><span class="line">    [<span class="keyword">self</span>.progressV release];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 用NSTimer来监控音频播放进度</span></span><br><span class="line">    <span class="keyword">self</span>.timer = [<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">0.1</span> target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(playProgress) userInfo:<span class="literal">nil</span> repeats:<span class="literal">YES</span>];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 初始化音量控制</span></span><br><span class="line">    <span class="keyword">self</span>.volumeSlider = [[<span class="built_in">UISlider</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">80</span>, <span class="number">130</span>, <span class="number">200</span>, <span class="number">20</span>)];</span><br><span class="line">    [<span class="keyword">self</span>.volumeSlider addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(volumeChange) forControlEvents:<span class="built_in">UIControlEventValueChanged</span>];</span><br><span class="line">    <span class="comment">// 设置最小音量</span></span><br><span class="line">    [<span class="keyword">self</span>.volumeSlider setMinimumValue:<span class="number">0.0</span>f];</span><br><span class="line">    <span class="comment">// 设置最大音量</span></span><br><span class="line">    [<span class="keyword">self</span>.volumeSlider setMaximumValue:<span class="number">10.0</span>f];</span><br><span class="line">    <span class="comment">// 初始化音量为多少</span></span><br><span class="line">    [<span class="keyword">self</span>.volumeSlider setValue:<span class="number">5.0</span>f];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:<span class="keyword">self</span>.volumeSlider];</span><br><span class="line">    [<span class="keyword">self</span>.volumeSlider release];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">//声音开关控件(静音)</span></span><br><span class="line">    <span class="built_in">UISwitch</span> *swith = [[<span class="built_in">UISwitch</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">100</span>, <span class="number">500</span>, <span class="number">60</span>, <span class="number">40</span>)];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:swith];</span><br><span class="line">    [swith addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(onOrOff:) forControlEvents:<span class="built_in">UIControlEventValueChanged</span>];</span><br><span class="line">    <span class="comment">//默认状态为打开</span></span><br><span class="line">    swith.on = <span class="literal">YES</span>;</span><br><span class="line">    [swith release];</span><br><span class="line"></span><br><span class="line"><span class="comment">/********************AVAudioPlayer***************/</span></span><br><span class="line"><span class="comment">//播放</span></span><br><span class="line">- (<span class="keyword">void</span>)play</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span>.avAudioPlayer play];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//暂停</span></span><br><span class="line">- (<span class="keyword">void</span>)pause</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span>.avAudioPlayer pause];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//停止</span></span><br><span class="line">- (<span class="keyword">void</span>)stop</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span>.avAudioPlayer.currentTime = <span class="number">0</span>;  <span class="comment">//当前播放时间设置为0</span></span><br><span class="line">    [<span class="keyword">self</span>.avAudioPlayer stop];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//播放进度条</span></span><br><span class="line">- (<span class="keyword">void</span>)playProgress</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//通过音频播放时长的百分比,给progressview进行赋值;</span></span><br><span class="line">    <span class="keyword">self</span>.progressV.progress = <span class="keyword">self</span>.avAudioPlayer.currentTime/<span class="keyword">self</span>.avAudioPlayer.duration;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//声音开关(是否静音)</span></span><br><span class="line">- (<span class="keyword">void</span>)onOrOff:(<span class="built_in">UISwitch</span> *)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span>.avAudioPlayer.volume = sender.on;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//播放音量控制</span></span><br><span class="line">- (<span class="keyword">void</span>)volumeChange</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span>.avAudioPlayer.volume = <span class="keyword">self</span>.volumeSlider.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//播放完成时调用的方法  (代理里的方法),需要设置代理才可以调用</span></span><br><span class="line">- (<span class="keyword">void</span>)audioPlayerDidFinishPlaying:(<span class="built_in">AVAudioPlayer</span> *)player successfully:(<span class="built_in">BOOL</span>)flag</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span>.timer invalidate]; <span class="comment">//NSTimer暂停  invalidate  使...无效;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************AVAudioPlayer***************/</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[BOOL / bool / Boolean / NSCFBoolean]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/BOOL%20%20bool%20%20Boolean%20%20NSCFBoolean/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NameTypedefHeaderTrue ValueFalse ValueBOOLsigned charobjc.hYESNObool_Bool (<span class="keyword">int</span>)stdbool.htruefalseBooleanunsigned charMacTypes.hTRUEFALSENSNumber__NSCFBooleanFoundation.h@(<span class="literal">YES</span>)@(<span class="literal">NO</span>)<span class="built_in">CFBooleanRefstructCoreFoundation</span>.hkCFBooleanTruekCFBooleanFalse</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Core Animation 3D介绍(第1部分)]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/Core%20Animation%203D%E4%BB%8B%E7%BB%8D(%E7%AC%AC1%E9%83%A8%E5%88%86)/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>尊重原创 转自：<a href="http://codingobjc.com/blog/2013/06/11/core-animation-3djie-shao-di-1bu-fen/" target="_blank" rel="noopener">http://codingobjc.com/blog/2013/06/11/core-animation-3djie-shao-di-1bu-fen/</a></p>
<p>在本教程中，我将向你介绍Core Animation中用于绘制3D图形的一些技术。<br>我要告诉你的好消息是：我们不必直接使用OpenGL，仅仅用Core Animation就可以很容易的实现一些3D效果。但是，也别太高兴了，因为”用Core Animation来制作一个复杂的3D游戏”也并不是一个好主意。<br>这个教程分两部分。第一部分，我们先讨论下一些3D原理知识，然后运用这些概念来创建一些简单的3D场景。然后在第二部分中，我们将使用Core Animation来制作一个类似于旋转木马的3D场景特效。<br>最终app的预览效果如下：(译注: 原文中这里的视频被墙，因此这里只简单的提供一个图片预览，你可以直接下载例子代码运行即可以看到最终app的效果)<br><img src="http://codingobjc.com/images/posts/2013_06_11_core_animation_3d_app_preview.png" alt><br>好，准备好了吗？我们开始写代码吧！<br>首先，下载文章后面的代码。如果你要自己创建项目的话，要记得添加QuartzCore框架。</p>
<p>###3D和矩阵相关的数学知识(一点点…别担心，只有一点点)<br>要在一个3D空间中绘图，除了标准2D坐标(X和Y)概念外，我们还需要引入一个深度(depth)的概念，也就是要加入第三个坐标轴–Z轴。<br>这样，在空间中，我们只需要简单的改变物体的X、Y和Z坐标，就可以在垂直方向、水平方向或深度方向上移动物体。<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/handed.png" alt><br>在2D或3D空间中，对一个物体执行平移、缩放或旋转这些操作时需要使用矩阵运算。<br>你可以将矩阵想象成一个多维数组。比如，在3D空间中我们使用一个像下面这种格式的4X4矩阵：</p>
<pre><code>[X][0][0][0][0][Y][0][0][0][0][Z][0][0][0][0][1]
</code></pre><p>把这个矩阵和物体的每一个坐标点(又称顶点)相乘，我们可以得到物体的一个变换(transformation)效果。<br>严格点讲，前面这个矩阵是用来执行缩放操作的。其中的X、Y、Z值代表每个轴上的缩放值。<br>如果你要进行其他的变换操作，比如旋转或者平移，你需要将矩阵换成其他矩阵格式(scheme)。<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/Screen-Shot-2013-03-20-at-11.02.03-AM.png" alt><br>不要紧张！你不需要知道其他更多原理知识，而且也不必直接进行这些操作。Core Animation会为你完成这些操作，虽然你不知道它是如何做到的，但是它确实会为你完成这些操作，所以不必害怕。<br>当然，就我个人来说，如果我知道它背后是如何工作的(至少知道一些它的基本原理)，我会对我的代码更有自信。因此，如果你想了解更多矩阵相关的知识，建议你读一读这篇<a href="http://www.matrix44.net/cms/notes/opengl-3d-graphics/basic-3d-math-matrices" target="_blank" rel="noopener">文章</a>。</p>
<p>###3D变换(Transformations)<br>现在基本上，你已经知道矩阵的作用了，也知道了3D空间是如何构成的。来，我们用Core Animation做一些3D的东西吧。<br>打开TB_3DIntro-&gt;viewController.m文件。<br>我在里面列出了6个分别以A、B、C、D、E、F开头的函数。每一个函数对应了一种不同的3D场景效果。<br>我们先来看看由<code>A_singlePlan</code>函数创造的场景吧。<br>用这个函数，我们画了一个平面，平面绕Y轴旋转了45度。<br>首先，我们创建了一个CALayer，用它来作容器层(当然，并不是一定要这样做，只是我更喜欢不直接在self.view的layer上进行工作)。</p>
<pre><code>-(void)A_singlePlane{//Create the containerCALayer*container=[CALayerlayer];container.frame=CGRectMake(0,0,640,300);[self.view.layeraddSublayer:container];
</code></pre><p>然后我们创建了另一个CALayer，用它代表一个平面。</p>
<pre><code>//Create a PlaneCALayer*purplePlane=[selfaddPlaneToLayer:containersize:CGSizeMake(100,100)position:CGPointMake(250,150)color:[UIColorpurpleColor]];
</code></pre><p>我写了一个简单的辅助函数，用它将平面直接添加到容器层上，然后返回这个新建的平面层。代码非常简单：</p>
<pre><code>-(CALayer*)addPlaneToLayer:(CALayer*)containersize:(CGSize)sizeposition:(CGPoint)pointcolor:(UIColor*)color{//Initialize the layerCALayer*plane=[CALayerlayer];//Define position,size and colorsplane.backgroundColor=[colorCGColor];plane.opacity=0.6;plane.frame=CGRectMake(0,0,size.width,size.height);plane.position=point;plane.anchorPoint=CGPointMake(0.5,0.5);plane.borderColor=[[UIColorcolorWithWhite:1.0alpha:0.5]CGColor];plane.borderWidth=3;plane.cornerRadius=10;//Add the layer to the container layer[containeraddSublayer:plane];returnplane;}
</code></pre><p>最后，我们用CATransform3D来添加变换。<br>啊？？？你一定又想问CATransform3D是什么东西？按住Cmd键点击这个类型名称，你可以发现它是一个结构体，使用了一种很”火星”的语法来表示一个矩阵。<img src="http://www.thinkandbuild.it/wp-includes/images/smilies/icon_razz.gif" alt></p>
<pre><code>structCATransform3D{CGFloatm11,m12,m13,m14;CGFloatm21,m22,m23,m24;CGFloatm31,m32,m33,m34;CGFloatm41,m42,m43,m44;};typedefstructCATransform3DCATransform3D;
</code></pre><p>旋转变换部分的代码也相当简单：</p>
<pre><code>//Apply transform to the PLANECATransform3Dt=CATransform3DIdentity;t=CATransform3DRotate(t,45.00f*M_PI/180.0f,0,1,0);purplePlane.transform=t;}
</code></pre><p>先用单位矩阵<code>CATransform3DIdentity</code>来初始化一个变换(transformation)，然后用<code>CATransform3DRotate</code>函数给变换乘上一个旋转矩阵。<br>CATransform3DRotate这个函数的参数分别表示矩阵，旋转的角度(以弧度为单位)和3个坐标轴上的变换系数。这个例子中，X和Z轴都没受到影响，只对Y轴有影响，物体会在Y轴上旋转45度。<br>下图是运行结果。<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/pa1.png" alt><br>呃……你可以看到，它还不是3D的！我们只是在X轴方向上将一个正方形压扁了。<br>这是由于我们还没有设置视点的值(perspective value)。通常，在绘制3D场景的时候会将场景进行正射投影(Orthographic projection)处理，由此会产生一个扁平的场景。换句话说，在正射投影后你无法看到Z轴上的深度感。<br>要给我们的场景加上空间深度感，我们必须修改变换矩阵的<code>m34</code>参数。这个参数决定了视点的值。<br>现在，来看看<code>B_singlePlanePerspective</code>这个函数，这函数展示了视点的作用。<br>这个函数和前一个函数只有变换部分的代码有所不同：</p>
<pre><code>//Apply transform to the PLANECATransform3Dt=CATransform3DIdentity;//Add perspective!!!t.m34=1.0/-500;t=CATransform3DRotate(t,degToRad(45.0),0,1,0);purplePlane.transform=t;}
</code></pre><p>你可以看到，我们直接给矩阵的m34属性赋了一个值。在这里，我不会深入的从数学上解释这个值是如何起作用的。但是我可以告诉你的是，这个值越接近0，视点就越深。<br>下面是两种不同视点值的效果：<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/pa_2.png" alt><br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/pa_21.png" alt></p>
<p>###3D变换的顺序问题(Transformations chain)<br>我们可以将多个矩阵相乘从而将多种变换应用到一个物体上。比如，如果我们想将平移和旋转变换应用到一个物体上，我们可以直接将两个变换矩阵相乘：</p>
<pre><code>TransformMatrix=TranslateMtx*RotateMtx
</code></pre><p>数学上，一般情况下乘法都可以使用交换律：</p>
<pre><code>TranslateMtx*RotateMxt=RotateMtx*TranslateMtx
</code></pre><p>但是矩阵乘法不适用于交换律。AxB的结果可能和BxA的结果不一样。要记住这一点！<br>接下来<code>C_transformationsChain</code>这个例子中，我们会将2个变换效果按不同的先后顺序应用到2个不同的物体上。<br>以下是主要代码：</p>
<pre><code>//Apply transformation to the PLANESCATransform3Dt=CATransform3DIdentity;//Purple plane: Perform a rotation and then a translationt=CATransform3DRotate(t,45.0f*M_PI/180.0f,0,0,1);t=CATransform3DTranslate(t,100,0,0);purplePlane.transform=t;//reset the transform matrixt=CATransform3DIdentity;//Red plane: Perform translation first and then the rotationt=CATransform3DTranslate(t,100,0,0);t=CATransform3DRotate(t,45.0f*M_PI/180.0f,0,0,1);redPlane.transform=t;
</code></pre><p>运行结果如下：<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/Screen-Shot-2013-03-20-at-11.47.15-AM.png" alt><br>看到了吗，不同的变换顺序完全导致了不同的效果。<br>我们重点下看一下紫色的那块。旋转变换改变了它的坐标轴方向，然后我们又将它沿X轴进行了平移，此时它的X轴方向已经和红色平面的X轴方向不一致了。<br>变换步骤示意图如下：<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/p_r.png" alt><br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/p_r2.png" alt></p>
<p>###图层层次(layer hierarchies)<br>到目前为止，我们都是将变换直接应用在这些平面上。在3D场景中，经常需要创建一些相互之间有层次结构的物体。这个时候，只需要将变换应用到根层次上，就可以使整个层次结构中的物体整体具有这个变换效果。这种做法非常有用。<br>接下来，我们来看看<code>D_multiplePlanes</code>这个例子。<br>我们在容器层上添加了4个平面。<br>当没有任何变换效果时看起来是这样的：<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/p5.png" alt><br>如果我们给每一个平面都加上一个Y轴上的旋转变换，我们会得到4个独立的旋转效果：<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/p5_2.png" alt><br>但是，如果我们只是在容器层上应用旋转变换，我们会得到一个完全不同的场景效果：<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/p5_1.png" alt><br>这种效果，是相机(camera)位置发生改变带来的结果。我们没有移动每个平面，只是改变了视点的位置。<br>此函数主要的变换部分代码如下，包含了分别应用于各个平面和应用于容器层的两种变换效果的代码：</p>
<pre><code>//Transformation CATransform3Dt=CATransform3DIdentity;BOOLapplyToContainer=NO;//Apply the transformation to each PLANEif(!applyToContainer){t.m34=1.0/-500.0;t=CATransform3DRotate(t,degToRad(60.0),0,1,0);purplePlane.transform=t;t=CATransform3DIdentity;t.m34=1.0/-500.0;t=CATransform3DRotate(t,degToRad(60.0),0,1,0);redPlane.transform=t;t=CATransform3DIdentity;t.m34=1.0/-500.0;t=CATransform3DRotate(t,degToRad(60.0),0,1,0);orangePlane.transform=t;t=CATransform3DIdentity;t.m34=1.0/-500.0;t=CATransform3DRotate(t,degToRad(60.0),0,1,0);yellowPlane.transform=t;}//Apply the transformation to the CONTAINERelse{CATransform3Dt=CATransform3DIdentity;t.m34=1.0/-500;t=CATransform3DRotate(t,degToRad(60.0),0,1,0);container.transform=t;}
</code></pre><p>###CATransformLayer<br>到目前为止我们所见到的代码都能正常工作，但说实话，作为3D层次结构的根，CALayer不是正确的选择。<br>函数<code>E_multiplePlanesZAxis</code>展示了为什么。<br>这个例子中，我们创建4个XY坐标相同只有Z坐标不同的平面。紫色平面最近，黄色平面最远。</p>
<pre><code>//Apply transforms to the PLANESt=CATransform3DIdentity;t=CATransform3DTranslate(t,0,0,-10);purplePlane.transform=t;t=CATransform3DIdentity;t=CATransform3DTranslate(t,0,0,-50);redPlane.transform=t;t=CATransform3DIdentity;t=CATransform3DTranslate(t,0,0,-90);orangePlane.transform=t;t=CATransform3DIdentity;t=CATransform3DTranslate(t,0,0,-130);yellowPlane.transform=t;
</code></pre><p>在旋转这些平面前，我们先让容器层执行了一个旋转变换。</p>
<pre><code>//Apply transform to the CONTAINERCATransform3Dt=CATransform3DIdentity;t.m34=1.0/-500;t=CATransform3DRotate(t,80.0f*M_PI/180.0f,0,1,0);container.transform=t;
</code></pre><p>你也许希望看到下面这种结果：<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/p6_1.png" alt><br>但是，实际上会得到这种结果：<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/03/p6.png" alt><br>这是因为CALayer不能处理3D层次结构的深度，它只能将场景处理成相同的Z层次。<br>为了修正这个问题，我们需要用一个<code>CATransformLayers</code>来做根层对象。<br>函数<code>F_multiplePlanesZAxis</code>修正了这个问题：</p>
<pre><code>//Create the container as a CATransformLayerCATransformLayer*container=[CATransformLayerlayer];container.frame=CGRectMake(0,0,640,300);[self.view.layeraddSublayer:container];
</code></pre><p>CATransformLayer是一个特殊的layer。与CALayer的不同之处在于，CATransformLayer本身不会被渲染到屏幕上，只有它的子图层才会被渲染到屏幕上。所以它的一些属性，比如backgroundColor、contents、border等等都没有什么用。要记住这点。<br>到这里，这个教程的第一部分就完了。建议你实际运行一下这些函数，也可以试试我没有讲到的<code>CATransform3DScale</code>，试试用它做一个缩放变换看。<br>如果你有任何问题，可以在twitter上找到我(<a href="http://www.twitter.com/bitwaker" target="_blank" rel="noopener">@bitwaker</a>)。<br><a href="https://github.com/ariok/TB_3DCoreAnimation" target="_blank" rel="noopener">本教程代码下载</a><br>译自：<a href="http://www.thinkandbuild.it/introduction-to-3d-drawing-in-core-animation-part-1/" target="_blank" rel="noopener">Think<br> &amp; Build</a></p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Core Animation 3D介绍(第2部分)]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/Core%20Animation%203D%E4%BB%8B%E7%BB%8D(%E7%AC%AC2%E9%83%A8%E5%88%86)/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>尊重原创 转自：<a href="http://codingobjc.com/blog/2013/06/24/core-animation-3djie-shao-di-2bu-fen/" target="_blank" rel="noopener">http://codingobjc.com/blog/2013/06/24/core-animation-3djie-shao-di-2bu-fen/</a></p>
<p>在<a href="http://rockonmycode.com/blog/2013/06/11/core-animation-3djie-shao-di-1bu-fen/" target="_blank" rel="noopener">上一篇</a>教程中，我们已经学习了Core<br> Animation中3D绘图的基本方法。这篇教程，我们准备深入一些，讲讲如何创建一个可交互的3D场景。我们将会创建一个类似于旋转木马的3D场景界面，用户可以通过拖拽手势来旋转界面。<br>可能你已经在上一篇教程中见过最终APP的样子了，但是，让我们再来看一次吧：<br><img src="http://codingobjc.com/images/posts/2013_06_11_core_animation_3d_app_preview.png" alt><br>你可以直接下载教程的<a href="https://github.com/ariok/TB_3DCoreAnimation" target="_blank" rel="noopener">源代码</a>。本篇教程的源代码和上一篇教程中的源代码在同一个代码仓库里面，但是我做了一些修改，为这篇教程建立了一个新的target。</p>
<p>###概述<br>这个程序，我们把工作分成了以下几个部分。</p>
<p>####3D<br>因为我们需要3D效果，所以我们需要使用一个透视视图来进行绘制工作。为了构造旋转木马效果，我们将会建立一个3D层次体系。正如前一篇教程中介绍过的，用CATransformLayer来做层次体系中的根是不错的选择。</p>
<p>####平面<br>旋转木马效果由一系列平面构成。我们将使用CAGradientLayer来表示这些平面。CAGradientLayer是CALayer的一个子类，用它可以制作渐变背景色，会比纯色背景要好看一些。<br>我们会对这些平面进行一些平移和旋转操作，使它们沿着旋转木马的圆周排列。</p>
<p>####手势<br>获取用户的手势非常简单。我们只需要使用一个手势识别器(Gesture Recognizer)就可以了。然后，我们追踪用户的动作，将手势数据转换成角度值，用这个角度值来旋转界面。<br>好了，现在你应该已经知道这个项目有哪些东西要完成了吧？启动XCode吧！</p>
<p>###写代码吧<br>展开项目中的TB_3DPlanes文件夹，然后打开ViewController.m文件。<br>我们从viewDidLoad这个函数开始：<br>    1<br>    2<br>    3<br>    4<br>    5<br>    6<br>    7<br>    8<br>    9<br>    10<br>    11<br>    12<br>    13<br>    14<br>    15<br>    16<br>    17<br>    18<br>    19<br>    20<br>    21<br>    22<br>    23<br>    24<br>    25<br>    26</p>
<pre><code>-(void)viewDidLoad{[superviewDidLoad];//Initialize the TransformLayertransformLayer=[CATransformLayerlayer];transformLayer.frame=self.view.bounds;[self.view.layeraddSublayer:transformLayer];angle=0;XPanOffset=0;//Create 5 planes[selfaddPlane];[selfaddPlane];[selfaddPlane];[selfaddPlane];[selfaddPlane];//Force the first animation to set the planes in place[selfanimate];//Initialize the Pan gesture recognizerUIPanGestureRecognizer*panGesture=[[UIPanGestureRecognizeralloc]initWithTarget:selfaction:@selector(pan:)];[self.viewaddGestureRecognizer:panGesture];}
</code></pre><p>或许这个函数中有许多东西你还不完全明白是什么意思。但是，确实从这里开始就是核心部分的代码了。你可以暂时不用在这里纠结，继续阅读，后面会解释这些代码的意思的。<img src="http://www.thinkandbuild.it/wp-includes/images/smilies/icon_smile.gif" alt><br>很显然，我们先用CATransformLayer创建了一个根图层对象(transformLayer)，然后我们用addPlane函数向场景中添加了5个平面，并且我们将用pan:函数来处理拖拽手势。</p>
<p>###绘制平面<br>addPlane函数的代码也是相当直观的。它只是用CAGradientLayer和一些参数创建了一个图层罢了。然后将图层添加到了transformLayer上.<br>    1<br>    2<br>    3<br>    4<br>    5<br>    6<br>    7<br>    8<br>    9<br>    10<br>    11<br>    12<br>    13<br>    14<br>    15<br>    16<br>    17<br>    18<br>    19<br>    20<br>    21<br>    22<br>    23<br>    24<br>    25<br>    26<br>    27<br>    28<br>    29<br>    30<br>    31<br>    32<br>    33<br>    34<br>    35<br>    36<br>    37<br>    38</p>
<pre><code>/** A simple function to create a CAGradientLayer **/-(void)addPlane{CGSizeplaneSize=CGSizeMake(250,150);//Initialize the layerCAGradientLayer*layer=[CAGradientLayerlayer];//Set the frame and the anchorPointlayer.frame=CGRectMake(480/2-planeSize.width/2,320/2-planeSize.height/2-20,planeSize.width,planeSize.height);layer.anchorPoint=CGPointMake(0.5,0.5);//Set borders and cornerRadiuslayer.borderColor=[[UIColorcolorWithWhite:1.0alpha:0.3]CGColor];layer.cornerRadius=10;layer.borderWidth=4;//Set the gradient color for the plane backgroundlayer.colors=[NSArrayarrayWithObjects:(id)[UIColorpurpleColor].CGColor,(id)[UIColorredColor].CGColor,nil];layer.locations=[NSArrayarrayWithObjects:[NSNumbernumberWithFloat:0.0f],[NSNumbernumberWithFloat:1.0f],nil];//Set the shadowlayer.shadowColor=[[UIColorblackColor]CGColor];layer.shadowOpacity=1;layer.shadowRadius=20;//The double side has to be setted if we want to see the plane when its face is turned backlayer.doubleSided=YES;//Add the plane to the transformLayer[transformLayeraddSublayer:layer];}
</code></pre><p>这里唯一需要解释一下的是doubleSide属性。将它设置成YES，表示我们希望图层的背面也被绘制出来。当一个平面在Y轴上旋转接近180度的时候，我们仍然可以在场景中看到它，只是它旋转到了相反的方向。<br>为了更形象地说明这个问题，可以看看下图doubleSide为NO和YES时的对比。<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/04/double_side.png" alt><br>看了图，一下就明白了吧？设置成NO的时候，被旋转到背对着我们的那些平面都不会被绘制出来。<br>也许你已经注意到了，在viewDidLoad函数中我们添加了5个平面，但是这些平面并不是按位置排列在场景中的。在addPlane函数中，它们被添加到了同一个位置(参见frame属性)。</p>
<p>###更新平面位置<br>在viewDidLoad函数里，平面被创建后，我们调用了animate方法。这个函数的主要作用是更新各个平面的位置。这里是我们第一次调用这个函数，这个时候并没有发生任何触摸事件，这里调用它只是为了让各个平面沿着旋转木马的圆周排列好。<br>我们来看看这个函数的代码：<br>    1<br>    2<br>    3<br>    4<br>    5<br>    6<br>    7<br>    8<br>    9<br>    10<br>    11<br>    12<br>    13<br>    14<br>    15<br>    16<br>    17<br>    18<br>    19<br>    20<br>    21<br>    22<br>    23<br>    24<br>    25<br>    26<br>    27<br>    28<br>    29<br>    30<br>    31<br>    32</p>
<pre><code>/** This function performs the transformation on each plane **/-(void)animate{//Define the degrees needed for each plane to create a circlefloatdegForPlane=360/[[transformLayersublayers]count];//The current angle offset (initially it is 0... it will change through the pan function)floatdegX=angle;for(CALayer*layerin[transformLayersublayers]){//Create the Matrix identityCATransform3Dt=CATransform3DIdentity;//Setup the perspective modifying the matrix elementat [3][4]t.m34=1.0f/-1000.0f;//Perform rotate on the matrix identityt=CATransform3DRotate(t,degToRad(degX),0.0f,1.0f,0.0f);//Perform translate on the current transform matrix (identity + rotate)t=CATransform3DTranslate(t,0.0f,0.0f,250.0f);//Avoid animations[CATransactionsetAnimationDuration:0.0];//apply the transoform on the current layerlayer.transform=t;//Add the degree needed for the next planedegX+=degForPlane;}}
</code></pre><p>其中，defForPlane变量是指沿着360度圆周上每个平面需要旋转的角度。看下图会容易理解一些：<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/04/planes_circle_1.png" alt><br>圆周上的5个平面需要旋转一定的角度。这个角度从0开始，每个平面增加”360/平面总数”度。<br>angle变量的值目前还是零，我们稍后会详细解释它的作用。<br>animate函数循环遍历transformLayer的所有子图层(5个平面)，为每一个平面加上一些变换效果：<br>第一个变换效果是改变视点，和我们在上一篇教程中的做法一样，直接给m34属性赋一个值，从而可以绘制出平面的3D空间深度。<br>另外2个变换效果需要一点点数值计算。我们前面已经谈到了，每个平面需要一个旋转角度。但是我们跳过了一个关键点，还没讲。<br>如果我们只是给每个平面加上一个旋转角度，我们只会得到下面这种效果：<br><img src="http://www.thinkandbuild.it/wp-content/uploads/2013/04/planes_center.png" alt><br>你可以看到，这种效果不行，我们还需要给每个平面加上平移变换，使让它们沿着圆周排列。<br>最后一步是将这些变换应用到各个平面上。只需要将变换赋值给当前平面的transform属性就可以了，赋值后，下一个平面的degX值会增加”degForPlane”度。</p>
<p>###拖拽手势<br>pan:函数是拖拽手势的处理函数。下面是该函数的代码：<br>    1<br>    2<br>    3<br>    4<br>    5<br>    6<br>    7<br>    8<br>    9<br>    10<br>    11<br>    12<br>    13<br>    14<br>    15<br>    16<br>    17<br>    18<br>    19<br>    20<br>    21<br>    22<br>    23</p>
<pre><code>-(void)pan:(UIPanGestureRecognizer*)gesture{//Get the current translation on the XfloatxOffset=[gesturetranslationInView:self.view].x;//When gesture begin, reset the offsetif(gesture.state==UIGestureRecognizerStateBegan){XPanOffset=0;}//the distance covered since the last gesture event (I slow down a bit the final rotation multiplying by 0.5)floatmovedBy=xOffset*0.5-XPanOffset;//Calculate the offset from the previous gesture eventXPanOffset+=movedBy;//Add the offset to the current angleangle+=movedBy;//Update the plane[selfanimate];}
</code></pre><p>拖拽手势是一个连续性的手势。从手势开始，直到所有手指离开屏幕之前，只要手指一移动，pan函数就会被调用。<br>为了将这些手势数据转换成对旋转木马动画有用的数据，我们需要获得每次移动前的X坐标值。<br>这里我们使用了XPanOffset这个变量来存储位置信息。当手势发生移动后，我们会计算出本次移动的距离(movedBy变量)。这个移动距离会被加到XPanOffset中，也会被加到当前的angle变量上。<br>然后调用animate函数就可以将所有平面旋转到新角度。<br>就这样，完成了！<img src="http://www.thinkandbuild.it/wp-includes/images/smilies/icon_smile.gif" alt><br>这个简单的例子展示了只需用Core Animation就可以做出来的一些3D效果。<br>祝你玩的愉快！有任何疑问或建议，请随时在<a href="http://twitter.com/bitwaker" target="_blank" rel="noopener">twitter</a>上联系我。<br><a href="https://github.com/ariok/TB_3DCoreAnimation" target="_blank" rel="noopener">教程源代码下载</a><br>译自：<a href="http://www.thinkandbuild.it/introduction-to-3d-drawing-in-core-animation-part-2/" target="_blank" rel="noopener">Think<br> &amp; Build</a></p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[MessageUI.framework发短信]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/MessageUI.framework%E5%8F%91%E7%9F%AD%E4%BF%A1/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;MessageUI/MessageUI.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">MFMessageComposeViewControllerDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="built_in">UIButton</span> *b = [<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeCustom</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:b];</span><br><span class="line">    b.frame = <span class="built_in">CGRectMake</span>(<span class="number">100</span>, <span class="number">100</span>, <span class="number">200</span>, <span class="number">100</span>);</span><br><span class="line">    b.backgroundColor = [<span class="built_in">UIColor</span> blackColor];</span><br><span class="line">    [b setTitle:<span class="string">@"sendMessage"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [b addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(buttonAction) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)buttonAction</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (![MFMessageComposeViewController canSendText])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"当前设备不能发短信"</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">       </span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">   </span><br><span class="line">    MFMessageComposeViewController *messageVC = [[MFMessageComposeViewController alloc]init];</span><br><span class="line">   </span><br><span class="line">    messageVC.recipients = @[<span class="string">@"10086"</span>,<span class="string">@"10010"</span>];</span><br><span class="line">    messageVC.body = <span class="string">@"大水杯"</span>;</span><br><span class="line">    messageVC.messageComposeDelegate = <span class="keyword">self</span>;</span><br><span class="line">   </span><br><span class="line">    [<span class="keyword">self</span> presentViewController:messageVC animated:<span class="literal">YES</span> completion:^&#123;</span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line">    &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)messageComposeViewController:(MFMessageComposeViewController *)controller didFinishWithResult:(MessageComposeResult)result</span><br><span class="line">&#123;</span><br><span class="line">   </span><br><span class="line">    [<span class="keyword">self</span> dismissViewControllerAnimated:<span class="literal">YES</span> completion:^&#123;</span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line">    &#125;];</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)didReceiveMemoryWarning &#123;</span><br><span class="line">    [<span class="keyword">super</span> didReceiveMemoryWarning];</span><br><span class="line">    <span class="comment">// Dispose of any resources that can be recreated.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[MPMoviePlayerViewController和MPMoviePlayerController]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/MPMoviePlayerViewController%E5%92%8CMPMoviePlayerController/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span> playVideo:[<span class="built_in">NSURL</span> URLWithString:<span class="keyword">self</span>.playURL]];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//根据视频url播放视频</span></span><br><span class="line">- (<span class="keyword">void</span>) playVideo:(<span class="built_in">NSURL</span> *) movieURL</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">MPMoviePlayerViewController</span> *playerViewController = [[<span class="built_in">MPMoviePlayerViewController</span> alloc]     initWithContentURL:movieURL];</span><br><span class="line">    <span class="keyword">self</span>.playerViewController = playerViewController;</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(playVideoFinished:) name:<span class="built_in">MPMoviePlayerPlaybackDidFinishNotification</span> object:[playerViewController moviePlayer]];</span><br><span class="line">    playerViewController.modalTransitionStyle = <span class="built_in">UIModalTransitionStyleFlipHorizontal</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:playerViewController.view];</span><br><span class="line">    <span class="built_in">MPMoviePlayerController</span> *player = [playerViewController moviePlayer];</span><br><span class="line">    [player play];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//当点击Done按键或者播放完毕时调用此函数</span></span><br><span class="line">- (<span class="keyword">void</span>) playVideoFinished:(<span class="built_in">NSNotification</span> *)theNotification</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">MPMoviePlayerController</span> *player = [theNotification object];</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span> name:<span class="built_in">MPMoviePlayerPlaybackDidFinishNotification</span> object:player];</span><br><span class="line">    [player stop];</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span> dismissViewControllerAnimated:<span class="literal">YES</span> completion:^&#123;</span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>MPMoviePlayerViewController和MPMoviePlayerController 使用场合不一样MPMoviePlayerViewController是在iOS3.2以后的平台上使用。MPMoviePlayerController在3.2之前使用，虽然在3.2之后也能使用，但是使用方法略有改变，建议3.2之后使用MPMoviePlayerViewController。<br>3.2之后,MPMoviePlayerController作为MPMoviePlayerViewController的一个属性存在。</p>
<p>以下是使用MPMoviePlayerViewController播放视频的代码:</p>
<p>去掉系统上的按钮导航条 self.play.controlStyle = MPMovieControlStyleNone;</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[NSHTTPCookieStorage]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/NSHTTPCookieStorage/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//保存cookie</span></span><br><span class="line">+ (<span class="keyword">void</span>)saveCookies &#123;</span><br><span class="line">    <span class="built_in">NSData</span> *cookiesData = [<span class="built_in">NSKeyedArchiver</span> archivedDataWithRootObject: [[<span class="built_in">NSHTTPCookieStorage</span> sharedHTTPCookieStorage] cookies]];</span><br><span class="line">    <span class="built_in">NSUserDefaults</span> *defaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line">    [defaults setObject: cookiesData forKey:kCookie];</span><br><span class="line">    [defaults synchronize];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//加载cookie</span></span><br><span class="line">+ (<span class="keyword">void</span>)loadCookies &#123;</span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSArray</span> *cookies = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithData: [[<span class="built_in">NSUserDefaults</span> standardUserDefaults] objectForKey: kCookie]];</span><br><span class="line">    <span class="built_in">NSHTTPCookieStorage</span> *cookieStorage = [<span class="built_in">NSHTTPCookieStorage</span> sharedHTTPCookieStorage];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSHTTPCookie</span> *cookie <span class="keyword">in</span> cookies)&#123;</span><br><span class="line">        [cookieStorage setCookie: cookie];</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除cookie</span></span><br><span class="line">+ (<span class="keyword">void</span>)clearCookies &#123;</span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSArray</span> *cookies = [[<span class="built_in">NSHTTPCookieStorage</span> sharedHTTPCookieStorage] cookies];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSHTTPCookie</span> *cookie <span class="keyword">in</span> cookies)</span><br><span class="line">    &#123;</span><br><span class="line">        [[<span class="built_in">NSHTTPCookieStorage</span> sharedHTTPCookieStorage] deleteCookie:cookie];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Masonry介绍与使用实践：快速上手Autolayout]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/Masonry%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8%E5%AE%9E%E8%B7%B5%EF%BC%9A%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8BAutolayout/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>转自：<a href="http://www.cocoachina.com/ios/20141219/10702.html" target="_blank" rel="noopener">http://www.cocoachina.com/ios/20141219/10702.html</a><br>前言<br>    MagicNumber -&gt; autoresizingMask -&gt; autolayou<br>以上是纯手写代码所经历的关于页面布局的三个时期<br>在iphone1-iphone3gs时代 window的size固定为(320,480) 我们只需要简单计算一下相对位置就好了<br>在iphone4-iphone4s时代 苹果推出了retina屏 但是给了码农们非常大的福利:window的size不变<br>在iphone5-iphone5s时代 window的size变了(320,568) 这时autoresizingMask派上了用场(为啥这时候不用Autolayout? 因为还要支持ios5呗) 简单的适配一下即可<br>在iphone6+时代 window的width也发生了变化(相对5和5s的屏幕比例没有变化) 终于是时候抛弃autoresizingMask改用autolayout了(不用支持ios5了 相对于屏幕适配的多样性来说autoresizingMask也已经过时了)<br>那如何快速的上手autolayout呢? 说实话 当年ios6推出的同时新增了autolayout的特性 我看了一下官方文档和demo 就立马抛弃到一边了 因为实在过于的繁琐和啰嗦(有过经验的朋友肯定有同感)<br>直到iPhone6发布之后 我知道使用autolayout势在必行了 这时想起了以前在浏览Github看到过的一个第三方库Masonry 在花了几个小时的研究使用后 我就将autolayout掌握了(重点是我并没有学习任何的官方文档或者其他的关于autolayout的知识) 这就是我为什么要写下这篇文章来推荐它的原因.<br><strong>介绍</strong><br>Masonry 源码：<a href="https://github.com/Masonry/Masonry" target="_blank" rel="noopener">https://github.com/Masonry/Masonry</a><br>Masonry是一个轻量级的布局框架 拥有自己的描述语法 采用更优雅的链式语法封装自动布局 简洁明了 并具有高可读性 而且同时支持 iOS 和 Max OS X。<br>我们先来看一段官方的sample code来认识一下Masonry<br>    [view1 mas_makeConstraints:^(MASConstraintMaker <em>make) {<br>        make.edges.equalTo(superview).with.insets(padding);<br>    }];<br>看到block里面的那句话: make edges equalTo superview with insets<br>通过链式的自然语言 就把view1给autolayout好了 是不是简单易懂?<br><strong>使用</strong><br>看一下Masonry支持哪一些属性<br>    @property (nonatomic, strong, readonly) MASConstraint </em>left;<br>    @property (nonatomic, strong, readonly) MASConstraint <em>top;<br>    @property (nonatomic, strong, readonly) MASConstraint </em>right;<br>    @property (nonatomic, strong, readonly) MASConstraint <em>bottom;<br>    @property (nonatomic, strong, readonly) MASConstraint </em>leading;<br>    @property (nonatomic, strong, readonly) MASConstraint <em>trailing;<br>    @property (nonatomic, strong, readonly) MASConstraint </em>width;<br>    @property (nonatomic, strong, readonly) MASConstraint <em>height;<br>    @property (nonatomic, strong, readonly) MASConstraint </em>centerX;<br>    @property (nonatomic, strong, readonly) MASConstraint <em>centerY;<br>    @property (nonatomic, strong, readonly) MASConstraint </em>baseline;<br>这些属性与NSLayoutAttrubute的对照表如下</p>
<p>其中leading与left trailing与right 在正常情况下是等价的 但是当一些布局是从右至左时(比如阿拉伯文?没有类似的经验) 则会对调 换句话说就是基本可以不理不用 用left和right就好了<br>在ios8发布后 又新增了一堆奇奇怪怪的属性(有兴趣的朋友可以去瞅瞅) Masonry暂时还不支持(不过你要支持ios6,ios7 就没必要去管那么多了)<br>在讲实例之前 先介绍一个MACRO<br>1<code>#define WS(weakSelf)  __weak __typeof(&amp;*self)weakSelf = self;</code>快速的定义一个weakSelf 当然是用于block里面啦 下面进入正题(为了方便 我们测试的superView都是一个size为(300,300)的UIView)<br>下面 通过一些简单的实例来简单介绍如何轻松愉快的使用Masonry:</p>
<ol>
<li>[基础] 居中显示一个view<br>1234567891011121314151617<code>- (void)viewDidLoad`</code>{<code></code>[<code>super` `viewDidLoad];</code>    <code>// Do any additional setup after loading the view.</code>    <code></code>    <code>WS(ws);</code>    <code></code>    <code>UIView *sv = [UIView</code>new<code>];</code>    <code>[sv showPlaceHolder];</code>    <code>sv.backgroundColor = [UIColor blackColor];</code>    <code>[self.view addSubview:sv];</code>    <code>[sv mas_makeConstraints:^(MASConstraintMaker *make) {</code>        <code>make.center.equalTo(ws.view);</code>        <code>make.size.mas_equalTo(CGSizeMake(300, 300));</code>    <code>}];</code>    <code></code>}`</li>
</ol>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[NSString]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/NSString/</url>
      <content type="html"><![CDATA[<p>NSString<br><a id="more"></a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***********************NSString***********************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 获取字符串长度 string.length</span></span><br><span class="line">    <span class="built_in">NSString</span> *string = <span class="string">@"12345678"</span>;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%ld"</span>,string.length);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 获取子字符串，调用系统方法 substringFromIndex:</span></span><br><span class="line">    <span class="built_in">NSString</span> *string = <span class="string">@"www.lanou.com"</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSString</span> *str1 =  [string substringFromIndex:<span class="number">4</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,str1);</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 截取指定范围的字符串 substringWithRange:</span></span><br><span class="line">    <span class="comment">//NSRange表示范围的结构体</span></span><br><span class="line">    <span class="built_in">NSRange</span> a = &#123;<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSString</span> *str3 = [string substringWithRange:a];</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,str3);</span><br><span class="line">   </span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 拼接字符串 stringByAppendingString:</span></span><br><span class="line">    <span class="built_in">NSString</span> *string = <span class="string">@"I love"</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *string1 = <span class="string">@" Kitty"</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//appand是拼接的意思</span></span><br><span class="line">    <span class="built_in">NSString</span> *string2 =  [string stringByAppendingString:string1];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,string2);</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 替换字符串 stringByReplacingOccurrencesOfString:@<span class="meta-string">"I"</span> withString:</span></span><br><span class="line">    <span class="built_in">NSString</span> *string = <span class="string">@"I love You"</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *string1 = <span class="string">@" Kitty"</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *string2 =</span><br><span class="line">    [string stringByReplacingOccurrencesOfString:<span class="string">@"I"</span> withString:<span class="string">@"You"</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,string2);</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 判断字符串是否相等 isEqualToString:</span></span><br><span class="line">    <span class="built_in">NSString</span> *string = <span class="string">@"abcd"</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *string1 = <span class="string">@"abc"</span>;</span><br><span class="line">    <span class="keyword">if</span> ([string isEqualToString:string1]) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"字符串相等"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"字符串不相等"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 字符串是否一一个字符开头 hasPrefix:</span></span><br><span class="line">    <span class="built_in">NSString</span> *string = <span class="string">@"abcdefg"</span>;</span><br><span class="line">    <span class="keyword">if</span> ([string hasPrefix:<span class="string">@"a"</span>]) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"字符串以a开头"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"字符串不以a开头"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 字符串是否一一个字符结尾 hasSuffix:  </span></span><br><span class="line">    <span class="keyword">if</span> ([string hasSuffix:<span class="string">@"efg"</span>]) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"是以efg结尾"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"不是以efg结尾"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    给定一个图片文件名，判断字符串中是否以“png”结尾，如果是就替换成“jpg”如果不是，就拼接“.jpg”</span><br><span class="line">    <span class="built_in">NSString</span> *string = <span class="string">@"abc.png"</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> ([string hasSuffix:<span class="string">@"png"</span>]) &#123;</span><br><span class="line">        string = [string stringByReplacingOccurrencesOfString:<span class="string">@"png"</span> withString:<span class="string">@"jpg"</span>];</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         string =  [string stringByAppendingString:<span class="string">@".jpg"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,string);</span><br><span class="line"><span class="comment">/***********************NSString************************/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/***********************NSMutableString******************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 可变字符串</span></span><br><span class="line">    <span class="comment">//可变字符串本身是可以修改的</span></span><br><span class="line">    <span class="built_in">NSMutableString</span> *mutString = [<span class="built_in">NSMutableString</span> stringWithFormat:<span class="string">@"张三"</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 插入字符串 insertString: atIndex:</span></span><br><span class="line">    [mutString insertString:<span class="string">@"大"</span> atIndex:<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"mutString = %@"</span>,mutString);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 删除字符串 deleteCharactersInRange:</span></span><br><span class="line">    <span class="built_in">NSRange</span> a = &#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line">    [mutString deleteCharactersInRange:a];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"mutString = %@"</span>,mutString);</span><br><span class="line">   </span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 拼接 appendString:</span></span><br><span class="line">    <span class="built_in">NSMutableString</span> *mutString = [<span class="built_in">NSMutableString</span> stringWithFormat:<span class="string">@"张三"</span>];</span><br><span class="line">    [mutString appendString:<span class="string">@"好"</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"mutString = %@"</span>,mutString);   </span><br><span class="line"></span><br><span class="line"><span class="comment">/***********************NSMutableString******************/</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[NSUserDefaults]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/NSUserDefaults/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*NSUserDefaults通常用于存储用户偏好设置和登陆注册等信息*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//取值</span></span><br><span class="line">    [[<span class="built_in">NSUserDefaults</span> standardUserDefaults]objectForKey:<span class="string">@"night"</span>];</span><br><span class="line">    <span class="comment">//存值</span></span><br><span class="line">    [[<span class="built_in">NSUserDefaults</span> standardUserDefaults] setObject:<span class="string">@"yes"</span> forKey:<span class="string">@"night"</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//存储数据</span></span><br><span class="line">    <span class="built_in">NSUserDefaults</span> *userDefault = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line">   </span><br><span class="line">    [userDefault setObject:<span class="string">@"张三"</span> forKey:<span class="string">@"name"</span>];</span><br><span class="line">    [userDefault setInteger:<span class="number">23</span> forKey:<span class="string">@"age"</span>];  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//取出数据</span></span><br><span class="line">    <span class="keyword">self</span>.navigationItem.title = [[<span class="built_in">NSUserDefaults</span> standardUserDefaults]objectForKey:<span class="string">@"name"</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%ld"</span>,[[<span class="built_in">NSUserDefaults</span> standardUserDefaults]integerForKey:<span class="string">@"age"</span> ]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//修改数据</span></span><br><span class="line">    [[<span class="built_in">NSUserDefaults</span> standardUserDefaults]setObject:<span class="string">@"李四"</span> forKey:<span class="string">@"name"</span>];</span><br><span class="line"></span><br><span class="line"> <span class="comment">//强制存储</span></span><br><span class="line">    <span class="comment">/*原因：NSUserDefaults存储数据会发生延迟现象，把数据存储到本地文件中，不是马上就生效，所以会出现娶不到数据现象*/</span></span><br><span class="line">    [[<span class="built_in">NSUserDefaults</span> standardUserDefaults]synchronize];</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[OC 函数库方法]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/OC%20%E5%87%BD%E6%95%B0%E5%BA%93%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="number">2.1</span><span class="number">.1</span>　rand()函数：产生随机数　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.2</span>　abs()函数/labs()函数：整数的绝对值　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.3</span>　fabs()/fabsf()/fabsl()函数：浮点数的绝对值　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.4</span>　floor()/floorf()/floorl()函数：向下取整　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.5</span>　ceil()/ceilf()/ceill()函数：向上取整　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.6</span>　round()/roundf()/roundl()函数：四舍五入　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.7</span>　sqrt()/sqrtf()/sqrtl()函数：求平方根　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.8</span>　fmax()/fmaxf()/fmaxl()函数：求最大值　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.9</span>　fmin()/fminf()/fminl()函数：求最小值　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.10</span>　hypot()/hypotf()/hypotl()函数：求直角三角形斜边的长度　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.11</span>　fmod()/fmodf()/fmodl()函数：求两数整除后的余数　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.12</span>　modf()/modff()/modfl()函数：浮点数分解为整数和小数　</span><br><span class="line">　　<span class="number">2.1</span><span class="number">.13</span>　frexp()/frexpf()/frexpl()函数：浮点数分解尾数和以二为底的指数　</span><br><span class="line">　　<span class="number">2.2</span>　三角运算函数　</span><br><span class="line">　　<span class="number">2.2</span><span class="number">.1</span>　sin()/sinf()/sinl()/函数：求正弦值　</span><br><span class="line">　　<span class="number">2.2</span><span class="number">.2</span>　sinh()/sinhf()/sinhl()函数：求双曲正弦值　</span><br><span class="line">　　<span class="number">2.2</span><span class="number">.3</span>　cos()/cosf()/cosl()函数：求余弦值　</span><br><span class="line">　　<span class="number">2.2</span><span class="number">.4</span>　cosh()/coshf()/coshl()函数：求双曲余弦值　</span><br><span class="line">　　<span class="number">2.2</span><span class="number">.5</span>　tan()/tanf()/tanl()函数：求正切值　</span><br><span class="line">　　<span class="number">2.2</span><span class="number">.6</span>　tanh()/tanhf()/tanhl()函数：求双曲正切值　</span><br><span class="line">　　<span class="number">2.3</span>　反三角运算　</span><br><span class="line">　　<span class="number">2.3</span><span class="number">.1</span>　asin()/asinf()/asinl()函数：求反正弦值　</span><br><span class="line">　　<span class="number">2.3</span><span class="number">.2</span>　asinh()/asinhf()/asinhl()函数：求反双曲正弦值　</span><br><span class="line">　　<span class="number">2.3</span><span class="number">.3</span>　acos()/acosf()/acosl()函数：求反余弦值　</span><br><span class="line">　　<span class="number">2.3</span><span class="number">.4</span>　acosh()/acoshf()/acoshl()函数：求反双曲余弦值　</span><br><span class="line">　　<span class="number">2.3</span><span class="number">.5</span>　atan()/atanf()/atanl()函数：求反正切值　</span><br><span class="line">　　<span class="number">2.3</span><span class="number">.6</span>　atan2()/atan2f()/atanl()函数：求坐标值的反正切值　</span><br><span class="line">　　<span class="number">2.3</span><span class="number">.7</span>　atanh()/atanhf()/atanhl()函数：求反双曲正切值　</span><br><span class="line">　　<span class="number">2.4</span>　指数和对数运算　</span><br><span class="line">　　<span class="number">2.4</span><span class="number">.1</span>　pow()/powf()/powl函数：求n的m次方的值　</span><br><span class="line">　　<span class="number">2.4</span><span class="number">.2</span>　exp()/expf()/expl()函数：求e的x次方的值　</span><br><span class="line">　　<span class="number">2.4</span><span class="number">.3</span>　exp2()/exp2f()/exp2l()函数：<span class="number">2</span>的x的次方的值　</span><br><span class="line">　　<span class="number">2.4</span><span class="number">.4</span>　log()/logf()/logl()函数：求以e为底的对数值　</span><br><span class="line">　　<span class="number">2.4</span><span class="number">.5</span>　log10()/log10f()/log10l()函数：求以<span class="number">10</span>为底的对数值</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIAlertController]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIAlertController/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>   //初始化方法</p>
<pre><code>+ (instancetype)alertControllerWithTitle:(nullableNSString *)title message:(nullableNSString *)message preferredStyle:(UIAlertControllerStyle)preferredStyle;
</code></pre><p>   //UIAlertControllerStyle<br>   typedefNS_ENUM(NSInteger, UIAlertControllerStyle) {<br>            UIAlertControllerStyleActionSheet =0,            UIAlertControllerStyleAlert     }<br>   /<strong><strong><strong>**</strong></strong></strong>自动消失的UIAlertController<strong><strong>*</strong></strong>/   //创建UIAlertController<br>   UIAlertController*alertController = [UIAlertControlleralertControllerWithTitle:@”标题”message:@”UIAlertController”preferredStyle:UIAlertControllerStyleAlert];</p>
<pre><code>[selfpresentViewController:alertControlleranimated:YEScompletion:nil];
</code></pre><p>   //线程2秒后执行<br>   dispatch_after(dispatch_time(DISPATCH_TIME_NOW,<br> (int64_t)(2.f*NSEC_PER_SEC)),dispatch_get_main_queue(), ^{</p>
<pre><code>    [alertControllerdismissViewControllerAnimated:YEScompletion:^{


    }];
});   /**************自动消失的UIAlertController*********/ 
</code></pre><p> /<em><br>     <strong>**</strong>添加按钮<strong>**</strong><br>     Title :标题名称<br>     style :样式[Cancle(取消)<br> Default(默认的) destructive(重置)]<br>     handler:处理程序(点击按钮执行的代码)
     </em>/</p>
<p>   /<strong><strong><strong>**</strong></strong></strong>带按钮的的UIAlertController<strong><strong>*</strong></strong>/<br>   //创建UIAlertController<br>   UIAlertController*alertController = [UIAlertControlleralertControllerWithTitle:@”标题”message:@”UIAlertController”preferredStyle:UIAlertControllerStyleAlert];</p>
<p>   //创建”取消”样式按钮<br>   UIAlertAction<em>cancelAction = [UIAlertActionactionWithTitle:@”取消”style:UIAlertActionStyleCancelhandler:^(UIAlertAction</em>action) {<br>       //添加点击事件<br>       self.view.backgroundColor= [UIColoryellowColor];</p>
<pre><code>}];
</code></pre><p>   //创建”默认”样式按钮<br>   UIAlertAction<em>defaultAction = [UIAlertActionactionWithTitle:@”默认default”style:UIAlertActionStyleDefaulthandler:^(UIAlertAction</em>_Nonnullaction) {</p>
<pre><code>}];
</code></pre><p>   //创建“警示”样式按钮<br>   UIAlertAction<em>destructiveAction = [UIAlertActionactionWithTitle:@”重置deatructive” style:UIAlertActionStyleDestructivehandler:^(UIAlertAction</em>_Nonnullaction) {</p>
<pre><code>}];
</code></pre><p>   //将按钮添加到alertController上<br>    [alertControlleraddAction:cancelAction];<br>    [alertControlleraddAction:defaultAction];<br>    [alertControlleraddAction:destructiveAction];</p>
<pre><code>[selfpresentViewController:alertControlleranimated:YEScompletion:nil];
</code></pre><p>   /<strong><strong><strong>**</strong></strong></strong>带按钮的的UIAlertController<strong><strong>*</strong></strong>/</p>
<p>/<strong><strong><strong>**</strong></strong></strong>带输入框的UIAlertController<strong><strong>*</strong></strong>/   //创建UIAlertController<br>   UIAlertController*alertController = [UIAlertControlleralertControllerWithTitle:@”文本对话框”message:@”登录和密码对话框示例”preferredStyle:UIAlertControllerStyleAlert];</p>
<p>   //添加输入框<br>    [alertControlleraddTextFieldWithConfigurationHandler:^(UITextField*textField){<br>        textField.placeholder=@”登录”;</p>
<pre><code>   //添加通知，监听输入框的变化
    [[NSNotificationCenterdefaultCenter]addObserver:selfselector:@selector(alertTextFieldDidChange:)name:UITextFieldTextDidChangeNotificationobject:textField];
}];

[alertControlleraddTextFieldWithConfigurationHandler:^(UITextField*textField) {
    textField.placeholder=@&quot;密码&quot;;
    textField.secureTextEntry=YES;
}];
</code></pre><p>   //添加按钮<br>   UIAlertAction<em>okAction = [UIAlertActionactionWithTitle:@”好的”style:UIAlertActionStyleDefaulthandler:^(UIAlertAction</em>action) {</p>
<pre><code>   //获取到输入框的内容
   UITextField*login = alertController.textFields.firstObject;
   UITextField*password = alertController.textFields.lastObject;

   //移除通知
    [[NSNotificationCenterdefaultCenter]removeObserver:selfname:UITextFieldTextDidChangeNotificationobject:nil];

}];
</code></pre><p>   //冻结按钮<br>    okAction.enabled=NO;<br>    [alertControlleraddAction:okAction];</p>
<pre><code>[selfpresentViewController:alertControlleranimated:YEScompletion:^{


}];
</code></pre><p>   /<strong><strong><strong>**</strong></strong></strong>带输入框的UIAlertController<strong><strong>*</strong></strong>/<br>}<br>//通知触发的方法</p>
<ul>
<li><p>(void)alertTextFieldDidChange:(NSNotification<em>)notification{<br> UIAlertController</em>alertController = (UIAlertController*)self.presentedViewController;</p>
<p> if(alertController) {</p>
<pre><code>UITextField*login = alertController.textFields.firstObject;
UIAlertAction*okAction = alertController.actions.lastObject;

//当输入的字数大于2时解冻
 okAction.enabled= login.text.length&gt;2;
</code></pre><p>  }<br>}</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[NSTimer]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/NSTimer/</url>
      <content type="html"><![CDATA[<p>NSTimer<br><a id="more"></a></p>
<p><code>`</code>objc<br>    //创建NSTimerNSTimer*timer = [[NSTimeralloc]init];      //每1秒运行一次function方法。    timer =  [NSTimer scheduledTimerWithTimeInterval:1.0target:selfselector:@selector(function:) userInfo:nilrepeats:YES];   //TimeInterval:调用的时间间隔   //repeats:决定是否重复调NSTimer   //注意：将计数器的repeats设置为YES的时候，self的引用计数会加1。因此可能会导致self（即viewController）不能release，所以，必须在viewWillAppear的时候，将计数器timer停止，否则可能会导致内存泄露。   //停止timer的运行，但这个是永久的停止：（注意：停止后，一定要将timer赋空，否则还是没有释放。<br>   //取消定时器<br>    [timer invalidate];    timer =nil;<br>   //要想实现：先停止，然后再某种情况下再次开启运行timer，可以使用下面的方法：<br>   //暂时关闭定时器    [myTimer setFireDate:[NSDatedistantFuture]];<br>   //开启定时器    [myTimer setFireDate:[NSDatedistantPast]];</p>
<p>   //设置启动页面时间    NSThread sleepForTimeInterval:&lt;#(NSTimeInterval)#&gt;<br>/<em> NSTimer.hCopyright (c) 1994-2014, Apple Inc. All rights reserved.
</em>/</p>
<p>#import&lt;Foundation/NSObject.h&gt;</p>
<p>#import&lt;Foundation/NSDate.h&gt;</p>
<p>@interfaceNSTimer :NSObject</p>
<ul>
<li>(NSTimer<em>)timerWithTimeInterval:(NSTimeInterval)ti invocation:(NSInvocation</em>)invocation repeats:(BOOL)yesOrNo;</li>
<li><p>(NSTimer<em>)scheduledTimerWithTimeInterval:(NSTimeInterval)ti invocation:(NSInvocation</em>)invocation repeats:(BOOL)yesOrNo;</p>
</li>
<li><p>(NSTimer*)timerWithTimeInterval:(NSTimeInterval)ti target:(id)aTarget<br>selector:(SEL)aSelector userInfo:(id)userInfo<br>repeats:(BOOL)yesOrNo;</p>
</li>
<li>(NSTimer*)scheduledTimerWithTimeInterval:(NSTimeInterval)ti target:(id)aTarget<br>selector:(SEL)aSelector userInfo:(id)userInfo<br>repeats:(BOOL)yesOrNo;</li>
</ul>
<ul>
<li><p>(instancetype)initWithFireDate:(NSDate*)date interval:(NSTimeInterval)ti target:(id)t<br>selector:(SEL)s userInfo:(id)ui<br>repeats:(BOOL)repNS_DESIGNATED_INITIALIZER;</p>
</li>
<li><p>(void)fire;</p>
</li>
</ul>
<p>@property(copy)NSDate*fireDate;<br>@property(readonly)NSTimeIntervaltimeInterval;</p>
<p>// Setting a tolerance for a timer allows it to fire later than the scheduled fire date, improving the ability of the system to optimize for increased power savings and responsiveness.<br> The timer may fire at any time between its scheduled fire date and the scheduled fire date plus the tolerance. The timer will not fire before the scheduled fire date. For repeating timers, the next fire date is calculated from the original fire date regardless<br> of tolerance applied at individual fire times, to avoid drift. The default value is zero, which means no additional tolerance is applied. The system reserves the right to apply a small amount of tolerance to certain timers regardless of the value of this property.<br>// As the user of the timer, you will have the best idea of what an appropriate tolerance for a timer may be. A general rule of thumb, though, is to set the tolerance to at least 10%<br> of the interval, for a repeating timer. Even a small amount of tolerance will have a significant positive impact on the power usage of your application. The system may put a maximum value of the tolerance.<br>@propertyNSTimeIntervaltoleranceNS_AVAILABLE(10_9,7_0);</p>
<ul>
<li>(void)invalidate;<br>@property(readonly,getter=isValid)BOOLvalid;</li>
</ul>
<p>@property(readonly,retain)iduserInfo;</p>
<p>@end</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIBarMetrics]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIBarMetrics/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">forBarMetrics有点类似于按钮的<span class="keyword">for</span> state状态，即什么状态下显示</span><br><span class="line"></span><br><span class="line">    <span class="comment">//UIBarMetricsDefault-竖屏横屏都有，横屏导航条变宽，则自动repeat图片</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//UIBarMetricsCompact-竖屏没有，横屏有，相当于之前老iOS版本里地UIBarMetricsLandscapePhone</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//UIBarMetricsCompactPrompt和UIBarMetricsDefaultPrompt暂时不知道用处，官方解释是Applicable only in bars with the prompt property, such as UINavigationBar and UISearchBar，</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIBlurEffect系统自带毛玻璃效果]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIBlurEffect%E7%B3%BB%E7%BB%9F%E8%87%AA%E5%B8%A6%E6%AF%9B%E7%8E%BB%E7%92%83%E6%95%88%E6%9E%9C/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p><code>`</code>objc<br>   //需要模糊效果的view<br>   UIImageView*i = [[UIImageViewalloc]initWithFrame:CGRectMake(100,100,100,200)];<br>    [self.viewaddSubview:i];<br>    i.image= [UIImageimageNamed:@”1”];</p>
<p>   //创建UIBlurEffect<br>   UIBlurEffect*blurEffect = [UIBlurEffecteffectWithStyle:UIBlurEffectStyleLight];</p>
<p>   //UIVisualEffectView<br>   UIVisualEffectView*effectView = [[UIVisualEffectViewalloc]initWithEffect:blurEffect];   //设置模糊效果的frame    effectView.frame = i.bounds;   //添加到view上    [iaddSubview:effectView];    //设置模糊的程度    effectView.alpha =.5f;<br>typedefNS_ENUM(NSInteger, UIBlurEffectStyle) {    UIBlurEffectStyleExtraLight,    UIBlurEffectStyleLight,<br>    UIBlurEffectStyleDark}</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIColor和TintColor]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIColor%E5%92%8CTintColor/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>前者是指颜色，tint是指着色，色调。<br>通过tintColor属性可以定制UINavigationBar的背景颜色，但如果需要设定渐变色、甚至纹理来说，就需要贴图了。比较“暴力”的一种做法就是通过Category来重新实现- (void)<br> drawRect:(CGRect)rect的实现，“暴力”是因为这种杀伤面很广，所有项目内的UINavigationBar都会因此改变。</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIControlEvents]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIControlEvents/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIControlEventstypedefNS_OPTIONS</span>(<span class="built_in">NSUInteger</span>,</span><br><span class="line"> <span class="built_in">UIControlEvents</span>) &#123;    <span class="built_in">UIControlEventTouchDown</span>           =<span class="number">1</span>&lt;&lt; <span class="number">0</span>,     <span class="comment">// on all touch downs</span></span><br><span class="line">    <span class="built_in">UIControlEventTouchDownRepeat</span>     =<span class="number">1</span>&lt;&lt; <span class="number">1</span>,     <span class="comment">// on multiple touchdowns (tap count &gt; 1)</span></span><br><span class="line">    <span class="built_in">UIControlEventTouchDragInside</span>     =<span class="number">1</span>&lt;&lt; <span class="number">2</span>,</span><br><span class="line">    <span class="built_in">UIControlEventTouchDragOutside</span>    =<span class="number">1</span>&lt;&lt; <span class="number">3</span>,</span><br><span class="line">    <span class="built_in">UIControlEventTouchDragEnter</span>      =<span class="number">1</span>&lt;&lt; <span class="number">4</span>,</span><br><span class="line">    <span class="built_in">UIControlEventTouchDragExit</span>       =<span class="number">1</span>&lt;&lt; <span class="number">5</span>,</span><br><span class="line">    <span class="built_in">UIControlEventTouchUpInside</span>       =<span class="number">1</span>&lt;&lt; <span class="number">6</span>,</span><br><span class="line">    <span class="built_in">UIControlEventTouchUpOutside</span>      =<span class="number">1</span>&lt;&lt; <span class="number">7</span>,</span><br><span class="line">    <span class="built_in">UIControlEventTouchCancel</span>         =<span class="number">1</span>&lt;&lt; <span class="number">8</span>,</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UIControlEventValueChanged</span>        =<span class="number">1</span>&lt;&lt;<span class="number">12</span>,    <span class="comment">// sliders, etc.</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">UIControlEventEditingDidBegin</span>     =<span class="number">1</span>&lt;&lt;<span class="number">16</span>,    <span class="comment">// UITextField</span></span><br><span class="line">    <span class="built_in">UIControlEventEditingChanged</span>      =<span class="number">1</span>&lt;&lt;<span class="number">17</span>,</span><br><span class="line">    <span class="built_in">UIControlEventEditingDidEnd</span>       =<span class="number">1</span>&lt;&lt;<span class="number">18</span>,</span><br><span class="line">    <span class="built_in">UIControlEventEditingDidEndOnExit</span> =<span class="number">1</span>&lt;&lt;<span class="number">19</span>,    <span class="comment">// 'return key' ending editing</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">UIControlEventAllTouchEvents</span>      =<span class="number">0x00000FFF</span>, <span class="comment">// for touch events</span></span><br><span class="line">    <span class="built_in">UIControlEventAllEditingEvents</span>    =<span class="number">0x000F0000</span>, <span class="comment">// for UITextField</span></span><br><span class="line">    <span class="built_in">UIControlEventApplicationReserved</span> =<span class="number">0x0F000000</span>, <span class="comment">// range available for application use</span></span><br><span class="line">    <span class="built_in">UIControlEventSystemReserved</span>      =<span class="number">0xF0000000</span>, <span class="comment">// range reserved for internal framework use</span></span><br><span class="line">    <span class="built_in">UIControlEventAllEvents</span>           =<span class="number">0xFFFFFFFF</span>&#125;;<span class="comment">/*</span></span><br><span class="line"><span class="comment"> UIControlEventTouchDown 单点触摸按下事件：用户点触屏幕，或者又有新手指落下的时候。</span></span><br><span class="line"><span class="comment"> UIControlEventTouchDownRepeat 多点触摸按下事件，点触计数大于1：用户按下第二、三、或第四根手指的时候。</span></span><br><span class="line"><span class="comment"> UIControlEventTouchDragInside 当一次触摸在控件窗口内拖动时。</span></span><br><span class="line"><span class="comment"> UIControlEventTouchDragOutside 当一次触摸在控件窗口之外拖动时。</span></span><br><span class="line"><span class="comment"> UIControlEventTouchDragEnter 当一次触摸从控件窗口之外拖动到内部时。</span></span><br><span class="line"><span class="comment"> UIControlEventTouchDragExit</span></span><br><span class="line"><span class="comment"> 当一次触摸从控件窗口内部拖动到外部时。</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> UIControlEventTouchUpInside 所有在控件之内触摸抬起事件。</span></span><br><span class="line"><span class="comment"> UIControlEventTouchUpOutside 所有在控件之外触摸抬起事件(点触必须开始与控件内部才会发送通知)。</span></span><br><span class="line"><span class="comment"> UIControlEventTouchCancel 所有触摸取消事件，即一次触摸因为放上了太多手指而被取消，或者被上锁或者电话呼叫打断。</span></span><br><span class="line"><span class="comment"> UIControlEventTouchChanged 当控件的值发生改变时，发送通知。用于滑块、分段控件、以及其他取值的控件。你可以配置滑块控件何时发送通知，在滑块被放下时发送，或者在被拖动时发送。</span></span><br><span class="line"><span class="comment"> UIControlEventEditingDidBegin 当文本控件中开始编辑时发送通知。</span></span><br><span class="line"><span class="comment"> UIControlEventEditingChanged 当文本控件中的文本被改变时发送通知。</span></span><br><span class="line"><span class="comment"> UIControlEventEditingDidEnd 当文本控件中编辑结束时发送通知。</span></span><br><span class="line"><span class="comment"> UIControlEventEditingDidOnExit 当文本控件内通过按下回车键（或等价行为）结束编辑时，发送通知。</span></span><br><span class="line"><span class="comment"> UIControlEventAlltouchEvents 通知所有触摸事件。</span></span><br><span class="line"><span class="comment"> UIControlEventAllEditingEvents 通知所有关于文本编辑的事件。</span></span><br><span class="line"><span class="comment"> UIControlEventAllEvents</span></span><br><span class="line"><span class="comment"> 通知所有事件。</span></span><br><span class="line"><span class="comment">       */</span></span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIDevice]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIDevice/</url>
      <content type="html"><![CDATA[<p>UIDevice提供了多种属性、类函数及状态通知，帮助我们全方位了解设备状况。从检测电池电量到定位设备与临近感应，UIDevice所做的工作就是为应用程序提供用户及设备的一些信息。UIDevice类还能够收集关于设备的各种具体细节，例如机型及iOS版本等。其中大部分属性都对开发工作具有积极的辅助作用。下面的代码简单的使用UIDevice获取手机属性。<br><a id="more"></a><br> typedef NS_ENUM(NSInteger, UIDeviceOrientation) //设备方向<br>    {<br>        UIDeviceOrientationUnknown,<br>        UIDeviceOrientationPortrait,                   // 竖向，头向上<br>        UIDeviceOrientationPortraitUpsideDown,  // 竖向，头向下<br>        UIDeviceOrientationLandscapeLeft,         // 横向，头向左<br>        UIDeviceOrientationLandscapeRight,       // 横向，头向右<br>        UIDeviceOrientationFaceUp,                   // 平放，屏幕朝下<br>        UIDeviceOrientationFaceDown                // 平放，屏幕朝下<br>    };</p>
<pre><code>typedef NS_ENUM(NSInteger, UIDeviceBatteryState) //电池状态
{
    UIDeviceBatteryStateUnknown,
    UIDeviceBatteryStateUnplugged,   // 未充电
    UIDeviceBatteryStateCharging,     // 正在充电
    UIDeviceBatteryStateFull,             // 满电
};

typedef NS_ENUM(NSInteger, UIUserInterfaceIdiom) //用户界面类型
{
    //iOS3.2以上有效
</code></pre><p>#if <strong>IPHONE_3_2 &lt;= </strong>IPHONE_OS_VERSION_MAX_ALLOWED<br>        UIUserInterfaceIdiomPhone,           // iPhone 和 iPod touch 风格<br>        UIUserInterfaceIdiomPad,              // iPad 风格</p>
<p>#endif<br>    };</p>
<p>#define UI_USER_INTERFACE_IDIOM() ([[UIDevice currentDevice] respondsToSelector:@selector(userInterfaceIdiom)] ? [[UIDevice currentDevice] userInterfaceIdiom] : UIUserInterfaceIdiomPhone)</p>
<p>#define UIDeviceOrientationIsPortrait(orientation)  ((orientation) == UIDeviceOrientationPortrait || (orientation) == UIDeviceOrientationPortraitUpsideDown)</p>
<p>#define UIDeviceOrientationIsLandscape(orientation) ((orientation) == UIDeviceOrientationLandscapeLeft || (orientation) == UIDeviceOrientationLandscapeRight)</p>
<pre><code>NS_CLASS_AVAILABLE_IOS(2_0) @interface UIDevice : NSObject {
@private
    NSInteger _numDeviceOrientationObservers;
    float    _batteryLevel;
    struct {
        unsigned int batteryMonitoringEnabled:1;
        unsigned int proximityMonitoringEnabled:1;
        unsigned int expectsFaceContactInLandscape:1;
        unsigned int orientation:3;
        unsigned int batteryState:2;
        unsigned int proximityState:1;
    } _deviceFlags;
}

+ (UIDevice *)currentDevice; // 获取当前设备

@property(nonatomic,readonly,retain) NSString    *name;                // e.g. &quot;My iPhone&quot;
@property(nonatomic,readonly,retain) NSString    *model;               // e.g. @&quot;iPhone&quot;, @&quot;iPod touch&quot;
@property(nonatomic,readonly,retain) NSString    *localizedModel;    // localized version of model
@property(nonatomic,readonly,retain) NSString    *systemName;      // e.g. @&quot;iOS&quot;
@property(nonatomic,readonly,retain) NSString    *systemVersion;    // e.g. @&quot;4.0&quot;
@property(nonatomic,readonly) UIDeviceOrientation orientation;       // 除非正在生成设备方向的通知，否则返回UIDeviceOrientationUnknown 。

@property(nonatomic,readonly,retain) NSUUID      *identifierForVendor NS_AVAILABLE_IOS(6_0);      // 可用于唯一标识该设备，同一供应商不同应用具有相同的UUID 。

@property(nonatomic,readonly,getter=isGeneratingDeviceOrientationNotifications) BOOL generatesDeviceOrientationNotifications; //是否生成设备转向通知
- (void)beginGeneratingDeviceOrientationNotifications;
- (void)endGeneratingDeviceOrientationNotifications;

@property(nonatomic,getter=isBatteryMonitoringEnabled) BOOL batteryMonitoringEnabled NS_AVAILABLE_IOS(3_0);  // 是否启动电池监控，默认为NO
@property(nonatomic,readonly) UIDeviceBatteryState batteryState NS_AVAILABLE_IOS(3_0);  // 如果禁用电池监控，则电池状态为UIDeviceBatteryStateUnknown
@property(nonatomic,readonly) float batteryLevel NS_AVAILABLE_IOS(3_0);  //电量百分比， 0 .. 1.0。如果电池状态为UIDeviceBatteryStateUnknown，则百分比为-1.0

@property(nonatomic,getter=isProximityMonitoringEnabled) BOOL proximityMonitoringEnabled NS_AVAILABLE_IOS(3_0); // 是否启动接近监控（例如接电话时脸靠近屏幕），默认为NO
@property(nonatomic,readonly)  BOOL proximityState NS_AVAILABLE_IOS(3_0);  // 如果设备不具备接近感应器，则总是返回NO

@property(nonatomic,readonly,getter=isMultitaskingSupported) BOOL multitaskingSupported NS_AVAILABLE_IOS(4_0); // 是否支持多任务

@property(nonatomic,readonly) UIUserInterfaceIdiom userInterfaceIdiom NS_AVAILABLE_IOS(3_2); // 当前用户界面模式

- (void)playInputClick NS_AVAILABLE_IOS(4_2);  // 播放一个输入的声音
@end

@protocol UIInputViewAudioFeedback
@optional
@property (nonatomic, readonly) BOOL enableInputClicksWhenVisible; // 实现该方法，返回YES则自定义的视图能够播放输入的声音
@end

UIKIT_EXTERN NSString *const UIDeviceOrientationDidChangeNotification; // 屏幕方向变化通知
UIKIT_EXTERN NSString *const UIDeviceBatteryStateDidChangeNotification   NS_AVAILABLE_IOS(3_0); // 电池状态变化通知
UIKIT_EXTERN NSString *const UIDeviceBatteryLevelDidChangeNotification   NS_AVAILABLE_IOS(3_0); // 电池电量变化通知
UIKIT_EXTERN NSString *const UIDeviceProximityStateDidChangeNotification NS_AVAILABLE_IOS(3_0); // 接近状态变化通知
</code></pre><p><code>`</code></p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIGestureRecognizerState]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIGestureRecognizerState/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">UIGestureRecognizerState</span>) &#123;</span><br><span class="line">    <span class="built_in">UIGestureRecognizerStatePossible</span>,   <span class="comment">// the recognizer has not yet recognized its gesture, but may be evaluating touch events. this is the default state</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">UIGestureRecognizerStateBegan</span>,      <span class="comment">// the recognizer has received touches recognized as the gesture. the action method will be called at the next turn of the run loop</span></span><br><span class="line">    <span class="built_in">UIGestureRecognizerStateChanged</span>,    <span class="comment">// the recognizer has received touches recognized as a change to the gesture. the action method will be called at the next turn of the run loop</span></span><br><span class="line">    <span class="built_in">UIGestureRecognizerStateEnded</span>,      <span class="comment">// the recognizer has received touches recognized as the end of the gesture. the action method will be called at the next turn of the run loop and the recognizer will be reset to UIGestureRecognizerStatePossible</span></span><br><span class="line">    <span class="built_in">UIGestureRecognizerStateCancelled</span>,  <span class="comment">// the recognizer has received touches resulting in the cancellation of the gesture. the action method will be called at the next turn of the run loop. the recognizer will be reset to UIGestureRecognizerStatePossible</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">UIGestureRecognizerStateFailed</span>,     <span class="comment">// the recognizer has received a touch sequence that can not be recognized as the gesture. the action method will not be called and the recognizer will be reset to UIGestureRecognizerStatePossible</span></span><br><span class="line">   </span><br><span class="line">    <span class="comment">// Discrete Gestures – gesture recognizers that recognize a discrete event but do not report changes (for example, a tap) do not transition through the Began and Changed states and can not fail or be cancelled</span></span><br><span class="line">    <span class="built_in">UIGestureRecognizerStateRecognized</span> = <span class="built_in">UIGestureRecognizerStateEnded</span> <span class="comment">// the recognizer has received touches recognized as the gesture. the action method will be called at the next turn of the run loop and the recognizer will be reset to UIGestureRecognizerStatePossible</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Possible: 识别器在未识别出它的手势，但可能会接收到触摸时处于这个状态。这是默认状态。</span><br><span class="line">Began: 识别器接收到触摸并识别出是它的手势时处于这个状态。响应方法将在下个循环步骤中被调用。</span><br><span class="line"></span><br><span class="line">Changed:the recognizer has received touches recognized as a change to the gesture. （不懂怎么翻译，理解上就是识别器识别出一个变化为它的手势的触摸），响应方法将在下个循环步骤中被调用。</span><br><span class="line"></span><br><span class="line">Ended:识别器在识别到作为当前手势结束信号的触摸时处于这个状态。响应方法将在下个循环步骤中被调用 并且 识别器将重置为possible状态。</span><br><span class="line"></span><br><span class="line">Cancelled:识别器处于取消状态.响应方法将在下个循环步骤中被调用 并且 识别器将重置为possible状态。</span><br><span class="line"></span><br><span class="line">Failed: 识别器接收到不能识别为它的手势的一系列触摸。响应方法不会被调用 并且 识别器将重置为possible状态。</span><br><span class="line"></span><br><span class="line">Recognized: 识别器已识别到它的手势。响应方法将在下个循环步骤中被调用 并且 识别器将重置为possible状态。</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIDatePicker]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIDatePicker/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.datePicker = [[<span class="built_in">UIDatePicker</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">200</span>, <span class="number">375</span>, <span class="number">267</span>)];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.datePicker.backgroundColor = [<span class="built_in">UIColor</span> whiteColor];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置地区</span></span><br><span class="line">    <span class="keyword">self</span>.datePicker.locale = [[<span class="built_in">NSLocale</span> alloc]initWithLocaleIdentifier:<span class="string">@"zh_CN"</span>];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置DatePicker的日历，默认为当天。</span></span><br><span class="line">    <span class="keyword">self</span>.datePicker.calendar = [<span class="built_in">NSCalendar</span> currentCalendar];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置时区</span></span><br><span class="line">    <span class="keyword">self</span>.datePicker.timeZone = [<span class="built_in">NSTimeZone</span> defaultTimeZone];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//选择时区</span></span><br><span class="line"><span class="comment">//    [self.datePicker setTimeZone:[NSTimeZone timeZoneWithName:@"GMT+8"]];</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 设置当前显示时间</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSDate</span> *currentTime  = [<span class="built_in">NSDate</span> date];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.datePicker.date = currentTime;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 设置显示最大时间</span></span><br><span class="line">   </span><br><span class="line">   <span class="keyword">self</span>.datePicker.maximumDate = currentTime;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 显示模式</span></span><br><span class="line">    [<span class="keyword">self</span>.datePicker setDatePickerMode:<span class="built_in">UIDatePickerModeDate</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//倒计时按秒显示</span></span><br><span class="line">    <span class="keyword">self</span>.datePicker.countDownDuration = <span class="number">600</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置分钟间隔</span></span><br><span class="line">    <span class="keyword">self</span>.datePicker.minuteInterval = <span class="number">10</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 回调的方法</span></span><br><span class="line">    [<span class="keyword">self</span>.datePicker addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(datePickerValueChanged:) forControlEvents:<span class="built_in">UIControlEventValueChanged</span>];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:<span class="keyword">self</span>.datePicker];</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">-(<span class="keyword">void</span>)datePickerValueChanged:(<span class="keyword">id</span>)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSDate</span> *selected = [<span class="built_in">NSDate</span> date];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"date: %@"</span>, selected);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UINavigationController]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UINavigationController/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">属性 ：</span><br><span class="line">viewControllers属性:         存储了栈中的所有被管理的控制器</span><br><span class="line">navigationController属性:  父类中的属性，每个在栈中的控制器，都能    通过此属性，获取自己所在的<span class="built_in">UINavigationController</span>对象。</span><br><span class="line">     <span class="comment">/***********创建导航控制器***********************/</span></span><br><span class="line">RootViewController *rootVC = [[RootViewControlleralloc]init];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建一个导航控制器</span></span><br><span class="line">    <span class="built_in">UINavigationController</span> *naVC = [[<span class="built_in">UINavigationController</span> alloc]initWithRootViewController:rootVC];</span><br><span class="line">    [rootVC release];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//指定导航控制器为window的根视图</span></span><br><span class="line">    <span class="keyword">self</span>.window.rootViewController = naVC;</span><br><span class="line">    [naVC release];</span><br><span class="line">    <span class="comment">/*****************************************************/</span>    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/****************设置导航栏外观***********************/</span></span><br><span class="line">    <span class="comment">//导航栏背景颜色</span></span><br><span class="line">    naVC.navigationBar.barTintColor = [<span class="built_in">UIColor</span> purpleColor];</span><br><span class="line">    <span class="comment">//设置导航栏不显示半透明效果</span></span><br><span class="line">    naVC.navigationBar.translucent = <span class="literal">NO</span>;</span><br><span class="line">    <span class="comment">//将导航栏隐藏</span></span><br><span class="line">    naVC.navigationBar.hidden = <span class="literal">NO</span>;</span><br><span class="line">    <span class="comment">//设置背景图片</span></span><br><span class="line">    <span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"bk.png"</span>];</span><br><span class="line">    [naVC.navigationBar setBackgroundImage:image forBarMetrics:<span class="built_in">UIBarMetricsDefault</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     <span class="comment">/****************设置导航栏内容***********************/</span></span><br><span class="line">    <span class="comment">//设置导航栏上的内容：navigationItem</span></span><br><span class="line">    <span class="comment">//title</span></span><br><span class="line">    <span class="keyword">self</span>.navigationItem.title = <span class="string">@"第二页"</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//titleView</span></span><br><span class="line">    <span class="built_in">UISegmentedControl</span> *segmentC = [[<span class="built_in">UISegmentedControl</span> alloc]initWithItems:[<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"消息"</span>,<span class="string">@"通话"</span>, <span class="literal">nil</span>]];</span><br><span class="line">   </span><br><span class="line">    [segmentC addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(segmentAction:) forControlEvents:<span class="built_in">UIControlEventEditingChanged</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">self</span>.navigationItem.titleView = segmentC;</span><br><span class="line">    [segmentC release];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置自定义内容放在左侧</span></span><br><span class="line">    <span class="built_in">UITextField</span> *textf = [[<span class="built_in">UITextField</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">40</span>)];</span><br><span class="line">    textf.backgroundColor = [<span class="built_in">UIColor</span> yellowColor];</span><br><span class="line">    <span class="keyword">self</span>.navigationItem.rightBarButtonItem = [[<span class="built_in">UIBarButtonItem</span> alloc]initWithCustomView:textf];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     <span class="comment">//自定义导航栏左侧按钮</span></span><br><span class="line">    <span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"1.png"</span>];</span><br><span class="line">    <span class="comment">//取消渲染</span></span><br><span class="line">    image = [image imageWithRenderingMode:<span class="built_in">UIImageRenderingModeAlwaysOriginal</span>];</span><br><span class="line">    <span class="keyword">self</span>.navigationItem.leftBarButtonItem = [[<span class="built_in">UIBarButtonItem</span> alloc]initWithImage:image style:<span class="built_in">UIBarButtonItemStylePlain</span> target:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(leftBarAction:)]autorelease];</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)leftBarAction:(<span class="built_in">UIBarButtonItem</span> *)barItem</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span>.navigationController popViewControllerAnimated:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自定义导航栏右侧按钮为可以编辑Edit</span></span><br><span class="line">    <span class="keyword">self</span>.navigationItem.rightBarButtonItem = <span class="keyword">self</span>.editButtonItem;</span><br><span class="line"></span><br><span class="line"><span class="comment">/****************编辑***********************/</span></span><br><span class="line"><span class="comment">//重写系统编辑按钮触发的方法</span></span><br><span class="line">-(<span class="keyword">void</span>)setEditing:(<span class="built_in">BOOL</span>)editing animated:(<span class="built_in">BOOL</span>)animated</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> setEditing:editing animated:animated];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//通过系统编辑按钮控制tableview的编辑状态</span></span><br><span class="line">    [<span class="keyword">self</span>.tableView setEditing:editing animated:animated];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//隐藏导航栏返回按钮</span></span><br><span class="line">    <span class="keyword">self</span>.navigationItem.hidesBackButton =<span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自定义导航栏右侧按钮</span></span><br><span class="line">    <span class="keyword">self</span>.navigationItem.rightBarButtonItem = [[[<span class="built_in">UIBarButtonItem</span> alloc]initWithTitle:<span class="string">@"下一页"</span> style:<span class="built_in">UIBarButtonItemStylePlain</span> target:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(rightBarAction:)]autorelease];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)rightBarAction:(<span class="built_in">UIBarButtonItem</span> *)barItem</span><br><span class="line">&#123;</span><br><span class="line">    SecondViewController *sVC = [[SecondViewController alloc]init];</span><br><span class="line">    [<span class="keyword">self</span>.navigationController pushViewController:sVC animated:<span class="literal">YES</span>];</span><br><span class="line">     [sVC release]; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*****************************************************/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/****************跳转页面的方法***********************/</span></span><br><span class="line">pushViewController:animated    <span class="comment">//进入下一个视图控制器</span></span><br><span class="line">popViewControllerAnimated:      <span class="comment">//返回上一个视图控制器</span></span><br><span class="line">popToViewController:animated   <span class="comment">//返回到指定的视图控制器</span></span><br><span class="line">popToRootViewControllerAnimated   <span class="comment">//返回到根视图控制器</span></span><br><span class="line">    <span class="comment">//进入下一页</span></span><br><span class="line">    SecondViewController *secondVC = [[SecondViewController alloc]init];</span><br><span class="line">   </span><br><span class="line">    [<span class="keyword">self</span>.navigationController pushViewController:secondVC animated:<span class="literal">YES</span>];</span><br><span class="line"></span><br><span class="line">   <span class="comment">//返回上一页</span></span><br><span class="line">    [<span class="keyword">self</span>.navigationController popViewControllerAnimated:<span class="literal">YES</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//跳到根页面</span></span><br><span class="line">    [<span class="keyword">self</span>.navigationController popToRootViewControllerAnimated:<span class="literal">YES</span>];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   <span class="comment">//跳到指定页面</span></span><br><span class="line">    <span class="built_in">UIViewController</span> *vc =</span><br><span class="line">    [<span class="keyword">self</span>.navigationController.viewControllers objectAtIndex:<span class="number">0</span>];</span><br><span class="line"> </span><br><span class="line">    [<span class="keyword">self</span>.navigationController popToViewController:vc animated:<span class="literal">YES</span>];</span><br><span class="line"><span class="comment">/*****************************************************/</span></span><br><span class="line"></span><br><span class="line">自定义导航栏左侧按钮后恢复右拉返回功能</span><br><span class="line"><span class="keyword">self</span>.navigationController.interactivePopGestureRecognizer.delegate=(<span class="keyword">id</span>)<span class="keyword">self</span>;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIImagePickerController从本地相册加载图片]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIImagePickerController%E4%BB%8E%E6%9C%AC%E5%9C%B0%E7%9B%B8%E5%86%8C%E5%8A%A0%E8%BD%BD%E5%9B%BE%E7%89%87/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>/*1.签两个协议协议<br>          UIImagePickerControllerDelegate<br>          UINavigationControllerDelegate<br>  2.两个方法</p>
<p>方法一：<br>//点击按钮触发的方法<br>-(void)buttonAction:(UIButton*)button<br>{</p>
<pre><code>//创建获取本地相册控制器对象
UIImagePickerController *picker = [[UIImagePickerControlleralloc]init];

//成为代理
picker.delegate= self;

//设置相片来源类型
picker.sourceType=UIImagePickerControllerSourceTypePhotoLibrary;

//是否可以编辑
picker.allowsEditing= YES;

//模态显示本地相册
[selfpresentViewController:pickeranimated:YEScompletion:^{


}]; 
</code></pre><p>}</p>
<p>方法二：<br>//当用户选择相册中的某个图片时触发的方法,协议里的方法<br>//该方法可以获取到选中的图片</p>
<ul>
<li><p>(void)imagePickerController:(UIImagePickerController<em>)picker didFinishPickingMediaWithInfo:(NSDictionary</em>)info<br>{</p>
<p>  NSLog(@”info = %@”,info);<br>  UIImage <em>image=<br>  [info objectForKey:@”UIImagePickerControllerOriginalImage”];<br>  //通过tag值取对象<br>  UIButton </em>button = (UIButton*)[self.viewviewWithTag:10000];<br>  [button setBackgroundImage:imageforState:UIControlStateNormal];</p>
<p>  //让相册模态消失<br>  [picker dismissViewControllerAnimated:YEScompletion:^{</p>
</li>
</ul>
<pre><code>}];
</code></pre><p>}<br>数据来源类型一共有三种：<br>enum {<br>   UIImagePickerControllerSourceTypePhotoLibrary ,//来自图库<br>   UIImagePickerControllerSourceTypeCamera ,//来自相机<br>   UIImagePickerControllerSourceTypeSavedPhotosAlbum //来自相册<br>};<br>在用这些来源的时候最好检测以下设备是否支持；<br> if([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera])<br>    {<br>        NSLog(@”支持相机”);<br>    }<br>    if([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypePhotoLibrary])<br>    {<br>        NSLog(@”支持图库”);<br>    }<br>    if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeSavedPhotosAlbum])<br>    {<br>        NSLog(@”支持相片库”);<br>    }</p>
<p>调用摄像头来获取资源</p>
<ul>
<li>(void)viewDidLoad {<br>  [super viewDidLoad];<br>  picker = [[UIImagePickerController alloc]init];<br>  picker.view.backgroundColor = [UIColor orangeColor];<br>  UIImagePickerControllerSourceType sourcheType = UIImagePickerControllerSourceTypeCamera;<br>  picker.sourceType = sourcheType;<br>  picker.delegate = self;<br>  picker.allowsEditing = YES;<br>}</li>
</ul>
<p><code>`</code></p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIPageControl]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIPageControl/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/*****************创建UIPageControl*********************/</span></span><br><span class="line">    <span class="comment">//创建UIPageControl</span></span><br><span class="line">   <span class="keyword">self</span>.pageC= [[<span class="built_in">UIPageControlalloc</span>]initWithFrame:<span class="built_in">CGRectMake</span>((WIDTH<span class="number">-300</span>)/<span class="number">2</span>,HEIGHT<span class="number">-60</span>,<span class="number">300</span>,<span class="number">50</span>)];</span><br><span class="line">    [<span class="keyword">self</span>.viewaddSubview:<span class="keyword">self</span>.pageC];</span><br><span class="line">    [<span class="keyword">self</span>.pageCrelease];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置页数</span></span><br><span class="line">   <span class="keyword">self</span>.pageC.numberOfPages =<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//设置当前页码的颜色</span></span><br><span class="line">   <span class="keyword">self</span>.pageC.currentPageIndicatorTintColor = [<span class="built_in">UIColoryellowColor</span>];</span><br><span class="line"></span><br><span class="line">   <span class="comment">//设置所有页的颜色</span></span><br><span class="line">    <span class="keyword">self</span>.pageC.pageIndicatorTintColor= [<span class="built_in">UIColorredColor</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//核心方法</span></span><br><span class="line">    [<span class="keyword">self</span>.pageCaddTarget:selfaction:<span class="keyword">@selector</span>(pageAction:)forControlEvents:<span class="built_in">UIControlEventValueChanged</span>];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.scroll.delegate= <span class="keyword">self</span>;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)pageAction:(<span class="built_in">UIPageControl</span>*)pageC</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//打印当前页码</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"切换页码= %ld "</span>,(<span class="keyword">long</span>)pageC.currentPage);</span><br><span class="line">   </span><br><span class="line">  <span class="comment">//页面跟着page的点动</span></span><br><span class="line">    [<span class="keyword">self</span>.scrollsetContentOffset:<span class="built_in">CGPointMake</span>(<span class="number">375</span>*<span class="keyword">self</span>.pageC.currentPage,<span class="number">0</span>)animated:<span class="literal">YES</span>];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line">   <span class="comment">/*****************************************************/</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIProgressView进度条]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIProgressView%E8%BF%9B%E5%BA%A6%E6%9D%A1/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">//创建</span></span><br><span class="line">    <span class="built_in">UIProgressView</span> *progressView = [[<span class="built_in">UIProgressView</span> alloc]initWithProgressViewStyle:<span class="built_in">UIProgressViewStyleBar</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:progressView];</span><br><span class="line">    [progressView release];</span><br><span class="line">   </span><br><span class="line">    progressView.frame = <span class="built_in">CGRectMake</span>(<span class="number">20</span>, <span class="number">100</span>, <span class="number">300</span>, <span class="number">10</span>);</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//属性progress决定值的大小</span></span><br><span class="line">    <span class="comment">//设置初始值</span></span><br><span class="line">    progressView.progress = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//利用NSTimer</span></span><br><span class="line">     <span class="comment">//创建NSTimer</span></span><br><span class="line">    <span class="built_in">NSTimer</span> *timer = [<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">0.1</span> target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(timerAction:) userInfo:<span class="literal">nil</span> repeats:<span class="literal">YES</span>];</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)timerAction:(<span class="built_in">NSTimer</span> *)timer</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.progressView.progress &lt; <span class="number">1</span>) &#123;</span><br><span class="line">         <span class="keyword">self</span>.progressView.progress += <span class="number">0.01</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UISlider滑条]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UISlider%E6%BB%91%E6%9D%A1/</url>
      <content type="html"><![CDATA[<p>UIDevice提供了多种属性、类函数及状态通知，帮助我们全方位了解设备状况。从检测电池电量到定位设备与临近感应，UIDevice所做的工作就是为应用程序提供用户及设备的一些信息。UIDevice类还能够收集关于设备的各种具体细节，例如机型及iOS版本等。其中大部分属性都对开发工作具有积极的辅助作用。下面的代码简单的使用UIDevice获取手机属性。<br><a id="more"></a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UISlider</span>*slider = [[<span class="built_in">UISlideralloc</span>]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">80</span>,<span class="number">400</span>,<span class="number">200</span>,<span class="number">40</span>)];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:slider];</span><br><span class="line">    [slider release];</span><br><span class="line">    slider.backgroundColor = [<span class="built_in">UIColor</span> lightGrayColor];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//最小滑条颜色</span></span><br><span class="line">    slider.minimumTrackTintColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">    <span class="comment">//最大滑条颜色</span></span><br><span class="line">    slider.maximumTrackTintColor = [<span class="built_in">UIColor</span> greenColor];</span><br><span class="line">    <span class="comment">//设置滑块最小值</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置滑块最大值</span></span><br><span class="line">    slider.maximumValue = <span class="number">10</span>;</span><br><span class="line">    <span class="comment">//默认的值</span></span><br><span class="line">    slider.value = <span class="number">5</span>;</span><br><span class="line">    <span class="comment">//核心方法</span></span><br><span class="line">    [slider addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(sliderAction:) forControlEvents:<span class="built_in">UIControlEventValueChanged</span>];</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)sliderAction:(<span class="built_in">UISlider</span> *)slider</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"value = %f"</span>,slider.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UITextView]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UITextView/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="keyword">self</span>.view.backgroundColor = [<span class="built_in">UIColor</span> whiteColor];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView = [[<span class="built_in">UITextView</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">667</span><span class="number">-80</span>, <span class="number">375</span>, <span class="number">80</span>)];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.delegate = <span class="keyword">self</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.font = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">20</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.textColor = [<span class="built_in">UIColor</span> blackColor];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.contentInset = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);<span class="comment">//添加滚动区域</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.textView.text = <span class="string">@"习大大"</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.scrollEnabled = <span class="literal">YES</span>;<span class="comment">//是否可滚动</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.textView.editable = <span class="literal">YES</span>;<span class="comment">//是否可编辑</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.returnKeyType = <span class="built_in">UIReturnKeyDefault</span>;<span class="comment">//返回键的类型</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.keyboardType = <span class="built_in">UIKeyboardTypeDefault</span>;<span class="comment">//键盘类型</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.scrollEnabled = <span class="literal">YES</span>;<span class="comment">//是否可以拖动</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.autoresizingMask = <span class="built_in">UIViewAutoresizingFlexibleHeight</span>;<span class="comment">//自适应高度</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.layer.cornerRadius = <span class="number">8</span>; <span class="comment">//边框设置为圆角</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.textView.layer.borderWidth = <span class="number">1</span>;</span><br><span class="line">   </span><br><span class="line"><span class="comment">//    设置边框颜色 参数2是一个数组 分别为三基色和alpha分量；</span></span><br><span class="line">    <span class="built_in">CGFloat</span> color[]=&#123;<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">self</span>.textView.layer.borderColor = <span class="built_in">CGColorCreate</span>(<span class="built_in">CGColorSpaceCreateDeviceRGB</span>(),color);</span><br><span class="line">    <span class="keyword">self</span>.textView.layer.masksToBounds = <span class="literal">YES</span>;</span><br><span class="line">   </span><br><span class="line"><span class="comment">//    [self.textView becomeFirstResponder];//获得焦点 程序运行就获取光标</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.myView = [[<span class="built_in">UIView</span> alloc]initWithFrame:[[<span class="built_in">UIScreen</span> mainScreen]bounds]];</span><br><span class="line">    <span class="keyword">self</span>.myView.tag = <span class="number">1000</span>;</span><br><span class="line">   </span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:<span class="keyword">self</span>.myView];</span><br><span class="line">   </span><br><span class="line">    [<span class="keyword">self</span>.myView addSubview:<span class="keyword">self</span>.textView];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//注册通知,监听键盘弹出事件</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(keyboardDidShow:) name:<span class="built_in">UIKeyboardDidShowNotification</span> object:<span class="literal">nil</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//注册通知,监听键盘消失事件</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(keyboardDidHidden) name:<span class="built_in">UIKeyboardDidHideNotification</span> object:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将要开始编辑</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)textViewShouldBeginEditing:(<span class="built_in">UITextView</span> *)textView&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将要结束编辑</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)textViewShouldEndEditing:(<span class="built_in">UITextView</span> *)textView&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//开始编辑</span></span><br><span class="line">- (<span class="keyword">void</span>)textViewDidBeginEditing:(<span class="built_in">UITextView</span> *)textView&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//结束编辑</span></span><br><span class="line">- (<span class="keyword">void</span>)textViewDidEndEditing:(<span class="built_in">UITextView</span> *)textView&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//焦点发生改变</span></span><br><span class="line">- (<span class="keyword">void</span>)textViewDidChangeSelection:(<span class="built_in">UITextView</span> *)textView&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//内容发生改变编辑</span></span><br><span class="line">- (<span class="keyword">void</span>)textViewDidChange:(<span class="built_in">UITextView</span> *)textView&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//内容将要发生改变编辑</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//控制输入文字的长度和内容，可通调用以下代理方法实现</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)textView:(<span class="built_in">UITextView</span> *)textView shouldChangeTextInRange:(<span class="built_in">NSRange</span>)range replacementText:(<span class="built_in">NSString</span> *)text&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> (range.location&gt;=<span class="number">100</span>)&#123;</span><br><span class="line">        <span class="comment">//控制输入文本的长度</span></span><br><span class="line">        <span class="keyword">return</span>  <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ([text isEqualToString:<span class="string">@"\n"</span>]) &#123;</span><br><span class="line">        <span class="comment">//禁止输入换行</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 键盘弹出时</span></span><br><span class="line">-(<span class="keyword">void</span>)keyboardDidShow:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//获取键盘高度</span></span><br><span class="line">    <span class="built_in">NSValue</span> *keyboardObject = [[notification userInfo] objectForKey:<span class="built_in">UIKeyboardFrameEndUserInfoKey</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="built_in">CGRect</span> keyboardRect;</span><br><span class="line">   </span><br><span class="line">    [keyboardObject getValue:&amp;keyboardRect];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//调整放置有textView的view的位置</span></span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置动画</span></span><br><span class="line">    [<span class="built_in">UIView</span> beginAnimations:<span class="literal">nil</span> context:<span class="literal">nil</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//定义动画时间</span></span><br><span class="line">    [<span class="built_in">UIView</span> setAnimationDuration:kAnimationDuration];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置view的frame，往上平移</span></span><br><span class="line">    [(<span class="built_in">UIView</span> *)[<span class="keyword">self</span>.view viewWithTag:<span class="number">1000</span>] setFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="keyword">self</span>.view.frame.size.height-keyboardRect.size.height-kViewHeight, <span class="number">375</span>, kViewHeight)];</span><br><span class="line">   </span><br><span class="line">    [<span class="built_in">UIView</span> commitAnimations];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//键盘消失时</span></span><br><span class="line">-(<span class="keyword">void</span>)keyboardDidHidden</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//定义动画</span></span><br><span class="line">    [<span class="built_in">UIView</span> beginAnimations:<span class="literal">nil</span> context:<span class="literal">nil</span>];</span><br><span class="line">    [<span class="built_in">UIView</span> setAnimationDuration:kAnimationDuration];</span><br><span class="line">    <span class="comment">//设置view的frame，往下平移</span></span><br><span class="line">    [(<span class="built_in">UIView</span> *)[<span class="keyword">self</span>.view viewWithTag:<span class="number">1000</span>] setFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="keyword">self</span>.view.frame.size.height-kViewHeight, <span class="number">375</span>, kViewHeight)];</span><br><span class="line">    [<span class="built_in">UIView</span> commitAnimations];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event&#123;</span><br><span class="line">   </span><br><span class="line">    [<span class="keyword">self</span>.textView resignFirstResponder];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UITextField]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UITextField/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">//创建 </span></span><br><span class="line">     <span class="built_in">UITextField</span>*textfield = [[<span class="built_in">UITextField</span>             alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">20</span>,<span class="number">20</span>,<span class="number">200</span>,<span class="number">40</span>)];</span><br><span class="line">    [<span class="keyword">self</span>.window addSubview:<span class="keyword">self</span>.myTextField];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置背景颜色</span></span><br><span class="line">    <span class="keyword">self</span>.myTextField.backgroundColor = [<span class="built_in">UIColor</span> clearColor];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置输入框样式</span></span><br><span class="line">    <span class="keyword">self</span>.myTextField.borderStyle = <span class="built_in">UITextBorderStyleRoundedRect</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//密文输入</span></span><br><span class="line">    <span class="keyword">self</span>.myTextField.secureTextEntry = <span class="literal">YES</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置占位提示符</span></span><br><span class="line">    <span class="keyword">self</span>.myTextField.placeholder = <span class="string">@"请输入"</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置输入框删除按钮</span></span><br><span class="line">    <span class="keyword">self</span>.myTextField.clearButtonMode = <span class="built_in">UITextFieldViewModeAlways</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置键盘类型</span></span><br><span class="line">    <span class="keyword">self</span>.myTextField.keyboardType = <span class="built_in">UIKeyboardTypeNumberPad</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/******按按钮键盘隐藏*********************************/</span></span><br><span class="line">  <span class="comment">//创建按钮</span></span><br><span class="line">    <span class="built_in">UIButton</span> *Button = [<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeCustom</span>];</span><br><span class="line">    [<span class="keyword">self</span>.window addSubview:Button];</span><br><span class="line">    Button.frame = <span class="built_in">CGRectMake</span>(<span class="number">20</span>, <span class="number">80</span>, <span class="number">100</span>, <span class="number">30</span>);</span><br><span class="line">    Button.backgroundColor = [<span class="built_in">UIColor</span> cyanColor];</span><br><span class="line"></span><br><span class="line">    [Button addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(buttonAction:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>) buttonAction:(<span class="built_in">UIButton</span> *)b</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span>.myTextField resignFirstResponder];</span><br><span class="line">    <span class="comment">//取消第一响应者</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/******************************************************/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/******按return键盘隐藏*********************************/</span></span><br><span class="line"><span class="number">1.</span>签<span class="built_in">UITextFieldDelegate</span>协议</span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AppDelegate</span> : <span class="title">UIResponder</span> &lt;<span class="title">UIApplicationDelegate</span>,<span class="title">UITextFieldDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>成为代理人</span><br><span class="line">哪个输入框成为代理人哪个输入框有此功能</span><br><span class="line"> <span class="keyword">self</span>.myTextField.delegate = <span class="keyword">self</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>实现协议里的方法</span><br><span class="line"><span class="comment">//点击return建的时候被触发</span></span><br><span class="line">通用，一个就可以给所有输入框用</span><br><span class="line">- (<span class="built_in">BOOL</span>)textFieldShouldReturn:(<span class="built_in">UITextField</span> *)textField</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span>.myTextField resignFirstResponder];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/******************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/******按空白处键盘隐藏*********************************/</span></span><br><span class="line"> <span class="comment">//按空白处键盘回收</span></span><br><span class="line">    <span class="built_in">UITapGestureRecognizer</span> *tap = [[<span class="built_in">UITapGestureRecognizer</span> alloc]initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(backgroundTap:)];</span><br><span class="line">    [<span class="keyword">self</span>.view addGestureRecognizer:tap];</span><br><span class="line"></span><br><span class="line"><span class="comment">//按空白处键盘回收调用的方法</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)backgroundTap:(<span class="keyword">id</span>)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span>.studentDetailV.tf1  resignFirstResponder];</span><br><span class="line">    [<span class="keyword">self</span>.studentDetailV.tf2  resignFirstResponder];</span><br><span class="line">    [<span class="keyword">self</span>.studentDetailV.tf3  resignFirstResponder];</span><br><span class="line">    [<span class="keyword">self</span>.studentDetailV.tf4  resignFirstResponder];</span><br><span class="line">    [<span class="keyword">self</span>.studentDetailV.tf5  resignFirstResponder];</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/******************************************************/</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIWebView]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIWebView/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">retain</span>)<span class="built_in">UIWebView</span> *webView;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建</span></span><br><span class="line">    <span class="keyword">self</span>.webView = [[<span class="built_in">UIWebViewalloc</span>]initWithFrame:[[<span class="built_in">UIScreenmainScreen</span>] bounds]];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:<span class="keyword">self</span>.webView];</span><br><span class="line"></span><br><span class="line">   <span class="comment">//要前往的URL</span></span><br><span class="line">   <span class="built_in">NSString</span> *str = <span class="string">@"http://www.youku.com"</span>;</span><br><span class="line">    <span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:str];</span><br><span class="line">    <span class="built_in">NSURLRequest</span> *request = [<span class="built_in">NSURLRequest</span> requestWithURL:url];</span><br><span class="line">    [<span class="keyword">self</span>.webView loadRequest:request];</span><br><span class="line"></span><br><span class="line">   <span class="comment">//成为代理</span></span><br><span class="line">    <span class="keyword">self</span>.webView.delegate = <span class="keyword">self</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//自定义导航栏左右按钮</span></span><br><span class="line">    <span class="keyword">self</span>.navigationItem.leftBarButtonItem = [[<span class="built_in">UIBarButtonItem</span> alloc]initWithTitle:<span class="string">@"后退"</span> style:<span class="built_in">UIBarButtonItemStylePlain</span> target:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(leftAction)];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">self</span>.navigationItem.rightBarButtonItem = [[<span class="built_in">UIBarButtonItem</span> alloc]initWithTitle:<span class="string">@"前进"</span> style:<span class="built_in">UIBarButtonItemStylePlain</span> target:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(rightAction)];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="built_in">UITextField</span> *textf = [[<span class="built_in">UITextField</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">150</span>, <span class="number">30</span>)];</span><br><span class="line">    textf.borderStyle = <span class="built_in">UITextBorderStyleRoundedRect</span>;</span><br><span class="line">    textf.clearButtonMode = <span class="built_in">UITextFieldViewModeAlways</span>;</span><br><span class="line">    <span class="keyword">self</span>.navigationItem.titleView = textf;</span><br><span class="line">    textf.delegate = <span class="keyword">self</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//后退</span></span><br><span class="line">-(<span class="keyword">void</span>)leftAction</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span>.webView goBack];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//前进</span></span><br><span class="line">-(<span class="keyword">void</span>)rightAction</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span>.webView goForward];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">UITextFieldDelegate</span>协议方法</span><br><span class="line">-(<span class="built_in">BOOL</span>)textFieldShouldReturn:(<span class="built_in">UITextField</span> *)textField</span><br><span class="line">&#123;</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> ([textField.text hasPrefix:<span class="string">@"http://www."</span>]) &#123;</span><br><span class="line">       </span><br><span class="line">        <span class="built_in">NSURLRequest</span> *request = [<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:textField.text]];</span><br><span class="line">        [<span class="keyword">self</span>.webView loadRequest:request];</span><br><span class="line">       </span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSString</span> *str = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"http://www.%@"</span>,textField.text];</span><br><span class="line">        <span class="built_in">NSURLRequest</span> *request = [<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:str]];</span><br><span class="line">        [<span class="keyword">self</span>.webView loadRequest:request];</span><br><span class="line">    &#125;</span><br><span class="line">    [textField resignFirstResponder];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIWindow.h详解]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIWindow.h%E8%AF%A6%E8%A7%A3/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;//基础框架入口</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;CoreGraphics/CoreGraphics.h&gt;//绘图入口</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIView.h&gt;//视图对象</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIApplication.h&gt;//提供iOS程序运行期的协作和控制</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKitDefines.h&gt;//一些宏定义</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">CGFloat</span> <span class="built_in">UIWindowLevel</span>;<span class="comment">//32位则为float | 64位为double</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  UIEvent 触摸事件，运动事件</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  UIScreen 屏幕处理</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  NSUndoManager  记录撤销，修改操作的消息</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  UIViewController 视图控制器</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">UIEvent</span>,<span class="title">UIScreen</span>, <span class="title">NSUndoManager</span>,<span class="title">UIViewController</span>;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_CLASS_AVAILABLE_IOS</span>(<span class="number">2</span>_0)<span class="class"><span class="keyword">@interface</span> <span class="title">UIWindow</span> :<span class="title">UIView</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)<span class="built_in">UIScreen</span> *screen; </span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>)<span class="built_in">UIWindowLevel</span> windowLevel;            </span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">getter</span>=isKeyWindow) </span><br><span class="line"></span><br><span class="line"><span class="built_in">BOOL</span> keyWindow;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)becomeKeyWindow;                               </span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)resignKeyWindow;                               </span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)makeKeyWindow;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)makeKeyAndVisible;                             </span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nullable</span>,<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)<span class="built_in">UIViewController</span> *rootViewController <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">4</span>_0);  <span class="comment">// default is nil</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> 事件拦截分发到指定视图对象</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> 当用户发起一个事件，比如触摸屏幕或者晃动设备，系统产生一个事件，同时投递给UIApplication，而UIApplication则将这个事件传递给特定</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> UIWindow进行处理(正常情况都一个程序都只有一个UIWindow)，然后由UIWindow将这个事件传递给特定的对象(即first responder)并通过响应链</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> 进行处理。虽然都是通过响应链对事件进行处理，但是触摸事件和运动事件在处理上有着明显的不同(主要体现在确定哪个对象才是他们的first</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> responder)：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)sendEvent:(<span class="built_in">UIEvent</span> *)event; </span><br><span class="line"></span><br><span class="line">                   </span><br><span class="line"></span><br><span class="line"><span class="comment">//窗口坐标系统转化</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGPoint</span>)convertPoint:(<span class="built_in">CGPoint</span>)point toWindow:(nullableUIWindow *)window;<span class="comment">//转化当前窗口一个坐标相对另外一个窗口的坐标</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGPoint</span>)convertPoint:(<span class="built_in">CGPoint</span>)point fromWindow:(nullableUIWindow *)window;<span class="comment">//转化另外窗口一个坐标相对于当前窗口的坐标</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGRect</span>)convertRect:(<span class="built_in">CGRect</span>)rect toWindow:(nullableUIWindow *)window;<span class="comment">//转化当前窗口一个矩形坐标相对另外一个窗口的坐标</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGRect</span>)convertRect:(<span class="built_in">CGRect</span>)rect fromWindow:(nullableUIWindow *)window;<span class="comment">//转化另外窗口一个矩形坐标相对于当前窗口的坐标</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> constUIWindowLevel <span class="built_in">UIWindowLevelNormal</span>;<span class="comment">//默认等级</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> constUIWindowLevel <span class="built_in">UIWindowLevelAlert</span>;<span class="comment">//UIAlert等级</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> constUIWindowLevel <span class="built_in">UIWindowLevelStatusBar</span>;<span class="comment">//状态栏等级</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIWindowDidBecomeVisibleNotification</span>;<span class="comment">// nil 通知对象窗口为可见</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIWindowDidBecomeHiddenNotification</span>; <span class="comment">// nil 通知对象窗口为隐藏</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIWindowDidBecomeKeyNotification</span>;    <span class="comment">// nil 通知对象窗口为重要</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIWindowDidResignKeyNotification</span>;    <span class="comment">// nil 通知对象窗口取消主窗</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//当键盘显示或消失时，系统会发送相关的通知:</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardWillShowNotification</span>;<span class="comment">//通知键盘对象视图即将加载</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardDidShowNotification</span>;<span class="comment">//通知键盘对象视图完全加载</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardWillHideNotification</span>;<span class="comment">//通知键盘对象视图即将隐藏</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardDidHideNotification</span>;<span class="comment">//通知键盘对象视图完全隐藏</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">通知消息 NSNotification中的 userInfo字典中包含键盘的位置和大小信息，对应的key为</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  UIKeyboardFrameBeginUserInfoKey</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  UIKeyboardFrameEndUserInfoKey</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  UIKeyboardAnimationDurationUserInfoKey</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  UIKeyboardAnimationCurveUserInfoKey</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">UIKeyboardFrameBeginUserInfoKey,UIKeyboardFrameEndUserInfoKey对应的Value是个NSValue对象，内部包含CGRect结构，分别为键盘起始时和终止时的位置信息。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">UIKeyboardAnimationCurveUserInfoKey对应的Value是NSNumber对象，内部为UIViewAnimationCurve类型的数据，表示键盘显示或消失的动画类型。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">UIKeyboardAnimationDurationUserInfoKey对应的Value也是NSNumber对象，内部为double类型的数据，表示键盘h显示或消失时动画的持续时间</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> 例如，在UIKeyboardWillShowNotification，UIKeyboardDidShowNotification通知中的userInfo内容为</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    userInfo = &#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardAnimationCurveUserInfoKey = 0;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardAnimationDurationUserInfoKey = "0.25";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardBoundsUserInfoKey = "NSRect: &#123;&#123;0, 0&#125;, &#123;320, 216&#125;&#125;";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardCenterBeginUserInfoKey = "NSPoint: &#123;160, 588&#125;";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardCenterEndUserInfoKey = "NSPoint: &#123;160, 372&#125;";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardFrameBeginUserInfoKey = "NSRect: &#123;&#123;0, 480&#125;, &#123;320, 216&#125;&#125;";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardFrameChangedByUserInteraction = 0;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardFrameEndUserInfoKey = "NSRect: &#123;&#123;0, 264&#125;, &#123;320, 216&#125;&#125;";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">               &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    在UIKeyboardWillHideNotification,UIKeyboardDidHideNotification通知中的userInfo内容为:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   userInfo = &#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardAnimationCurveUserInfoKey = 0;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardAnimationDurationUserInfoKey = "0.25";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardBoundsUserInfoKey = "NSRect: &#123;&#123;0, 0&#125;, &#123;320, 216&#125;&#125;";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardCenterBeginUserInfoKey = "NSPoint: &#123;160, 372&#125;";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardCenterEndUserInfoKey = "NSPoint: &#123;160, 588&#125;";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardFrameBeginUserInfoKey = "NSRect: &#123;&#123;0, 264&#125;, &#123;320, 216&#125;&#125;";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardFrameChangedByUserInteraction = 0;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                 UIKeyboardFrameEndUserInfoKey = "NSRect: &#123;&#123;0, 480&#125;, &#123;320, 216&#125;&#125;";</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">              &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardFrameBeginUserInfoKey</span>       <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_2);<span class="comment">// NSValue of CGRect</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardFrameEndUserInfoKey</span>         <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_2);<span class="comment">// NSValue of CGRect</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardAnimationDurationUserInfoKeyNS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);<span class="comment">// NSNumber of double</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardAnimationCurveUserInfoKey</span>   <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);<span class="comment">// NSNumber of NSUInteger (UIViewAnimationCurve)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardIsLocalUserInfoKey</span>          <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);<span class="comment">// NSNumber of BOOL</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardWillChangeFrameNotification</span> <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">5</span>_0);<span class="comment">//键盘即将改变布局发出通知</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardDidChangeFrameNotification</span>  <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">5</span>_0);<span class="comment">//键盘已经改变布局后发出通知</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardCenterBeginUserInfoKey</span>  <span class="built_in">NS_DEPRECATED_IOS</span>(<span class="number">2</span>_0,<span class="number">3</span>_2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardCenterEndUserInfoKey</span>    <span class="built_in">NS_DEPRECATED_IOS</span>(<span class="number">2</span>_0,<span class="number">3</span>_2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UIKeyboardBoundsUserInfoKey</span>       <span class="built_in">NS_DEPRECATED_IOS</span>(<span class="number">2</span>_0,<span class="number">3</span>_2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UISwitch 圆点按钮]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UISwitch%20%E5%9C%86%E7%82%B9%E6%8C%89%E9%92%AE/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UISwitch的初始化</span></span><br><span class="line">    <span class="built_in">UISwitch</span> *switchView = [[<span class="built_in">UISwitch</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">54.0</span>f, <span class="number">16.0</span>f, <span class="number">100.0</span>f, <span class="number">28.0</span>f)];</span><br><span class="line">    [view addSubview:switchView];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置UISwitch的初始化状态</span></span><br><span class="line">    switchView.on = <span class="literal">YES</span>;<span class="comment">//设置初始为ON的一边</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">//UISwitch事件的响应</span></span><br><span class="line">    [switchView addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(switchAction:) forControlEvents:<span class="built_in">UIControlEventValueChanged</span>];</span><br><span class="line">  </span><br><span class="line">    <span class="comment">//开启状态的颜色</span></span><br><span class="line">    switchView.onTintColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//关闭状态的颜色</span></span><br><span class="line">    switchView.tintColor = [<span class="built_in">UIColor</span> greenColor];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//圆圈的颜色</span></span><br><span class="line">    switchView.thumbTintColor = [<span class="built_in">UIColor</span> yellowColor];</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UTF-8 和 GBK 的 NSString 相互转化的方法]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UTF-8%20%E5%92%8C%20GBK%20%E7%9A%84%20NSString%20%E7%9B%B8%E4%BA%92%E8%BD%AC%E5%8C%96%E7%9A%84%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>应用都要遇到一个很头疼的问题：文字编码，汉字的 GBK 和 国际通用的 UTF-8 的互相转化稍一不慎，<br>就会满屏乱码。下面介绍 UTF-8 和 GBK 的 NSString 相互转化的方法</p>
<p> NSStringEncoding enc = CFStringConvertEncodingToNSStringEncoding(kCFStringEncodingGB_18030_2000);<br>    char<em> c_test = “北京”;<br>    int nLen = strlen(c_test);<br>    NSString</em> str = [[NSString alloc]initWithBytes:c_test length:nLen encoding:enc ];<br>    NSLog(@”str = %@”,str);</p>
<p><strong>从 GBK 转到 UTF-8
</strong>用 NSStringEncoding enc =CFStringConvertEncodingToNSStringEncoding(kCFStringEncodingGB_18030_2000) ，<br>然后就可以用initWithData：encoding来实现。</p>
<p><strong>从 UTF-8 转到 GBK
</strong>CFStringConvertEncodingToNSStringEncoding(kCFStringEncodingGB_18030_2000)，<br>得到的enc却是kCFStringEncodingInvalidId。<br>没关系，试试 NSData *data=[nsstring dataUsingEncoding:-2147482063];</p>
<p>转换字符编码主要用到CFStringConvertEncodingToNSStringEncoding函数,具体的大家可以看看这个函数的用法<br>NSStringEncoding enc = CFStringConvertEncodingToNSStringEncoding (kCFStringEncodingGB_18030_2000);</p>
<p>完整代码如下:<br><strong>NSURL <em>url = [NSURL URLWithString:urlStr];<br>NSData </em>data = [NSData dataWithContentsOfURL:url];<br>NSStringEncoding enc = CFStringConvertEncodingToNSStringEncoding(kCFStringEncodingGB_18030_2000);<br>NSString *retStr = [[NSString alloc] initWithData:data encoding:enc];
</strong><br>一个比较方便的转换NSString为UTF8编码的函数,大家可以试试</p>
<p><strong>头文件：
</strong>@interface NSString (OAURLEncodingAdditions) </p>
<ul>
<li>(NSString *)URLEncodedString; </li>
<li><p>(NSString *)URLDecodedString;<br>@end<br><strong>m文件:
</strong><br>@implementation<br>NSString (OAURLEncodingAdditions) </p>
<ul>
<li>(NSString <em>)URLEncodedString<br>{<br>NSString </em>result = (NSString <em>)CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault,(CFStringRef)self,NULL,CFSTR(“!</em>‘();:@&amp;=+$,/?%#[]”),kCFStringEncodingUTF8);<br>[result autorelease];<br>return result;<br>}</li>
</ul>
</li>
<li><p>(NSString<em>)URLDecodedString<br>{<br> NSString </em>result = (NSString *)CFURLCreateStringByReplacingPercentEscapesUsingEncoding(kCFAllocatorDefault,(CFStringRef)self, CFSTR(“”),kCFStringEncodingUTF8);CFSTR(“”),kCFStringEncodingUTF8);<br> [result autorelease];<br> return result;<br>}<br>@end<br>如果需要转换一个NSString, 只需要</p>
</li>
</ul>
<p>NSString <em>temp = [@”测试utf8” URLEncodedString];<br>NSString </em>decoded = [temp URLDecodedString];</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[assert]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/assert/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">assert宏的原型定义在&lt;assert.h&gt;中，其作用是如果它的条件返回错误，则终止程序执行，原型定义：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="keyword">void</span> assert( <span class="keyword">int</span> expression );</span><br><span class="line">assert的作用是现计算表达式 expression ，如果其值为假（即为<span class="number">0</span>），那么它先向stderr打印一条出错信息，然后通过调用 abort 来终止程序运行。请看下面的程序清单badptr.c：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="number">1</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"> <span class="number">2</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"> <span class="number">3</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"> <span class="number">4</span> <span class="keyword">int</span> main( <span class="keyword">void</span> )</span><br><span class="line"> <span class="number">5</span> &#123;</span><br><span class="line"> <span class="number">6</span>        FILE *fp;</span><br><span class="line"> <span class="number">7</span>     </span><br><span class="line"> <span class="number">8</span>        fp = fopen( <span class="string">"test.txt"</span>, <span class="string">"w"</span> );<span class="comment">//以可写的方式打开一个文件，如果不存在就创建一个同名文件</span></span><br><span class="line"> <span class="number">9</span>        assert( fp );                           <span class="comment">//所以这里不会出错</span></span><br><span class="line"><span class="number">10</span>        fclose( fp );</span><br><span class="line"><span class="number">11</span>     </span><br><span class="line"><span class="number">12</span>        fp = fopen( <span class="string">"noexitfile.txt"</span>, <span class="string">"r"</span> );<span class="comment">//以只读的方式打开一个文件，如果不存在就打开文件失败</span></span><br><span class="line"><span class="number">13</span>        assert( fp );                           <span class="comment">//所以这里出错</span></span><br><span class="line"><span class="number">14</span>        fclose( fp );                           <span class="comment">//程序永远都执行不到这里来</span></span><br><span class="line"><span class="number">15</span>        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">16</span> &#125;</span><br><span class="line"></span><br><span class="line">已放弃使用assert()的缺点是，频繁的调用会极大的影响程序的性能，增加额外的开销。在调试结束后，可以通过在包含<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;的语句之前插入 #define NDEBUG 来禁用assert调用，示例代码如下：</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NDEBUG</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line">用法总结与注意事项：</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>）在函数开始处检验传入参数的合法性如：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> resetBufferSize(<span class="keyword">int</span> nNewSize)</span><br><span class="line">&#123;</span><br><span class="line">　　<span class="comment">//功能:改变缓冲区大小,</span></span><br><span class="line">　　<span class="comment">//参数:nNewSize 缓冲区新长度</span></span><br><span class="line">　　<span class="comment">//返回值:缓冲区当前长度 </span></span><br><span class="line">　　<span class="comment">//说明:保持原信息内容不变     nNewSize&lt;=0表示清除缓冲区</span></span><br><span class="line">　　assert(nNewSize &gt;= <span class="number">0</span>);</span><br><span class="line">　　assert(nNewSize &lt;= MAX_BUFFER_SIZE);</span><br><span class="line">　　...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  <span class="number">2</span>）每个assert只检验一个条件，因为同时检验多个条件时，如果断言失败，无法直观的判断是哪个条件失败，如：</span><br><span class="line"></span><br><span class="line">　不好：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">assert(nOffset&gt;=<span class="number">0</span> &amp;&amp; nOffset+nSize&lt;=m_nInfomationSize);</span><br><span class="line">　好：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">assert(nOffset &gt;= <span class="number">0</span>);</span><br><span class="line">assert(nOffset+nSize &lt;= m_nInfomationSize);</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>）不能使用改变环境的语句，因为assert只在DEBUG个生效，如果这么做，会使用程序在真正运行时遇到问题，如：</span><br><span class="line">　错误：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">assert(i++ &lt; <span class="number">100</span>);</span><br><span class="line">这是因为如果出错，比如在执行之前i=<span class="number">100</span>，那么这条语句就不会执行，那么i++这条命令就没有执行。</span><br><span class="line"></span><br><span class="line">　正确：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">assert(i &lt; <span class="number">100</span>);</span><br><span class="line"> i++;</span><br><span class="line"></span><br><span class="line">   <span class="number">4</span>）assert和后面的语句应空一行，以形成逻辑和视觉上的一致感。</span><br><span class="line">  <span class="number">5</span>）有的地方，assert不能代替条件过滤。</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UIscrollView滚动时调用的方法]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UIscrollView%E6%BB%9A%E5%8A%A8%E6%97%B6%E8%B0%83%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UIscrollView开始拖拽的时候调用</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginDragging:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"开始拖拽"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//UIscrollView拖拽结束的时候调用</span></span><br><span class="line">-(<span class="keyword">void</span>)scrollViewDidEndDragging:(<span class="built_in">UIScrollView</span> *)scrollView willDecelerate:(<span class="built_in">BOOL</span>)decelerate</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"拖拽结束"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//UIscrollView拖拽结束的时候调用</span></span><br><span class="line">-(<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//在滚动的时候调用</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//UIscrollView开始减速的时候调用</span></span><br><span class="line">-(<span class="keyword">void</span>)scrollViewWillBeginDecelerating:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"开始减速"</span>);</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//UIscrollView减速停止的时候调用</span></span><br><span class="line">-(<span class="keyword">void</span>)scrollViewDidEndDecelerating:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"减速停止"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">UIView</span> *)viewForZoomingInScrollView:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> [scrollView viewWithTag:<span class="number">9999</span>];</span><br><span class="line">    <span class="comment">//只有实现这个方法 才能执行缩放 指定对象;</span></span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)scrollViewDidZoom:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"缩放时一直触发"</span>);</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIView</span> *)viewForZoomingInScrollView:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> _imageView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 当缩放完毕的时候调用</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndZooming:(<span class="built_in">UIScrollView</span> *)scrollView withView:(<span class="built_in">UIView</span> *)view atScale:(<span class="keyword">float</span>)scale</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//    NSLog(@"结束缩放 - %f", scale);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 当正在缩放的时候调用</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidZoom:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//    NSLog(@"-----");</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[cell的几种style]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/cell%E7%9A%84%E5%87%A0%E7%A7%8Dstyle/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>cell.accessoryType = UITableViewCellAccessoryNone;//cell没有任何的样式<br>cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;//cell的右边有一个小箭头，距离右边有十几像素；<br>cell.accessoryType = UITableViewCellAccessoryDetailDisclosureButton;//cell右边有一个蓝色的圆形button；<br>cell.accessoryType = UITableViewCellAccessoryCheckmark;//cell右边的形状是对号；</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[double 型转换成 金额]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/double%20%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%88%90%20%E9%87%91%E9%A2%9D/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p><code>`</code>objc</p>
<ul>
<li>(NSString <em>)priceString:(double)input {<br>DDLogDebug(@”input %f”,input);<br>NSNumber </em>price = [NSNumber numberWithDouble:input];<br>DDLogDebug(@”price %@”,price);<br>NSNumberFormatter *nf = [NSNumberFormatter new];<br>[nf setNumberStyle:NSNumberFormatterCurrencyStyle];<br>nf.locale = [NSLocale localeWithLocaleIdentifier:@”zh_CN”];<br>DDLogDebug(@”nf %@”,[nf stringFromNumber:price]);<br>return [nf stringFromNumber:price];<br>}</li>
</ul>
<p><img src="http://img.blog.csdn.net/20151218115131757" alt="这里写图片描述"></p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS 使用纯代码或xib创建圆角视图]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS%20%E4%BD%BF%E7%94%A8%E7%BA%AF%E4%BB%A3%E7%A0%81%E6%88%96xib%E5%88%9B%E5%BB%BA%E5%9C%86%E8%A7%92%E8%A7%86%E5%9B%BE/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>####尊重原创 转自：<a href="http://www.jianshu.com/p/80f1fd3f63a0" target="_blank" rel="noopener">http://www.jianshu.com/p/80f1fd3f63a0</a></p>
<p>####</p>
<p>####引言:</p>
<blockquote>
<p>在我们日常开发中, 很多中情况下我们需要设置UIView或者UIImageView的圆角以及边框等,例如个人中心的用户头像等等。</p>
<p><strong>例如 简书:</strong><br><img src="http://upload-images.jianshu.io/upload_images/1975627-4cd88898bae5d219.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>简书-我的界面#####我们通常的做法是:</p>
<ol>
<li>使用纯代码。</li>
<li>在xib下设置属性。</li>
</ol>
</blockquote>
<hr>
<p>####纯代码创建圆角视图:<br>代码如下:<br>        UIView *view = [[UIView alloc] initWithFrame:(CGRectMake(50, 100, 200, 200))];<br>        view.backgroundColor = [UIColor brownColor];</p>
<pre><code>// 设置圆角的角度(当view的宽和高相等, 且 圆角角度为宽的一半时 为圆形)
view.layer.cornerRadius = 20;

// 设置允许裁剪
view.layer.masksToBounds = YES;

// 设置边框
view.layer.borderWidth = 5;

// 设置边框颜色
view.layer.borderColor = [[UIColor redColor] CGColor];

[self.view addSubview:view];
</code></pre><p>创建imageView 和 view 的方式是一样的, 在这里只演示view的创建。</p>
<hr>
<p>####xib下创建圆角视图:<br>正常情况下, 我们在xib中使用 keyPath 来设置圆角。如图:<br><img src="http://upload-images.jianshu.io/upload_images/1975627-5e1fb160b9f1c014.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>xib.png<br>这里虽然设置了, 但是我们并不能立即在xib中看到设置后圆角效果的, 只有在程序运行后才会看到效果。 所以我们要使用<code>IB_DESIGNABLE</code>和<code>IBInspectable</code>来实现实时查看圆角效果。</p>
<p>######IB_DESIGNABLE:<br>这是一个宏定义, 功能就是让XCode动态渲染出该类图形化界面。<br>使用方法: 在自定义的view的.h文件中 添加该 宏定义。</p>
<p>######IBInspectable:<br>IBInspectable 宏定义的功能是可以可视化显示自定义view中相关的属性。</p>
<hr>
<p>####如何实现实时查看圆角效果:<br>1.自定义view , CornerView.h:</p>
<pre><code>#import &lt;UIKit/UIKit.h&gt;
IB_DESIGNABLE  // 动态刷新
@interfaceCornerView : UIView
// 注意: 加上IBInspectable就可以可视化显示相关的属性
/** 可视化设置边框宽度 */
@property (nonatomic, assign)IBInspectable CGFloat borderWidth;
/** 可视化设置边框颜色 */
@property (nonatomic, strong)IBInspectable UIColor *borderColor;
/** 可视化设置圆角 */
@property (nonatomic, assign)IBInspectable CGFloat cornerRadius;
@end
</code></pre><p>CornerView.m:<br>    @implementationCornerView.m</p>
<pre><code>#pragma mark - 设置边框宽度
- (void)setBorderWidth:(CGFloat)borderWidth {

    if (borderWidth &lt; 0) return;

    self.layer.borderWidth = borderWidth;
}

#pragma mark - 设置边框颜色
- (void)setBorderColor:(UIColor *)borderColor {

    self.layer.borderColor = borderColor.CGColor;
}

#pragma mark - 设置圆角
- (void)setCornerRadius:(CGFloat)cornerRadius {

    self.layer.cornerRadius = cornerRadius;
    self.layer.masksToBounds = cornerRadius &gt; 0;
}
</code></pre><p>2.在xib中拖一个view, 将view设定为 自定义view: CornerView 如图:<br><img src="http://upload-images.jianshu.io/upload_images/1975627-4db67f19b49fe871.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>自定义view<br>注意:<code>Designable</code>如果没有这行字，说明没有正确添加添加IB_DESIGNABLE，如果它的状态显示up to date,说明设置成功, 如果是updating，说明视图在更新，案如果是build failed的话，请检查布局代码，可能有哪里出错了。<br>3.如图, 我们就可以看到自定义view中设置的属性了:<br><img src="http://upload-images.jianshu.io/upload_images/1975627-07722f927de30e71.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>自定义属性4.设置好 属性后 , 右边的view就会立即 更新了!<br><img src="http://upload-images.jianshu.io/upload_images/1975627-e8d8c896c0de4983.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>效果图.jpg该方法同样适用于UIIamgeView ! ! ! !</p>
<hr>
<p>####效果图:<br><img src="http://upload-images.jianshu.io/upload_images/1975627-ebdb869d89da681f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>效果图</p>
<p>本篇文章对应的源代码下载地址:<a href="https://github.com/LiCheng244/CornerViewDemo" target="_blank" rel="noopener">CornerViewDemo</a><br><strong>该 demo 中封装了 自定义view 和 自定义imageView , 可以将CornerTool文件夹拖入到项目中直接使用, <code>xib下 view</code> 继承 <code>CornerView</code>类, <code>imageView</code> 继承 <code>CornerImageView</code>即可设置属性。</strong></p>
<p>文／Li_Cheng（简书作者）<br>原文链接：<a href="http://www.jianshu.com/p/80f1fd3f63a0" target="_blank" rel="noopener">http://www.jianshu.com/p/80f1fd3f63a0</a><br>著作权归作者所有，转载请联系作者获得授权，并标注“简书作者”。</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS 打电话]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS%20%E6%89%93%E7%94%B5%E8%AF%9D/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)telePhoneAction:(<span class="built_in">NSString</span> *)teleNum &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSString</span> *number = teleNum;<span class="comment">// 此处读入电话号码</span></span><br><span class="line">   </span><br><span class="line">    <span class="comment">//NSString *num = [[NSString alloc] initWithFormat:@"tel://%@",number]; //number为号码字符串 如果使用这个方法 结束电话之后会进入联系人列表</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSString</span> *num = [[<span class="built_in">NSString</span> alloc] initWithFormat:<span class="string">@"telprompt://%@"</span>,number]; <span class="comment">//而这个方法则打电话前先弹框  是否打电话 然后打完电话之后回到程序中 网上说这个方法可能不合法 无法通过审核</span></span><br><span class="line">   </span><br><span class="line">    [[<span class="built_in">UIApplication</span> sharedApplication] openURL:[<span class="built_in">NSURL</span> URLWithString:num]]; <span class="comment">//拨号</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS 网络编程模式总结]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%BC%8F%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>转自：  <a href="http://blog.csdn.net/goohong/article/details/40505291" target="_blank" rel="noopener">http://blog.csdn.net/goohong/article/details/40505291</a><br>IOS 可以采用三类api 接口进行网络编程，根据抽象层次从低到高分别为socket方式、stream方式、url 方式。<br>一 、socket 方式<br>       IOS 提供的socket 方式的网络编程接口为CFSocket。CFSocket是BSD sockets的抽象和封装，CFSocket提供BSD sockets几乎所有的功能，并与run loop集成，用来实现多线程网络编程和网络事件监听。基于 CFSocket可以实现各种类型的 socket编程，包括stream-based 的sockets(如tcp)和packet-based 的sockets(如udp)。需要注意的是在iOS中CFSocket接口在需要时不自动激活设备的<br> cellular modem或on-demand VPN。<br>      CFSocket包括以下编程接口，包括Socket的 创建、配置，以及根据创建和配置好的Socket 进行 远程通讯等接口。<br>1  Socket的 创建</p>
<blockquote>
<p>1 .1、CFSocketCreate<br>创建一个特定协议和类型的 CFSocket对象<br>1.2、CFSocketCreateWithSocketSignature<br>该接口根据一个包含通讯协议和地址的CFSocketSignature结构来创建一个CFSocket对象</p>
<p>1.3、 CFSocketCreateConnectedToSocketSignature<br>该接口在创建一个CFSocket对象的同时还与一个远端主机进行连接。</p>
<p>1.4、CFSocketCreateWithNative<br>该接口通过封装一个存在的 BSD socket来创建一个CFSocket对象。</p>
</blockquote>
<p>2   Socket的配置</p>
<blockquote>
<p>2.1   CFSocketCopyAddress<br>功能： 返回一个 CFSocket对象的本地地址。<br>语法：<br>SWIFT<br>func CFSocketCopyAddress(_ s: CFSocket!) -&gt; CFData!<br>2.2、CFSocketCopyPeerAddress<br>功能：返回与一个 CFSocket对象连接的远端地址。<br>语法：<br>SWIFT<br>func CFSocketCopyPeerAddress(_ s: CFSocket!) -&gt; CFData!<br>2.3  CFSocketDisableCallBacks<br>功能：临时取消一个CFSocket对象创建时指定的某种类型的事件回调。<br>语法：<br>SWIFT<br>func CFSocketDisableCallBacks(_ s: CFSocket!,<br>                            _ callBackTypes: CFOptionFlags)<br>2.4   CFSocketEnableCallBacks<br>功能：重新允许先前CFSocketDisableCallBacks函数取消的某种类型的事件回调。<br>语法：<br>SWIFT<br>func CFSocketEnableCallBacks(_ s: CFSocket!,<br>                           _ callBackTypes: CFOptionFlags)<br>2.5 CFSocketGetContext<br>功能：返回一个CFSocket对象的上下文信息。<br>语法：<br>SWIFT<br>func CFSocketGetContext(_ s: CFSocket!,<br>                      _ context: UnsafeMutablePointer<cfsocketcontext>)<br>2.6 CFSocketGetNative<br>返回与一个CFSocket对象相关的本地 BSD socket。<br>语法：<br>SWIFT<br>func CFSocketGetNative(_ s: CFSocket!) -&gt; CFSocketNativeHandle<br>2.7   CFSocketGetSocketFlags<br>功能：返回控制一个CFSocket对象的确定行为的 标志。<br>语法：<br>SWIFT<br>func CFSocketGetSocketFlags(_ s: CFSocket!) -&gt; CFOptionFlags</cfsocketcontext></p>
<p>2.8 CFSocketSetSocketFlags<br>功能：设置控制一个CFSocket对象的确定行为的 标志。<br>语法：<br>SWIFT<br>func CFSocketSetSocketFlags(_ s: CFSocket!,<br>                          _ flags: CFOptionFlags)<br>2.9 CFSocketSetAddress<br>语法：<br>SWIFT<br>func CFSocketSetAddress(_ s: CFSocket!,<br>                      _ address: CFData!) -&gt; CFSocketError<br>功能：为一个CFSocket对象绑定一个本地地址并在本地socket支持的情况下对socket进行配置使其处于监听状态。该函数对应本地socket的 bind以及listen功能。一旦CFSocket对象绑定地址，依赖于socket的协议，其它进程和主机能连接到该CFSocket对象。</p>
</blockquote>
<p>3、Sockets的使用</p>
<blockquote>
<p>3.1 CFSocketConnectToAddress<br>功能：打开与一个远程socket的一个连接。<br>语法：<br>SWIFT<br>func CFSocketConnectToAddress(_ s: CFSocket!,<br>                            _ address: CFData!,<br>                            _ timeout: CFTimeInterval) -&gt; CFSocketError<br>3.2 CFSocketCreateRunLoopSource<br>语法：<br>SWIFT<br>func CFSocketCreateRunLoopSource(_ allocator: CFAllocator!,<br>                               _ s: CFSocket!,<br>                               _ order: CFIndex) -&gt; CFRunLoopSource!<br>功能：为一个CFSocket对象创建一个CFRunLoopSource对象。该创建的 CFRunLoopSource对象不自动添加到一个run loop。为了增加该run loop source到某个run loop，需要调用CFRunLoop对象 的CFRunLoopAddSource函数来为该CFRunLoop对象添加run loop source。<br>3.3 CFSocketGetTypeID<br>功能：返回CFSocket对象的 opaque类型对应的类型标示符。<br>语法：<br>SWIFT<br>func CFSocketGetTypeID() -&gt; CFTypeID<br>3.4  CFSocketInvalidate<br>功能：使一个CFSocket对象无效，使其停止接收和发送任何消息。<br>语法：<br>SWIFT<br>func CFSocketInvalidate(_ s: CFSocket!)<br>3.5 CFSocketIsValid<br>功能：返回一个指示一个CFSocket对象是否有效及是否能够发送和接收消息的布尔值。<br>语法：<br>SWIFT<br>func CFSocketIsValid(_ s: CFSocket!) -&gt; Boolean<br>3.6 CFSocketSendData<br>功能：该函数用来通过一个CFSocket对象发送数据。<br>语法：<br>SWIFT<br>func CFSocketSendData(_ s: CFSocket!,<br>                    _ address: CFData!,<br>                    _ data: CFData!,<br>                    _ timeout: CFTimeInterval) -&gt; CFSocketError</p>
</blockquote>
<p>二、stream编程模式<br>       stream编程模式提供了与 unix 的文件操作类似的模式。首先创建和设置流，接着打开流，然后读写流，在流存在时还可以通过查询流的相关属性来读取流的相关信息，在流使用完毕后关闭流。<br>       iOS 为stream编程模式提供的api编程接口包括两大类，一类是Core Foundation框架层用C语言实现的CFStream  API（包括CFStream、 CFReadStream 、CFWriteStream等）,一类是基于其上的在Foundation框架层用Objective-C语言实现的NSStream API（包括NSStream、NSInputStream NSOutputStream等）,两者提供相似的接口和行为，其中某些对象是toll-free<br> bridged类型的，如CFStream 与NSStream，CFReadStream与NSInputStream，CFWriteStream与NSOutputStream之间，因此可以混合使用。<br>       开发人员可以根据自己的语言偏好选择使用。<br>       CFStream API的主要接口：<br>1、CFStream 创建接口</p>
<blockquote>
<p>1.1  CFStreamCreatePairWithPeerSocketSignature<br>          功能：创建一对到一个socket的可读和可写流。<br>1.2 CFStreamCreatePairWithSocketToHost<br>功能：创建连接到一个特定主机的特定端口的一对可读写流。<br>1.3 CFStreamCreatePairWithSocket<br>功能：创建一对连接到一个socket的可读写流<br>1.4 CFStreamCreateBoundPair<br>功能：创建一对读写流。<br>其它可读写流创建接口：<br> 1.5 CFReadStreamCreateForHTTPRequest<br>   功能：为一个CFHTTP请求创建一个可读流。<br>1.6 CFReadStreamCreateForStreamedHTTPRequest<br>功能：为一个HTTP请求的body保持在内存的CFHTTP请求创建一个可读流。<br>1.7  CFReadStreamCreateWithFTPURL<br>功能：创建一个FTP可读流<br>1.8  CFWriteStreamCreateWithFTPURL<br>功能：创建一个FTP可读流</p>
<ol start="2">
<li>CFReadStream接口<br>2.1 流的打开和关闭<br>   CFReadStreamOpen<pre><code>CFReadStreamClose
</code></pre>2.2  读取数据<br>   CFReadStreamRead<br>2.3.  调度一个可读流<br>CFReadStreamScheduleWithRunLoop(_:_:_:) <pre><code>CFReadStreamUnscheduleFromRunLoop(_:_:_:) 
</code></pre>2.4 检查可读流的属性<br>CFReadStreamCopyProperty(_:<em>:)<br>CFReadStreamGetBuffer(</em>:_:<em>:)<br>CFReadStreamCopyError(</em>:)<br>CFReadStreamGetError(<em>:)<br>CFReadStreamGetStatus(</em>:)<br>CFReadStreamHasBytesAvailable(<em>:)<br>2.5 设置可读流的属性<br>CFReadStreamSetClient(</em>:_:_:<em>:)<br>CFReadStreamSetProperty(</em>:_:_:)<br>2.6 得到 CFReadStream的 Type ID<pre><code>CFReadStreamGetTypeID()
</code></pre></li>
</ol>
</blockquote>
<p>3.CFWriteStream 相关接口</p>
<blockquote>
<pre><code>3.1 CFWriteStreamClose(_:) 
3.2 CFWriteStreamOpen(_:) 
3.3 CFWriteStreamWrite(_:_:_:)
   3.4 CFWriteStreamScheduleWithRunLoop(_:_:_:)
</code></pre><p>  3.5 CFWriteStreamUnscheduleFromRunLoop(_:_:<em>:)<br>        3.6 CFWriteStreamCanAcceptBytes(</em>:)<br>      3.7 CFWriteStreamCopyProperty(_:<em>:)<br>      3.8 CFWriteStreamCopyError(</em>:)<br>      3.9 CFWriteStreamGetError(<em>:)<br>      3.10 CFWriteStreamGetStatus(</em>:)<br>         3.11 CFWriteStreamSetClient(_:_:_:<em>:)<br>  3.12 CFWriteStreamSetProperty(</em>:_:_:)<br>      3.13 CFWriteStreamGetTypeID()<br>CFStream API的使用步骤：<br>1） 利用流创建接口创建相关流；<br>2）、调用CFReadStreamSetClient （可读流）或CFWriteStreamSetClient （可写流）来登记要接收的流相关的事件；<br>3）、调用CFReadStreamScheduleWithRunLoop（可读流）或CFWriteStreamScheduleWithRunLoop（可写流）来使在流在一个run loop上进行调度以便接收相关事件；<br>4）、调用CFReadStreamOpen 或CFWriteStreamOpen 来打开已创建的流；<br>5）、在读取流的创建时登记的回调中，在接收到kCFStreamEventHasBytesAvailable事件时来读取数据， 在可写流已登记的回调中，在接收到kCFStreamEventCanAcceptBytes 事件时开始发送数据或请求；<br>6） 数据传输完成，关闭和释放打开和创建的相关流；<br>2、NSStream   API的使用&gt;  在ios 中由于NSStream类不支持 与一个远程主机连接，而CFStream支持，因此为了使用 NSStream，你需要使用流创建函数CFStreamCreatePairWithSocketToHost或CFStreamCreatePairWithSocketToCFHost来打开一个与远程主机连接的socket并分配一对CFStream 对象（CFReadStream和CFWriteStream），并cast这些对象到NSStream<br> 对象（对应NSInputStream 和 NSOutputStream）。从而可以使用NSStream类的相关接口进行相关网络编程。如设置接收网络事件的代理对象，调度到当前的run loop，然后打开它们进行相应处理。<br>代码片段如下：<br><strong>[objc]</strong> <a href="http://blog.csdn.net/goohong/article/details/40505291#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/goohong/article/details/40505291#" title="copy" target="_blank" rel="noopener">copy</a><a href="https://code.csdn.net/snippets/498585" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/CODE_ico.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/498585/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/ico_fork.svg" alt="派生到我的代码片"></a>1. {  </p>
<ol start="2">
<li></li>
<li>NSURL *website = [NSURL URLWithString:urlStr];  </li>
<li></li>
<li>if (!website) {  </li>
<li></li>
<li>NSLog(@”%@ is not a valid URL”);  </li>
<li></li>
<li>return;  </li>
<li></li>
<li>}  </li>
<li></li>
<li>CFReadStreamRef readStream;  </li>
<li></li>
<li>CFWriteStreamRef writeStream;  </li>
<li></li>
<li>CFStreamCreatePairWithSocketToHost(NULL, (CFStringRef)[website host], 80, &amp;readStream, &amp;writeStream);  </li>
<li></li>
<li>NSInputStream <em>inputStream = (__bridge_transfer NSInputStream </em>)readStream;  </li>
<li></li>
<li>NSOutputStream <em>outputStream = (__bridge_transfer NSOutputStream </em>)writeStream;  </li>
<li></li>
<li>[inputStream setDelegate:self];  </li>
<li></li>
<li>[outputStream setDelegate:self];  </li>
<li></li>
<li>[inputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];  </li>
<li></li>
<li>[outputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];  </li>
<li></li>
<li>[inputStream open];  </li>
<li></li>
<li>[outputStream open];  </li>
<li></li>
<li></li>
<li>/* Store a reference to the input and output streams so that </li>
<li></li>
<li>they don’t go away…. */  </li>
<li></li>
<li>…  </li>
<li></li>
<li>}  </li>
</ol>
</blockquote>
<pre><code>在NSStream对象打开后，当接收到相关的stream-event网络消息，其代理对象中的handleEvent: 函数被调用，从而进行流相关的网络消息处理，  如发送相关协议的请求或接收应答等。以下为handleEvent: 函数进行事件处理的代码片段：
</code></pre><p><strong>[objc]</strong> <a href="http://blog.csdn.net/goohong/article/details/40505291#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/goohong/article/details/40505291#" title="copy" target="_blank" rel="noopener">copy</a><a href="https://code.csdn.net/snippets/498585" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/CODE_ico.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/498585/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/ico_fork.svg" alt="派生到我的代码片"></a>1. - (void)stream:(NSStream *)stream handleEvent:(NSStreamEvent)eventCode {  </p>
<ol start="2">
<li></li>
<li>NSLog(@”stream:handleEvent: is invoked…”);  </li>
<li></li>
<li></li>
<li></li>
<li>switch(eventCode) {  </li>
<li></li>
<li>case NSStreamEventHasSpaceAvailable:  </li>
<li></li>
<li>{  </li>
<li></li>
<li>if (stream == oStream) {  </li>
<li></li>
<li>NSString * str = [NSString stringWithFormat:  </li>
<li></li>
<li>@”GET / HTTP/1.0\r\n\r\n”];  </li>
<li></li>
<li>const uint8_t * rawstring =  </li>
<li></li>
<li>(const uint8_t *)[str UTF8String];  </li>
<li></li>
<li>[oStream write:rawstring maxLength:strlen(rawstring)];  </li>
<li></li>
<li>[oStream close];  </li>
<li></li>
<li>}  </li>
<li></li>
<li>break;  </li>
<li></li>
<li>}  </li>
<li></li>
<li>// continued …  </li>
<li></li>
<li>}  </li>
<li></li>
<li>}  </li>
</ol>
<p>三、url 编程模式<br>         url 编程模式通过URL 的方式来实现网络编程，任何要存取的网络资源（包括局域网和广域网）都可以用一个URL来表示和存取，并支持设备间的资源共享。url 编程模式系统提供http, https, file, ftp, data等五种协议支持，并允许用户自己开发和登记相关类来支持另外的应用层网络协议，进行协议的扩展。<br>        url 编程模式在IOS系统可以使用两种编程接口：NSURLSession 和NSURLConnection。<br>        对于iOS 7 以后的最新系统推荐使用NSURLSession API，对于老版本由于不支持NSURLSession，因此必须使用NSURLConnection API。<br>NSURLSession编程模式是对相关的连接请求通过一个会话来完成，应用通过创建一系列sessions来实现网络通讯，每一个session协调一组相关数据的传输任务。在每一个session内，应用添加一系列任务，每一个任务表现一个特定URL 请求。<br>        NSURLSession相比NSURLConnection的优点是支持在应用挂起、停止或crashed时能够在后台继续下载数据，即支持任务的取消、重启（恢复）、挂起，以及支持从已挂起、取消或失败的下载中重新恢复下载的能力。<br>         对于简单的请求，还可以直接通过一个简单的NSURL对象来发出请求，并使用一个NSData内存对象或者一个文件的方式来引出NSURL指向的内容。而NSURLConnection API只能通过构造一个NSURLRequest对象或其子类来发出URL请求来请求下载或上传URL数据。 使用一个NSURLRequest请求对象封装一个URL请求，例如HTTP协议方法，除了可以封装一些协议特定的属性外，还可以规定任意本地cached数据的使用策略。<br>         对于NSURLRequest请求对象的应答包括两部分：描述内容的元数据metadata及内容数据本身。两种API对于使用NSURLRequest请求接收的元数据metadata都由NSURLResponse类来封装，其中包含MIME类型、内容长度、编码及提供应答的URL等内容。NSURLResponse协议特定的子类还能提供额外的元数据，如NSHTTPURLResponse提供协议头和WEB服务器返回的状态码<br> 等信息。<br>         NSURLSession API的使用：</p>
<pre><code>NSURLSession类支持三种会话类型（默认会话类型、临时会话、后台会话）以及三种类型的任务（数据任务、下载任务、上传任务）。
数据任务使用NSData 对象来发送和接收内存数据，不存储数据到一个文件，因此不支持后台会话。
下载任务以一个文件的形式引出数据，并支持在应用没有运行时的后台下载。
上传任务用来上传数据（文件），也能够支持应用没有运行时的后台上传。
 默认会话和后台会话的区别是后台会话使用一个分离的进程处理所有的数据传输任务，并带有一些限制：后台会话必须使用特定应用代理来提供事件提交，并仅支持HTTP和HTTPS 协议，不支持其它定制协议，并仅支持上传和下载任务，不支持数据任务。
临时会话不存储任何数据到磁盘，所有接收的内容都保存到与会话关联的RAM中，当会话无效时，RAM中接收的内容自动被清除。
</code></pre><p>   NSURLSession API的使用步骤：<br>   1 、创建一个NSURLSessionConfiguration配置对象</p>
<blockquote>
<p>NSURLSessionConfiguration配置对象提供广泛的配置选项，包括：<br>1）、特定于单个会话的私有数据存储，包括caches, cookies, credentials, 和protocols；<br>2）、与一个特定请求或一个会话关联的Authentication；<br>3）、与一个主机的最大连接数；<br>4）、与一个资源关联的超时；<br>5）、最小和最大TLS版本支持；<br>6）、定制的代理词典；<br>7）、cookie策略的控制；<br>8）、HTTP pipelining行为的控制<br>2、根据配置创建相应的NSURLSession；<br>       如下代码片段展示了根据不同的配置对象创建不同类型的NSURLSession会话对象。</p>
</blockquote>
<p><strong>[objc]</strong> <a href="http://blog.csdn.net/goohong/article/details/40505291#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/goohong/article/details/40505291#" title="copy" target="_blank" rel="noopener">copy</a><a href="https://code.csdn.net/snippets/498585" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/CODE_ico.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/498585/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/ico_fork.svg" alt="派生到我的代码片"></a>1. /<em> Create a session for each configurations. </em>/  </p>
<ol start="2">
<li>self.defaultSession = [NSURLSession sessionWithConfiguration: defaultConfigObject delegate: self delegateQueue: [NSOperationQueue mainQueue]];  </li>
<li>self.backgroundSession = [NSURLSession sessionWithConfiguration: backgroundConfigObject delegate: self delegateQueue: [NSOperationQueue mainQueue]];  </li>
<li>self.ephemeralSession = [NSURLSession sessionWithConfiguration: ephemeralConfigObject delegate: self delegateQueue: [NSOperationQueue mainQueue]];  </li>
</ol>
<pre><code>  NSURLSession API通过代理来实现异步URL内容存取，代理可以是系统提供的代理，还可以是应用提供的特定代理对象。任务对象当从服务器接收到数据或传输完成时调用这些代理对象的方法。
在创建会话指定相应的代理对象。
</code></pre><p>3、为会话添加任务；<br>使用如下方法来添加数据任务到一个会话。</p>
<blockquote>
<p>dataTaskWithURL(<em>:)<br>dataTaskWithURL(</em>:completionHandler:)<br>dataTaskWithRequest(<em>:)<br>dataTaskWithRequest(</em>:completionHandler:) </p>
</blockquote>
<p>使用如下方法来添加下载任务到一个会话。</p>
<blockquote>
<p>downloadTaskWithURL(<em>:)<br>downloadTaskWithURL(</em>:completionHandler:)<br>downloadTaskWithRequest(<em>:)<br>downloadTaskWithRequest(</em>:completionHandler:)<br>downloadTaskWithResumeData(<em>:)<br>downloadTaskWithResumeData(</em>:completionHandler:) </p>
</blockquote>
<p>使用如下方法来添加上传任务到一个会话</p>
<blockquote>
<p>uploadTaskWithRequest(<em>:fromData:)<br>uploadTaskWithRequest(</em>:fromData:completionHandler:)<br>uploadTaskWithRequest(<em>:fromFile:)<br>uploadTaskWithRequest(</em>:fromFile:completionHandler:)<br>uploadTaskWithStreamedRequest(_:)<br>         如下是数据任务创建代码片段：<br><strong>[objc]</strong> <a href="http://blog.csdn.net/goohong/article/details/40505291#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/goohong/article/details/40505291#" title="copy" target="_blank" rel="noopener">copy</a><a href="https://code.csdn.net/snippets/498585" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/CODE_ico.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/498585/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/ico_fork.svg" alt="派生到我的代码片"></a>1. NSURL *url = [NSURL URLWithString: @”<a href="http://www.example.com/&quot;]" target="_blank" rel="noopener">http://www.example.com/&quot;]</a>;  </p>
<ol start="2">
<li></li>
<li>NSURLSessionDataTask *dataTask = [self.defaultSession dataTaskWithURL: url];  </li>
<li></li>
<li>[dataTask resume];  </li>
</ol>
</blockquote>
<pre><code>下面是下载任务创建代码片段：         
</code></pre><p><strong>[objc]</strong> <a href="http://blog.csdn.net/goohong/article/details/40505291#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/goohong/article/details/40505291#" title="copy" target="_blank" rel="noopener">copy</a><a href="https://code.csdn.net/snippets/498585" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/CODE_ico.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/498585/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/ico_fork.svg" alt="派生到我的代码片"></a>1. NSURL *url = [NSURL URLWithString: @”<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/&quot;" target="_blank" rel="noopener">https://developer.apple.com/library/ios/documentation/Cocoa/Reference/&quot;</a>  </p>
<ol start="2">
<li></li>
<li>“Foundation/ObjC_classic/FoundationObjC.pdf”];  </li>
<li></li>
<li>NSURLSessionDownloadTask *downloadTask = [self.backgroundSession downloadTaskWithURL: url];  </li>
<li></li>
<li>[downloadTask resume];  </li>
</ol>
<p>4、使用代理方法接收数据及状态信息</p>
<blockquote>
<p>会话的数据任务在使用应用特定代理接收数据时必须实现如下两个代理方法：<br>URLSession:dataTask:didReceiveData:<br>一次一片的提供请求的数据给会话任务。<br>URLSession:task:didCompleteWithError:<br>指示请求数据已经全部接收。</p>
<p>会话的下载任务在下载文件时应该实现如下代理方法：<br>URLSession:downloadTask:didFinishDownloadingToURL:<br>下载内容存储到一个URL指定的一个临时文件，在该方法返回之前，必须把临时文件的内容移到一个永久位置，而临时文件被删除。<br>URLSession:downloadTask:didWriteData:totalBytesWritten:totalBytesExpectedToWrite:<br>为应用提供关于当前下载进度的状态信息<br>URLSession:downloadTask:didResumeAtOffset:expectedTotalBytes:<br>告诉应用已经从从先前的失败下载中恢复。<br>URLSession:task:didCompleteWithError:<br>告诉应用下载已经失败。</p>
<p>下载失败恢复处理：<br>在应用使用cancelByProducingResumeData: 方法取消下载任务时，可以使用downloadTaskWithResumeData: 或 downloadTaskWithResumeData:completionHandler:方法重新创建一个新下载任务并传送cancelByProducingResumeData:产生的恢复数据从而接着继续下载。<br>在传输失败时，如果任务可恢复，则调用URLSession:task:didCompleteWithError: 方法。在传送给URLSession:task:didCompleteWithError: 方法的参数NSError中的 userInfo 词典中包含键值为NSURLSessionDownloadTaskResumeData的恢复数据，因此可以使用downloadTaskWithResumeData:<br> 或 downloadTaskWithResumeData:completionHandler:方法重新创建一个新下载任务来接着恢复数据继续下载。</p>
<p>系统代理仅能支持基本的URL资源存取任务，不支持认证和后台下载，并且还必须提供一个completion handler block来把返回的URL数据提交到应用。如下是一个使用系统代理的代码例子：<br><strong>[objc]</strong> <a href="http://blog.csdn.net/goohong/article/details/40505291#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/goohong/article/details/40505291#" title="copy" target="_blank" rel="noopener">copy</a><a href="https://code.csdn.net/snippets/498585" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/CODE_ico.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/498585/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/ico_fork.svg" alt="派生到我的代码片"></a>1. NSURLSession *delegateFreeSession = [NSURLSession sessionWithConfiguration: defaultConfigObject delegate: nil delegateQueue: [NSOperationQueue mainQueue]];  </p>
<ol start="2">
<li></li>
<li>[delegateFreeSession dataTaskWithURL: [NSURL URLWithString: @”<a href="http://www.example.com/&quot;]" target="_blank" rel="noopener">http://www.example.com/&quot;]</a>  </li>
<li></li>
<li>completionHandler:^(NSData <em>data, NSURLResponse </em>response,  </li>
<li></li>
<li>NSError *error) {  </li>
<li></li>
<li>NSLog(@”Got response %@ with error %@.\n”, response, error);  </li>
<li></li>
<li>NSLog(@”DATA:\n%@\nEND DATA\n”,  </li>
<li></li>
<li>[[NSString alloc] initWithData: data  </li>
<li></li>
<li>encoding: NSUTF8StringEncoding]);  </li>
<li></li>
<li>}] resume];  </li>
</ol>
</blockquote>
<pre><code>会话的上传任务的任务创建和相关代理方法：
会话的上传任务使用HTTP  POST方法来上传数据。可以以一个NSData对象、一个文件或使用一个流为HTTP POST请求的body提供内容。
在以NSData对象提供上传数据时，应用调用uploadTaskWithRequest:fromData: 或uploadTaskWithRequest:fromData:completionHandler: 方法来创建上传任务。
</code></pre><blockquote>
<p>在以文件形式提供上传数据时，应用调用uploadTaskWithRequest:fromFile: 或 uploadTaskWithRequest:fromFile:completionHandler:方法来创建上传任务<br>在以流方式提供上传数据时，应用调用uploadTaskWithStreamedRequest:方法来创建上传任务。<br>应用特定代理可以通过实现URLSession:task:didSendBodyData:totalBytesSent:totalBytesExpectedToSend:方法来获得上传进度信息。</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS-使用AudioServices相关接口的连续震动]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS-%E4%BD%BF%E7%94%A8AudioServices%E7%9B%B8%E5%85%B3%E6%8E%A5%E5%8F%A3%E7%9A%84%E8%BF%9E%E7%BB%AD%E9%9C%87%E5%8A%A8/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">转自：http:<span class="comment">//www.jianshu.com/p/dded314dd920</span></span><br><span class="line">话不多说，先上代码！！！喜欢就点赞</span><br><span class="line"></span><br><span class="line">主要功能函数</span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">    @function       AudioServicesAddSystemSoundCompletion</span></span><br><span class="line"><span class="comment">    @abstract       Call the provided Completion Routine when provided SystemSoundID</span></span><br><span class="line"><span class="comment">                    finishes playing.</span></span><br><span class="line"><span class="comment">    @discussion     Once set, the System Sound server will send a message to the System Sound client</span></span><br><span class="line"><span class="comment">                    indicating which SystemSoundID has finished playing.</span></span><br><span class="line"><span class="comment">    @param          inSystemSoundID</span></span><br><span class="line"><span class="comment">                        systemSoundID 自定义的sound（1007系统默认提示音）或者kSystemSoundID_Vibrate（震动）</span></span><br><span class="line"><span class="comment">    @param          inRunLoop</span></span><br><span class="line"><span class="comment">                       没有研究 一般写NULL 有兴趣可以自己研究一下跟大家共享</span></span><br><span class="line"><span class="comment">    @param          inRunLoopMode</span></span><br><span class="line"><span class="comment">                        同上个属性</span></span><br><span class="line"><span class="comment">    @param          inCompletionRoutine</span></span><br><span class="line"><span class="comment">                        这个是指某次震动播放完成后的回调 注意是C的函数 一般我们会在回调中写播放震动的函数 来实现连续震动</span></span><br><span class="line"><span class="comment">    @param          inClientData</span></span><br><span class="line"><span class="comment">                        没有研究啦！！！NULL就行啦</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">extern</span> OSStatus </span><br><span class="line">AudioServicesAddSystemSoundCompletion(  SystemSoundID               inSystemSoundID,</span><br><span class="line">                                     <span class="built_in">CFRunLoopRef</span>                         inRunLoop,</span><br><span class="line">                                     <span class="built_in">CFStringRef</span>                          inRunLoopMode,</span><br><span class="line">                                     AudioServicesSystemSoundCompletionProc  inCompletionRoutine,</span><br><span class="line">                                     <span class="keyword">void</span>*                                inClientData)       </span><br><span class="line">首先实现上述函数中的回调函数（注意是C）</span><br><span class="line"><span class="keyword">void</span> soundCompleteCallback(SystemSoundID sound,<span class="keyword">void</span> * clientData) &#123;</span><br><span class="line">    AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);  <span class="comment">//震动</span></span><br><span class="line">    AudioServicesPlaySystemSound(sound);  <span class="comment">// 播放系统声音 这里的sound是我自定义的，不要copy哈，没有的</span></span><br><span class="line">&#125;</span><br><span class="line">实现播放声音或震动的代码</span><br><span class="line">    SystemSoundID sound;</span><br><span class="line">    <span class="built_in">NSString</span> *path = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:soundName ofType:<span class="literal">nil</span>];</span><br><span class="line">    AudioServicesCreateSystemSoundID((__bridge <span class="built_in">CFURLRef</span>)[<span class="built_in">NSURL</span> fileURLWithPath:path], &amp;_sound);</span><br><span class="line"></span><br><span class="line">    AudioServicesAddSystemSoundCompletion(_soundID, <span class="literal">NULL</span>, <span class="literal">NULL</span>, soundCompleteCallback, <span class="literal">NULL</span>);</span><br><span class="line">    AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);</span><br><span class="line">    AudioServicesPlaySystemSound(_sound);</span><br><span class="line">至此，就可以顺利的播放声音和震动了，而且是连续的哦！！！</span><br><span class="line">别忘了！ 怎么让他停下来</span><br><span class="line">为了方便 我就写了而一个OC的方法来做了</span><br><span class="line">-(<span class="keyword">void</span>)stopAlertSoundWithSoundID:(SystemSoundID)sound &#123;</span><br><span class="line">    AudioServicesDisposeSystemSoundID(kSystemSoundID_Vibrate);</span><br><span class="line">    AudioServicesDisposeSystemSoundID(sound);</span><br><span class="line">    AudioServicesRemoveSystemSoundCompletion(sound);</span><br><span class="line">&#125;</span><br><span class="line">这里要详细解说一下需要注意的事项：</span><br><span class="line">AudioServicesAddSystemSoundCompletion(kSystemSoundID_Vibrate, <span class="literal">NULL</span>, <span class="literal">NULL</span>, systemAudioCallback, <span class="literal">NULL</span>);</span><br><span class="line">AudioServicesRemoveSystemSoundCompletion(kSystemSoundID_Vibrate);</span><br><span class="line">这两个接口的用途是绑定和取消指定soundID对应的回调方法；kSystemSoundID_Vibrate为soundID类型，其回调方法认准的也是这个soundID,在任何地方使用这个<span class="keyword">id</span>去执行AudioServicesPlaySystemSound(xxxSoundID)都会调用到该回调方法。而一旦调用remove方法取消回调，同样的在任何地方使用这个<span class="keyword">id</span>去执行AudioServicesPlaySystemSound(xxxSoundID)都不会调用到这个回调。说的这么绕，其实就是说这俩接口的影响是全局的，威力很大。</span><br><span class="line">我们只要在回调方法里面再调用AudioServicesPlaySystemSound接口，就可以实现连续震动了；当我们想要停止震动时，调用remove接口，ok，回调方法就歇火了。</span><br><span class="line"></span><br><span class="line">优化：（参考某大神的博客，名字太长，直接附链接）</span><br><span class="line">http:<span class="comment">//blog.csdn.net/openglnewbee/article/details/8494598</span></span><br><span class="line">经过测试发现震动之间太连续，体验不符合要求；所以我们在c回调里面通过单例（全局变量性质的指针）调用到oc的方法进行[<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(triggerShake) withObject:<span class="literal">nil</span> afterDelay:<span class="number">1</span>]（triggerShake是震动接口);在停止震动时候我们需要调用</span><br><span class="line"></span><br><span class="line">[<span class="built_in">NSObject</span> cancelPreviousPerformRequestsWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(triggerShake)  object:<span class="literal">nil</span>];</span><br><span class="line">停止之前可能的回调；这两个方法的成对使用既好用又简便，对于需要定时调用的场景很适合，也免去维护定时器的麻烦。</span><br><span class="line"></span><br><span class="line">这个时候屏幕要是常亮就更好了，不用费脑子了，用这个！！！</span><br><span class="line">[[<span class="built_in">UIApplication</span> sharedApplication] setIdleTimerDisabled:<span class="literal">YES</span>];   <span class="comment">// 设置播放时屏幕常亮</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS实现一个颜色渐变的弧形进度条]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E9%A2%9C%E8%89%B2%E6%B8%90%E5%8F%98%E7%9A%84%E5%BC%A7%E5%BD%A2%E8%BF%9B%E5%BA%A6%E6%9D%A1/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>转自：<a href="https://www.ganlvji.com/gradient_circle_progress/###1、先来一个结果" target="_blank" rel="noopener">https://www.ganlvji.com/gradient_circle_progress/###1、先来一个结果</a><br>80%的状态：<br><a href="http://img.ganlvji.com/2014/03/80percent.png" target="_blank" rel="noopener"><img src="http://img.ganlvji.com/2014/03/80percent.png" alt="80percent"></a><br>99%的状态:<br><a href="http://img.ganlvji.com/2014/03/99percent.png" target="_blank" rel="noopener"><img src="http://img.ganlvji.com/2014/03/99percent.png" alt="99percent"></a></p>
<p>###2、需要用到的宏：</p>
<pre><code>#define degreesToRadians(x) (M_PI*(x)/180.0) //把角度转换成PI的方式
#define  PROGREESS_WIDTH 80 //圆直径 
#define PROGRESS_LINE_WIDTH 4 //弧线的宽度
</code></pre><p>###3、CAShapeLayer<br>首先，你得要引入Core Animation框架。为了实现环形效果，需要使用到CAShapeLayer，原理是CAShapeLayer可以通过指定Path的方式实现生成一个图形，非常方便。</p>
<p>###4、UIBezierPath</p>
<p>由于需要画一个圆形，UIBeziperPath是非常好用的画圆形的工具。实现下面的代码可以画出上面所示的整个轨道。这个圆形是从-210度的角度到30度。</p>
<pre><code>UIBezierPath *path = [UIBezierPath bezierPathWithArcCenter:CGPointMake(40, 40) radius:(PROGREESS_WIDTH-PROGRESS_LINE_WIDTH)/2 startAngle:degreesToRadians(-210) endAngle:degreesToRadians(30) clockwise:YES];
</code></pre><p>###5、画出一个完成的进度的背景轨道</p>
<p>这里原理很简单，就是使用CAShapeLayer和UIBezierPath结合起来就能够达成目标，这一步的结果如下所示：<br><a href="http://img.ganlvji.com/2014/03/0percent.png" target="_blank" rel="noopener"><img src="http://img.ganlvji.com/2014/03/0percent.png" alt="0percent"></a></p>
<pre><code>_trackLayer = [CAShapeLayer layer];//创建一个track shape layer
_trackLayer.frame = self.bounds;
[self.layer addSublayer:_trackLayer];
_trackLayer.fillColor = [[UIColor clearColor] CGColor];
 _trackLayer.strokeColor = [_strokeColor CGColor];//指定path的渲染颜色
_trackLayer.opacity = 0.25; //背景同学你就甘心做背景吧，不要太明显了，透明度小一点
_trackLayer.lineCap = kCALineCapRound;//指定线的边缘是圆的
_trackLayer.lineWidth = PROGRESS_LINE_WIDTH;//线的宽度
UIBezierPath *path = [UIBezierPath bezierPathWithArcCenter:CGPointMake(40, 40) radius:(PROGREESS_WIDTH-PROGRESS_LINE_WIDTH)/2 startAngle:degreesToRadians(-210) endAngle:degreesToRadians(30) clockwise:YES];//上面说明过了用来构建圆形
_trackLayer.path =[path CGPath]; //把path传递給layer，然后layer会处理相应的渲染，整个逻辑和CoreGraph是一致的。
</code></pre><p>###6、渐变进度条：<br>首先要明确的需求是，我们需要颜色根据百分比从红色渐变到黄色然后再到蓝色。<br>怎么实现这个颜色的渐变效果。这里我们需要使用到CAGradientLayer，CAGradientLayer是一个用来画颜色渐变的层（如果使用透明的颜色，也就可以做到透明渐变）。我们先用CAGradientLayer做出渐变效果，然后把ShapeLayer作为GradientLayer的Mask来截取出需要的部分，以此达到渐变的进度条效果。</p>
<p>首先，需要构建出顺着弧形的颜色渐变。上面的需求我们可以分解成两部分。<br>①左半部分，颜色从红色渐变到黄色。<br>②右半部分，颜色从黄色渐变到蓝色。<br>由此可以了解到是我们需要两个CAShapeLayer。<br>为什么要这么折腾？CAShapeLayer不能顺着弧线进行渐变只能指定两个点之间进行渐变。所以只能曲线救国了。<br>先看看这个部分的效果：<br><a href="http://img.ganlvji.com/2014/03/gradient.png" target="_blank" rel="noopener"><img src="http://img.ganlvji.com/2014/03/gradient.png" alt="gradient"></a><br>然后，创建一个新的CAShapeLayer来截取这个颜色渐变的层。<br>这部分代码如下所示：<br>            _progressLayer = [CAShapeLayer layer];<br>            _progressLayer.frame = self.bounds;<br>            _progressLayer.fillColor =  [[UIColor clearColor] CGColor];<br>            _progressLayer.strokeColor  = [PROCESS_COLOR CGColor];<br>            _progressLayer.lineCap = kCALineCapRound;<br>            _progressLayer.lineWidth = PROGRESS_LINE_WIDTH;<br>            _progressLayer.path = [path CGPath];<br>            _progressLayer.strokeEnd = 0;</p>
<pre><code>CALayer *gradientLayer = [CALayer layer];
CAGradientLayer *gradientLayer1 =  [CAGradientLayer layer];
gradientLayer1.frame = CGRectMake(0, 0, self.width/2, self.height);
[gradientLayer1 setColors:[NSArray arrayWithObjects:(id)[[UIColor redColor] CGColor],(id)[UIColorFromRGB(0xfde802) CGColor], nil]];
[gradientLayer1 setLocations:@[@0.5,@0.9,@1 ]];
[gradientLayer1 setStartPoint:CGPointMake(0.5, 1)];
[gradientLayer1 setEndPoint:CGPointMake(0.5, 0)];
[gradientLayer addSublayer:gradientLayer1];

CAGradientLayer *gradientLayer2 =  [CAGradientLayer layer];
[gradientLayer2 setLocations:@[@0.1,@0.5,@1]];
gradientLayer2.frame = CGRectMake(self.width/2, 0, self.width/2, self.height);
[gradientLayer2 setColors:[NSArray arrayWithObjects:(id)[UIColorFromRGB(0xfde802) CGColor],(id)[MAIN_BLUE CGColor], nil]];
[gradientLayer2 setStartPoint:CGPointMake(0.5, 0)];
[gradientLayer2 setEndPoint:CGPointMake(0.5, 1)];
[gradientLayer addSublayer:gradientLayer2];

[gradientLayer setMask:_progressLayer]; //用progressLayer来截取渐变层
[self.layer addSublayer:gradientLayer];
</code></pre><p>###7、进度条效果<br>走到上面一步我们得到的效果是一个进度为100%的效果，_progressLayer的长度和_trackLayer的长度是一样的。那么怎么解决百分比的问题呢？<br>CAShapeLayer有一个strokeEnd的属性，这个属性是从0到1的浮点类型，正好可以用表达百分比，而且这个属性是animatable，可以动态的表示进度的变化。<br>如下代码所示：<br>    -(void)setPercent:(NSInteger)percent animated:(BOOL)animated<br>    {<br>        [CATransaction begin];<br>        [CATransaction setDisableActions:!animated];<br>        [CATransaction setAnimationTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn]];<br>        [CATransaction setAnimationDuration:MAIN_SCREEN_ANIMATION_TIME];<br>        _progressLayer.strokeEnd = percent/100.0;<br>        [CATransaction commit];</p>
<pre><code>    _percent = percent;
}
</code></pre>]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS开发系列--Swift语言]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS%E5%BC%80%E5%8F%91%E7%B3%BB%E5%88%97--Swift%E8%AF%AD%E8%A8%80/</url>
      <content type="html"><![CDATA[<p>Swift是苹果2014年推出的全新的编程语言，它继承了C语言、ObjC的特性，且克服了C语言的兼容性问题。<br><a id="more"></a><br>来自：<a href="http://blog.csdn.net/jianxin160/article/details/47753245" target="_blank" rel="noopener">http://blog.csdn.net/jianxin160/article/details/47753245</a><br>概述<br>Swift是苹果2014年推出的全新的编程语言，它继承了C语言、ObjC的特性，且克服了C语言的兼容性问题。Swift发展过程中不仅保留了ObjC很多语法特性，它也借鉴了多种现代化语言的特点，在其中你可以看到C#、Java、Javascript、Python等多种语言的影子。同时在2015年的WWDC上苹果还宣布Swift的新版本Swift2.0，并宣布稍后Swift即将开源，除了支持iOS、OS X之外还将支持linux。<br>本文将继续iOS开发系列教程，假设读者已经有了其他语言基础（强烈建议初学者从本系列第一章开始阅读，如果您希望从Swift学起，那么推荐你首先阅读苹果官方电子书<a href="https://itunes.apple.com/us/book/swift-programming-language/id881256329?mt=11" target="_blank" rel="noopener">《the swift<br> programming language》</a>），不会从零基础一点点剖析这门语言的语法，旨在帮助大家快速从ObjC快速过度到Swift开发中。即便如此，要尽可能全面的介绍Swift的语法特点也不是一件容易的事情，因此本文将采用较长的篇幅进行介绍。</p>
<ol>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#basic" target="_blank" rel="noopener">基础部分</a>1. <a href="http://blog.csdn.net/jianxin160/article/details/47753245#firstSwift" target="_blank" rel="noopener">第一个Swift程序</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#dataType" target="_blank" rel="noopener">数据类型</a>1. <a href="http://blog.csdn.net/jianxin160/article/details/47753245#basicType" target="_blank" rel="noopener">基础类型</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#collectionType" target="_blank" rel="noopener">集合类型</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#tuple" target="_blank" rel="noopener">元组</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#optional" target="_blank" rel="noopener">可选类型</a></li>
</ol>
<ol start="5">
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#operator" target="_blank" rel="noopener">运算符</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#controlFlow" target="_blank" rel="noopener">控制流</a></li>
</ol>
<ol start="7">
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#functionAndClosures" target="_blank" rel="noopener">函数和闭包</a>1. <a href="http://blog.csdn.net/jianxin160/article/details/47753245#function" target="_blank" rel="noopener">函数</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#closures" target="_blank" rel="noopener">闭包</a></li>
</ol>
<ol start="3">
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#class" target="_blank" rel="noopener">类</a>1. <a href="http://blog.csdn.net/jianxin160/article/details/47753245#property" target="_blank" rel="noopener">属性</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#method" target="_blank" rel="noopener">方法</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#subscript" target="_blank" rel="noopener">下标脚本</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#inheritance" target="_blank" rel="noopener">继承</a></li>
</ol>
<ol start="5">
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#protocol" target="_blank" rel="noopener">协议</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#extension" target="_blank" rel="noopener">扩展</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#enumAndStruct" target="_blank" rel="noopener">枚举和结构体</a>1. <a href="http://blog.csdn.net/jianxin160/article/details/47753245#struct" target="_blank" rel="noopener">结构体</a></li>
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#enum" target="_blank" rel="noopener">枚举</a></li>
</ol>
<ol start="3">
<li><a href="http://blog.csdn.net/jianxin160/article/details/47753245#generic" target="_blank" rel="noopener">泛型</a></li>
</ol>
<p>#<a href></a>基础部分</p>
<p>##<a href></a>第一个Swift程序<br>创建一个命令行程序如下：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  Swift没有main函数，默认从top level code的上方开始自上而下执行（因此不能有多个top level代码）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">println</span>(<span class="string">"Hello, World!"</span>)</span><br></pre></td></tr></table></figure>
<p>从上面的代码可以看出：</p>
<ol>
<li>Swift没有main函数，从top level code的上方开始往下执行（就是第一个非声明语句开始执行[表达式或者控制结构，类、结构体、枚举和方法等属于声明语句]），不能存在多个top level code文件(否则编译器无法确定执行入口，事实上swift隐含一个main函数，这个main函数会设置并调用全局 “C_ARGC C_ARGV”并调用由top level code构成的top_level_code()函数)；</li>
<li>Swift通过import引入其他类库（和Java比较像）；</li>
<li>Swift语句不需要双引号结尾（尽管加上也不报错），除非一行包含多条语句（和Python有点类似）；</li>
</ol>
<p>##<a href></a>数据类型<br>Swift包含了C和ObjC语言中的所有基础类型，Int整形，Float和Double浮点型，Bool布尔型，Character字符型，String字符串类型；当然还包括enum枚举、struct结构体构造类型；Array数组、Set集合、Dictionary字典集合类型；不仅如此还增加了高阶数据类型元组（Tuple），可选类型（Optinal）。</p>
<p>###<a href></a>基础类型<br>Xcode 从6.0开始加入了Playground代码测试，可以实时查看代码执行结果，下面使用Playground简单演示一下Swift的基础内容，对Swift有个简单的认识：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a:<span class="type">Int</span>=<span class="number">1</span> <span class="comment">//通过var定义一个变量</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//下面变量b虽然没有声明类型，但是会自动进行类型推断，这里b推断为Int类型</span></span><br><span class="line"><span class="keyword">var</span> b=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="built_in">c</span>:<span class="type">UInt</span>=<span class="number">3</span></span><br><span class="line"><span class="keyword">let</span> d=a+b <span class="comment">//通过let定义一个变量</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//下面通过"\()"实现了字符串和变量相加(字符串插值)，等价于println("d="+String(d))</span></span><br><span class="line"><span class="built_in">println</span>(<span class="string">"d=\(d)"</span>) <span class="comment">//结果：d=3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//注意由于Swift是强类型语言，a是Int类型而c是UInt类型，二者不能运算，下面的语句报错;但是注意如果是类似于：let a=1+2.0是不会报错的，因为两个都是字面量，Swift会首先计算出结果再推断a的类型</span></span><br><span class="line"><span class="comment">//let e=a+c</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Int.max是Int类型的最大值，类似还有Int.min、Int32.max、Int32.min等</span></span><br><span class="line"><span class="keyword">let</span> e=<span class="type">Int</span>.<span class="built_in">max</span> <span class="comment">//结果：9223372036854775807</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f:<span class="type">Float</span>=<span class="number">1.0</span></span><br><span class="line"><span class="keyword">var</span> g=<span class="number">2.0</span> <span class="comment">//浮点型自动推断为Double类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> h:<span class="type">String</span>=<span class="string">"hello "</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//emoj表情也可以作为变量或者常量，事实上所有Unicode字符都是可以的</span></span><br><span class="line"><span class="keyword">var</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS开发拓展篇—CoreLocation简单介绍]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS%E5%BC%80%E5%8F%91%E6%8B%93%E5%B1%95%E7%AF%87%E2%80%94CoreLocation%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p><strong>一、简介</strong><br>1.在移动互联网时代，移动app能解决用户的很多生活琐事，比如<br>（1）导航：去任意陌生的地方<br>（2）周边：找餐馆、找酒店、找银行、找电影院</p>
<p>2.在上述应用中，都用到了地图和定位功能，在iOS开发中，要想加入这2大功能，必须基于2个框架进行开发<br>（1）Map Kit ：用于地图展示<br>（2）Core Location ：用于地理定位</p>
<p>3.两个热门专业术语<br>（1）LBS ：Location Based Service（基于定位的服务）<br>（2）SoLoMo ：Social Local Mobile（索罗门）</p>
<p><strong>二、CoreLocation框架的使用</strong><br>1.CoreLocation框架使用前提<br>（1）导入框架<br>　　<img src="http://images.cnitblog.com/i/450136/201408/091531084436493.png" alt><br>说明：在Xcode5以后，不再需要我们手动导入<br>（2）导入主头文件<br>　　#import &lt;CoreLocation/CoreLocation.h&gt;</p>
<p>2.CoreLocation框架使用须知<br>CoreLocation框架中所有数据类型的前缀都是CL<br>CoreLocation中使用CLLocationManager对象来做用户定位</p>
<p><strong>三、经纬度等地理信息扫盲</strong><br>1.示意图<br><strong>　　<img src="http://images.cnitblog.com/i/450136/201408/091533193501020.png" alt></strong><br>2.本初子午线：穿过英国伦敦格林文治天文台<br>往东边（右边）走，是东经（E）<br>往西边（左边）走，是西经（W）<br>东西经各180°，总共360°</p>
<p>3.赤道：零度维度<br>往北边（上边）走，是北纬（N）<br>往南边（下边）走，是南纬（S）<br>南北纬各90°，总共180°</p>
<p>提示：横跨经度\纬度越大（1° ≈ 111km），表示的范围就越大，在地图上看到的东西就越小<br>4.我国的经纬度:<br>（1）中国的经纬度范围<br>纬度范围：N 3°51′ ~  N 53°33′<br>经度范围：E 73°33′ ~  E 135°05′<br>（2）部分城市的经纬度<br>　　<img src="http://images.cnitblog.com/i/450136/201408/091536473652603.png" alt></p>
<p><strong>四、模拟位置</strong><br>说明：在对程序进行测试的时候，设置手机模拟器的模拟位置（经纬度）<br><img src="http://images.cnitblog.com/i/450136/201408/091538586931958.png" alt>    <img src="http://images.cnitblog.com/i/450136/201408/091539108818080.png" alt></p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS隐藏状态栏]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS%E9%9A%90%E8%97%8F%E7%8A%B6%E6%80%81%E6%A0%8F/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">状态栏： 运营商时间电量的行</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark  隐藏状态栏</span></span><br><span class="line">-(<span class="built_in">BOOL</span>)prefersStatusBarHidden</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iPhone尺寸]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iPhone%E5%B0%BA%E5%AF%B8/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>/<em> 屏幕尺寸     物理pt     像素pxiPhone4     320 </em> 480    2倍iPhone4s<br> 320 <em> 480    2倍iPhone5<br>     320 </em> 568    2倍iPhone6<br>     375 <em> 667    2倍iPhone6plus<br> 414 </em> 736    3倍iPhone6s    375</p>
<ul>
<li>667    2倍iPhone6splus<br>414 <em> 736    3倍 </em>/<br>/*Icon.png             –  57×57          iPhone (ios5/6) <a href="mailto:Icon@2x.png" target="_blank" rel="noopener">Icon@2x.png</a>      – 114×114        iPhone Retina (ios5/6) </li>
</ul>
<p>Icon-72.png         – 72×72        iPad (ios5/6) <a href="mailto:Icon-72@2x.png" target="_blank" rel="noopener">Icon-72@2x.png</a>  - 144×144     iPad Retina (ios5/6)<br><a href="mailto:Icon-60@2x.png" target="_blank" rel="noopener">Icon-60@2x.png</a>  - 120x120     iphone &amp; ipod touch (ios7/8)<br><a href="mailto:Icon-60@3x.png" target="_blank" rel="noopener">Icon-60@3x.png</a>  - 180x180     iphone6 plus (ios8) </p>
<p>Icon-76.png         - 76x76         ipad2 &amp; ipad mini (ios7/8)<br><a href="mailto:Icon-76@2x.png" target="_blank" rel="noopener">Icon-76@2x.png</a> - 152x152      ipad retina (ios7/8)*/</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[model归档]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/model%E5%BD%92%E6%A1%A3/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">warning</span> 归档第一步：让model签订NSCoding协议</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Student</span> : <span class="title">NSObject</span>&lt;<span class="title">NSCoding</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>)<span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)<span class="built_in">NSInteger</span> age;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>)<span class="built_in">NSString</span> *gender;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Student.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">warning</span> 归档第二步：对model属性进行编码</span></span><br><span class="line">-(<span class="keyword">void</span>)encodeWithCoder:(<span class="built_in">NSCoder</span> *)aCoder</span><br><span class="line">&#123;</span><br><span class="line">    [aCoder encodeObject:<span class="keyword">self</span>.name forKey:<span class="string">@"name"</span>];</span><br><span class="line">    [aCoder encodeObject:<span class="keyword">self</span>.gender forKey:<span class="string">@"gender"</span>];</span><br><span class="line">    [aCoder encodeInteger:<span class="keyword">self</span>.age forKey:<span class="string">@"age"</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">warning</span> 归档第三步：对model进行解码</span></span><br><span class="line">-(<span class="keyword">id</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name =</span><br><span class="line">        [aDecoder decodeObjectForKey:<span class="string">@"name"</span>];</span><br><span class="line">        <span class="keyword">self</span>.gender =</span><br><span class="line">        [aDecoder decodeObjectForKey:<span class="string">@"gender"</span>];</span><br><span class="line">        <span class="keyword">self</span>.age =</span><br><span class="line">        [aDecoder decodeIntegerForKey:<span class="string">@"age"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">/***************写入model*************************/</span></span><br><span class="line">    <span class="comment">//缓存自定义model模型数据</span></span><br><span class="line">    <span class="comment">//需要使用iOS中归档/反归档，专门来存储model数据到本地</span></span><br><span class="line">   </span><br><span class="line"><span class="meta">#<span class="meta-keyword">warning</span> 归档第四步：对model进行归档操作</span></span><br><span class="line">    Student *stu = [[Student alloc]init];</span><br><span class="line">    stu.name = <span class="string">@"大水杯"</span>;</span><br><span class="line">    stu.gender = <span class="string">@"男"</span>;</span><br><span class="line">    stu.age = <span class="number">18</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *archiverPath = [documentPath stringByAppendingPathComponent:<span class="string">@"student"</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//归档类</span></span><br><span class="line">    <span class="built_in">BOOL</span> result3 =</span><br><span class="line">    [<span class="built_in">NSKeyedArchiver</span> archiveRootObject:stu toFile:archiverPath];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> (result3) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"归档成功"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"归档失败"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//反归档取出model数据</span></span><br><span class="line">    Student *stu1 = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithFile:archiverPath];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"name = %@ %@ %ld"</span>,stu1.name,stu1.gender,stu1.age);</span><br><span class="line">    <span class="comment">/***************写入model*************************/</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[UISearchController]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/UISearchController/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">self</span>.allMovieArray = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">self</span>.searchArray = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/************UITableView*************/</span></span><br><span class="line">    <span class="keyword">self</span>.myTableView = [[<span class="built_in">UITableView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">self</span>.view.frame.size.width, <span class="keyword">self</span>.view.frame.size.height) style:<span class="built_in">UITableViewStylePlain</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:<span class="keyword">self</span>.myTableView];</span><br><span class="line">    [_myTableView release];</span><br><span class="line">    <span class="keyword">self</span>.myTableView.delegate = <span class="keyword">self</span>;</span><br><span class="line">    <span class="keyword">self</span>.myTableView.dataSource = <span class="keyword">self</span>;</span><br><span class="line">    <span class="comment">/************UITableView*************/</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">/************UISearchController*************/</span></span><br><span class="line">    <span class="comment">//创建UISearchController</span></span><br><span class="line">    <span class="keyword">self</span>.searchController = [[<span class="built_in">UISearchController</span> alloc] initWithSearchResultsController:<span class="literal">nil</span>];</span><br><span class="line">    <span class="keyword">self</span>.myTableView.tableHeaderView = <span class="keyword">self</span>.searchController.searchBar;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//成为代理</span></span><br><span class="line">    <span class="keyword">self</span>.searchController.searchResultsUpdater = <span class="keyword">self</span>;</span><br><span class="line">    <span class="comment">/************UISearchController*************/</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="comment">/************interface*************/</span></span><br><span class="line">    <span class="comment">//设置开始搜索时背景显示与否 页面背景阴影效果,一般不要设置.</span></span><br><span class="line">    <span class="keyword">self</span>.searchController.dimsBackgroundDuringPresentation = <span class="literal">NO</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//设置点击搜索框时候隐藏导航栏</span></span><br><span class="line">    <span class="keyword">self</span>.searchController.hidesNavigationBarDuringPresentation = <span class="literal">NO</span>;</span><br><span class="line">    <span class="comment">/************interface*************/</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">/************searchBar*************/</span></span><br><span class="line">    <span class="keyword">self</span>.searchController.searchBar.frame = <span class="built_in">CGRectMake</span>(<span class="keyword">self</span>.searchController.searchBar.frame.origin.x, <span class="keyword">self</span>.searchController.searchBar.frame.origin.y, <span class="keyword">self</span>.searchController.searchBar.frame.size.width, <span class="number">44.0</span>);</span><br><span class="line"><span class="comment">//    [searchBar sizeToFit]:设置searchBar位置自适应</span></span><br><span class="line">    [<span class="keyword">self</span>.searchController.searchBar sizeToFit];</span><br><span class="line">    <span class="comment">/************searchBar*************/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*****************searchMethod*********s*********/</span></span><br><span class="line"><span class="comment">//UISearchController的移除</span></span><br><span class="line"><span class="comment">//在viewWillDisappear中要将UISearchController移除, 否则切换到下一个View中, 搜索框仍然会有短暂的存在.</span></span><br><span class="line">- (<span class="keyword">void</span>)viewWillDisappear:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewWillDisappear:animated];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.searchController.active) &#123;</span><br><span class="line">        <span class="keyword">self</span>.searchController.active = <span class="literal">NO</span>;</span><br><span class="line">        [<span class="keyword">self</span>.searchController.searchBar removeFromSuperview];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)updateSearchResultsForSearchController:(<span class="built_in">UISearchController</span> *)searchController &#123;</span><br><span class="line">    <span class="built_in">NSString</span> *searchString = [<span class="keyword">self</span>.searchController.searchBar text];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"===%@"</span>,searchString);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">NSPredicate</span> *preicate = [<span class="built_in">NSPredicate</span> predicateWithFormat:<span class="string">@"SELF CONTAINS[c] %@"</span>, searchString];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.searchArray!= <span class="literal">nil</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.searchArray removeAllObjects];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//过滤数据</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     对象数组过滤</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     ios提供了一个filteredArrayUsingPredicate 方法，通过给定条件来进行过滤，过滤后形成一个新的数组。 而NSMutableArray提供了一个filterUsingPredicate方法，在原数组中保留符合条件的数组元素。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">self</span>.searchArray= [<span class="built_in">NSMutableArray</span> arrayWithArray:[<span class="keyword">self</span>.allMovieArray filteredArrayUsingPredicate:preicate]];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"searchArray===%@"</span>,<span class="keyword">self</span>.searchArray);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//刷新表格</span></span><br><span class="line">    [<span class="keyword">self</span>.myTableView reloadData];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*****************searchMethod*********s*********/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*****************tableviewmethod*********s*********/</span></span><br><span class="line">-(<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">     <span class="comment">//如果searchController是活动状态,说明是当前正在搜索</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.searchController.active) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.searchArray.count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.allMovieArray.count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">     <span class="keyword">static</span> <span class="built_in">NSString</span> *cellIdentifier = <span class="string">@"cell"</span>;</span><br><span class="line">    <span class="built_in">UITableViewCell</span> *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];</span><br><span class="line">    <span class="keyword">if</span> (cell == <span class="literal">nil</span>) &#123;</span><br><span class="line">       </span><br><span class="line">        cell = [[<span class="built_in">UITableViewCell</span> alloc] initWithStyle:<span class="built_in">UITableViewCellStyleDefault</span> reuseIdentifier:cellIdentifier];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.searchController.active) &#123;</span><br><span class="line">        cell.textLabel.text = [<span class="keyword">self</span>.searchArray objectAtIndex:indexPath.row];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        cell.textLabel.text = [<span class="keyword">self</span>.allMovieArray objectAtIndex:indexPath.row];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView didSelectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    DetailViewController *detailVC = [[DetailViewController alloc] init];</span><br><span class="line">    <span class="comment">//如果searchController是活动状态,说明是当前正在搜索</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.searchController.active) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"选中搜索列表"</span>);</span><br><span class="line">        detailVC.movieName = [<span class="keyword">self</span>.searchArray objectAtIndex:indexPath.row];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"选中所有列表"</span>);</span><br><span class="line">        detailVC.movieName = [<span class="keyword">self</span>.allMovieArray objectAtIndex:indexPath.row];</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="keyword">self</span>.navigationController pushViewController:detailVC animated:<span class="literal">YES</span>];</span><br><span class="line">    [detailVC release];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-(<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*****************tableviewmethod*********s*********/</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[oc 播放gif动画]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/oc%20%E6%92%AD%E6%94%BEgif%E5%8A%A8%E7%94%BB/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设定位置和大小</span></span><br><span class="line">    <span class="built_in">CGRect</span> frame = <span class="built_in">CGRectMake</span>(<span class="number">50</span>,<span class="number">50</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    frame.size = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"load.gif"</span>].size;</span><br><span class="line">    <span class="comment">// 读取gif图片数据</span></span><br><span class="line">    <span class="built_in">NSData</span> *gif = [<span class="built_in">NSData</span> dataWithContentsOfFile: [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"load"</span> ofType:<span class="string">@"gif"</span>]];</span><br><span class="line">    <span class="comment">// view生成</span></span><br><span class="line">    <span class="built_in">UIWebView</span> *webView = [[<span class="built_in">UIWebView</span> alloc] initWithFrame:frame];</span><br><span class="line">    webView.userInteractionEnabled = <span class="literal">NO</span>;<span class="comment">//用户不可交互</span></span><br><span class="line">    [webView loadData:gif MIMEType:<span class="string">@"image/gif"</span> textEncodingName:<span class="literal">nil</span> baseURL:<span class="literal">nil</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:webView];</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[runtime 运行时机制 完全解读]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/runtime%20%E8%BF%90%E8%A1%8C%E6%97%B6%E6%9C%BA%E5%88%B6%20%E5%AE%8C%E5%85%A8%E8%A7%A3%E8%AF%BB/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>我们前面已经讲过一篇runtime 原理，现在这篇文章主要介绍的是runtime是什么以及怎么用！希望对读者有所帮助！<br>首先，第一个问题，<br>1》runtime实现的机制是什么,怎么用，一般用于干嘛？<br>这个问题我就不跟大家绕弯子了，直接告诉大家，<br>runtime是一套比较底层的纯C语言API, 属于1个C语言库, 包含了很多底层的C语言API。<br>在我们平时编写的OC代码中, 程序运行过程时, 其实最终都是转成了runtime的C语言代码, runtime算是OC的幕后工作者<br>比如说，下面一个创建对象的方法中，<br>举例:<br>OC :<br>[[MJPerson alloc] init]<br>runtime :<br>objc_msgSend(objc_msgSend(“MJPerson” , “alloc”), “init”)<br>第二个问题<br>runtime 用来干什么呢？？用在那些地方呢？怎么用呢？<br>runtime是属于OC的底层, 可以进行一些非常底层的操作(用OC是无法现实的, 不好实现)</p>
<ul>
<li><p>在程序运行过程中, 动态创建一个类(比如KVO的底层实现)</p>
</li>
<li><p>在程序运行过程中, 动态地为某个类添加属性\方法, 修改属性值\方法</p>
</li>
<li><p>遍历一个类的所有成员变量(属性)\所有方法<br>例如：我们需要对一个类的属性进行归档解档的时候属性特别的多，这时候，我们就会写很多对应的代码，但是如果使用了runtime就可以动态设置！<br>例如，PYPerson.h的文件如下所示<br>#import </p>
</li>
</ul>
<p><a href="http://my.oschina.net/u/996807" target="_blank" rel="noopener">@interface</a> PYPerson : NSObject<br>@property (nonatomic, assign) int age;<br>@property (nonatomic, assign) int height;<br>@property (nonatomic, copy) NSString <em>name;<br>@property (nonatomic, assign) int age2;<br>@property (nonatomic, assign) int height2;<br>@property (nonatomic, assign) int age3;<br>@property (nonatomic, assign) int height3;<br>@property (nonatomic, assign) int age4;<br>@property (nonatomic, assign) int height4;<br><a href="http://my.oschina.net/u/567204" target="_blank" rel="noopener">@end</a><br>而PYPerson.m实现文件的内容如下
    </em><!-- lang: cpp -->*</p>
<pre><code>#import &quot;PYPerson.h&quot;
</code></pre><p>#import<br>@implementation PYPerson</p>
<ul>
<li><p>(void)encodeWithCoder:(NSCoder )encoder<br>{<br>unsigned int count = 0;<br>Ivar ivars = class_copyIvarList([PYPerson class], &amp;count);<br>for (int i = 0; i&lt;count; i++) {<br>  <em>// 取出i位置对应的成员变量</em><br>  Ivar ivar = ivars[i];</p>
<p>  <em>// 查看成员变量</em><br>  const char *name = ivar_getName(ivar);</p>
<p>  <em>// 归档</em><br>  NSString *key = [NSString stringWithUTF8String:name];<br>  id value = [self valueForKey:key];<br>  [encoder encodeObject:value forKey:key];</p>
</li>
</ul>
<p>}<br>free(ivars);<br>}</p>
<ul>
<li><p>(id)initWithCoder:(NSCoder <em>)decoder<br>{<br>if (self = [super init]) {<br>  unsigned int count = 0;<br>  Ivar </em>ivars = class_copyIvarList([PYPerson class], &amp;count);</p>
<p>  for (int i = 0; i&lt;count; i++) {</p>
<pre><code>*// 取出i位置对应的成员变量*
Ivar ivar = ivars[i];

*// 查看成员变量*
const char *name = ivar_getName(ivar);

*// 归档*
NSString *key = [NSString stringWithUTF8String:name];
id value = [decoder decodeObjectForKey:key];

*// 设置到成员变量身上*
[self setValue:value forKey:key];
</code></pre><p>  }</p>
<p>  free(ivars);</p>
</li>
</ul>
<p>}<br>return self;<br>}</p>
<p><a href="http://my.oschina.net/u/567204" target="_blank" rel="noopener">@end</a><br>这样我们可以看到归档和解档的案例其实是runtime写下的<br>学习，runtime机制首先要了解下面几个问题<br>1相关的头文件和函数<br>1&gt; 头文件</p>
<ul>
<li>利用头文件，我们可以查看到runtime中的各个方法！ </li>
</ul>
<p>2&gt; 相关应用</p>
<ul>
<li>NSCoding(归档和解档, 利用runtime遍历模型对象的所有属性)</li>
<li>字典 –&gt; 模型 (利用runtime遍历模型对象的所有属性, 根据属性名从字典中取出对应的值, 设置到模型的属性上)</li>
<li>KVO(利用runtime动态产生一个类)</li>
<li>用于封装框架(想怎么改就怎么改)<br>这就是我们runtime机制的只要运用方向</li>
</ul>
<p>3&gt; 相关函数</p>
<ul>
<li>objc_msgSend : 给对象发送消息</li>
<li>class_copyMethodList : 遍历某个类所有的方法</li>
<li>class_copyIvarList : 遍历某个类所有的成员变量</li>
<li>class_…..<br>这是我们学习runtime必须知道的函数！</li>
</ul>
<p>4.必备常识<br>1&gt; Ivar : 成员变量<br>2&gt; Method : 成员方法<br>从上面例子中我们看到我们定义的成员变量，如果要是动态创建方法，可以使用Method，<br>也许，看到这里，你是否对runtime有了更深入的了解呢？在这里，希望我们大家相互交流！有什么错误之处，还请指正 </p>
<p>RunTime简称运行时。就是系统在运行的时候的一些机制，其中最主要的是消息机制。对于C语言，函数的调用在编译的时候会决定调用哪个函数（ C语言的函数调用请看这里 ）。编译完成之后直接顺序执行，无任何二义性。OC的函数调用成为消息发送。属于动态调用过程。在编译的时候并不能决定真正调用哪个函数（事实证明，在编 译阶段，OC可以调用任何函数，即使这个函数并未实现，只要申明过就不会报错。而C语言在编译阶段就会报错）。只有在真正运行的时候才会根据函数的名称找 到对应的函数来调用。<br>那OC是怎么实现动态调用的呢？下面我们来看看OC通过发送消息来达到动态调用的秘密。假如在OC中写了这样的一个代码：<br>1<code>[obj makeText];</code>其中obj是一个对象，makeText是一个函数名称。对于这样一个简单的调用。在编译时RunTime会将上述代码转化成<br>1<code>objc_msgSend(obj,@selector(makeText));</code>首先我们来看看obj这个对象，iOS中的obj都继承于NSObject。<br>123<code>@interface NSObject &lt;nsobject&gt; {`</code>    <code>Class isa  OBJC_ISA_AVAILABILITY;</code>}<code>在NSObjcet中存在一个Class的isa指针。然后我们看看Class：
1234567891011121314</code>typedef struct objc_class <em>Class;<code>struct objc_class {</code>  <code>Class isa;</code>// 指向metaclass<code>` `</code>Class super_class ; <code>// 指向其父类</code>  <code></code>const char </em>name ; <code>// 类名</code>  <code>long version ;</code>// 类的版本信息，初始化默认为0，可以通过runtime函数class_setVersion和class_getVersion进行修改、读取<code></code>long info; <code>// 一些标识信息,如CLS_CLASS (0x1L) 表示该类为普通 class ，其中包含对象方法和成员变量;CLS_META (0x2L) 表示该类为 metaclass，其中包含类方法;</code>  <code>long instance_size ;</code>// 该类的实例变量大小(包括从父类继承下来的实例变量);<code></code>struct objc_ivar_list <em>ivars; <code>// 用于存储每个成员变量的地址</code>  <code>struct objc_method_list **methodLists ;</code>// 与 info 的一些标志位有关,如CLS_CLASS (0x1L),则存储对象方法，如CLS_META (0x2L)，则存储类方法;<code></code>struct objc_cache </em>cache; <code>// 指向最近使用的方法的指针，用于提升效率；</code>  <code>struct objc_protocol_list *protocols;</code>// 存储该类遵守的协议<code></code>}`</p>
<p>我们可以看到，对于一个Class类中，存在很多东西，下面我来一一解释一下：<br>Class isa：指向metaclass，也就是静态的Class。一般一个Obj对象中的isa会指向普通的Class，这个Class中存储普通成员变量和对 象方法（“-”开头的方法），普通Class中的isa指针指向静态Class，静态Class中存储static类型成员变量和类方法（“+”开头的方 法）。<br>Class super_class:指向父类，如果这个类是根类，则为NULL。<br>下面一张图片很好的描述了类和对象的继承关系：<br><img src="cid:f919a9e0f1d396baac9ed7f8fdc4a3be" alt="iuqQFnm.png" title="1413628797629491.png"><br><strong>注意</strong>：所有metaclass中isa指针都指向跟metaclass。而跟metaclass则指向自身。Root metaclass是通过继承Root class产生的。与root class结构体成员一致，也就是前面提到的结构。不同的是Root metaclass的isa指针指向自身。<br>Class类中其他的成员这里就先不做过多解释了，下面我们来看看：<br><strong>@selector (makeText)</strong>：这是一个SEL方法选择器。SEL其主要作用是快速的通过方法名字（makeText）查找到对应方法的函数指针，然后调用其函 数。SEL其本身是一个Int类型的一个地址，地址中存放着方法的名字。对于一个类中。每一个方法对应着一个SEL。所以iOS类中不能存在2个名称相同 的方法，即使参数类型不同，因为SEL是根据方法名字生成的，相同的方法名称只能对应一个SEL。<br>下面我们就来看看具体消息发送之后是怎么来动态查找对应的方法的。</p>
<p>首先，编译器将代码[obj makeText];转化为objc_msgSend(obj, @selector (makeText));，在objc_msgSend函数中。首先通过obj的isa指针找到obj对应的class。在Class中先去cache中 通过SEL查找对应函数method（猜测cache中method列表是以SEL为key通过hash表来存储的，这样能提高函数查找速度），若 cache中未找到。再去methodList中查找，若methodlist中未找到，则取superClass中查找。若能找到，则将method加<br> 入到cache中，以方便下次查找，并通过method中的函数指针跳转到对应的函数中去执行。 </p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[scrollView加约束]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/scrollView%E5%8A%A0%E7%BA%A6%E6%9D%9F/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>#尊重原创 转自：<a href="http://www.jianshu.com/p/1cfeb1eab6c6" target="_blank" rel="noopener">http://www.jianshu.com/p/1cfeb1eab6c6</a><br>#</p>
<p>#先办到能设置contentSize</p>
<ul>
<li>得添加一个额外的视图,占位</li>
<li>scrollView中只添加个UIView</li>
<li>其它的控件全部放在这个UIView上</li>
<li>设置UIView的高度,即为scrollView的contendSize</li>
<li>得设置水平居中</li>
<li>约束完毕</li>
</ul>
<p>##上下滚动</p>
<ul>
<li>1.添加一个UIView类型的子控件(这将是UIScrollView唯一的一个子控件)</li>
<li>2.上下左右0</li>
<li>3.高度(contentSize的高度,可滚动的高度)</li>
<li>4.水平居中</li>
</ul>
<p>##左右滚动</p>
<ul>
<li>1.添加一个UIView类型的子控件(这将是UIScrollView唯一的一个子控件)</li>
<li>2.上下左右0</li>
<li>3.宽度(contentSize的宽度,可滚动的宽度)</li>
<li>4.竖直居中</li>
</ul>
<p>##上下左右都能滚动</p>
<ul>
<li>1.添加一个UIView类型的子控件(这将是UIScrollView唯一的一个子控件)</li>
<li>2.上下左右0</li>
<li>3.宽度,高度(contentSize的宽度,可滚动的宽度,contentSize的高度,可滚动的高度)</li>
</ul>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[storyboard传值]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/storyboard%E4%BC%A0%E5%80%BC/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Navigation</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// In a storyboard-based application, you will often want to do a little preparation before navigation</span></span><br><span class="line">- (<span class="keyword">void</span>)prepareForSegue:(<span class="built_in">UIStoryboardSegue</span> *)segue sender:(<span class="keyword">id</span>)sender &#123;</span><br><span class="line">    <span class="comment">// Get the new view controller using [segue destinationViewController].</span></span><br><span class="line">    <span class="comment">// Pass the selected object to the new view controller.</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//得到点击的cell，sender是指触发跳转的那个控件，这里指的是点击的cell</span></span><br><span class="line">    <span class="built_in">UITableViewCell</span> *cell = (<span class="built_in">UITableViewCell</span> *)sender;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//通过当前被点击的cell得到点击位置</span></span><br><span class="line">    <span class="built_in">NSIndexPath</span> *selectedIndexPath = [<span class="keyword">self</span>.tableView indexPathForCell:cell];</span><br><span class="line">    </span><br><span class="line">    Roster *roster = <span class="keyword">self</span>.rosterArray[selectedIndexPath.row];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//得到要跳转的viewcontroller</span></span><br><span class="line">    ChatTableViewController *chatTableViewController = (ChatTableViewController *)[segue destinationViewController];</span><br><span class="line">    </span><br><span class="line">    chatTableViewController.chatToRoster = roster;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[tableview 下拉图片放大]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/tableview%20%E4%B8%8B%E6%8B%89%E5%9B%BE%E7%89%87%E6%94%BE%E5%A4%A7/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"RootViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">RootViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">RootViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.view.backgroundColor = [<span class="built_in">UIColor</span> lightGrayColor];</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span> setAutomaticallyAdjustsScrollViewInsets:<span class="literal">NO</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.myTableView = [[<span class="built_in">UITableView</span> alloc] initWithFrame:[[<span class="built_in">UIScreen</span> mainScreen] bounds] style:<span class="built_in">UITableViewStylePlain</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:<span class="keyword">self</span>.myTableView];</span><br><span class="line">    [_myTableView release];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置tableview的contentView距离上边界200</span></span><br><span class="line">    <span class="comment">//相对于0点,已经向下偏移了-200</span></span><br><span class="line">    <span class="keyword">self</span>.myTableView.contentInset = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">200.0</span>+<span class="number">64</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">self</span>.myTableView.delegate = <span class="keyword">self</span>;</span><br><span class="line">    <span class="keyword">self</span>.myTableView.dataSource = <span class="keyword">self</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//相对于0点,图片坐标应该是(0,-200)</span></span><br><span class="line">    <span class="keyword">self</span>.imageView = [[<span class="built_in">UIImageView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">-200.0</span>, <span class="keyword">self</span>.view.frame.size.width, <span class="number">200</span>)];</span><br><span class="line">    <span class="keyword">self</span>.imageView.image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"hua.jpg"</span>];</span><br><span class="line">    <span class="comment">//设置imageView高度改变时宽度也跟着改变</span></span><br><span class="line">    <span class="keyword">self</span>.imageView.contentMode = <span class="built_in">UIViewContentModeScaleAspectFill</span>;</span><br><span class="line">    [<span class="keyword">self</span>.myTableView addSubview:<span class="keyword">self</span>.imageView];</span><br><span class="line">    [_imageView release];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//指定多少行</span></span><br><span class="line">-(<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个cell</span></span><br><span class="line">-(<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *cellIdentifier = <span class="string">@"cell"</span>;</span><br><span class="line">  <span class="built_in">UITableViewCell</span> *cell =  [tableView dequeueReusableCellWithIdentifier:cellIdentifier];</span><br><span class="line">    <span class="keyword">if</span> (!cell) &#123;</span><br><span class="line">        cell = [[<span class="built_in">UITableViewCell</span> alloc] initWithStyle:<span class="built_in">UITableViewCellStyleDefault</span> reuseIdentifier:cellIdentifier];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cell.textLabel.text = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%ld"</span>,indexPath.row];</span><br><span class="line">    cell.selectionStyle =  <span class="built_in">UITableViewCellSelectionStyleNone</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cell;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//设置行高</span></span><br><span class="line">-(<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">80</span>;</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView didSelectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//点击后自动取消选中置灰效果</span></span><br><span class="line">    [tableView deselectRowAtIndexPath:indexPath animated:<span class="literal">YES</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//刚开始y的偏移量初始值就是-264</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"y1 === %f"</span>,scrollView.contentOffset.y);</span><br><span class="line">    <span class="built_in">CGFloat</span> y = scrollView.contentOffset.y + <span class="number">64</span>;<span class="comment">//加上导航栏高度,第一次是-200</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"y2 === %f"</span>,y);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (y &lt; <span class="number">-200</span>) &#123;</span><br><span class="line">        <span class="built_in">CGRect</span> frame = <span class="keyword">self</span>.imageView.frame;</span><br><span class="line">        frame.origin.y = y;<span class="comment">//imageView的frame是不断往上偏移</span></span><br><span class="line">        frame.size.height =  -y;<span class="comment">//tablview向下偏移了多少,高度就增加多少</span></span><br><span class="line">        <span class="keyword">self</span>.imageView.frame = frame;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)didReceiveMemoryWarning &#123;</span><br><span class="line">    [<span class="keyword">super</span> didReceiveMemoryWarning];</span><br><span class="line">    <span class="comment">// Dispose of any resources that can be recreated.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[view 的 clipsToBounds属性]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/view%20%E7%9A%84%20clipsToBounds%E5%B1%9E%E6%80%A7/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p><strong>取值：</strong>BOOL（YES/NO）<strong>作用：</strong>决定了子视图的显示范围当取值为YES时，超出父视图范围的子视图被剪裁不显示；当取值为NO时，超出父视图范围的子视图不被剪裁，显示。默认值为NO。<br>如下图所示：view2是view1的子视图<br><strong>取值为NO时：</strong><br><strong>取值为YES时：</strong><img src="http://img.blog.csdn.net/20160525095602290?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt><br><img src="http://img.blog.csdn.net/20160525095512445?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt></p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS之CF和OC之间类型转换]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS%E4%B9%8BCF%E5%92%8COC%E4%B9%8B%E9%97%B4%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>转自：<a href="http://blog.csdn.net/annkey123/article/details/8271806" target="_blank" rel="noopener">http://blog.csdn.net/annkey123/article/details/8271806</a></p>
<p>自 Xcode4.2 开始导入ARC机制后，为了支持对象间的转型，Apple又增加了许多转型用的关键字。这一讲我们就来了解其用法，以及产生的理由。</p>
<p>###<a href></a><a href></a>引子<br>我们先来看一下ARC无效的时候，我们写id类型转void*类型的写法：</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id obj &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSObject&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; alloc&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; init&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; obj&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>反过来，当把void*对象变回id类型时，只是简单地如下来写，</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id obj &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; p&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;obj release&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>但是上面的代码在ARC有效时，就有了下面的错误：</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;    error&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;implicit&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; conversion of an &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;Objective&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;C pointer&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;        to &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;’&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*’&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; disallowed &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; ARC&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; obj&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L3&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;                  &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L4&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt; &lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L5&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;    error&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;implicit&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; conversion of a non&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;Objective&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;C pointer&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L6&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;        type &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;’&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*’&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; to &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;’&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;’&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; disallowed &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; ARC&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L7&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;        id o &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; p&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L8&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>###<a href></a><a href></a><a href></a><strong>bridge<br>为了解决这一问题，我们使用 </strong>bridge 关键字来实现id类型与void*类型的相互转换。看下面的例子。</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id obj &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSObject&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; alloc&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; init&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt; &lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L3&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt; &lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L4&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id o &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge id&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>将Objective-C的对象类型用 <strong>bridge 转换为 void* 类型和使用 </strong>unsafe_unretained 关键字修饰的变量是一样的。被代入对象的所有者需要明确对象生命周期的管理，不要出现异常访问的问题。<br>除过 <strong>bridge 以外，还有两个 </strong>bridge 相关的类型转换关键字：</p>
<ul>
<li>__bridge_retained</li>
<li>__bridge_transfer</li>
</ul>
<p>接下来，我们将看看这两个关键字的区别。</p>
<p>####<a href></a><a href></a><a href></a><strong>bridge_retained<br>先来看使用 </strong>bridge_retained 关键字的例子程序：</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id obj &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSObject&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; alloc&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; init&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt; &lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge_retained &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>从名字上我们应该能理解其意义：类型被转换时，其对象的所有权也将被变换后变量所持有。如果不是ARC代码，类似下面的实现：</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id obj &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSObject&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; alloc&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; init&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt; &lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; obj&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L3&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p retain&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>可以用一个实际的例子验证，对象所有权是否被持有。</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;lit&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt; &lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt;&#123;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L3&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;    id obj &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSObject&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; alloc&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; init&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L4&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;    p &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge_retained &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L5&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt;&#125;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L6&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt; &lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L7&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSLog&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(@&lt;/span&gt;&lt;span class=&quot;str&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;&quot;class=%@&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge id&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;]);&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>出了大括号的范围后，p 仍然指向一个有效的实体。说明他拥有该对象的所有权，该对象没有因为出其定义范围而被销毁。</p>
<p>####<a href></a><a href></a><a href></a><strong>bridge_transfer<br>相反，当想把本来拥有对象所有权的变量，在类型转换后，让其释放原先所有权的时候，需要使用 </strong>bridge_transfer 关键字。文字有点绕口，我们还是来看一段代码吧。<br>如果ARC无效的时候，我们可能需要写下面的代码。</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;com&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt;// p 变量原先持有对象的所有权&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id obj &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;obj retain&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L3&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p release&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>那么ARC有效后，我们可以用下面的代码来替换：</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;com&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt;// p 变量原先持有对象的所有权&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id obj &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge_transfer id&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>可以看出来，<strong>bridge_retained 是编译器替我们做了 retain 操作，而 </strong>bridge_transfer 是替我们做了 release<a href="http://www.yifeiyang.net/development-of-the-iphone-simply-6/#fn.1" target="_blank" rel="noopener"></a>1。</p>
<p>###<a href></a><a href></a><a href></a>Toll-Free bridged<br>在iOS世界，主要有两种对象：Objective-C 对象和 Core Foundation 对象0。Core Foundation 对象主要是有C语言实现的 Core Foundation Framework 的对象，其中也有对象引用计数的概念，只是不是 Cocoa Framework::Foundation Framework 的 retain/release，而是自身的 CFRetain/CFRelease 接口。<br>这两种对象间可以互相转换和操作，不使用ARC的时候，单纯的用C原因的类型转换，不需要消耗CPU的资源，所以叫做 Toll-Free bridged。比如 NSArray和CFArrayRef, NSString和CFStringRef，他们虽然属于不同的 Framework，但是具有相同的对象结构，所以可以用标准C的类型转换。<br>比如不使用ARC时，我们用下面的代码：</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; stringWithFormat&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;:...];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; cfString &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>同样，Core Foundation类型向Objective-C类型转换时，也是简单地用标准C的类型转换即可。<br>但是在ARC有效的情况下，将出现类似下面的编译错误：</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;Cast&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; of &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;Objective&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;C pointer type &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;‘&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*’&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; to C pointer type &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;‘&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;’&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;aka &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;‘&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;struct&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; __CFString &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*’)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; requires a bridged cast&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;Use&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; __bridge to convert directly &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;no&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; change &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; ownership&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;Use&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; __bridge_retained to make an ARC &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; available &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; a &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;lit&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;‘&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;’&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;aka &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;‘&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;struct&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; __CFString &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*’)&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>错误中已经提示了我们需要怎样做：用 <strong>bridge 或者 </strong>bridge_retained 来转型，其差别就是变更对象的所有权。<br>正因为Objective-C是ARC管理的对象，而Core Foundation不是ARC管理的对象，所以才要特意这样转换，这与id类型向void*转换是一个概念。也就是说，当这两种类型（有ARC管理，没有ARC管理）在转换时，需要告诉编译器怎样处理对象的所有权。<br>上面的例子，使用 <strong>bridge/</strong>bridge_retained 后的代码如下：</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; stringWithFormat&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;:...];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; cfString &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>只是单纯地执行了类型转换，没有进行所有权的转移，也就是说，当string对象被释放的时候，cfString也不能被使用了。</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; stringWithFormat&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;:...];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; cfString &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge_retained &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt;...&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L3&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFRelease&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;cfString&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;// 由于Core Foundation的对象不属于ARC的管理范畴，所以需要自己release&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>使用 __bridge_retained 可以通过转换目标处（cfString）的 retain 处理，来使所有权转移。即使 string 变量被释放，cfString 还是可以使用具体的对象。只是有一点，由于Core Foundation的对象不属于ARC的管理范畴，所以需要自己release。<br>实际上，Core Foundation 内部，为了实现Core Foundation对象类型与Objective-C对象类型的相互转换，提供了下面的函数。</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFTypeRef&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFBridgingRetain&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id  X&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;&#123;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge_retained  &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFTypeRef&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt;&#125;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L3&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt; &lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L4&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;id  &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFBridgingRelease&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFTypeRef&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;  X&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;&#123;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L5&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge_transfer  id&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L6&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt;&#125;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>所以，可以用 CFBridgingRetain 替代 __bridge_retained 关键字：</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; stringWithFormat&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;:...];&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; cfString &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFBridgingRetain&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt;...&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L3&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFRelease&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;cfString&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;com&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;// 由于Core Foundation不在ARC管理范围内，所以需要主动release。&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p><strong>bridge_transfer所有权被转移的同时，被转换变量将失去对象的所有权。当Core Foundation对象类型向Objective-C对象类型转换的时候，会经常用到 </strong>bridge_transfer 关键字。</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; cfString &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringCreate&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;...();&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;__bridge_transfer &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*)&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;cfString&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L2&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt; &lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L3&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span class=&quot;com&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px; background-color: rgb(255, 255, 255);&quot;&gt;// CFRelease(cfString); 因为已经用 __bridge_transfer 转移了对象的所有权，所以不需要调用 release&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>同样，我们可以使用 CFBridgingRelease() 来代替 __bridge_transfer 关键字。</p>
<figure class="highlight plain"><figcaption><span>prettyprint linenums:1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol class=&quot;linenums&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px 0px 0px 26px;&quot;&gt;&lt;li value=&quot;1&quot; class=&quot;L0&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringRef&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; cfString &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFStringCreate&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;...();&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=&quot;L1&quot; style=&quot;border-width: 0px; margin: 0px 0px 0px 20px; padding: 0px; list-style-type: decimal;&quot;&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kwd&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;CFBridgingRelease&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;cfString&lt;/span&gt;&lt;span class=&quot;pun&quot; style=&quot;border-width: 0px; margin: 0px; padding: 0px;&quot;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<p>###<a href></a><a href></a><a href></a>总结<br>由上面的学习我们了解到 ARC 中类型转换的用法，那么我们实际使用中按照怎样的原则或者方法来区分使用呢，下面我总结了几点关键要素。</p>
<ul>
<li>明确被转换类型是否是 ARC 管理的对象- Core Foundation 对象类型不在 ARC 管理范畴内</li>
<li>Cocoa Framework::Foundation 对象类型（即一般使用到的Objectie-C对象类型）在 ARC 的管理范畴内</li>
</ul>
<ul>
<li>如果不在 ARC 管理范畴内的对象，那么要清楚 release 的责任应该是谁</li>
<li>各种对象的生命周期是怎样的</li>
</ul>
<hr>
<p><a href="http://www.yifeiyang.net/development-of-the-iphone-simply-6/#fnr.1" target="_blank" rel="noopener"></a>1. 声明 id obj 的时候，其实是缺省的申明了一个 <strong>strong 修饰的变量，所以编译器自动地加入了<br> retain 的处理，所以说 </strong>bridge_transfer 关键字只为我们做了 release 处理。</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[target action]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/target%20action/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>//自定义target:<br> action:方法</p>
<p>#warning第一步声明target和action属性@property(nonatomic,assign)idmyTarget;<br>@property(nonatomic,assign)SELmyAction;</p>
<p>#warning第二部声明方法-(void)addmyTarget:(id)target<br> Ation:(SEL)action;</p>
<p>#warning第三步实现方法<br>-(void)addmyTarget:(id)target<br> Ation:(SEL)action{</p>
<p>#warning第四步接收传进来的目标对象和行为方法<br>   self.myTarget= target;<br>   self.myAction= action;</p>
<p>}</p>
<p>#warning第五步使用目标对象去执行行为方法<br>-(void)touchesBegan:(NSSet<em>)touches withEvent:(UIEvent</em>)event<br>{</p>
<pre><code>[self.myTargetperformSelector:self.myActionwithObject:nil];}
</code></pre>]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[不规则瀑布流]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E4%B8%8D%E8%A7%84%E5%88%99%E7%80%91%E5%B8%83%E6%B5%81/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">WaterLayoutDelegate</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@required</span></span><br><span class="line">- (<span class="built_in">CGSize</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView</span><br><span class="line">                  layout:(<span class="built_in">UICollectionViewLayout</span> *)collectionViewLayout</span><br><span class="line">  sizeForItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WJY_WaterFallLayout</span> : <span class="title">UICollectionViewLayout</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="keyword">id</span>&lt;WaterLayoutDelegate&gt; delegate;</span><br><span class="line"><span class="comment">// 行数</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">NSInteger</span> lineCount;</span><br><span class="line"><span class="comment">// 水平间距</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> verticalSpacing;</span><br><span class="line"><span class="comment">// 垂直间距</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> horizontalSpacing;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">UIEdgeInsets</span> sectionInset;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"WJY_WaterFallLayout.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WJY_WaterFallLayout</span>()</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">retain</span>) <span class="built_in">NSMutableArray</span> *heights;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">retain</span>) <span class="built_in">NSMutableArray</span> *originX;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">retain</span>) <span class="built_in">NSMutableDictionary</span> *itemsArrange;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">retain</span>) <span class="built_in">NSMutableDictionary</span> *itemsInitialArrange;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">WJY_WaterFallLayout</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 重写，应 始终调用子类</span></span><br><span class="line">- (<span class="keyword">void</span>)prepareLayout</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 如果item 是0 返回</span></span><br><span class="line">    <span class="built_in">NSInteger</span> cellCount = [<span class="keyword">self</span>.collectionView numberOfItemsInSection:<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (cellCount == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 调转系统的协议方法 并设置代理</span></span><br><span class="line">    <span class="keyword">self</span>.delegate = (<span class="keyword">id</span>&lt;WaterLayoutDelegate&gt;)<span class="keyword">self</span>.collectionView.delegate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span>.itemsArrange = [<span class="built_in">NSMutableDictionary</span> dictionary];</span><br><span class="line">    <span class="keyword">self</span>.itemsInitialArrange = [<span class="built_in">NSMutableDictionary</span> dictionary];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> initAllarrays];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; cellCount; i++) &#123;</span><br><span class="line">        [</span><br><span class="line">         <span class="keyword">self</span> layoutForItemAtIndexPath:[<span class="built_in">NSIndexPath</span> indexPathForItem:i inSection:<span class="number">0</span>]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> 初始化所以数组</span></span><br><span class="line">- (<span class="keyword">void</span>)initAllarrays</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span>.heights = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">self</span>.originX = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="comment">// item宽度</span></span><br><span class="line">    <span class="built_in">CGFloat</span> itemWidth   = ([<span class="built_in">UIScreen</span> mainScreen].bounds.size.width - <span class="keyword">self</span>.sectionInset.left - <span class="keyword">self</span>.sectionInset.right - (<span class="keyword">self</span>.lineCount - <span class="number">1</span>) * <span class="keyword">self</span>.horizontalSpacing) / <span class="keyword">self</span>.lineCount;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="keyword">self</span>.lineCount; i++) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 循环添加 每行的每个top的点到 height数组中</span></span><br><span class="line">        [<span class="keyword">self</span>.heights addObject:[<span class="built_in">NSNumber</span> numberWithDouble:<span class="keyword">self</span>.sectionInset.top]];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//设置oringin_x 为0</span></span><br><span class="line">        <span class="built_in">CGFloat</span> oringin_x   = <span class="number">0.0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">         <span class="comment">//i = 0 x点 = left;</span></span><br><span class="line">            oringin_x = <span class="keyword">self</span>.sectionInset.left;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//  x = i + item宽 + 横向宽度</span></span><br><span class="line">            oringin_x = [<span class="keyword">self</span>.originX[i - <span class="number">1</span>] doubleValue] + itemWidth + <span class="keyword">self</span>.horizontalSpacing;</span><br><span class="line">        &#125;</span><br><span class="line">         <span class="comment">// 把得到的点加到 x数组中</span></span><br><span class="line">        [<span class="keyword">self</span>.originX addObject:[<span class="built_in">NSNumber</span> numberWithDouble: oringin_x]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - itme设置</span></span><br><span class="line">- (<span class="keyword">void</span>)layoutForItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGRect</span> rect = <span class="built_in">CGRectZero</span>;</span><br><span class="line">    <span class="comment">// 协议方法</span></span><br><span class="line">    <span class="built_in">CGSize</span> size = [<span class="keyword">self</span>.delegate collectionView:<span class="keyword">self</span>.collectionView layout:<span class="keyword">self</span> sizeForItemAtIndexPath:indexPath];</span><br><span class="line">    </span><br><span class="line">    rect.size.height = size.height;</span><br><span class="line">    </span><br><span class="line">    rect.size.width  = ([<span class="built_in">UIScreen</span> mainScreen].bounds.size.width  - <span class="keyword">self</span>.sectionInset.left - <span class="keyword">self</span>.sectionInset.right - (<span class="keyword">self</span>.lineCount - <span class="number">1</span>) * <span class="keyword">self</span>.horizontalSpacing) / <span class="keyword">self</span>.lineCount;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSInteger</span> index  = [<span class="keyword">self</span> getLowerHeightRowIndex:<span class="keyword">self</span>.heights];</span><br><span class="line">    </span><br><span class="line">    rect.origin.x = [<span class="keyword">self</span>.originX[index] doubleValue];</span><br><span class="line">    rect.origin.y = [<span class="keyword">self</span>.heights[index] doubleValue];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGFloat</span> newHeight = rect.origin.y + rect.size.height + <span class="keyword">self</span>.verticalSpacing;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.heights replaceObjectAtIndex:index withObject:[<span class="built_in">NSNumber</span> numberWithDouble: newHeight]];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.itemsArrange setObject:indexPath forKey:<span class="built_in">NSStringFromCGRect</span>(rect)];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.itemsInitialArrange setObject:indexPath forKey:<span class="built_in">NSStringFromCGRect</span>(<span class="built_in">CGRectMake</span>(rect.origin.x, rect.origin.y - [<span class="built_in">UIScreen</span> mainScreen].bounds.size.height, rect.size.width, rect.size.height))];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 子类必须重写此方法并使用它来返回的宽度和高度的视图的内容。这些值表示的宽度和高度的所有内容，视图使用此信息来配置其自身内容的大小，以便滚动。</span></span><br><span class="line">- (<span class="built_in">CGSize</span>)collectionViewContentSize</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGFloat</span> heightest = [<span class="keyword">self</span> getHeightest:<span class="keyword">self</span>.heights];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGSize</span> size = <span class="built_in">CGSizeMake</span>(<span class="number">0</span>, heightest);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 设置布局信息</span></span><br><span class="line">- (<span class="built_in">UICollectionViewLayoutAttributes</span> *)layoutAttributesForItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UICollectionViewLayoutAttributes</span> *attributes = [<span class="built_in">UICollectionViewLayoutAttributes</span> layoutAttributesForCellWithIndexPath:indexPath];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSArray</span> *keyArr = <span class="keyword">self</span>.itemsArrange.allKeys;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span> *rectStr <span class="keyword">in</span> keyArr) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.itemsArrange[rectStr] != indexPath) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">CGRect</span> rect = <span class="built_in">CGRectFromString</span>(rectStr);</span><br><span class="line">        </span><br><span class="line">        attributes.frame = rect;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> attributes;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 重新自定义layout</span></span><br><span class="line">- (<span class="built_in">UICollectionViewLayoutAttributes</span> *)initialLayoutAttributesForAppearingItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)itemIndexPath &#123;</span><br><span class="line">    <span class="comment">// layout初始化方法</span></span><br><span class="line">    <span class="built_in">UICollectionViewLayoutAttributes</span> *attributes = [<span class="built_in">UICollectionViewLayoutAttributes</span> layoutAttributesForCellWithIndexPath:itemIndexPath];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSArray</span> *keyArr = <span class="keyword">self</span>.itemsArrange.allKeys;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span> *rectStr <span class="keyword">in</span> keyArr) &#123;</span><br><span class="line">        <span class="comment">// item的rect信息和布局信息不等 就跳出本次循环</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.itemsInitialArrange[rectStr] != itemIndexPath) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">CGRect</span> rect = <span class="built_in">CGRectFromString</span>(rectStr);</span><br><span class="line">        </span><br><span class="line">        attributes.frame = rect;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> attributes;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 布局属性返回数组 视图在给定矩形</span></span><br><span class="line">- (<span class="built_in">NSArray</span> *)layoutAttributesForElementsInRect:(<span class="built_in">CGRect</span>)rect &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGFloat</span> up = rect.origin.y;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGFloat</span> down = rect.origin.y + rect.size.height;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSMutableArray</span> *attributes = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span> *rectStr <span class="keyword">in</span> <span class="keyword">self</span>.itemsArrange) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">CGRect</span> itemRect = <span class="built_in">CGRectFromString</span>(rectStr);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (itemRect.origin.y &lt;= down &amp;&amp; itemRect.origin.y + itemRect.size.height &gt;= up) &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">NSIndexPath</span> *indexPath = [<span class="keyword">self</span>.itemsArrange objectForKey:rectStr];</span><br><span class="line">            </span><br><span class="line">                    <span class="comment">//设置布局信息 添加到数组里</span></span><br><span class="line">            [attributes addObject:[<span class="keyword">self</span> layoutAttributesForItemAtIndexPath:indexPath]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> attributes;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta"># <span class="meta-keyword">pragma</span> mark - 获取低行高</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)getLowerHeightRowIndex:(<span class="built_in">NSMutableArray</span> *)height &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (height.count == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSInteger</span> index  = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGFloat</span> heightest = [height[<span class="number">0</span>] doubleValue];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSInteger</span> i  = <span class="number">1</span>; i &lt; height.count; i++) &#123;</span><br><span class="line">        <span class="comment">// 判定获取低行位置</span></span><br><span class="line">        index = heightest &gt; [height[i] doubleValue] ? i : index;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> index;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta"># <span class="meta-keyword">pragma</span> mark - 获取高度</span></span><br><span class="line">- (<span class="built_in">CGFloat</span>)getHeightest:(<span class="built_in">NSMutableArray</span> *)height &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (height.count == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGFloat</span> heightest = <span class="keyword">self</span>.sectionInset.top;</span><br><span class="line">    <span class="comment">// 遍历最高点</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSInteger</span> i  = <span class="number">0</span>; i &lt; height.count; i++) &#123;</span><br><span class="line">        <span class="comment">// 如果heightest为最高点返回返回 如果不是则返回height</span></span><br><span class="line">        heightest  = heightest &gt; [height[i] doubleValue] ? heightest : [height[i] doubleValue];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> heightest;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[不同数据类型转换]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E4%B8%8D%E5%90%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/</url>
      <content type="html"><![CDATA[<p>不同数据类型转换<br><a id="more"></a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/****************NSString 相关********************/</span></span><br><span class="line">    <span class="comment">//NSDictionary 转NSString</span></span><br><span class="line">    <span class="comment">//用字符串将nsarray的元素拼接起来</span></span><br><span class="line">    <span class="built_in">NSArray</span> *array = [<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"hello"</span>,<span class="string">@"world"</span>, <span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *string = [array componentsJoinedByString:<span class="string">@" "</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"string = %@"</span>,string );</span><br><span class="line">   </span><br><span class="line"> </span><br><span class="line">   </span><br><span class="line">    <span class="comment">//nsdata 转 nsstring</span></span><br><span class="line">    <span class="built_in">NSString</span> *strurl = <span class="string">@"www."</span>;</span><br><span class="line">    <span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:strurl];</span><br><span class="line">    <span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfURL:url];</span><br><span class="line">    <span class="built_in">NSString</span> *datastr1 = [[<span class="built_in">NSString</span> alloc]initWithData:data encoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"> <span class="comment">//   NSString 转换成NSData 对象</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSData</span>* Data = [<span class="string">@"testdata"</span> dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">  <span class="comment">//  NSData 转换成char*</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSData</span> *data2;</span><br><span class="line">    <span class="keyword">const</span>  <span class="keyword">char</span>* a=[data2 bytes];</span><br><span class="line">   </span><br><span class="line">  <span class="comment">//nsstring zhuan char</span></span><br><span class="line">    <span class="built_in">NSString</span> *str = <span class="string">@"dad"</span>;</span><br><span class="line">    <span class="keyword">const</span>  <span class="keyword">char</span> *q =[str UTF8String];</span><br><span class="line">   </span><br><span class="line"> <span class="comment">//   char* 转换成NSData对象</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    Byte* tempData = malloc(<span class="keyword">sizeof</span>(Byte)*<span class="number">16</span>);</span><br><span class="line">    <span class="built_in">NSData</span> *content=[<span class="built_in">NSData</span> dataWithBytes:tempData length:<span class="number">16</span>];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="comment">//    NSNumber转NSString:</span></span><br><span class="line">   </span><br><span class="line"><span class="comment">//    假设现有一NSNumber的变量A，要转换成NSString类型的B</span></span><br><span class="line">   </span><br><span class="line"><span class="comment">//    方法如下：</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSNumberFormatter</span>* numberFormatter = [[<span class="built_in">NSNumberFormatter</span> alloc] init];</span><br><span class="line">    <span class="built_in">NSNumber</span> *A = [[<span class="built_in">NSNumber</span> alloc]initWithInt:<span class="number">5</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *B;</span><br><span class="line">    B = [numberFormatter stringFromNumber:A];</span><br><span class="line">   </span><br><span class="line">    [numberFormatter release];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"> <span class="comment">//   nsstring和float 还有int之间的转换</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSString</span> *tempA = <span class="string">@"123"</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSString</span> *tempB = <span class="string">@"456"</span>;</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="comment">//    1，字符串拼接</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSString</span> *newString = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@%@"</span>,tempA,tempB];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="comment">//  2，字符转int</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">int</span> intString = [newString intValue];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="comment">//   3，int转字符</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSString</span> *stringInt = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%d"</span>,intString];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="comment">//4，字符转float</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">float</span> floatString = [newString floatValue];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="comment">//    5，万能公式其他转字符</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSString</span> *stringFloat = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%f"</span>,floatString];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">   <span class="comment">//nsdictionary 相关</span></span><br><span class="line"><span class="comment">//字典nsdictionary 转成json</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)dictionaryToJason:(<span class="built_in">NSDictionary</span> *)dic</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSData</span> *jsondata = [<span class="built_in">NSJSONSerialization</span> dataWithJSONObject:dic options:<span class="built_in">NSJSONWritingPrettyPrinted</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="keyword">return</span> [[<span class="built_in">NSString</span> alloc]initWithData:jsondata encoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[协议]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E5%8D%8F%E8%AE%AE/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">协议共分六步：<span class="number">1.</span>声明协议<span class="number">2.</span>声明代理人属性<span class="number">3.</span>执行协议方法<span class="number">4.</span>签订协议<span class="number">5.</span>指定代理人<span class="number">6.</span>实现协议方法<span class="comment">/******************声明协议的类****************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************声明协议的类.h****************************/</span><span class="meta">#<span class="meta-keyword">warning</span>协议第一步声明协议@protocolMarry <span class="meta-string">&lt;NSObject&gt;</span></span></span><br><span class="line">-(<span class="keyword">void</span>)makeMoney:(<span class="built_in">NSString</span>*)text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">warning</span>协议第二步声明代理人@interfaceGirl :NSObject@property(nonatomic,assign)id<span class="meta-string">&lt;Marry&gt;myDelegate;//assign弱引用，不会对内存引起记数变化</span></span></span><br><span class="line">-(<span class="keyword">void</span>)getMessage:(<span class="built_in">NSString</span>*)content;<span class="keyword">@end</span><span class="comment">/*********************************************************/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************声明协议的类.m****************************/</span><span class="meta">#<span class="meta-keyword">warning</span>协议第三步执行协议方法@implementationGirl-(void)getMessage:(NSString*)content</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">   <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,content);</span><br><span class="line">   <span class="comment">//使用代理人去执行协议方法</span></span><br><span class="line">    [<span class="keyword">self</span>.myDelegate makeMoney:<span class="string">@"赶快去赚钱!!!"</span>];</span><br><span class="line">   </span><br><span class="line">&#125;<span class="keyword">@end</span><span class="comment">/******************************************************/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/********************执行协议的类*************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/********************执行协议的类.h***********************/</span><span class="meta">#<span class="meta-keyword">warning</span>协议第四步签订协议#import<span class="meta-string">"Girl.h"</span>@interfaceBoy :NSObject<span class="meta-string">&lt;Marry&gt;</span></span></span><br><span class="line">-(<span class="keyword">void</span>)sendMessageToGirl:(<span class="built_in">NSString</span> *)content;<span class="keyword">@end</span><span class="comment">/*******************************************************/</span></span><br><span class="line"><span class="comment">/********************执行协议的类.m*************************/</span><span class="meta">#<span class="meta-keyword">warning</span>协议第五步指定代理人@implementationBoy</span></span><br><span class="line">-(<span class="keyword">void</span>)sendMessageToGirl:(<span class="built_in">NSString</span>*)content</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">   Girl*aGirl = [[Girlalloc]init];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">//指定代理人，一定要找到声明协议类的对象，因为代理人是Girl的一个属性，所以用Girl对象调用属性.</span></span><br><span class="line">    aGirl.myDelegate=<span class="keyword">self</span>;<span class="comment">//成为奴隶</span></span><br><span class="line">    [aGirlgetMessage:content];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">warning</span>协议第六步实现协议方法</span></span><br><span class="line">-(<span class="keyword">void</span>)makeMoney:(<span class="built_in">NSString</span>*)text</span><br><span class="line">&#123;</span><br><span class="line">   <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,text);</span><br><span class="line">&#125;<span class="keyword">@end</span><span class="comment">/******************************************************/</span></span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> oc </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[单例模式]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>单例模式：传值<br>    单一的实例 唯一的对象 全工程中唯一的一个对象<br>    作用是通过单例来保存工程中的多个页面中共享的对象和数据<br>    生命周期和程序的生命周期一样 当程序结束时单例对象释放掉<br><a id="more"></a><br>/<strong><strong><strong><strong>*</strong></strong></strong></strong>单例类.h<strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong>/<br>继承自NSObject：因为只处理数据，不需要显示，不需要控制传值</p>
<p>#import&lt;Foundation/Foundation.h&gt;</p>
<p>@interface DataHandle : NSObject</p>
<p>+(instancetype)shareDateHandle;<br>@property(nonatomic,copy)NSString <em>dataTitle;<br>@property(nonatomic,retain)NSMutableArray </em>allKeysArray;</p>
<p>@end<br>/<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>**</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/</p>
<p>/<strong><strong><strong><strong>*</strong></strong></strong></strong>单例类.m<strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong>/</p>
<p>#import “DataHandle.h”</p>
<p>@implementation DataHandle<br>+(instancetype)shareDateHandle<br>{</p>
<pre><code>//static声明静态变量
//特点：静态变量存储在静态区（全局区）只能初始化一次

static  DataHandle  *dataHandle = nil;
if (dataHandle == nil) {
    dataHandle = [[DataHandle alloc]init];
    [dataHandle setStudentDic];
}


return dataHandle;
</code></pre><p>}<br>@end<br>/<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/</p>
<p>/<strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong>取出数据<strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong>/<br>-(void)setStudentDic<br>{<br>    NSString <em>filePath = [[NSBundle mainBundle] pathForResource:@”Students” ofType:@”plist”];<br>    //通过文件路径取出字典<br>    NSMutableDictionary </em>bigDic = [NSMutableDictionary dictionaryWithContentsOfFile:filePath];<br>    NSLog(@”bigDic = %@”,bigDic);</p>
<pre><code>self.allStuDic = [NSMutableDictionary dictionary];

for (NSString *key in bigDic) {

    NSMutableArray *array = [bigDic objectForKey:key];

    NSMutableArray *stuArray = [NSMutableArray array];

    for (NSMutableDictionary *dic in array) {

        Student *stu = [[Student alloc] init];
</code></pre><p>//            stu.name = [dic objectForKey:@”name”];<br>            //使用KVC间接给属性赋值<br>[stu setValuesForKeysWithDictionary:dic];<br>            [stuArray addObject:stu];<br>            [stu release];</p>
<pre><code>    }

    [self.allStuDic setObject:stuArray forKey:key];

}


 self.allKeysArray = [NSMutableArray       arrayWithArray:self.allStuDic.allKeys];

//数组排序
[self.allKeysArray sortUsingSelector:@selector(compare:)];
</code></pre><p>}<br>/<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/</p>
<p><code>`</code></p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[category extension]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/category%20extension/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>category和extension用来做类扩展的，可以对现有类扩展功能或者修改其功能。在iOS中category应用是非常广泛的，系统自带的很多类都有多个category扩展功能。<br>一般category中可以定义新的方法、重写类原来的方法和添加readonly属性<br>而extension可以认为是匿名的category，但是这个extension相对于category有有一个特殊功能：在extension中可以定义可写的属性，公有可读、私有可写的属性(Publicly-Readable, Privately-Writeable Properties)一般这样实现！<br>举例说明如下：1. 创建测试程序empty application2. 我们自定义一个UIViewController，命名为RootViewController，它的.h文件为：###<a href></a>[代码]c#/cpp/oc代码：<br><code>01`</code>//<code>02</code>//<br> RootViewController.h<code>03</code>//<br> Test4<code>04</code>//<code>05</code>//<br> Created by Vincent on 13-5-29.<code>06</code>//<br> Copyright (c) 2013年 DevDiv Community. All rights reserved.<code>07</code>//<code>08` `09</code>#import<br> &lt;UIKit/UIKit.h&gt;<code>10` `11</code>@<code>interface` `RootViewController
 : UIViewController</code>12<code></code>@end`</p>
<p>那么在其对应的.m中会自动生成以下代码：###<a href></a>[代码]c#/cpp/oc代码：<br><code>01`</code>//<code>02</code>//<br> RootViewController.m<code>03</code>//<br> Test4<code>04</code>//<code>05</code>//<br> Created by Vincent on 13-5-29.<code>06</code>//<br> Copyright (c) 2013年 DevDiv Community. All rights reserved.<code>07</code>//<code>08` `09</code>#import<br> “RootViewController.h”<code>10` `11</code>@<code>interface` `RootViewController
 ()</code>12<code>@end</code>13<code></code>14<code>@implementation
 RootViewController</code>15<code></code>16<code></code>17<code>-
 (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil</code>18<code>{</code>19<code></code>self<br> = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];<code>20</code>    <code>if` `(self)
 {</code>21<code></code>//<br> Custom initialization<code>22</code>    <code>}</code>23<code></code>return<code></code>self;<code>24</code>}<code>25` `26</code>-<br> (<code>void</code>)viewDidLoad<code>27</code>{<code>28</code>    <code>[super
 viewDidLoad];</code>29<code></code>//<br> Do any additional setup after loading the view.<code>30</code>    <code>self.title
 =</code>@”RootController”<code>;</code>31<code></code>self.navigationItem<code>32</code>}<code>33` `34</code>-<br> (<code>void</code>)didReceiveMemoryWarning<code>35</code>{<code>36</code>    <code>[super
 didReceiveMemoryWarning];</code>37<code></code>//<br> Dispose of any resources that can be recreated.<code>38</code>}<code>39` `40</code>@end`</p>
<ol start="3">
<li>第2步中我们能看到###<a href></a>[代码]c#/cpp/oc代码：<br><code>1`</code>@<code>interface` `RootViewController
()</code>2<code></code>@end`<br>这个就是extension了（也就是特殊类型的category）<br>如果我们在.h添加这样一个属性@property (readonly) float value;那么RootViewController对外就暴露一个readonly的属性，它是公开的，所以外部是不能够对它进行写操作的。这时我们可以在extension加入以下代码：@property (readwrite) float value;那么这个属性在内部就是可读写的了，如果是只读只能在构造时期对它赋值，其他类方法中是不能对其赋值的。有了这个特性支持，那么类的内部方法均可以对其进行赋值了。</li>
</ol>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[在c的函数中调用oc的方法]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E5%9C%A8c%E7%9A%84%E5%87%BD%E6%95%B0%E4%B8%AD%E8%B0%83%E7%94%A8oc%E7%9A%84%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> soundCompleteCallback(SystemSoundID sound,<span class="keyword">void</span> * clientData) &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">    [[Single shareDateHandle] a];</span><br><span class="line">&#125;</span><br><span class="line">在程序中创建个单例</span><br><span class="line">使用单例调用方法，单例属于全局性的指针</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[和CFStringRef相关的CFSTR与和NSString相关的]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E5%92%8CCFStringRef%E7%9B%B8%E5%85%B3%E7%9A%84CFSTR%E4%B8%8E%E5%92%8CNSString%E7%9B%B8%E5%85%B3%E7%9A%84@/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">CoreFoundation里面的<span class="built_in">CFStringRef</span>和<span class="built_in">NSString</span>*是可以直接转换的，两种也都有一个相似的用来直接赋常量的操作。例如：</span><br><span class="line"></span><br><span class="line"><span class="built_in">CFStringRef</span> a = <span class="built_in">CFSTR</span>(<span class="string">"a"</span>);</span><br><span class="line"><span class="built_in">NSString</span> *b = <span class="string">@"b"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">CFSTR</span>是一个宏，这个宏的定义可能是<span class="built_in">CFStringMakeConstantString</span>，也可能是__builtin___CFStringMakeConstantString。如果是<span class="built_in">CFStringMakeConstantString</span>，看看<span class="built_in">CFStringMakeConstantString</span>的实现就会明白，<span class="built_in">CFSTR</span>(<span class="string">"a"</span>)是存放在一个全局字典里面的，下次用到<span class="built_in">CFSTR</span>(<span class="string">"a"</span>)的时候先查字典里面有没有，如果有就是用存在的，如果没有则分配一个，并且放到字典里面。</span><br><span class="line"></span><br><span class="line">所以这里有两个需要注意的，一：<span class="built_in">CFSTR</span>分配出来的字符串对象是不能自己释放的，如果你释放了下次在使用就会使用到一个野对象；二：多线程使用可能会出问题，因为全局的字典是没有锁的。</span><br><span class="line"></span><br><span class="line">而<span class="built_in">NSString</span>的@有些不一样，应该和__builtin___CFStringMakeConstantString有些类似，允许你多线程使用，同样也不需要你自己去release，可以理解为b是一个autorelease的对象，系统会自己自动收回b。如果想长时间持有b那就<span class="keyword">retain</span>，但不要忘了release。</span><br><span class="line"></span><br><span class="line">他们俩直接类型转换就可以了，比如</span><br><span class="line"><span class="built_in">CFStringRef</span> aCFString = (<span class="built_in">CFStringRef</span>)aNSString;</span><br><span class="line"><span class="built_in">NSString</span> *aNSString = (<span class="built_in">NSString</span> *)aCFString;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[夜间模式]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>夜间模式：利用继承与NSUserDefaults1.创建基类，负责夜间模式的转换2.所有的类都继承于基类，基类的模式改变了，所有子类的模式也改变了3.夜间模式触发的按钮发送通知4.利用NSUserDefault把模式保存到本地<br><a id="more"></a><br>/<strong><strong><strong>*</strong></strong></strong>基类.h<strong><strong>***</strong></strong>/#import”BaseViewController.h”</p>
<p>@interfaceBaseViewController()</p>
<p>@end</p>
<p>@implementationBaseViewController</p>
<ul>
<li>(void)viewDidLoad {<br>  [superviewDidLoad];<br> // Do any additional setup after loading the view.</li>
</ul>
<p>   //父亲默认颜色<br>   self.view.backgroundColor= [UIColorredColor];<br>   self.navigationController.navigationBar.barTintColor= [UIColorgreenColor];</p>
<p>   //注册通知<br>    [[NSNotificationCenterdefaultCenter]addObserver:selfselector:@selector(changeColor:)name:@”changeColor”object:nil];</p>
<p>   //判断模式<br>   NSString<em>str = [[NSUserDefaultsstandardUserDefaults]objectForKey:@”night”];<br>   if([strisEqualToString:@”yes”]) {<br>       self.view.backgroundColor= [UIColorlightGrayColor];<br>       self.navigationController.navigationBar.barTintColor= [UIColorblackColor];<br>    }<br>}<br>//接受通知触发的方法<br>-(void)changeColor:(NSNotification</em>)notification<br>{</p>
<p>   NSString*str = [[NSUserDefaultsstandardUserDefaults]objectForKey:@”night”];<br>   if([strisEqualToString:@”yes”]) {<br>       self.view.backgroundColor= [UIColorlightGrayColor];<br>       self.navigationController.navigationBar.barTintColor= [UIColorblackColor];<br>    }else<br>    {<br>       self.view.backgroundColor= [UIColorredColor];<br>       self.navigationController.navigationBar.barTintColor= [UIColorgreenColor];<br>    }</p>
<p>}</p>
<ul>
<li><p>(void)didReceiveMemoryWarning {<br>  [superdidReceiveMemoryWarning];<br> // Dispose of any resources that can be recreated.}@end/<strong><strong><strong>*</strong></strong></strong>基类.h<strong><strong><strong>***</strong></strong></strong>/<br>/<strong><strong><strong>*</strong></strong></strong>夜间模式触发的按钮<strong><strong><strong>***</strong></strong></strong>/ UIButton*button = [UIButtonbuttonWithType:UIButtonTypeCustom];<br>  [self.viewaddSubview:button];<br>  button.frame=CGRectMake(100,100,200,40);<br>  button.backgroundColor= [UIColorblackColor];</p>
<p>  [buttonaddTarget:selfaction:@selector(buttonAction)forControlEvents:UIControlEventTouchUpInside];</p>
</li>
</ul>
<p>}<br>-(void)buttonAction<br>{<br>   NSString*str = [[NSUserDefaultsstandardUserDefaults]objectForKey:@”night”];<br>   if([strisEqualToString:@”yes”]) {<br>        [[NSUserDefaultsstandardUserDefaults]setObject:@”no”forKey:@”night”];</p>
<pre><code>    [[NSNotificationCenterdefaultCenter]postNotificationName:@&quot;changeColor&quot;object:@&quot;no&quot;];
}else
{
    [[NSUserDefaultsstandardUserDefaults]setObject:@&quot;yes&quot;forKey:@&quot;night&quot;];

    [[NSNotificationCenterdefaultCenter]postNotificationName:@&quot;changeColor&quot;object:@&quot;yes&quot;];
}
</code></pre><p>   }/<strong><strong><strong>*</strong></strong></strong>夜间模式触发的按钮<strong><strong><strong>***</strong></strong></strong>/</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[屏幕横屏竖屏转换]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E5%B1%8F%E5%B9%95%E6%A8%AA%E5%B1%8F%E7%AB%96%E5%B1%8F%E8%BD%AC%E6%8D%A2/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//横屏</span></span><br><span class="line">  <span class="keyword">if</span> ([[<span class="built_in">UIDevice</span> currentDevice] respondsToSelector:<span class="keyword">@selector</span>(setOrientation:)]) &#123;</span><br><span class="line">      SEL selector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"setOrientation:"</span>);</span><br><span class="line">      <span class="built_in">NSInvocation</span> *invocation = [<span class="built_in">NSInvocation</span> invocationWithMethodSignature:[<span class="built_in">UIDevice</span> instanceMethodSignatureForSelector:selector]];</span><br><span class="line">      [invocation setSelector:selector];</span><br><span class="line">      [invocation setTarget:[<span class="built_in">UIDevice</span> currentDevice]];</span><br><span class="line">      <span class="keyword">int</span> val = <span class="built_in">UIInterfaceOrientationLandscapeRight</span>;</span><br><span class="line">      [invocation setArgument:&amp;val atIndex:<span class="number">2</span>];</span><br><span class="line">      [invocation invoke];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//竖屏</span></span><br><span class="line">  <span class="keyword">if</span> ([[<span class="built_in">UIDevice</span> currentDevice] respondsToSelector:<span class="keyword">@selector</span>(setOrientation:)]) &#123;</span><br><span class="line">      SEL selector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"setOrientation:"</span>);</span><br><span class="line">      <span class="built_in">NSInvocation</span> *invocation = [<span class="built_in">NSInvocation</span> invocationWithMethodSignature:[<span class="built_in">UIDevice</span> instanceMethodSignatureForSelector:selector]];</span><br><span class="line">      [invocation setSelector:selector];</span><br><span class="line">      [invocation setTarget:[<span class="built_in">UIDevice</span> currentDevice]];</span><br><span class="line">      <span class="keyword">int</span> val = <span class="built_in">UIInterfaceOrientationPortrait</span>;</span><br><span class="line">      [invocation setArgument:&amp;val atIndex:<span class="number">2</span>];</span><br><span class="line">      [invocation invoke];</span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[按照时间排序]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E6%8C%89%E7%85%A7%E6%97%B6%E9%97%B4%E6%8E%92%E5%BA%8F/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//排序 对时间进行排序</span></span><br><span class="line">    <span class="built_in">NSMutableArray</span> *dataArray=[[<span class="built_in">NSMutableArray</span> alloc]initWithCapacity:<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">NSMutableDictionary</span> *dir=[[<span class="built_in">NSMutableDictionary</span> alloc]init];</span><br><span class="line">    [dir setObject:<span class="string">@"2012-12-02"</span> forKey:<span class="string">@"time"</span>];</span><br><span class="line">    [dataArray addObject:dir];</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSMutableDictionary</span> *dir1=[[<span class="built_in">NSMutableDictionary</span> alloc]init];</span><br><span class="line">    [dir1 setObject:<span class="string">@"2012-02-15"</span> forKey:<span class="string">@"time"</span>];</span><br><span class="line">    [dataArray addObject:dir1];</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSMutableDictionary</span> *dir2=[[<span class="built_in">NSMutableDictionary</span> alloc]init];</span><br><span class="line">    [dir2 setObject:<span class="string">@"2012-03-02"</span> forKey:<span class="string">@"time"</span>];</span><br><span class="line">    [dataArray addObject:dir2];</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSMutableDictionary</span> *dir3=[[<span class="built_in">NSMutableDictionary</span> alloc]init];</span><br><span class="line">    [dir3 setObject:<span class="string">@"2000-03-02"</span> forKey:<span class="string">@"time"</span>];</span><br><span class="line">    [dataArray addObject:dir3];</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSMutableDictionary</span> *dir4=[[<span class="built_in">NSMutableDictionary</span> alloc]init];</span><br><span class="line">    [dir4 setObject:<span class="string">@"2112-03-02"</span> forKey:<span class="string">@"time"</span>];</span><br><span class="line">    [dataArray addObject:dir4];</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSMutableArray</span> *myArray=[[<span class="built_in">NSMutableArray</span> alloc]initWithCapacity:<span class="number">0</span>];</span><br><span class="line">    [myArray addObjectsFromArray:dataArray];</span><br><span class="line">    <span class="comment">//[myArray release];</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;[myArray count]; i++) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"排序前-----&gt;&gt;%@"</span>,[[myArray objectAtIndex:i] objectForKey:<span class="string">@"time"</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="built_in">NSSortDescriptor</span> *sorter = [[<span class="built_in">NSSortDescriptor</span> alloc]initWithKey:<span class="string">@"time"</span> ascending:<span class="literal">YES</span>];</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *sortDescriptors=[[<span class="built_in">NSMutableArray</span> alloc]initWithObjects:&amp;sorter count:<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">NSArray</span> *sortArray=[myArray sortedArrayUsingDescriptors:sortDescriptors];</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;[sortArray count]; i++) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"排序后-----&gt;&gt;%@"</span>,[[sortArray objectAtIndex:i] objectForKey:<span class="string">@"time"</span>]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[模态]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E6%A8%A1%E6%80%81/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>/<em>模态：就是从一个页面中弹出一个临时的页面，用来收集用户信息，常用于登陆注册页面</em>/</p>
<p>aViewController.m中调用bViewController.m的模态</p>
<p>aViewController.m/<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/在  - (void)viewDidLoad<br>  中用Button调用action方法-(void)action{      //1.用bViewController创建bViewController的对象bVC   bViewController*bVC = [[bViewControlleralloc]init];      //2.用self 调用模态控制器方法    //animated:是否有动画    [selfpresentViewController:bVCanimated:YEScompletion:^{   //可以设置方法处理事件<br>    }];       //3.设置模态样式     [bVCsetModalTransitionStyle:UIModalTransitionStyleFlipHorizontal];   </p>
<p>   }/<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/</p>
<p>bViewController.m /<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/在  - (void)viewDidLoad<br>  中用Button调用action方法-(void)action{<br>       //用self 调用模态控制器方法<br> 模态消失    [selfdismissViewControllerAnimated:YEScompletion:^{    //可以设置方法处理事件<br>    }];}/<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>/</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[汉字转拼音]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E6%B1%89%E5%AD%97%E8%BD%AC%E6%8B%BC%E9%9F%B3/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">带音标</span><br><span class="line"><span class="built_in">CFMutableStringRefstring</span> = <span class="built_in">CFStringCreateMutableCopy</span>(<span class="literal">NULL</span>,<span class="number">0</span>,<span class="built_in">CFSTR</span>(<span class="string">"中国"</span>));</span><br><span class="line">   <span class="built_in">CFStringTransform</span>(string,<span class="literal">NULL</span>,kCFStringTransformMandarinLatin,<span class="literal">NO</span>);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, string);</span><br><span class="line"> </span><br><span class="line">不带音标</span><br><span class="line"><span class="built_in">CFMutableStringRefstring</span> = <span class="built_in">CFStringCreateMutableCopy</span>(<span class="literal">NULL</span>,<span class="number">0</span>,<span class="built_in">CFSTR</span>(<span class="string">"中国"</span>));</span><br><span class="line">   <span class="built_in">CFStringTransform</span>(string,<span class="literal">NULL</span>,kCFStringTransformMandarinLatin,<span class="literal">NO</span>);</span><br><span class="line">    <span class="built_in">CFStringTransform</span>(string,<span class="literal">NULL</span>,kCFStringTransformStripDiacritics,<span class="literal">NO</span>);</span><br><span class="line">   <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, string);</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[数组 基本用法和排序]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E6%95%B0%E7%BB%84%20%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>1.创建数组</p>
<p><strong>[objc]</strong> <a href="http://blog.csdn.net/daiyelang/article/details/18726947#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/daiyelang/article/details/18726947#" title="copy" target="_blank" rel="noopener">copy</a><a href="https://code.csdn.net/snippets/169157" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/CODE_ico.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/169157/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/ico_fork.svg" alt="派生到我的代码片"></a>1. // 创建一个空的数组  </p>
<ol start="2">
<li>NSArray *array = [NSArray array];      </li>
<li>// 创建有1个元素的数组  </li>
<li>array = [NSArray arrayWithObject:@”123”];  </li>
<li>// 创建有多个元素的数组  </li>
<li>array = [NSArray arrayWithObjects:@”a”, @”b”, @”c”, nil nil];  </li>
<li>NSArray *array3 = [array arrayByAddingObjectsFromArray:[NSArray arrayWithObjects:@”4”, @”5”, nil nil]];  </li>
<li></li>
<li>NSArray *array4 = [NSArray arrayWithObjects:@”1”, @”2”, @”3”, @”4”, nil nil];  </li>
<li>NSRange range = NSMakeRange(1, 2);  </li>
<li>NSArray *array5 = [array4 subarrayWithRange:range];  </li>
</ol>
<p>2.数组的一些基本方法</p>
<p><strong>[objc]</strong> <a href="http://blog.csdn.net/daiyelang/article/details/18726947#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/daiyelang/article/details/18726947#" title="copy" target="_blank" rel="noopener">copy</a><a href="https://code.csdn.net/snippets/169157" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/CODE_ico.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/169157/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/ico_fork.svg" alt="派生到我的代码片"></a>1. int count = [array count];//个数  </p>
<ol start="2">
<li>// 判断是否包含了某个元素  </li>
<li>if ([array containsObject:@”a”]) {  </li>
<li>NSLog(@”包含了字符串a”);  </li>
<li>}  </li>
<li>NSString *last = [array lastObject];最后一个元素  </li>
<li>NSString *str = [array objectAtIndex:1];根据索引获取数组中的元素  </li>
<li>int index = [array indexOfObject:@”c”];获取指定元素的索引  </li>
<li>// 让数组里面的所有对象都调用test方法，123为参数  </li>
<li>NSArray *array = [NSArray arrayWithObjects:stu1, stu2, stu3, nil nil];  </li>
<li>[array makeObjectsPerformSelector:@selector(test2:) withObject:@”123”];  </li>
<li>NSArray *array = [NSArray arrayWithObjects:@”1”, @”2”, @”3”, @”4”, nil nil];  </li>
<li>// 1-2-3-4  </li>
<li>// 利用分隔符-拼接所有的数组元素  </li>
<li>NSString *str = [array componentsJoinedByString:@”-“];  </li>
<li>// 将一个数组写入文件（生成的是一个xml文件）  </li>
<li>NSString *path = @”/Users/apple/Desktop/array.xml”;  </li>
<li>[array writeToFile:path atomically:YES];  </li>
<li>path = @”/Users/apple/Desktop/array.txt”;  </li>
<li>// 从文件中读取数组内容（文件有严格的格式要求）  </li>
<li>NSArray *array2 = [NSArray arrayWithContentsOfFile:path];  </li>
</ol>
<p>3.遍历数组</p>
<p><strong>[objc]</strong> <a href="http://blog.csdn.net/daiyelang/article/details/18726947#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/daiyelang/article/details/18726947#" title="copy" target="_blank" rel="noopener">copy</a><a href="https://code.csdn.net/snippets/169157" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/CODE_ico.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/169157/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/ico_fork.svg" alt="派生到我的代码片"></a>1. #pragma mark 遍历数组1  </p>
<ol start="2">
<li>void arrayFor1() {  </li>
<li>NSArray *array = [NSArray arrayWithObjects:stu1, @”1”, @”2”, @”3”, nil nil];  </li>
<li>int count = array.count;  </li>
<li>for (int i = 0; i&lt;count; i++) {  </li>
<li>id obj = [array objectAtIndex:i];  </li>
<li>}  </li>
<li>}  </li>
<li></li>
<li>#pragma mark 遍历数组2 快速遍历  </li>
<li>void arrayFor2() {  </li>
<li>Student *stu1 = [Student student];  </li>
<li>NSArray *array = [NSArray arrayWithObjects:stu1, @”1”, @”2”, @”3”, nil nil];  </li>
<li>int i =0;  </li>
<li>for (id obj in array) {  </li>
<li>NSLog(@”%i-%@”, i, obj);  </li>
<li>i++;  </li>
<li>}  </li>
<li>}  </li>
<li></li>
<li>#pragma mark 遍历数组3  </li>
<li>void arrayFor3() {  </li>
<li>Student *stu1 = [Student student];  </li>
<li>NSArray *array = [NSArray arrayWithObjects:stu1, @”1”, @”2”, @”3”, nil nil];  </li>
<li>[array enumerateObjectsUsingBlock:  </li>
<li>^(id obj, NSUInteger idx, BOOLBOOL *stop) {  </li>
<li>NSLog(@”%i-%@”, idx, obj);  </li>
<li>// 如果索引为1，就停止遍历  </li>
<li>if (idx == 1) {  </li>
<li>// 利用指针修改外面BOOL变量的值  </li>
<li>*stop = YES;  </li>
<li>}  </li>
<li>}];  </li>
<li>}  </li>
<li></li>
<li>#pragma mark 遍历数组4  </li>
<li>void arrayFor4() {  </li>
<li>Student *stu1 = [Student student];  </li>
<li>NSArray *array = [NSArray arrayWithObjects:stu1, @”1”, @”2”, @”3”, nil nil];  </li>
<li>// 获取数组的迭代器  </li>
<li>// NSEnumerator *enumerator = [array objectEnumerator];  </li>
<li>// 反序迭代器（从尾部开始遍历元素）  </li>
<li>NSEnumerator *enumerator = [array reverseObjectEnumerator];  </li>
<li>// allObjects是取出没有被遍历过的对象  </li>
<li>NSArray *array2 = [enumerator allObjects];  </li>
<li>NSLog(@”array2:%@”, array2);  </li>
<li>// 获取下一个需要遍历的元素  </li>
<li>id obj = nil;  </li>
<li>while (obj = [enumerator nextObject]) {  </li>
<li>NSLog(@”obj=%@”, obj);  </li>
<li>}  </li>
<li>}  </li>
</ol>
<p>4.数组排序</p>
<p><strong>[objc]</strong> <a href="http://blog.csdn.net/daiyelang/article/details/18726947#" title="view plain" target="_blank" rel="noopener">view<br> plain</a><a href="http://blog.csdn.net/daiyelang/article/details/18726947#" title="copy" target="_blank" rel="noopener">copy</a><a href="https://code.csdn.net/snippets/169157" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/CODE_ico.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/169157/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="https://code.csdn.net/assets/ico_fork.svg" alt="派生到我的代码片"></a>1. #pragma mark 数组排序1  </p>
<ol start="2">
<li>void arraySort1() {  </li>
<li>NSArray *array = [NSArray arrayWithObjects:@”2”, @”3”, @”1”, @”4”, nil nil];  </li>
<li></li>
<li>// 返回一个排好序的数组，原来数组的元素顺序不会改变  </li>
<li>// 指定元素的比较方法：compare:  </li>
<li>NSArray *array2 = [array sortedArrayUsingSelector:@selector(compare:)];  </li>
<li>NSLog(@”array2:%@”, array2);  </li>
<li>}  </li>
<li></li>
<li>#pragma mark 数组排序2  </li>
<li>void arraySort2() {  </li>
<li>Student *stu1 = [Student studentWithFirstname:@”MingJie” lastname:@”Li”];  </li>
<li>Student *stu2 = [Student studentWithFirstname:@”LongHu” lastname:@”Huang”];  </li>
<li>Student *stu3 = [Student studentWithFirstname:@”LianJie” lastname:@”Li”];  </li>
<li>Student *stu4 = [Student studentWithFirstname:@”Jian” lastname:@”Xiao”];  </li>
<li>NSArray *array = [NSArray arrayWithObjects:stu1,stu2,stu3, stu4, nil nil];  </li>
<li>// 指定排序的比较方法  </li>
<li>NSArray *array2 = [array sortedArrayUsingSelector:@selector(compareStudent:)];  </li>
<li>NSLog(@”array2:%@”, array2);  </li>
<li>}  </li>
<li><ul>
<li>(NSComparisonResult)compareStudent:(Student *)stu {  </li>
</ul>
</li>
<li>// 先按照姓排序  </li>
<li>NSComparisonResult result = [self.lastname compare:stu.lastname];  </li>
<li>// 如果有相同的姓，就比较名字  </li>
<li>if (result == NSOrderedSame) {  </li>
<li>result = [self.firstname compare:stu.firstname];  </li>
<li>}  </li>
<li>return result;  </li>
<li>}  </li>
<li></li>
<li>#pragma mark 数组排序3  </li>
<li>void arraySort3() {  </li>
<li>Student *stu1 = [Student studentWithFirstname:@”MingJie” lastname:@”Li”];  </li>
<li>Student *stu2 = [Student studentWithFirstname:@”LongHu” lastname:@”Huang”];  </li>
<li>Student *stu3 = [Student studentWithFirstname:@”LianJie” lastname:@”Li”];  </li>
<li>Student *stu4 = [Student studentWithFirstname:@”Jian” lastname:@”Xiao”];  </li>
<li>NSArray *array = [NSArray arrayWithObjects:stu1,stu2,stu3, stu4, nil nil];  </li>
<li></li>
<li>// 利用block进行排序  </li>
<li>NSArray *array2 = [array sortedArrayUsingComparator:  </li>
<li>^NSComparisonResult(Student <em>obj1, Student </em>obj2) {  </li>
<li>// 先按照姓排序  </li>
<li>NSComparisonResult result = [obj1.lastname compare:obj2.lastname];  </li>
<li>// 如果有相同的姓，就比较名字  </li>
<li>if (result == NSOrderedSame) {  </li>
<li>result = [obj1.firstname compare:obj2.firstname];  </li>
<li>}  </li>
<li></li>
<li>return result;  </li>
<li>}];  </li>
<li></li>
<li>NSLog(@”array2:%@”, array2);  </li>
<li>}  </li>
<li></li>
<li>#pragma mark 数组排序4-高级排序  </li>
<li>void arraySort4() {  </li>
<li>Student *stu1 = [Student studentWithFirstname:@”MingJie” lastname:@”Li” bookName:@”book1”];  </li>
<li>Student *stu2 = [Student studentWithFirstname:@”LongHu” lastname:@”Huang” bookName:@”book2”];  </li>
<li>Student *stu3 = [Student studentWithFirstname:@”LianJie” lastname:@”Li” bookName:@”book2”];  </li>
<li>Student *stu4 = [Student studentWithFirstname:@”Jian” lastname:@”Xiao” bookName:@”book1”];  </li>
<li>NSArray *array = [NSArray arrayWithObjects:stu1,stu2,stu3, stu4, nil nil];  </li>
<li></li>
<li>// 1.先按照书名进行排序  </li>
<li>// 这里的key写的是@property的名称  </li>
<li>NSSortDescriptor *bookNameDesc = [NSSortDescriptor sortDescriptorWithKey:@”book.name” ascending:YES];  </li>
<li>// 2.再按照姓进行排序  </li>
<li>NSSortDescriptor *lastnameDesc = [NSSortDescriptor sortDescriptorWithKey:@”lastname” ascending:YES];  </li>
<li>// 3.再按照名进行排序  </li>
<li>NSSortDescriptor *firstnameDesc = [NSSortDescriptor sortDescriptorWithKey:@”firstname” ascending:YES];  </li>
<li>// 按顺序添加排序描述器  </li>
<li>NSArray *descs = [NSArray arrayWithObjects:bookNameDesc, lastnameDesc, firstnameDesc, nil nil];  </li>
<li></li>
<li>NSArray *array2 = [array sortedArrayUsingDescriptors:descs];  </li>
<li></li>
<li>NSLog(@”array2:%@”, array2);  </li>
<li>}  </li>
</ol>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[获取当前时间]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取当前时间</span></span><br><span class="line"><span class="built_in">NSDate</span> *date = [<span class="built_in">NSDate</span> date];</span><br><span class="line"><span class="comment">//时间格式</span></span><br><span class="line"><span class="built_in">NSDateFormatter</span> *dateFormatter = [[<span class="built_in">NSDateFormatter</span> alloc]init];</span><br><span class="line">dateFormatter.dateFormat = <span class="string">@"YYYY-MM-dd HH:mm:ss"</span>;</span><br><span class="line"><span class="comment">//时间转换</span></span><br><span class="line"><span class="built_in">NSString</span> *time = [dateFormatter stringFromDate:date];</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[计算字符串的宽或者高]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E8%AE%A1%E7%AE%97%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%AE%BD%E6%88%96%E8%80%85%E9%AB%98/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p><code>`</code>objc<br>/*<em> </em>返回值是该字符串所占的大小(width,<br> height)<br> <em>font :该字符串所用的字体(字体大小不一样,显示出来的面积也不同)
 </em>maxSize :为限制改字体的最大宽和高(如果显示一行,则宽高都设置为MAXFLOAT,如果显示为多行,只需将宽设置一个有限定长值,高设置为MAXFLOAT)<br> <em>/+(CGSize)sizeWithFont:(UIFont </em>)font maxSize:(CGSize)maxSize<br> content:(NSString <em>)content;<br>//返回字符串所占用的尺寸.<br>+(CGSize)sizeWithFont:(UIFont</em>)font maxSize:(CGSize)maxSize content:(NSString<em>)content<br>{<br>   NSDictionary</em>attrs =@{NSFontAttributeName: font};</p>
<p>   return[contentboundingRectWithSize:maxSizeoptions:NSStringDrawingUsesLineFragmentOriginattributes:attrscontext:nil].size;}</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[通知]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E9%80%9A%E7%9F%A5/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>#warning通知第一步，注册通知<br>   //    NSNotification消息通知类，是抽象类，使用他的子类，消息中心单例    [[NSNotificationCenterdefaultCenter] addObserver:selfselector:@selector(changeColor:)name:@”changeColor”object:nil];   #warning通知第二步，实现通知触发的方法<br>//当收到通知后，该方法会被执行<br>-(void)changeColor:(NSNotification*)notification<br>{</p>
<p>#warning通知第四步，接收消息<br>   UIColor<em>color = (UIColor</em>)[notificationobject];<br>   self.view.backgroundColor= color;}</p>
<p>#warning通知第三步，发送通知<br>    [[NSNotificationCenterdefaultCenter]postNotificationName:@”changeColor”object:[UIColorredColor]];    [[NSNotificationCenterdefaultCenter]postNotificationName:@”changeColor2”object:[UIColorredColor]];  </p>
<ul>
<li>(void)dealloc<br>{<br>  [[NSNotificationCenterdefaultCenter]removeObserver:selfname:@”changeColor”object:nil];<br>  [superdealloc];}</li>
</ul>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[让超出自己视图范围的子视图响应事件]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E8%AE%A9%E8%B6%85%E5%87%BA%E8%87%AA%E5%B7%B1%E8%A7%86%E5%9B%BE%E8%8C%83%E5%9B%B4%E7%9A%84%E5%AD%90%E8%A7%86%E5%9B%BE%E5%93%8D%E5%BA%94%E4%BA%8B%E4%BB%B6/</url>
      <content type="html"><![CDATA[<p>有时需要让子视图的位置超出父视图，这时子视图不会响应点击事件，在父视图中实现这个方法，可以让子视图超出的部分也响应点击事件<br>父视图需要是view的子类<br>这个方法可以判断出自己的子视图，和子视图的子视图，在多层的话需要继续遍历<br><a id="more"></a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//让超出自己视图范围的子视图响应事件</span></span><br><span class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//没有剪裁子视图 没有隐藏 透明度大于0.0</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">self</span>.clipsToBounds &amp;&amp; !<span class="keyword">self</span>.hidden &amp;&amp; <span class="keyword">self</span>.alpha &gt; <span class="number">0.0</span>)&#123;</span><br><span class="line">       </span><br><span class="line">        <span class="comment">//遍历子视图</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">UIView</span> *member <span class="keyword">in</span> <span class="keyword">self</span>.subviews)&#123;</span><br><span class="line">          </span><br><span class="line">            <span class="comment">//将相对于自己的点坐标转化为相对于子视图的点坐标</span></span><br><span class="line">            <span class="built_in">CGPoint</span> subPoint = [member convertPoint:point fromView:<span class="keyword">self</span>];</span><br><span class="line">            <span class="comment">//返回响应的view</span></span><br><span class="line">            <span class="built_in">UIView</span> *result = [member hitTest:subPoint withEvent:event];</span><br><span class="line">           </span><br><span class="line">            <span class="keyword">if</span>(result != <span class="literal">nil</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//遍历下一级子视图</span></span><br><span class="line">                <span class="keyword">if</span>(!member.clipsToBounds &amp;&amp; !member.hidden &amp;&amp; member.alpha &gt; <span class="number">0.0</span>)&#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="built_in">UIView</span> *member1 <span class="keyword">in</span> member.subviews)&#123;</span><br><span class="line">                       </span><br><span class="line">                        <span class="built_in">CGPoint</span> subPoint1 = [member1 convertPoint:subPoint fromView:member];</span><br><span class="line">                        <span class="built_in">UIView</span> *result1 = [member hitTest:subPoint1 withEvent:event];</span><br><span class="line">                        <span class="keyword">if</span>(result1 != <span class="literal">nil</span>)&#123;</span><br><span class="line">                            <span class="keyword">return</span> result1;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[通讯录]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E9%80%9A%E8%AE%AF%E5%BD%95/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>通讯录<br>AddressBook<br>iOS中带有一个Contacts应用程序来管理联系人，但是有些时候我们希望自己的应用能够访问或者修改这些信息，这个时候就要用到AddressBook.framework框架。iOS中的通讯录是存储在数据库中的，由于iOS的权限设计，开发人员是不允许直接访问通讯录数据库的，必须依靠AddressBook提供的标准API来实现通讯录操作。通过AddressBook.framework开发者可以从底层去操作AddressBook.framework的所有信息，但是需要注意的是这个框架是基于C语言编写的，无法使用ARC来管理内存，开发者需要自己管理内存。下面大致介绍一下通讯录操作中常用的类型：<br>ABAddressBookRef：代表通讯录对象，通过该对象开发人员不用过多的关注通讯录的存储方式，可以直接以透明的方式去访问、保存（在使用AddressBook.framework操作联系人时，所有的增加、删除、修改后都必须执行保存操作，类似于Core Data）等。<br>ABRecordRef：代表一个通用的记录对象，可以是一条联系人信息，也可以是一个群组，可以通过ABRecordGetRecordType()函数获得具体类型。如果作为联系人（事实上也经常使用它作为联系人），那么这个记录记录了一个完整的联系人信息（姓名、性别、电话、邮件等），每条记录都有一个唯一的ID标示这条记录（可以通过ABRecordGetRecordID()函数获得）。<br>ABPersonRef：代表联系人信息，很少直接使用，实际开发过程中通常会使用类型为“kABPersonType”的ABRecordRef来表示联系人（由此可见ABPersonRef其实是一种类型为“kABPersonType”的ABRecordRef）<br>ABGroupRef：代表群组，与ABPersonRef类似，很少直接使用ABGroupRef，而是使用类型为“kABGroupType”的ABRecordRef来表示群组，一个群组可以包含多个联系人，一个联系人也同样可以多个群组。<br>由于通讯录操作的关键是对ABRecordRef的操作，首先看一下常用的操作通讯录记录的方法：<br>ABPersonCreate():创建一个类型为“kABPersonType”的ABRecordRef。<br>ABRecordCopyValue():取得指定属性的值。<br>ABRecordCopyCompositeName():取得联系人（或群组）的复合信息（对于联系人则包括：姓、名、公司等信息，对于群组则返回组名称）。<br>ABRecordSetValue():设置ABRecordRef的属性值。注意在设置ABRecordRef的值时又分为单值属性和多值属性：单值属性设置只要通过ABRecordSetValue()方法指定属性名和值即可；多值属性则要先通过创建一个ABMutableMultiValueRef类型的变量，然后通过ABMultiValueAddValueAndLabel()方法依次添加属性值，最后通过ABRecordSetValue()方法将ABMutableMultiValueRef类型的变量设置为记录值。<br>ABRecordRemoveValue():删除指定的属性值。<br>注意：<br>由于联系人访问时（读取、设置、删除时）牵扯到大量联系人属性，可以到ABPerson.h中查询或者直接到帮助文档“Personal Information Properties”<br>通讯录的访问步骤一般如下：<br>调用ABAddressBookCreateWithOptions()方法创建通讯录对象ABAddressBookRef。<br>调用ABAddressBookRequestAccessWithCompletion()方法获得用户授权访问通讯录。<br>调用ABAddressBookCopyArrayOfAllPeople()、ABAddressBookCopyPeopleWithName()方法查询联系人信息。<br>读取联系人后如果要显示联系人信息则可以调用ABRecord相关方法读取相应的数据；如果要进行修改联系人信息，则可以使用对应的方法修改ABRecord信息，然后调用ABAddressBookSave()方法提交修改；如果要删除联系人，则可以调用ABAddressBookRemoveRecord()方法删除，然后调用ABAddressBookSave()提交修改操作。<br>也就是说如果要修改或者删除都需要首先查询对应的联系人，然后修改或删除后提交更改。如果用户要增加一个联系人则不用进行查询，直接调用ABPersonCreate()方法创建一个ABRecord然后设置具体的属性，调用ABAddressBookAddRecord方法添加即可。<br>下面就通过一个示例演示一下如何通过ABAddressBook.framework访问通讯录，这个例子中通过一个UITableViewController模拟一下通讯录的查看、删除、添加操作。<br>主控制器视图，用于显示联系人，修改删除联系人：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br></pre></td><td class="code"><pre><span class="line">KCContactViewController.h</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  KCTableViewController.h</span></span><br><span class="line"><span class="comment">//  AddressBook</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/04/05.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  定义一个协议作为代理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">KCContactDelegate</span></span></span><br><span class="line"><span class="comment">//新增或修改联系人</span></span><br><span class="line">-(<span class="keyword">void</span>)editPersonWithFirstName:(<span class="built_in">NSString</span> *)firstName lastName:(<span class="built_in">NSString</span> *)lastName workNumber:(<span class="built_in">NSString</span> *)workNumber;</span><br><span class="line"><span class="comment">//取消修改或新增</span></span><br><span class="line">-(<span class="keyword">void</span>)cancelEdit;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">KCContactTableViewController</span> : <span class="title">UITableViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">KCContactViewController.m</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  KCTableViewController.m</span></span><br><span class="line"><span class="comment">//  AddressBook</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/04/05.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCContactTableViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;AddressBook/AddressBook.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCAddPersonViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">KCContactTableViewController</span> ()&lt;<span class="title">KCContactDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>,<span class="keyword">nonatomic</span>) ABAddressBookRef addressBook;<span class="comment">//通讯录</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>,<span class="keyword">nonatomic</span>) <span class="built_in">NSMutableArray</span> *allPerson;<span class="comment">//通讯录所有人员</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>,<span class="keyword">nonatomic</span>) <span class="keyword">int</span> isModify;<span class="comment">//标识是修改还是新增，通过选择cell进行导航则认为是修改，否则视为新增</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>,<span class="keyword">nonatomic</span>) <span class="built_in">UITableViewCell</span> *selectedCell;<span class="comment">//当前选中的单元格</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">KCContactTableViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 控制器视图</span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//请求访问通讯录并初始化数据</span></span><br><span class="line">    [<span class="keyword">self</span> requestAddressBook];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//由于在整个视图控制器周期内addressBook都驻留在内存中，所有当控制器视图销毁时销毁该对象</span></span><br><span class="line">-(<span class="keyword">void</span>)dealloc&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.addressBook!=<span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">CFRelease</span>(<span class="keyword">self</span>.addressBook);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UI事件</span></span><br><span class="line"><span class="comment">//点击删除按钮</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)trashClick:(<span class="built_in">UIBarButtonItem</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">self</span>.tableView.editing=!<span class="keyword">self</span>.tableView.editing;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UITableView数据源方法</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSInteger</span>)numberOfSectionsInTableView:(<span class="built_in">UITableView</span> *)tableView &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.allPerson.count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">NSString</span> *identtityKey=<span class="string">@"myTableViewCellIdentityKey1"</span>;</span><br><span class="line">    <span class="built_in">UITableViewCell</span> *cell=[tableView dequeueReusableCellWithIdentifier:identtityKey];</span><br><span class="line">    <span class="keyword">if</span>(cell==<span class="literal">nil</span>)&#123;</span><br><span class="line">        cell=[[<span class="built_in">UITableViewCell</span> alloc]initWithStyle:<span class="built_in">UITableViewCellStyleValue1</span> reuseIdentifier:identtityKey];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//取得一条人员记录</span></span><br><span class="line">    ABRecordRef recordRef=(__bridge ABRecordRef)<span class="keyword">self</span>.allPerson[indexPath.row];</span><br><span class="line">    <span class="comment">//取得记录中得信息</span></span><br><span class="line">    <span class="built_in">NSString</span> *firstName=(__bridge <span class="built_in">NSString</span> *) ABRecordCopyValue(recordRef, kABPersonFirstNameProperty);<span class="comment">//注意这里进行了强转，不用自己释放资源</span></span><br><span class="line">    <span class="built_in">NSString</span> *lastName=(__bridge <span class="built_in">NSString</span> *)ABRecordCopyValue(recordRef, kABPersonLastNameProperty);</span><br><span class="line">    </span><br><span class="line">    ABMultiValueRef phoneNumbersRef= ABRecordCopyValue(recordRef, kABPersonPhoneProperty);<span class="comment">//获取手机号，注意手机号是ABMultiValueRef类，有可能有多条</span></span><br><span class="line"><span class="comment">//    NSArray *phoneNumbers=(__bridge NSArray *)ABMultiValueCopyArrayOfAllValues(phoneNumbersRef);//取得CFArraryRef类型的手机记录并转化为NSArrary</span></span><br><span class="line">    <span class="keyword">long</span> count= ABMultiValueGetCount(phoneNumbersRef);</span><br><span class="line"><span class="comment">//    for(int i=0;i&lt;count;++i)&#123;</span></span><br><span class="line"><span class="comment">//        NSString *phoneLabel= (__bridge NSString *)(ABMultiValueCopyLabelAtIndex(phoneNumbersRef, i));</span></span><br><span class="line"><span class="comment">//        NSString *phoneNumber=(__bridge NSString *)(ABMultiValueCopyValueAtIndex(phoneNumbersRef, i));</span></span><br><span class="line"><span class="comment">//        NSLog(@"%@:%@",phoneLabel,phoneNumber);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">    </span><br><span class="line">    cell.textLabel.text=[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@ %@"</span>,firstName,lastName];</span><br><span class="line">    <span class="keyword">if</span> (count&gt;<span class="number">0</span>) &#123;</span><br><span class="line">        cell.detailTextLabel.text=(__bridge <span class="built_in">NSString</span> *)(ABMultiValueCopyValueAtIndex(phoneNumbersRef, <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(ABPersonHasImageData(recordRef))&#123;<span class="comment">//如果有照片数据</span></span><br><span class="line">        <span class="built_in">NSData</span> *imageData= (__bridge <span class="built_in">NSData</span> *)(ABPersonCopyImageData(recordRef));</span><br><span class="line">        cell.imageView.image=[<span class="built_in">UIImage</span> imageWithData:imageData];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        cell.imageView.image=[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"avatar"</span>];<span class="comment">//没有图片使用默认头像</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//使用cell的tag存储记录id</span></span><br><span class="line">    cell.tag=ABRecordGetRecordID(recordRef);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView commitEditingStyle:(<span class="built_in">UITableViewCellEditingStyle</span>)editingStyle forRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    <span class="keyword">if</span> (editingStyle == <span class="built_in">UITableViewCellEditingStyleDelete</span>) &#123;</span><br><span class="line">        ABRecordRef recordRef=(__bridge ABRecordRef )<span class="keyword">self</span>.allPerson[indexPath.row];</span><br><span class="line">        [<span class="keyword">self</span> removePersonWithRecord:recordRef];<span class="comment">//从通讯录删除</span></span><br><span class="line">        [<span class="keyword">self</span>.allPerson removeObjectAtIndex:indexPath.row];<span class="comment">//从数组移除</span></span><br><span class="line">        [tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:<span class="built_in">UITableViewRowAnimationFade</span>];<span class="comment">//从列表删除</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (editingStyle == <span class="built_in">UITableViewCellEditingStyleInsert</span>) &#123;</span><br><span class="line">        <span class="comment">// Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view</span></span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UITableView代理方法</span></span><br><span class="line">-(<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView didSelectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</span><br><span class="line">    <span class="keyword">self</span>.isModify=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">self</span>.selectedCell=[tableView cellForRowAtIndexPath:indexPath];</span><br><span class="line">    [<span class="keyword">self</span> performSegueWithIdentifier:<span class="string">@"AddPerson"</span> sender:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Navigation</span></span><br><span class="line">- (<span class="keyword">void</span>)prepareForSegue:(<span class="built_in">UIStoryboardSegue</span> *)segue sender:(<span class="keyword">id</span>)sender &#123;</span><br><span class="line">    <span class="keyword">if</span>([segue.identifier isEqualToString:<span class="string">@"AddPerson"</span>])&#123;</span><br><span class="line">        <span class="built_in">UINavigationController</span> *navigationController=(<span class="built_in">UINavigationController</span> *)segue.destinationViewController;</span><br><span class="line">        <span class="comment">//根据导航控制器取得添加/修改人员的控制器视图</span></span><br><span class="line">        KCAddPersonViewController *addPersonController=(KCAddPersonViewController *)navigationController.topViewController;</span><br><span class="line">        addPersonController.delegate=<span class="keyword">self</span>;</span><br><span class="line">        <span class="comment">//如果是通过选择cell进行的导航操作说明是修改，否则为添加</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.isModify) &#123;</span><br><span class="line">            <span class="built_in">UITableViewCell</span> *cell=<span class="keyword">self</span>.selectedCell;</span><br><span class="line">            addPersonController.recordID=(ABRecordID)cell.tag;<span class="comment">//设置</span></span><br><span class="line">            <span class="built_in">NSArray</span> *array=[cell.textLabel.text componentsSeparatedByString:<span class="string">@" "</span>];</span><br><span class="line">            <span class="keyword">if</span> (array.count&gt;<span class="number">0</span>) &#123;</span><br><span class="line">                addPersonController.firstNameText=[array firstObject];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (array.count&gt;<span class="number">1</span>) &#123;</span><br><span class="line">                addPersonController.lastNameText=[array lastObject];</span><br><span class="line">            &#125;</span><br><span class="line">            addPersonController.workPhoneText=cell.detailTextLabel.text;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - KCContact代理方法</span></span><br><span class="line">-(<span class="keyword">void</span>)editPersonWithFirstName:(<span class="built_in">NSString</span> *)firstName lastName:(<span class="built_in">NSString</span> *)lastName workNumber:(<span class="built_in">NSString</span> *)workNumber&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.isModify) &#123;</span><br><span class="line">        <span class="built_in">UITableViewCell</span> *cell=<span class="keyword">self</span>.selectedCell;</span><br><span class="line">        <span class="built_in">NSIndexPath</span> *indexPath= [<span class="keyword">self</span>.tableView indexPathForCell:cell];</span><br><span class="line">        [<span class="keyword">self</span> modifyPersonWithRecordID:(ABRecordID)cell.tag firstName:firstName lastName:lastName workNumber:workNumber];</span><br><span class="line">        [<span class="keyword">self</span>.tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:<span class="built_in">UITableViewRowAnimationRight</span>];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        [<span class="keyword">self</span> addPersonWithFirstName:firstName lastName:lastName workNumber:workNumber];<span class="comment">//通讯簿中添加信息</span></span><br><span class="line">        [<span class="keyword">self</span> initAllPerson];<span class="comment">//重新初始化数据</span></span><br><span class="line">        [<span class="keyword">self</span>.tableView reloadData];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">self</span>.isModify=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)cancelEdit&#123;</span><br><span class="line">    <span class="keyword">self</span>.isModify=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  请求访问通讯录</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)requestAddressBook&#123;</span><br><span class="line">    <span class="comment">//创建通讯录对象</span></span><br><span class="line">    <span class="keyword">self</span>.addressBook=ABAddressBookCreateWithOptions(<span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//请求访问用户通讯录,注意无论成功与否block都会调用</span></span><br><span class="line">    ABAddressBookRequestAccessWithCompletion(<span class="keyword">self</span>.addressBook, ^(<span class="keyword">bool</span> granted, <span class="built_in">CFErrorRef</span> error) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!granted) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"未获得通讯录访问权限！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        [<span class="keyword">self</span> initAllPerson];</span><br><span class="line">        </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得所有通讯录记录</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)initAllPerson&#123;</span><br><span class="line">    <span class="comment">//取得通讯录访问授权</span></span><br><span class="line">    ABAuthorizationStatus authorization= ABAddressBookGetAuthorizationStatus();</span><br><span class="line">    <span class="comment">//如果未获得授权</span></span><br><span class="line">    <span class="keyword">if</span> (authorization!=kABAuthorizationStatusAuthorized) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"尚未获得通讯录访问授权！"</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//取得通讯录中所有人员记录</span></span><br><span class="line">    <span class="built_in">CFArrayRef</span> allPeople= ABAddressBookCopyArrayOfAllPeople(<span class="keyword">self</span>.addressBook);</span><br><span class="line">    <span class="keyword">self</span>.allPerson=(__bridge <span class="built_in">NSMutableArray</span> *)allPeople;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//释放资源</span></span><br><span class="line">    <span class="built_in">CFRelease</span>(allPeople);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  删除指定的记录</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param recordRef 要删除的记录</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)removePersonWithRecord:(ABRecordRef)recordRef&#123;</span><br><span class="line">    ABAddressBookRemoveRecord(<span class="keyword">self</span>.addressBook, recordRef, <span class="literal">NULL</span>);<span class="comment">//删除</span></span><br><span class="line">    ABAddressBookSave(<span class="keyword">self</span>.addressBook, <span class="literal">NULL</span>);<span class="comment">//删除之后提交更改</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  根据姓名删除记录</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)removePersonWithName:(<span class="built_in">NSString</span> *)personName&#123;</span><br><span class="line">    <span class="built_in">CFStringRef</span> personNameRef=(__bridge <span class="built_in">CFStringRef</span>)(personName);</span><br><span class="line">    <span class="built_in">CFArrayRef</span> recordsRef= ABAddressBookCopyPeopleWithName(<span class="keyword">self</span>.addressBook, personNameRef);<span class="comment">//根据人员姓名查找</span></span><br><span class="line">    <span class="built_in">CFIndex</span> count= <span class="built_in">CFArrayGetCount</span>(recordsRef);<span class="comment">//取得记录数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">CFIndex</span> i=<span class="number">0</span>; i&lt;count; ++i) &#123;</span><br><span class="line">        ABRecordRef recordRef=<span class="built_in">CFArrayGetValueAtIndex</span>(recordsRef, i);<span class="comment">//取得指定的记录</span></span><br><span class="line">        ABAddressBookRemoveRecord(<span class="keyword">self</span>.addressBook, recordRef, <span class="literal">NULL</span>);<span class="comment">//删除</span></span><br><span class="line">    &#125;</span><br><span class="line">    ABAddressBookSave(<span class="keyword">self</span>.addressBook, <span class="literal">NULL</span>);<span class="comment">//删除之后提交更改</span></span><br><span class="line">    <span class="built_in">CFRelease</span>(recordsRef);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  添加一条记录</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param firstName  名</span></span><br><span class="line"><span class="comment"> *  @param lastName   姓</span></span><br><span class="line"><span class="comment"> *  @param iPhoneName iPhone手机号</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addPersonWithFirstName:(<span class="built_in">NSString</span> *)firstName lastName:(<span class="built_in">NSString</span> *)lastName workNumber:(<span class="built_in">NSString</span> *)workNumber&#123;</span><br><span class="line">    <span class="comment">//创建一条记录</span></span><br><span class="line">    ABRecordRef recordRef= ABPersonCreate();</span><br><span class="line">    ABRecordSetValue(recordRef, kABPersonFirstNameProperty, (__bridge <span class="built_in">CFTypeRef</span>)(firstName), <span class="literal">NULL</span>);<span class="comment">//添加名</span></span><br><span class="line">    ABRecordSetValue(recordRef, kABPersonLastNameProperty, (__bridge <span class="built_in">CFTypeRef</span>)(lastName), <span class="literal">NULL</span>);<span class="comment">//添加姓</span></span><br><span class="line">    </span><br><span class="line">    ABMutableMultiValueRef multiValueRef =ABMultiValueCreateMutable(kABStringPropertyType);<span class="comment">//添加设置多值属性</span></span><br><span class="line">    ABMultiValueAddValueAndLabel(multiValueRef, (__bridge <span class="built_in">CFStringRef</span>)(workNumber), kABWorkLabel, <span class="literal">NULL</span>);<span class="comment">//添加工作电话</span></span><br><span class="line">    ABRecordSetValue(recordRef, kABPersonPhoneProperty, multiValueRef, <span class="literal">NULL</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//添加记录</span></span><br><span class="line">    ABAddressBookAddRecord(<span class="keyword">self</span>.addressBook, recordRef, <span class="literal">NULL</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//保存通讯录，提交更改</span></span><br><span class="line">    ABAddressBookSave(<span class="keyword">self</span>.addressBook, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">//释放资源</span></span><br><span class="line">    <span class="built_in">CFRelease</span>(recordRef);</span><br><span class="line">    <span class="built_in">CFRelease</span>(multiValueRef);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  根据RecordID修改联系人信息</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param recordID   记录唯一ID</span></span><br><span class="line"><span class="comment"> *  @param firstName  姓</span></span><br><span class="line"><span class="comment"> *  @param lastName   名</span></span><br><span class="line"><span class="comment"> *  @param homeNumber 工作电话</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)modifyPersonWithRecordID:(ABRecordID)recordID firstName:(<span class="built_in">NSString</span> *)firstName lastName:(<span class="built_in">NSString</span> *)lastName workNumber:(<span class="built_in">NSString</span> *)workNumber&#123;</span><br><span class="line">    ABRecordRef recordRef=ABAddressBookGetPersonWithRecordID(<span class="keyword">self</span>.addressBook,recordID);</span><br><span class="line">    ABRecordSetValue(recordRef, kABPersonFirstNameProperty, (__bridge <span class="built_in">CFTypeRef</span>)(firstName), <span class="literal">NULL</span>);<span class="comment">//添加名</span></span><br><span class="line">    ABRecordSetValue(recordRef, kABPersonLastNameProperty, (__bridge <span class="built_in">CFTypeRef</span>)(lastName), <span class="literal">NULL</span>);<span class="comment">//添加姓</span></span><br><span class="line">    </span><br><span class="line">    ABMutableMultiValueRef multiValueRef =ABMultiValueCreateMutable(kABStringPropertyType);</span><br><span class="line">    ABMultiValueAddValueAndLabel(multiValueRef, (__bridge <span class="built_in">CFStringRef</span>)(workNumber), kABWorkLabel, <span class="literal">NULL</span>);</span><br><span class="line">    ABRecordSetValue(recordRef, kABPersonPhoneProperty, multiValueRef, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">//保存记录，提交更改</span></span><br><span class="line">    ABAddressBookSave(<span class="keyword">self</span>.addressBook, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">//释放资源</span></span><br><span class="line">    <span class="built_in">CFRelease</span>(multiValueRef);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">新增或修改控制器视图，用于显示一个联系人的信息或者新增一个联系人：</span><br><span class="line">KCAddPersonViewController.h</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  KCAddPersonViewController.h</span></span><br><span class="line"><span class="comment">//  AddressBook</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  kABPersonFirstNameProperty</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">KCContactDelegate</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">KCAddPersonViewController</span> : <span class="title">UIViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>,<span class="keyword">nonatomic</span>) <span class="keyword">int</span> recordID;<span class="comment">//通讯录记录id，如果ID不为0则代表修改否则认为是新增</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>,<span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *firstNameText;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>,<span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *lastNameText;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>,<span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *workPhoneText;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>,<span class="keyword">nonatomic</span>) <span class="keyword">id</span>&lt;KCContactDelegate&gt; delegate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">KCAddPersonViewController.m</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  KCAddPersonViewController.m</span></span><br><span class="line"><span class="comment">//  AddressBook</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  kABPersonFirstNameProperty</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCAddPersonViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCContactTableViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">KCAddPersonViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UITextField</span> *firstName;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UITextField</span> *lastName;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UITextField</span> *workPhone;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">KCAddPersonViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    [<span class="keyword">self</span> setupUI];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UI事件</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)cancelClick:(<span class="built_in">UIBarButtonItem</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span>.delegate cancelEdit];</span><br><span class="line">    [<span class="keyword">self</span> dismissViewControllerAnimated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)doneClick:(<span class="built_in">UIBarButtonItem</span> *)sender &#123;</span><br><span class="line">    <span class="comment">//调用代理方法</span></span><br><span class="line">    [<span class="keyword">self</span>.delegate editPersonWithFirstName:<span class="keyword">self</span>.firstName.text lastName:<span class="keyword">self</span>.lastName.text workNumber:<span class="keyword">self</span>.workPhone.text];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> dismissViewControllerAnimated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line">-(<span class="keyword">void</span>)setupUI&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.recordID) &#123;<span class="comment">//如果ID不为0则认为是修改，此时需要初始化界面</span></span><br><span class="line">        <span class="keyword">self</span>.firstName.text=<span class="keyword">self</span>.firstNameText;</span><br><span class="line">        <span class="keyword">self</span>.lastName.text=<span class="keyword">self</span>.lastNameText;</span><br><span class="line">        <span class="keyword">self</span>.workPhone.text=<span class="keyword">self</span>.workPhoneText;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[长按保存图片到本地]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E9%95%BF%E6%8C%89%E4%BF%9D%E5%AD%98%E5%9B%BE%E7%89%87%E5%88%B0%E6%9C%AC%E5%9C%B0/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p><code>`</code>objc<br>  //创建UILongPressGestureRecognizer     UILongPressGestureRecognizer*longPG = [[UILongPressGestureRecognizeralloc]initWithTarget:selfaction:@selector(longAction:)<br> ];    [selfaddGestureRecognizer:longPG];</p>
<p>}</p>
<p>//长按触发的方法<br>-(void)longAction:(UILongPressGestureRecognizer*)longPG<br>{</p>
<p>   if(longPG.state==UIGestureRecognizerStateBegan)<br>    {</p>
<pre><code>   //创建UIAlertView对象
   UIAlertView*alert = [[UIAlertViewalloc]initWithTitle:@&quot;提示&quot;message:@&quot;是否保存图片到本地&quot;delegate:selfcancelButtonTitle:@&quot;取消&quot;otherButtonTitles:@&quot;确定&quot;,nil];
   //调用show方法
    [alertshow];
   //释放
    [alertrelease];


}
</code></pre><p>}</p>
<ul>
<li><p>(void)alertView:(UIAlertView*)alertView clickedButtonAtIndex:(NSInteger)buttonIndex<br>{<br> if(buttonIndex ==1) {</p>
<pre><code>//UIImage写入本地的方法
UIImageWriteToSavedPhotosAlbum(self.photo.image,nil,nil,nil);

//创建UIAlertView对象
UIAlertView*alert = [[UIAlertViewalloc]initWithTitle:@&quot;提示&quot;message:@&quot;图片已保存成功&quot;delegate:selfcancelButtonTitle:nilotherButtonTitles:nil];
//调用show方法
 [alertshow];
//释放
 [alertrelease];

dispatch_after(dispatch_time(DISPATCH_TIME_NOW,
</code></pre><p>(int64_t)(1.0f*NSEC_PER_SEC)),dispatch_get_main_queue(), ^{</p>
<pre><code>    [alertdismissWithClickedButtonIndex:0animated:YES];
});
</code></pre><p>  }</p>
<p> }</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[进程和线程]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p><strong>一、进程和线程</strong><br>1.什么是进程</p>
<p>进程是指在系统中正在运行的一个应用程序<br>每个进程之间是独立的，每个进程均运行在其专用且受保护的内存空间内<br><img src="http://images.cnitblog.com/i/450136/201406/241224432836121.png" alt></p>
<p>比如同时打开QQ、Xcode，系统就会分别启动2个进程<br>通过“活动监视器”可以查看Mac系统中所开启的进程</p>
<p>2.什么是线程<br>1个进程要想执行任务，必须得有线程（每1个进程至少要有1条线程）<br>线程是进程的基本执行单元，一个进程（程序）的所有任务都在线程中执行<br>比如使用酷狗播放音乐、使用迅雷下载电影，都需要在线程中执行<br> 　　<img src="http://images.cnitblog.com/i/450136/201406/241225080809896.png" alt></p>
<p>3.线程的串行</p>
<p>1个线程中任务的执行是串行的<br>如果要在1个线程中执行多个任务，那么只能一个一个地按顺序执行这些任务<br>也就是说，在同一时间内，1个线程只能执行1个任务<br>比如在1个线程中下载3个文件（分别是文件A、文件B、文件C）<br> <img src="http://images.cnitblog.com/i/450136/201406/241225242528638.png" alt></p>
<p>二、多线程</p>
<p>1.什么是多线程<br>1个进程中可以开启多条线程，每条线程可以并行（同时）执行不同的任务<br>进程 -&gt;车间，线程-&gt;车间工人<br>多线程技术可以提高程序的执行效率<br>比如同时开启3条线程分别下载3个文件（分别是文件A、文件B、文件C）<br><img src="http://images.cnitblog.com/i/450136/201406/241226293143615.png" alt><br><img src="http://images.cnitblog.com/i/450136/201406/241227387673566.png" alt></p>
<p>2.多线程的原理</p>
<p>同一时间，CPU只能处理1条线程，只有1条线程在工作（执行）<br>多线程并发（同时）执行，其实是CPU快速地在多条线程之间调度（切换）<br>如果CPU调度线程的时间足够快，就造成了多线程并发执行的假象<br>思考：如果线程非常非常多，会发生什么情况？<br>CPU会在N多线程之间调度，CPU会累死，消耗大量的CPU资源<br>每条线程被调度执行的频次会降低（线程的执行效率降低）</p>
<p>3.多线程的优缺点</p>
<p>多线程的优点<br>能适当提高程序的执行效率<br>能适当提高资源利用率（CPU、内存利用率）</p>
<p>多线程的缺点<br>开启线程需要占用一定的内存空间（默认情况下，主线程占用1M，子线程占用512KB），如果开启大量的线程，会占用大量的内存空间，降低程序的性能<br>线程越多，CPU在调度线程上的开销就越大<br>程序设计更加复杂：比如线程之间的通信、多线程的数据共享</p>
<p>4.多线程在iOS开发中的应用<br>主线程:一个iOS程序运行后，默认会开启1条线程，称为“主线程”或“UI线程”<br>主线程的主要作用<br>显示\刷新UI界面<br>处理UI事件（比如点击事件、滚动事件、拖拽事件等）</p>
<p>主线程的使用注意:别将比较耗时的操作放到主线程中。<br>耗时操作会卡住主线程，严重影响UI的流畅度，给用户一种“卡”的坏体验</p>
<p>5.代码示例<br><img src="http://images.cnitblog.com/i/450136/201406/241233129086114.png" alt><br><a href="&quot;复制代码&quot;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>     1 //<br>     2 //  YYViewController.m 3 //  01-阻塞主线程 4 //<br>     5 //  Created by apple on 14-6-23. 6 //  Copyright (c) 2014年 itcase. All rights reserved. 7 // 8<br>     9 #import “YYViewController.h”<br>    10<br>    11 @interface YYViewController ()12 - (IBAction)btnClick;13 @end<br>    14<br>    15<br>    16 @implementation YYViewController17<br>    18<br>    19 - (void)viewDidLoad20 {21     [super viewDidLoad];22 }23<br>    24<br>    25 //按钮的点击事件<br>    26 - (IBAction)btnClick {27     //1.获取当前线程<br>    28     NSThread *current=[NSThread currentThread];29     //2.使用for循环执行一些耗时操作<br>    30     for (int i=0; i&lt;10000; i++) {31         //3.输出线程<br>    32         NSLog(@”btnClick---%d---%@”,i,current);33     }34 }35<br>    36 @end<br><a href="&quot;复制代码&quot;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a><a href="&quot;复制代码&quot;"></a> 执行效果：<br><img src="http://images.cnitblog.com/i/450136/201406/241235051118926.png" alt><br>说明：当点击执行的时候，textView点击无响应。<br><img src="http://images.cnitblog.com/i/450136/201406/241236350808178.png" alt><br>执行分析：等待主线程串行执行。<br><img src="http://images.cnitblog.com/i/450136/201406/241238095028893.png" alt><br>开启子线程。<br><img src="http://images.cnitblog.com/i/450136/201406/241238382996357.png" alt></p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[音乐播放器时间]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8%E6%97%B6%E9%97%B4/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p><code>`</code>objc<br> NSNumber*n = [self.dataDicvalueForKey:@”duration”];</p>
<p>   self.progressSilder.maximumValue= n.floatValue;<br>   self.progressSilder.value= progress;</p>
<p>   //当前时长进度progress<br>   NSIntegerproMin = (NSInteger)progress /60;//当前秒<br>   NSIntegerproSec = (NSInteger)progress %60;//当前分钟</p>
<p>   //duration总时长<br>   NSIntegerdurMin = (NSInteger)n.floatValue/60;//总秒<br>   NSIntegerdurSec = (NSInteger)n.floatValue%60;//总分钟</p>
<p>   self.curentTimeLabel.text= [NSStringstringWithFormat:@”%02ld:%02ld”,<br> proMin, proSec];   self.totalTimeLabel.text = [NSStringstringWithFormat:@”%02ld:%02ld”,durMin,durSec];</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS开发系列--音频播放、录音、视频播放、拍照、视频录制]]></title>
      <url>https://shirly-yan.github.io/2016/10/08/oc/iOS%E5%BC%80%E5%8F%91%E7%B3%BB%E5%88%97--%E9%9F%B3%E9%A2%91%E6%92%AD%E6%94%BE%E3%80%81%E5%BD%95%E9%9F%B3%E3%80%81%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE%E3%80%81%E6%8B%8D%E7%85%A7%E3%80%81%E8%A7%86%E9%A2%91%E5%BD%95%E5%88%B6/</url>
      <content type="html"><![CDATA[<p>在iOS中音频播放从形式上可以分为音效播放和音乐播放。前者主要指的是一些短音频播放，通常作为点缀音频，对于这类音频不需要进行进度、循环等控制。后者指的是一些较长的音频，通常是主音频，对于这些音频的播放通常需要进行精确的控制。<br><a id="more"></a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br></pre></td><td class="code"><pre><span class="line">转自：http:<span class="comment">//blog.csdn.net/jianxin160/article/details/47753241</span></span><br><span class="line">音频</span><br><span class="line">在iOS中音频播放从形式上可以分为音效播放和音乐播放。前者主要指的是一些短音频播放，通常作为点缀音频，对于这类音频不需要进行进度、循环等控制。后者指的是一些较长的音频，通常是主音频，对于这些音频的播放通常需要进行精确的控制。在iOS中播放两类音频分别使用AudioToolbox.framework和<span class="built_in">AVFoundation</span>.framework来完成音效和音乐播放。</span><br><span class="line">音效</span><br><span class="line">AudioToolbox.framework是一套基于C语言的框架，使用它来播放音效其本质是将短音频注册到系统声音服务（System Sound Service）。System Sound Service是一种简单、底层的声音播放服务，但是它本身也存在着一些限制：</span><br><span class="line">音频播放时间不能超过<span class="number">30</span>s</span><br><span class="line">数据必须是PCM或者IMA4格式</span><br><span class="line">音频文件必须打包成.caf、.aif、.wav中的一种（注意这是官方文档的说法，实际测试发现一些.mp3也可以播放）</span><br><span class="line">使用System Sound Service 播放音效的步骤如下：</span><br><span class="line">调用AudioServicesCreateSystemSoundID(   <span class="built_in">CFURLRef</span>  inFileURL, SystemSoundID*   outSystemSoundID)函数获得系统声音ID。</span><br><span class="line">如果需要监听播放完成操作，则使用AudioServicesAddSystemSoundCompletion(  SystemSoundID inSystemSoundID,</span><br><span class="line"><span class="built_in">CFRunLoopRef</span>  inRunLoop, <span class="built_in">CFStringRef</span>  inRunLoopMode, AudioServicesSystemSoundCompletionProc  inCompletionRoutine, <span class="keyword">void</span>*  inClientData)方法注册回调函数。</span><br><span class="line">调用AudioServicesPlaySystemSound(SystemSoundID inSystemSoundID) 或者AudioServicesPlayAlertSound(SystemSoundID inSystemSoundID) 方法播放音效（后者带有震动效果）。</span><br><span class="line">下面是一个简单的示例程序：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  KCMainViewController.m</span></span><br><span class="line"><span class="comment">//  Audio</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/30.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//  音效播放</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCMainViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;AudioToolbox/AudioToolbox.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">KCMainViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">KCMainViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> playSoundEffect:<span class="string">@"videoRing.caf"</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放完成回调函数</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param soundID    系统声音ID</span></span><br><span class="line"><span class="comment"> *  @param clientData 回调时传递的数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> soundCompleteCallback(SystemSoundID soundID,<span class="keyword">void</span> * clientData)&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"播放完成..."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放音效文件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param name 音频文件名称</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)playSoundEffect:(<span class="built_in">NSString</span> *)name&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *audioFile=[[<span class="built_in">NSBundle</span> mainBundle] pathForResource:name ofType:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *fileUrl=[<span class="built_in">NSURL</span> fileURLWithPath:audioFile];</span><br><span class="line">    <span class="comment">//1.获得系统声音ID</span></span><br><span class="line">    SystemSoundID soundID=<span class="number">0</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * inFileUrl:音频文件url</span></span><br><span class="line"><span class="comment">     * outSystemSoundID:声音id（此函数会将音效文件加入到系统音频服务中并返回一个长整形ID）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    AudioServicesCreateSystemSoundID((__bridge <span class="built_in">CFURLRef</span>)(fileUrl), &amp;soundID);</span><br><span class="line">    <span class="comment">//如果需要在播放完之后执行某些操作，可以调用如下方法注册一个播放完成回调函数</span></span><br><span class="line">    AudioServicesAddSystemSoundCompletion(soundID, <span class="literal">NULL</span>, <span class="literal">NULL</span>, soundCompleteCallback, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">//2.播放音频</span></span><br><span class="line">    AudioServicesPlaySystemSound(soundID);<span class="comment">//播放音效</span></span><br><span class="line"><span class="comment">//    AudioServicesPlayAlertSound(soundID);//播放音效并震动</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">音乐</span><br><span class="line">如果播放较大的音频或者要对音频有精确的控制则System Sound Service可能就很难满足实际需求了，通常这种情况会选择使用<span class="built_in">AVFoundation</span>.framework中的<span class="built_in">AVAudioPlayer</span>来实现。<span class="built_in">AVAudioPlayer</span>可以看成一个播放器，它支持多种音频格式，而且能够进行进度、音量、播放速度等控制。首先简单看一下<span class="built_in">AVAudioPlayer</span>常用的属性和方法：</span><br><span class="line">属性	说明</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isPlaying) <span class="built_in">BOOL</span> playing	是否正在播放，只读</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>) <span class="built_in">NSUInteger</span> numberOfChannels	音频声道数，只读</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>) <span class="built_in">NSTimeInterval</span> duration	音频时长</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>) <span class="built_in">NSURL</span> *url	音频文件路径，只读</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>) <span class="built_in">NSData</span> *data	音频数据，只读</span><br><span class="line"><span class="keyword">@property</span> <span class="keyword">float</span> pan	立体声平衡，如果为<span class="number">-1.0</span>则完全左声道，如果<span class="number">0.0</span>则左右声道平衡，如果为<span class="number">1.0</span>则完全为右声道</span><br><span class="line"><span class="keyword">@property</span> <span class="keyword">float</span> volume	音量大小，范围<span class="number">0</span><span class="number">-1.0</span></span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">BOOL</span> enableRate	是否允许改变播放速率</span><br><span class="line"><span class="keyword">@property</span> <span class="keyword">float</span> rate	播放速率，范围<span class="number">0.5</span><span class="number">-2.0</span>，如果为<span class="number">1.0</span>则正常播放，如果要修改播放速率则必须设置enableRate为<span class="literal">YES</span></span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">NSTimeInterval</span> currentTime	当前播放时长</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>) <span class="built_in">NSTimeInterval</span> deviceCurrentTime	输出设备播放音频的时间，注意如果播放中被暂停此时间也会继续累加</span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">NSInteger</span> numberOfLoops	循环播放次数，如果为<span class="number">0</span>则不循环，如果小于<span class="number">0</span>则无限循环，大于<span class="number">0</span>则表示循环次数</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>) <span class="built_in">NSDictionary</span> *settings	音频播放设置信息，只读</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">getter</span>=isMeteringEnabled) <span class="built_in">BOOL</span> meteringEnabled	是否启用音频测量，默认为<span class="literal">NO</span>，一旦启用音频测量可以通过updateMeters方法更新测量值</span><br><span class="line">对象方法	说明</span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithContentsOfURL:(<span class="built_in">NSURL</span> *)url error:(<span class="built_in">NSError</span> **)outError	使用文件URL初始化播放器，注意这个URL不能是HTTP URL，<span class="built_in">AVAudioPlayer</span>不支持加载网络媒体流，只能播放本地文件</span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithData:(<span class="built_in">NSData</span> *)data error:(<span class="built_in">NSError</span> **)outError	使用<span class="built_in">NSData</span>初始化播放器，注意使用此方法时必须文件格式和文件后缀一致，否则出错，所以相比此方法更推荐使用上述方法或- (<span class="keyword">instancetype</span>)initWithData:(<span class="built_in">NSData</span> *)data fileTypeHint:(<span class="built_in">NSString</span> *)utiString error:(<span class="built_in">NSError</span> **)outError方法进行初始化</span><br><span class="line">- (<span class="built_in">BOOL</span>)prepareToPlay;	加载音频文件到缓冲区，注意即使在播放之前音频文件没有加载到缓冲区程序也会隐式调用此方法。</span><br><span class="line">- (<span class="built_in">BOOL</span>)play;	播放音频文件</span><br><span class="line">- (<span class="built_in">BOOL</span>)playAtTime:(<span class="built_in">NSTimeInterval</span>)time	在指定的时间开始播放音频</span><br><span class="line">- (<span class="keyword">void</span>)pause;	暂停播放</span><br><span class="line">- (<span class="keyword">void</span>)stop;	停止播放</span><br><span class="line">- (<span class="keyword">void</span>)updateMeters	更新音频测量值，注意如果要更新音频测量值必须设置meteringEnabled为<span class="literal">YES</span>，通过音频测量值可以即时获得音频分贝等信息</span><br><span class="line">- (<span class="keyword">float</span>)peakPowerForChannel:(<span class="built_in">NSUInteger</span>)channelNumber;	获得指定声道的分贝峰值，注意如果要获得分贝峰值必须在此之前调用updateMeters方法</span><br><span class="line">- (<span class="keyword">float</span>)averagePowerForChannel:(<span class="built_in">NSUInteger</span>)channelNumber	获得指定声道的分贝平均值，注意如果要获得分贝平均值必须在此之前调用updateMeters方法</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSArray</span> *channelAssignments	获得或设置播放声道</span><br><span class="line">代理方法	说明</span><br><span class="line">- (<span class="keyword">void</span>)audioPlayerDidFinishPlaying:(<span class="built_in">AVAudioPlayer</span> *)player successfully:(<span class="built_in">BOOL</span>)flag	音频播放完成</span><br><span class="line">- (<span class="keyword">void</span>)audioPlayerDecodeErrorDidOccur:(<span class="built_in">AVAudioPlayer</span> *)player error:(<span class="built_in">NSError</span> *)error	音频解码发生错误</span><br><span class="line"><span class="built_in">AVAudioPlayer</span>的使用比较简单：</span><br><span class="line">初始化<span class="built_in">AVAudioPlayer</span>对象，此时通常指定本地文件路径。</span><br><span class="line">设置播放器属性，例如重复次数、音量大小等。</span><br><span class="line">调用play方法播放。</span><br><span class="line">下面就使用<span class="built_in">AVAudioPlayer</span>实现一个简单播放器，在这个播放器中实现了播放、暂停、显示播放进度功能，当然例如调节音量、设置循环模式、甚至是声波图像（通过分析音频分贝值）等功能都可以实现，这里就不再一一演示。界面效果如下：</span><br><span class="line">AudioPlayerScreen</span><br><span class="line">当然由于<span class="built_in">AVAudioPlayer</span>一次只能播放一个音频文件，所有上一曲、下一曲其实可以通过创建多个播放器对象来完成，这里暂不实现。播放进度的实现主要依靠一个定时器实时计算当前播放时长和音频总时长的比例，另外为了演示委托方法，下面的代码中也实现了播放完成委托方法，通常如果有下一曲功能的话播放完可以触发下一曲音乐播放。下面是主要代码：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  KCAVAudioPlayer</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/30.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> kMusicFile @<span class="meta-string">"刘若英 - 原来你也在这里.mp3"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> kMusicSinger @<span class="meta-string">"刘若英"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> kMusicTitle @<span class="meta-string">"原来你也在这里"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">AVAudioPlayerDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">AVAudioPlayer</span> *audioPlayer;<span class="comment">//播放器</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UILabel</span> *controlPanel; <span class="comment">//控制面板</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIProgressView</span> *playProgress;<span class="comment">//播放进度</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UILabel</span> *musicSinger; <span class="comment">//演唱者</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIButton</span> *playOrPause; <span class="comment">//播放/暂停按钮(如果tag为0认为是暂停状态，1是播放状态)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span> ,<span class="keyword">nonatomic</span>) <span class="built_in">NSTimer</span> *timer;<span class="comment">//进度更新定时器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span> setupUI];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  初始化UI</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)setupUI&#123;</span><br><span class="line">    <span class="keyword">self</span>.title=kMusicTitle;</span><br><span class="line">    <span class="keyword">self</span>.musicSinger.text=kMusicSinger;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">NSTimer</span> *)timer&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_timer) &#123;</span><br><span class="line">        _timer=[<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">0.5</span> target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(updateProgress) userInfo:<span class="literal">nil</span> repeats:<span class="literal">true</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _timer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  创建播放器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 音频播放器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">AVAudioPlayer</span> *)audioPlayer&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_audioPlayer) &#123;</span><br><span class="line">        <span class="built_in">NSString</span> *urlStr=[[<span class="built_in">NSBundle</span> mainBundle]pathForResource:kMusicFile ofType:<span class="literal">nil</span>];</span><br><span class="line">        <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> fileURLWithPath:urlStr];</span><br><span class="line">        <span class="built_in">NSError</span> *error=<span class="literal">nil</span>;</span><br><span class="line">        <span class="comment">//初始化播放器，注意这里的Url参数只能时文件路径，不支持HTTP Url</span></span><br><span class="line">        _audioPlayer=[[<span class="built_in">AVAudioPlayer</span> alloc]initWithContentsOfURL:url error:&amp;error];</span><br><span class="line">        <span class="comment">//设置播放器属性</span></span><br><span class="line">        _audioPlayer.numberOfLoops=<span class="number">0</span>;<span class="comment">//设置为0不循环</span></span><br><span class="line">        _audioPlayer.delegate=<span class="keyword">self</span>;</span><br><span class="line">        [_audioPlayer prepareToPlay];<span class="comment">//加载音频文件到缓存</span></span><br><span class="line">        <span class="keyword">if</span>(error)&#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"初始化播放器过程发生错误,错误信息:%@"</span>,error.localizedDescription);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _audioPlayer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放音频</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)play&#123;</span><br><span class="line">    <span class="keyword">if</span> (![<span class="keyword">self</span>.audioPlayer isPlaying]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.audioPlayer play];</span><br><span class="line">        <span class="keyword">self</span>.timer.fireDate=[<span class="built_in">NSDate</span> distantPast];<span class="comment">//恢复定时器</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  暂停播放</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)pause&#123;</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.audioPlayer isPlaying]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.audioPlayer pause];</span><br><span class="line">        <span class="keyword">self</span>.timer.fireDate=[<span class="built_in">NSDate</span> distantFuture];<span class="comment">//暂停定时器，注意不能调用invalidate方法，此方法会取消，之后无法恢复</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  点击播放/暂停按钮</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender 播放/暂停按钮</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)playClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">if</span>(sender.tag)&#123;</span><br><span class="line">        sender.tag=<span class="number">0</span>;</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"playing_btn_play_n"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"playing_btn_play_h"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">        [<span class="keyword">self</span> pause];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        sender.tag=<span class="number">1</span>;</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"playing_btn_pause_n"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"playing_btn_pause_h"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">        [<span class="keyword">self</span> play];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  更新播放进度</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)updateProgress&#123;</span><br><span class="line">    <span class="keyword">float</span> progress= <span class="keyword">self</span>.audioPlayer.currentTime /<span class="keyword">self</span>.audioPlayer.duration;</span><br><span class="line">    [<span class="keyword">self</span>.playProgress setProgress:progress animated:<span class="literal">true</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 播放器代理方法</span></span><br><span class="line">-(<span class="keyword">void</span>)audioPlayerDidFinishPlaying:(<span class="built_in">AVAudioPlayer</span> *)player successfully:(<span class="built_in">BOOL</span>)flag&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"音乐播放完成..."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">运行效果：</span><br><span class="line"><span class="built_in">AVAudioPlayer</span></span><br><span class="line">音频会话</span><br><span class="line">事实上上面的播放器还存在一些问题，例如通常我们看到的播放器即使退出到后台也是可以播放的，而这个播放器如果退出到后台它会自动暂停。如果要支持后台播放需要做下面几件事情：</span><br><span class="line"><span class="number">1.</span>设置后台运行模式：在plist文件中添加Required background modes，并且设置item <span class="number">0</span>=App plays audio or streams audio/video using AirPlay（其实可以直接通过Xcode在Project Targets-Capabilities-Background Modes中设置）</span><br><span class="line">BackgroundModes</span><br><span class="line"><span class="number">2.</span>设置<span class="built_in">AVAudioSession</span>的类型为<span class="built_in">AVAudioSessionCategoryPlayback</span>并且调用setActive::方法启动会话。</span><br><span class="line">    <span class="built_in">AVAudioSession</span> *audioSession=[<span class="built_in">AVAudioSession</span> sharedInstance];</span><br><span class="line">    [audioSession setCategory:<span class="built_in">AVAudioSessionCategoryPlayback</span> error:<span class="literal">nil</span>];</span><br><span class="line">    [audioSession setActive:<span class="literal">YES</span> error:<span class="literal">nil</span>];</span><br><span class="line"><span class="number">3.</span>为了能够让应用退到后台之后支持耳机控制，建议添加远程控制事件（这一步不是后台播放必须的）</span><br><span class="line">前两步是后台播放所必须设置的，第三步主要用于接收远程事件，这部分内容之前的文章中有详细介绍，如果这一步不设置虽让也能够在后台播放，但是无法获得音频控制权（如果在使用当前应用之前使用其他播放器播放音乐的话，此时如果按耳机播放键或者控制中心的播放按钮则会播放前一个应用的音频），并且不能使用耳机进行音频控制。第一步操作相信大家都很容易理解，如果应用程序要允许运行到后台必须设置，正常情况下应用如果进入后台会被挂起，通过该设置可以上应用程序继续在后台运行。但是第二步使用的<span class="built_in">AVAudioSession</span>有必要进行一下详细的说明。</span><br><span class="line">在iOS中每个应用都有一个音频会话，这个会话就通过<span class="built_in">AVAudioSession</span>来表示。<span class="built_in">AVAudioSession</span>同样存在于<span class="built_in">AVFoundation</span>框架中，它是单例模式设计，通过sharedInstance进行访问。在使用Apple设备时大家会发现有些应用只要打开其他音频播放就会终止，而有些应用却可以和其他应用同时播放，在多种音频环境中如何去控制播放的方式就是通过音频会话来完成的。下面是音频会话的几种会话模式：</span><br><span class="line">会话类型	说明	是否要求输入	是否要求输出	是否遵从静音键</span><br><span class="line"><span class="built_in">AVAudioSessionCategoryAmbient</span>	混音播放，可以与其他音频应用同时播放	否	是	是</span><br><span class="line"><span class="built_in">AVAudioSessionCategorySoloAmbient</span>	独占播放	否	是	是</span><br><span class="line"><span class="built_in">AVAudioSessionCategoryPlayback</span>	后台播放，也是独占的	否	是	否</span><br><span class="line"><span class="built_in">AVAudioSessionCategoryRecord</span>	录音模式，用于录音时使用	是	否	否</span><br><span class="line"><span class="built_in">AVAudioSessionCategoryPlayAndRecord</span>	播放和录音，此时可以录音也可以播放	是	是	否</span><br><span class="line"><span class="built_in">AVAudioSessionCategoryAudioProcessing</span>	硬件解码音频，此时不能播放和录制	否	否	否</span><br><span class="line"><span class="built_in">AVAudioSessionCategoryMultiRoute</span>	多种输入输出，例如可以耳机、USB设备同时播放	是	是	否</span><br><span class="line">注意：是否遵循静音键表示在播放过程中如果用户通过硬件设置为静音是否能关闭声音。</span><br><span class="line">根据前面对音频会话的理解，相信大家开发出能够在后台播放的音频播放器并不难，但是注意一下，在前面的代码中也提到设置完音频会话类型之后需要调用setActive::方法将会话激活才能起作用。类似的，如果一个应用已经在播放音频，打开我们的应用之后设置了在后台播放的会话类型，此时其他应用的音频会停止而播放我们的音频，如果希望我们的程序音频播放完之后（关闭或退出到后台之后）能够继续播放其他应用的音频的话则可以调用setActive::方法关闭会话。代码如下：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  KCAVAudioPlayer</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/30.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//  AVAudioSession 音频会话</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> kMusicFile @<span class="meta-string">"刘若英 - 原来你也在这里.mp3"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> kMusicSinger @<span class="meta-string">"刘若英"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> kMusicTitle @<span class="meta-string">"原来你也在这里"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">AVAudioPlayerDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">AVAudioPlayer</span> *audioPlayer;<span class="comment">//播放器</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UILabel</span> *controlPanel; <span class="comment">//控制面板</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIProgressView</span> *playProgress;<span class="comment">//播放进度</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UILabel</span> *musicSinger; <span class="comment">//演唱者</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIButton</span> *playOrPause; <span class="comment">//播放/暂停按钮(如果tag为0认为是暂停状态，1是播放状态)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span> ,<span class="keyword">nonatomic</span>) <span class="built_in">NSTimer</span> *timer;<span class="comment">//进度更新定时器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span> setupUI];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  显示当面视图控制器时注册远程事件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param animated 是否以动画的形式显示</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)viewWillAppear:(<span class="built_in">BOOL</span>)animated&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewWillAppear:animated];</span><br><span class="line">    <span class="comment">//开启远程控制</span></span><br><span class="line">    [[<span class="built_in">UIApplication</span> sharedApplication] beginReceivingRemoteControlEvents];</span><br><span class="line">    <span class="comment">//作为第一响应者</span></span><br><span class="line">    <span class="comment">//[self becomeFirstResponder];</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  当前控制器视图不显示时取消远程控制</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param animated 是否以动画的形式消失</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)viewWillDisappear:(<span class="built_in">BOOL</span>)animated&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewWillDisappear:animated];</span><br><span class="line">    [[<span class="built_in">UIApplication</span> sharedApplication] endReceivingRemoteControlEvents];</span><br><span class="line">    <span class="comment">//[self resignFirstResponder];</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  初始化UI</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)setupUI&#123;</span><br><span class="line">    <span class="keyword">self</span>.title=kMusicTitle;</span><br><span class="line">    <span class="keyword">self</span>.musicSinger.text=kMusicSinger;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">NSTimer</span> *)timer&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_timer) &#123;</span><br><span class="line">        _timer=[<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">0.5</span> target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(updateProgress) userInfo:<span class="literal">nil</span> repeats:<span class="literal">true</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _timer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  创建播放器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 音频播放器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">AVAudioPlayer</span> *)audioPlayer&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_audioPlayer) &#123;</span><br><span class="line">        <span class="built_in">NSString</span> *urlStr=[[<span class="built_in">NSBundle</span> mainBundle]pathForResource:kMusicFile ofType:<span class="literal">nil</span>];</span><br><span class="line">        <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> fileURLWithPath:urlStr];</span><br><span class="line">        <span class="built_in">NSError</span> *error=<span class="literal">nil</span>;</span><br><span class="line">        <span class="comment">//初始化播放器，注意这里的Url参数只能时文件路径，不支持HTTP Url</span></span><br><span class="line">        _audioPlayer=[[<span class="built_in">AVAudioPlayer</span> alloc]initWithContentsOfURL:url error:&amp;error];</span><br><span class="line">        <span class="comment">//设置播放器属性</span></span><br><span class="line">        _audioPlayer.numberOfLoops=<span class="number">0</span>;<span class="comment">//设置为0不循环</span></span><br><span class="line">        _audioPlayer.delegate=<span class="keyword">self</span>;</span><br><span class="line">        [_audioPlayer prepareToPlay];<span class="comment">//加载音频文件到缓存</span></span><br><span class="line">        <span class="keyword">if</span>(error)&#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"初始化播放器过程发生错误,错误信息:%@"</span>,error.localizedDescription);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//设置后台播放模式</span></span><br><span class="line">        <span class="built_in">AVAudioSession</span> *audioSession=[<span class="built_in">AVAudioSession</span> sharedInstance];</span><br><span class="line">        [audioSession setCategory:<span class="built_in">AVAudioSessionCategoryPlayback</span> error:<span class="literal">nil</span>];</span><br><span class="line"><span class="comment">//        [audioSession setCategory:AVAudioSessionCategoryPlayback withOptions:AVAudioSessionCategoryOptionAllowBluetooth error:nil];</span></span><br><span class="line">        [audioSession setActive:<span class="literal">YES</span> error:<span class="literal">nil</span>];</span><br><span class="line">        <span class="comment">//添加通知，拔出耳机后暂停播放</span></span><br><span class="line">        [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(routeChange:) name:<span class="built_in">AVAudioSessionRouteChangeNotification</span> object:<span class="literal">nil</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _audioPlayer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放音频</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)play&#123;</span><br><span class="line">    <span class="keyword">if</span> (![<span class="keyword">self</span>.audioPlayer isPlaying]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.audioPlayer play];</span><br><span class="line">        <span class="keyword">self</span>.timer.fireDate=[<span class="built_in">NSDate</span> distantPast];<span class="comment">//恢复定时器</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  暂停播放</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)pause&#123;</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.audioPlayer isPlaying]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.audioPlayer pause];</span><br><span class="line">        <span class="keyword">self</span>.timer.fireDate=[<span class="built_in">NSDate</span> distantFuture];<span class="comment">//暂停定时器，注意不能调用invalidate方法，此方法会取消，之后无法恢复</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  点击播放/暂停按钮</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender 播放/暂停按钮</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)playClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">if</span>(sender.tag)&#123;</span><br><span class="line">        sender.tag=<span class="number">0</span>;</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"playing_btn_play_n"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"playing_btn_play_h"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">        [<span class="keyword">self</span> pause];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        sender.tag=<span class="number">1</span>;</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"playing_btn_pause_n"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"playing_btn_pause_h"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">        [<span class="keyword">self</span> play];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  更新播放进度</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)updateProgress&#123;</span><br><span class="line">    <span class="keyword">float</span> progress= <span class="keyword">self</span>.audioPlayer.currentTime /<span class="keyword">self</span>.audioPlayer.duration;</span><br><span class="line">    [<span class="keyword">self</span>.playProgress setProgress:progress animated:<span class="literal">true</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  一旦输出改变则执行此方法</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param notification 输出改变通知对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)routeChange:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic=notification.userInfo;</span><br><span class="line">    <span class="keyword">int</span> changeReason= [dic[<span class="built_in">AVAudioSessionRouteChangeReasonKey</span>] intValue];</span><br><span class="line">    <span class="comment">//等于AVAudioSessionRouteChangeReasonOldDeviceUnavailable表示旧输出不可用</span></span><br><span class="line">    <span class="keyword">if</span> (changeReason==<span class="built_in">AVAudioSessionRouteChangeReasonOldDeviceUnavailable</span>) &#123;</span><br><span class="line">        <span class="built_in">AVAudioSessionRouteDescription</span> *routeDescription=dic[<span class="built_in">AVAudioSessionRouteChangePreviousRouteKey</span>];</span><br><span class="line">        <span class="built_in">AVAudioSessionPortDescription</span> *portDescription= [routeDescription.outputs firstObject];</span><br><span class="line">        <span class="comment">//原设备为耳机则暂停</span></span><br><span class="line">        <span class="keyword">if</span> ([portDescription.portType isEqualToString:<span class="string">@"Headphones"</span>]) &#123;</span><br><span class="line">            [<span class="keyword">self</span> pause];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//    [dic enumerateKeysAndObjectsUsingBlock:^(id key, id obj, BOOL *stop) &#123;</span></span><br><span class="line"><span class="comment">//        NSLog(@"%@:%@",key,obj);</span></span><br><span class="line"><span class="comment">//    &#125;];</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)dealloc&#123;</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span> name:<span class="built_in">AVAudioSessionRouteChangeNotification</span> object:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 播放器代理方法</span></span><br><span class="line">-(<span class="keyword">void</span>)audioPlayerDidFinishPlaying:(<span class="built_in">AVAudioPlayer</span> *)player successfully:(<span class="built_in">BOOL</span>)flag&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"音乐播放完成..."</span>);</span><br><span class="line">    <span class="comment">//根据实际情况播放完成可以将会话关闭，其他音频应用继续播放</span></span><br><span class="line">    [[<span class="built_in">AVAudioSession</span> sharedInstance]setActive:<span class="literal">NO</span> error:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">在上面的代码中还实现了拔出耳机暂停音乐播放的功能，这也是一个比较常见的功能。在iOS7及以后的版本中可以通过通知获得输出改变的通知，然后拿到通知对象后根据userInfo获得是何种改变类型，进而根据情况对音乐进行暂停操作。</span><br><span class="line">扩展--播放音乐库中的音乐</span><br><span class="line">众所周知音乐是iOS的重要组成播放，无论是iPod、iTouch、iPhone还是iPad都可以在iTunes购买音乐或添加本地音乐到音乐库中同步到你的iOS设备。在MediaPlayer.frameowork中有一个<span class="built_in">MPMusicPlayerController</span>用于播放音乐库中的音乐。</span><br><span class="line">下面先来看一下<span class="built_in">MPMusicPlayerController</span>的常用属性和方法：</span><br><span class="line">属性	说明</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">MPMusicPlaybackState</span> playbackState	播放器状态，枚举类型：</span><br><span class="line"><span class="built_in">MPMusicPlaybackStateStopped</span>：停止播放 <span class="built_in">MPMusicPlaybackStatePlaying</span>：正在播放</span><br><span class="line"><span class="built_in">MPMusicPlaybackStatePaused</span>：暂停播放</span><br><span class="line"><span class="built_in">MPMusicPlaybackStateInterrupted</span>：播放中断</span><br><span class="line"><span class="built_in">MPMusicPlaybackStateSeekingForward</span>：向前查找</span><br><span class="line"><span class="built_in">MPMusicPlaybackStateSeekingBackward</span>：向后查找</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">MPMusicRepeatMode</span> repeatMode	重复模式，枚举类型：</span><br><span class="line"><span class="built_in">MPMusicRepeatModeDefault</span>：默认模式，使用用户的首选项（系统音乐程序设置）</span><br><span class="line"><span class="built_in">MPMusicRepeatModeNone</span>：不重复</span><br><span class="line"><span class="built_in">MPMusicRepeatModeOne</span>：单曲循环</span><br><span class="line"><span class="built_in">MPMusicRepeatModeAll</span>：在当前列表内循环</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">MPMusicShuffleMode</span> shuffleMode	随机播放模式，枚举类型：</span><br><span class="line"><span class="built_in">MPMusicShuffleModeDefault</span>：默认模式，使用用户首选项（系统音乐程序设置）</span><br><span class="line"><span class="built_in">MPMusicShuffleModeOff</span>：不随机播放</span><br><span class="line"><span class="built_in">MPMusicShuffleModeSongs</span>：按歌曲随机播放</span><br><span class="line"><span class="built_in">MPMusicShuffleModeAlbums</span>：按专辑随机播放</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">MPMediaItem</span> *nowPlayingItem	正在播放的音乐项</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">NSUInteger</span> indexOfNowPlayingItem	当前正在播放的音乐在播放队列中的索引</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> isPreparedToPlay	是否准好播放准备</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">NSTimeInterval</span> currentPlaybackTime	当前已播放时间，单位：秒</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="keyword">float</span> currentPlaybackRate	当前播放速度，是一个播放速度倍率，<span class="number">0</span>表示暂停播放，<span class="number">1</span>代表正常速度</span><br><span class="line">类方法	说明</span><br><span class="line">+ (<span class="built_in">MPMusicPlayerController</span> *)applicationMusicPlayer;	获取应用播放器，注意此类播放器无法在后台播放</span><br><span class="line">+ (<span class="built_in">MPMusicPlayerController</span> *)systemMusicPlayer	获取系统播放器，支持后台播放</span><br><span class="line">对象方法	说明</span><br><span class="line">- (<span class="keyword">void</span>)setQueueWithQuery:(<span class="built_in">MPMediaQuery</span> *)query	使用媒体队列设置播放源媒体队列</span><br><span class="line">- (<span class="keyword">void</span>)setQueueWithItemCollection:(<span class="built_in">MPMediaItemCollection</span> *)itemCollection	使用媒体项集合设置播放源媒体队列</span><br><span class="line">- (<span class="keyword">void</span>)skipToNextItem	下一曲</span><br><span class="line">- (<span class="keyword">void</span>)skipToBeginning	从起始位置播放</span><br><span class="line">- (<span class="keyword">void</span>)skipToPreviousItem	上一曲</span><br><span class="line">- (<span class="keyword">void</span>)beginGeneratingPlaybackNotifications	开启播放通知，注意不同于其他播放器，<span class="built_in">MPMusicPlayerController</span>要想获得通知必须首先开启，默认情况无法获得通知</span><br><span class="line">- (<span class="keyword">void</span>)endGeneratingPlaybackNotifications	关闭播放通知</span><br><span class="line">- (<span class="keyword">void</span>)prepareToPlay	做好播放准备（加载音频到缓冲区），在使用play方法播放时如果没有做好准备回自动调用该方法</span><br><span class="line">- (<span class="keyword">void</span>)play	开始播放</span><br><span class="line">- (<span class="keyword">void</span>)pause	暂停播放</span><br><span class="line">- (<span class="keyword">void</span>)stop	停止播放</span><br><span class="line">- (<span class="keyword">void</span>)beginSeekingForward	开始向前查找（快进）</span><br><span class="line">- (<span class="keyword">void</span>)beginSeekingBackward	开始向后查找（快退）</span><br><span class="line">- (<span class="keyword">void</span>)endSeeking	结束查找</span><br><span class="line">通知	说明</span><br><span class="line">（注意：要想获得<span class="built_in">MPMusicPlayerController</span>通知必须首先调用beginGeneratingPlaybackNotifications开启通知）</span><br><span class="line"><span class="built_in">MPMusicPlayerControllerPlaybackStateDidChangeNotification</span>	播放状态改变</span><br><span class="line"><span class="built_in">MPMusicPlayerControllerNowPlayingItemDidChangeNotification</span>	当前播放音频改变</span><br><span class="line"><span class="built_in">MPMusicPlayerControllerVolumeDidChangeNotification</span>	声音大小改变</span><br><span class="line"><span class="built_in">MPMediaPlaybackIsPreparedToPlayDidChangeNotification</span>	准备好播放</span><br><span class="line"><span class="built_in">MPMusicPlayerController</span>有两种播放器：applicationMusicPlayer和systemMusicPlayer，前者在应用退出后音乐播放会自动停止，后者在应用停止后不会退出播放状态。</span><br><span class="line"><span class="built_in">MPMusicPlayerController</span>加载音乐不同于前面的<span class="built_in">AVAudioPlayer</span>是通过一个文件路径来加载，而是需要一个播放队列。在<span class="built_in">MPMusicPlayerController</span>中提供了两个方法来加载播放队列：- (<span class="keyword">void</span>)setQueueWithQuery:(<span class="built_in">MPMediaQuery</span> *)query和- (<span class="keyword">void</span>)setQueueWithItemCollection:(<span class="built_in">MPMediaItemCollection</span> *)itemCollection，正是由于它的播放音频来源是一个队列，因此<span class="built_in">MPMusicPlayerController</span>支持上一曲、下一曲等操作。</span><br><span class="line">那么接下来的问题就是如何获取<span class="built_in">MPMediaQueue</span>或者<span class="built_in">MPMediaItemCollection</span>？<span class="built_in">MPMediaQueue</span>对象有一系列的类方法来获得媒体队列：</span><br><span class="line">+ (<span class="built_in">MPMediaQuery</span> *)albumsQuery;</span><br><span class="line">+ (<span class="built_in">MPMediaQuery</span> *)artistsQuery;</span><br><span class="line">+ (<span class="built_in">MPMediaQuery</span> *)songsQuery;</span><br><span class="line">+ (<span class="built_in">MPMediaQuery</span> *)playlistsQuery;</span><br><span class="line">+ (<span class="built_in">MPMediaQuery</span> *)podcastsQuery;</span><br><span class="line">+ (<span class="built_in">MPMediaQuery</span> *)audiobooksQuery;</span><br><span class="line">+ (<span class="built_in">MPMediaQuery</span> *)compilationsQuery;</span><br><span class="line">+ (<span class="built_in">MPMediaQuery</span> *)composersQuery;</span><br><span class="line">+ (<span class="built_in">MPMediaQuery</span> *)genresQuery;</span><br><span class="line">有了这些方法，就可以很容易获到歌曲、播放列表、专辑媒体等媒体队列了，这样就可以通过：- (<span class="keyword">void</span>)setQueueWithQuery:(<span class="built_in">MPMediaQuery</span> *)query方法设置音乐来源了。又或者得到<span class="built_in">MPMediaQueue</span>之后创建<span class="built_in">MPMediaItemCollection</span>，使用- (<span class="keyword">void</span>)setQueueWithItemCollection:(<span class="built_in">MPMediaItemCollection</span> *)itemCollection设置音乐来源。</span><br><span class="line">有时候可能希望用户自己来选择要播放的音乐，这时可以使用<span class="built_in">MPMediaPickerController</span>，它是一个视图控制器，类似于<span class="built_in">UIImagePickerController</span>，选择完播放来源后可以在其代理方法中获得<span class="built_in">MPMediaItemCollection</span>对象。</span><br><span class="line">无论是通过哪种方式获得<span class="built_in">MPMusicPlayerController</span>的媒体源，可能都希望将每个媒体的信息显示出来，这时候可以通过<span class="built_in">MPMediaItem</span>对象获得。一个<span class="built_in">MPMediaItem</span>代表一个媒体文件，通过它可以访问媒体标题、专辑名称、专辑封面、音乐时长等等。无论是<span class="built_in">MPMediaQueue</span>还是<span class="built_in">MPMediaItemCollection</span>都有一个items属性，它是<span class="built_in">MPMediaItem</span>数组，通过这个属性可以获得<span class="built_in">MPMediaItem</span>对象。</span><br><span class="line">下面就简单看一下<span class="built_in">MPMusicPlayerController</span>的使用，在下面的例子中简单演示了音乐的选择、播放、暂停、通知、下一曲、上一曲功能，相信有了上面的概念，代码读起来并不复杂（示例中是直接通过<span class="built_in">MPMeidaPicker</span>进行音乐选择的，但是仍然提供了两个方法getLocalMediaQuery和getLocalMediaItemCollection来演示如何直接通过<span class="built_in">MPMediaQueue</span>获得媒体队列或媒体集合）：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  MPMusicPlayerController</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui 14/03/30</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;MediaPlayer/MediaPlayer.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">MPMediaPickerControllerDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">MPMediaPickerController</span> *mediaPicker;<span class="comment">//媒体选择控制器</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">MPMusicPlayerController</span> *musicPlayer; <span class="comment">//音乐播放器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)dealloc&#123;</span><br><span class="line">    [<span class="keyword">self</span>.musicPlayer endGeneratingPlaybackNotifications];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  获得音乐播放器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 音乐播放器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">MPMusicPlayerController</span> *)musicPlayer&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_musicPlayer) &#123;</span><br><span class="line">        _musicPlayer=[<span class="built_in">MPMusicPlayerController</span> systemMusicPlayer];</span><br><span class="line">        [_musicPlayer beginGeneratingPlaybackNotifications];<span class="comment">//开启通知，否则监控不到MPMusicPlayerController的通知</span></span><br><span class="line">        [<span class="keyword">self</span> addNotification];<span class="comment">//添加通知</span></span><br><span class="line">        <span class="comment">//如果不使用MPMediaPickerController可以使用如下方法获得音乐库媒体队列</span></span><br><span class="line">        <span class="comment">//[_musicPlayer setQueueWithItemCollection:[self getLocalMediaItemCollection]];</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _musicPlayer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  创建媒体选择器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 媒体选择器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">MPMediaPickerController</span> *)mediaPicker&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_mediaPicker) &#123;</span><br><span class="line">        <span class="comment">//初始化媒体选择器，这里设置媒体类型为音乐，其实这里也可以选择视频、广播等</span></span><br><span class="line"><span class="comment">//        _mediaPicker=[[MPMediaPickerController alloc]initWithMediaTypes:MPMediaTypeMusic];</span></span><br><span class="line">        _mediaPicker=[[<span class="built_in">MPMediaPickerController</span> alloc]initWithMediaTypes:<span class="built_in">MPMediaTypeAny</span>];</span><br><span class="line">        _mediaPicker.allowsPickingMultipleItems=<span class="literal">YES</span>;<span class="comment">//允许多选</span></span><br><span class="line"><span class="comment">//        _mediaPicker.showsCloudItems=YES;//显示icloud选项</span></span><br><span class="line">        _mediaPicker.prompt=<span class="string">@"请选择要播放的音乐"</span>;</span><br><span class="line">        _mediaPicker.delegate=<span class="keyword">self</span>;<span class="comment">//设置选择器代理</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _mediaPicker;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得媒体队列</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 媒体队列</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">MPMediaQuery</span> *)getLocalMediaQuery&#123;</span><br><span class="line">    <span class="built_in">MPMediaQuery</span> *mediaQueue=[<span class="built_in">MPMediaQuery</span> songsQuery];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">MPMediaItem</span> *item <span class="keyword">in</span> mediaQueue.items) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"标题：%@,%@"</span>,item.title,item.albumTitle);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mediaQueue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得媒体集合</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 媒体集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">MPMediaItemCollection</span> *)getLocalMediaItemCollection&#123;</span><br><span class="line">    <span class="built_in">MPMediaQuery</span> *mediaQueue=[<span class="built_in">MPMediaQuery</span> songsQuery];</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *array=[<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">MPMediaItem</span> *item <span class="keyword">in</span> mediaQueue.items) &#123;</span><br><span class="line">        [array addObject:item];</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"标题：%@,%@"</span>,item.title,item.albumTitle);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">MPMediaItemCollection</span> *mediaItemCollection=[[<span class="built_in">MPMediaItemCollection</span> alloc]initWithItems:[array <span class="keyword">copy</span>]];</span><br><span class="line">    <span class="keyword">return</span> mediaItemCollection;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - MPMediaPickerController代理方法</span></span><br><span class="line"><span class="comment">//选择完成</span></span><br><span class="line">-(<span class="keyword">void</span>)mediaPicker:(<span class="built_in">MPMediaPickerController</span> *)mediaPicker didPickMediaItems:(<span class="built_in">MPMediaItemCollection</span> *)mediaItemCollection&#123;</span><br><span class="line">    <span class="built_in">MPMediaItem</span> *mediaItem=[mediaItemCollection.items firstObject];<span class="comment">//第一个播放音乐</span></span><br><span class="line">    <span class="comment">//注意很多音乐信息如标题、专辑、表演者、封面、时长等信息都可以通过MPMediaItem的valueForKey:方法得到,但是从iOS7开始都有对应的属性可以直接访问</span></span><br><span class="line"><span class="comment">//    NSString *title= [mediaItem valueForKey:MPMediaItemPropertyAlbumTitle];</span></span><br><span class="line"><span class="comment">//    NSString *artist= [mediaItem valueForKey:MPMediaItemPropertyAlbumArtist];</span></span><br><span class="line"><span class="comment">//    MPMediaItemArtwork *artwork= [mediaItem valueForKey:MPMediaItemPropertyArtwork];</span></span><br><span class="line">    <span class="comment">//UIImage *image=[artwork imageWithSize:CGSizeMake(100, 100)];//专辑图片</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"标题：%@,表演者：%@,专辑：%@"</span>,mediaItem.title ,mediaItem.artist,mediaItem.albumTitle);</span><br><span class="line">    [<span class="keyword">self</span>.musicPlayer setQueueWithItemCollection:mediaItemCollection];</span><br><span class="line">    [<span class="keyword">self</span> dismissViewControllerAnimated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//取消选择</span></span><br><span class="line">-(<span class="keyword">void</span>)mediaPickerDidCancel:(<span class="built_in">MPMediaPickerController</span> *)mediaPicker&#123;</span><br><span class="line">    [<span class="keyword">self</span> dismissViewControllerAnimated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 通知</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  添加通知</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addNotification&#123;</span><br><span class="line">    <span class="built_in">NSNotificationCenter</span> *notificationCenter=[<span class="built_in">NSNotificationCenter</span> defaultCenter];</span><br><span class="line">    [notificationCenter addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(playbackStateChange:) name:<span class="built_in">MPMusicPlayerControllerPlaybackStateDidChangeNotification</span> object:<span class="keyword">self</span>.musicPlayer];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放状态改变通知</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param notification 通知对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)playbackStateChange:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">self</span>.musicPlayer.playbackState) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMusicPlaybackStatePlaying</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"正在播放..."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMusicPlaybackStatePaused</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"播放暂停."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMusicPlaybackStateStopped</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"播放停止."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UI事件</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)selectClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span> presentViewController:<span class="keyword">self</span>.mediaPicker animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)playClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span>.musicPlayer play];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)puaseClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span>.musicPlayer pause];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)stopClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span>.musicPlayer stop];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)nextClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span>.musicPlayer skipToNextItem];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)prevClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span>.musicPlayer skipToPreviousItem];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">录音</span><br><span class="line">除了上面说的，在<span class="built_in">AVFoundation</span>框架中还要一个<span class="built_in">AVAudioRecorder</span>类专门处理录音操作，它同样支持多种音频格式。与<span class="built_in">AVAudioPlayer</span>类似，你完全可以将它看成是一个录音机控制类，下面是常用的属性和方法：</span><br><span class="line">属性	说明</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isRecording) <span class="built_in">BOOL</span> recording;	是否正在录音，只读</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>) <span class="built_in">NSURL</span> *url	录音文件地址，只读</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>) <span class="built_in">NSDictionary</span> *settings	录音文件设置，只读</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>) <span class="built_in">NSTimeInterval</span> currentTime	录音时长，只读，注意仅仅在录音状态可用</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">readonly</span>) <span class="built_in">NSTimeInterval</span> deviceCurrentTime	输入设置的时间长度，只读，注意此属性一直可访问</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">getter</span>=isMeteringEnabled) <span class="built_in">BOOL</span> meteringEnabled;	是否启用录音测量，如果启用录音测量可以获得录音分贝等数据信息</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSArray</span> *channelAssignments	当前录音的通道</span><br><span class="line">对象方法	说明</span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithURL:(<span class="built_in">NSURL</span> *)url settings:(<span class="built_in">NSDictionary</span> *)settings error:(<span class="built_in">NSError</span> **)outError	录音机对象初始化方法，注意其中的url必须是本地文件url，settings是录音格式、编码等设置</span><br><span class="line">- (<span class="built_in">BOOL</span>)prepareToRecord	准备录音，主要用于创建缓冲区，如果不手动调用，在调用record录音时也会自动调用</span><br><span class="line">- (<span class="built_in">BOOL</span>)record	开始录音</span><br><span class="line">- (<span class="built_in">BOOL</span>)recordAtTime:(<span class="built_in">NSTimeInterval</span>)time	在指定的时间开始录音，一般用于录音暂停再恢复录音</span><br><span class="line">- (<span class="built_in">BOOL</span>)recordForDuration:(<span class="built_in">NSTimeInterval</span>) duration	按指定的时长开始录音</span><br><span class="line">- (<span class="built_in">BOOL</span>)recordAtTime:(<span class="built_in">NSTimeInterval</span>)time forDuration:(<span class="built_in">NSTimeInterval</span>) duration	在指定的时间开始录音，并指定录音时长</span><br><span class="line">- (<span class="keyword">void</span>)pause;	暂停录音</span><br><span class="line">- (<span class="keyword">void</span>)stop;	停止录音</span><br><span class="line">- (<span class="built_in">BOOL</span>)deleteRecording;	删除录音，注意要删除录音此时录音机必须处于停止状态</span><br><span class="line">- (<span class="keyword">void</span>)updateMeters;	更新测量数据，注意只有meteringEnabled为<span class="literal">YES</span>此方法才可用</span><br><span class="line">- (<span class="keyword">float</span>)peakPowerForChannel:(<span class="built_in">NSUInteger</span>)channelNumber;	指定通道的测量峰值，注意只有调用完updateMeters才有值</span><br><span class="line">- (<span class="keyword">float</span>)averagePowerForChannel:(<span class="built_in">NSUInteger</span>)channelNumber	指定通道的测量平均值，注意只有调用完updateMeters才有值</span><br><span class="line">代理方法	说明</span><br><span class="line">- (<span class="keyword">void</span>)audioRecorderDidFinishRecording:(<span class="built_in">AVAudioRecorder</span> *)recorder successfully:(<span class="built_in">BOOL</span>)flag	完成录音</span><br><span class="line">- (<span class="keyword">void</span>)audioRecorderEncodeErrorDidOccur:(<span class="built_in">AVAudioRecorder</span> *)recorder error:(<span class="built_in">NSError</span> *)error	录音编码发生错误</span><br><span class="line"><span class="built_in">AVAudioRecorder</span>很多属性和方法跟<span class="built_in">AVAudioPlayer</span>都是类似的,但是它的创建有所不同，在创建录音机时除了指定路径外还必须指定录音设置信息，因为录音机必须知道录音文件的格式、采样率、通道数、每个采样点的位数等信息，但是也并不是所有的信息都必须设置，通常只需要几个常用设置。关于录音设置详见帮助文档中的“AV Foundation Audio Settings Constants”。</span><br><span class="line">下面就使用<span class="built_in">AVAudioRecorder</span>创建一个录音机，实现了录音、暂停、停止、播放等功能，实现效果大致如下：</span><br><span class="line"><span class="built_in">AVAudioRecorderSnapshot</span></span><br><span class="line">在这个示例中将实行一个完整的录音控制，包括录音、暂停、恢复、停止，同时还会实时展示用户录音的声音波动，当用户点击完停止按钮还会自动播放录音文件。程序的构建主要分为以下几步：</span><br><span class="line">设置音频会话类型为<span class="built_in">AVAudioSessionCategoryPlayAndRecord</span>，因为程序中牵扯到录音和播放操作。</span><br><span class="line">创建录音机<span class="built_in">AVAudioRecorder</span>，指定录音保存的路径并且设置录音属性，注意对于一般的录音文件要求的采样率、位数并不高，需要适当设置以保证录音文件的大小和效果。</span><br><span class="line">设置录音机代理以便在录音完成后播放录音，打开录音测量保证能够实时获得录音时的声音强度。（注意声音强度范围<span class="number">-160</span>到<span class="number">0</span>,<span class="number">0</span>代表最大输入）</span><br><span class="line">创建音频播放器<span class="built_in">AVAudioPlayer</span>，用于在录音完成之后播放录音。</span><br><span class="line">创建一个定时器以便实时刷新录音测量值并更新录音强度到<span class="built_in">UIProgressView</span>中显示。</span><br><span class="line">添加录音、暂停、恢复、停止操作，需要注意录音的恢复操作其实是有音频会话管理的，恢复时只要再次调用record方法即可，无需手动管理恢复时间等。</span><br><span class="line">下面是主要代码：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  AVAudioRecorder</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/30.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> kRecordAudioFile @<span class="meta-string">"myRecord.caf"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">AVAudioRecorderDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">AVAudioRecorder</span> *audioRecorder;<span class="comment">//音频录音机</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">AVAudioPlayer</span> *audioPlayer;<span class="comment">//音频播放器，用于播放录音文件</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">NSTimer</span> *timer;<span class="comment">//录音声波监控（注意这里暂时不对播放进行监控）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIButton</span> *record;<span class="comment">//开始录音</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIButton</span> *pause;<span class="comment">//暂停录音</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIButton</span> *resume;<span class="comment">//恢复录音</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIButton</span> *stop;<span class="comment">//停止录音</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIProgressView</span> *audioPower;<span class="comment">//音频波动</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 控制器视图方法</span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> setAudioSession];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  设置音频会话</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)setAudioSession&#123;</span><br><span class="line">    <span class="built_in">AVAudioSession</span> *audioSession=[<span class="built_in">AVAudioSession</span> sharedInstance];</span><br><span class="line">    <span class="comment">//设置为播放和录音状态，以便可以在录制完之后播放录音</span></span><br><span class="line">    [audioSession setCategory:<span class="built_in">AVAudioSessionCategoryPlayAndRecord</span> error:<span class="literal">nil</span>];</span><br><span class="line">    [audioSession setActive:<span class="literal">YES</span> error:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得录音文件保存路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 录音文件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSURL</span> *)getSavePath&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=[<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) lastObject];</span><br><span class="line">    urlStr=[urlStr stringByAppendingPathComponent:kRecordAudioFile];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"file path:%@"</span>,urlStr);</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> fileURLWithPath:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得录音文件设置</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 录音设置</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSDictionary</span> *)getAudioSetting&#123;</span><br><span class="line">    <span class="built_in">NSMutableDictionary</span> *dicM=[<span class="built_in">NSMutableDictionary</span> dictionary];</span><br><span class="line">    <span class="comment">//设置录音格式</span></span><br><span class="line">    [dicM setObject:@(kAudioFormatLinearPCM) forKey:<span class="built_in">AVFormatIDKey</span>];</span><br><span class="line">    <span class="comment">//设置录音采样率，8000是电话采样率，对于一般录音已经够了</span></span><br><span class="line">    [dicM setObject:@(<span class="number">8000</span>) forKey:<span class="built_in">AVSampleRateKey</span>];</span><br><span class="line">    <span class="comment">//设置通道,这里采用单声道</span></span><br><span class="line">    [dicM setObject:@(<span class="number">1</span>) forKey:<span class="built_in">AVNumberOfChannelsKey</span>];</span><br><span class="line">    <span class="comment">//每个采样点位数,分为8、16、24、32</span></span><br><span class="line">    [dicM setObject:@(<span class="number">8</span>) forKey:<span class="built_in">AVLinearPCMBitDepthKey</span>];</span><br><span class="line">    <span class="comment">//是否使用浮点数采样</span></span><br><span class="line">    [dicM setObject:@(<span class="literal">YES</span>) forKey:<span class="built_in">AVLinearPCMIsFloatKey</span>];</span><br><span class="line">    <span class="comment">//....其他设置等</span></span><br><span class="line">    <span class="keyword">return</span> dicM;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  获得录音机对象</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 录音机对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">AVAudioRecorder</span> *)audioRecorder&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_audioRecorder) &#123;</span><br><span class="line">        <span class="comment">//创建录音文件保存路径</span></span><br><span class="line">        <span class="built_in">NSURL</span> *url=[<span class="keyword">self</span> getSavePath];</span><br><span class="line">        <span class="comment">//创建录音格式设置</span></span><br><span class="line">        <span class="built_in">NSDictionary</span> *setting=[<span class="keyword">self</span> getAudioSetting];</span><br><span class="line">        <span class="comment">//创建录音机</span></span><br><span class="line">        <span class="built_in">NSError</span> *error=<span class="literal">nil</span>;</span><br><span class="line">        _audioRecorder=[[<span class="built_in">AVAudioRecorder</span> alloc]initWithURL:url settings:setting error:&amp;error];</span><br><span class="line">        _audioRecorder.delegate=<span class="keyword">self</span>;</span><br><span class="line">        _audioRecorder.meteringEnabled=<span class="literal">YES</span>;<span class="comment">//如果要监控声波则必须设置为YES</span></span><br><span class="line">        <span class="keyword">if</span> (error) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"创建录音机对象时发生错误，错误信息：%@"</span>,error.localizedDescription);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _audioRecorder;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  创建播放器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 播放器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">AVAudioPlayer</span> *)audioPlayer&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_audioPlayer) &#123;</span><br><span class="line">        <span class="built_in">NSURL</span> *url=[<span class="keyword">self</span> getSavePath];</span><br><span class="line">        <span class="built_in">NSError</span> *error=<span class="literal">nil</span>;</span><br><span class="line">        _audioPlayer=[[<span class="built_in">AVAudioPlayer</span> alloc]initWithContentsOfURL:url error:&amp;error];</span><br><span class="line">        _audioPlayer.numberOfLoops=<span class="number">0</span>;</span><br><span class="line">        [_audioPlayer prepareToPlay];</span><br><span class="line">        <span class="keyword">if</span> (error) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"创建播放器过程中发生错误，错误信息：%@"</span>,error.localizedDescription);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _audioPlayer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  录音声波监控定制器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 定时器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSTimer</span> *)timer&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_timer) &#123;</span><br><span class="line">        _timer=[<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">0.1</span>f target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(audioPowerChange) userInfo:<span class="literal">nil</span> repeats:<span class="literal">YES</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _timer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  录音声波状态设置</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)audioPowerChange&#123;</span><br><span class="line">    [<span class="keyword">self</span>.audioRecorder updateMeters];<span class="comment">//更新测量值</span></span><br><span class="line">    <span class="keyword">float</span> power= [<span class="keyword">self</span>.audioRecorder averagePowerForChannel:<span class="number">0</span>];<span class="comment">//取得第一个通道的音频，注意音频强度范围时-160到0</span></span><br><span class="line">    <span class="built_in">CGFloat</span> progress=(<span class="number">1.0</span>/<span class="number">160.0</span>)*(power+<span class="number">160.0</span>);</span><br><span class="line">    [<span class="keyword">self</span>.audioPower setProgress:progress];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UI事件</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  点击录音按钮</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender 录音按钮</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)recordClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">if</span> (![<span class="keyword">self</span>.audioRecorder isRecording]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.audioRecorder record];<span class="comment">//首次使用应用时如果调用record方法会询问用户是否允许使用麦克风</span></span><br><span class="line">        <span class="keyword">self</span>.timer.fireDate=[<span class="built_in">NSDate</span> distantPast];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  点击暂定按钮</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender 暂停按钮</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)pauseClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.audioRecorder isRecording]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.audioRecorder pause];</span><br><span class="line">        <span class="keyword">self</span>.timer.fireDate=[<span class="built_in">NSDate</span> distantFuture];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  点击恢复按钮</span></span><br><span class="line"><span class="comment"> *  恢复录音只需要再次调用record，AVAudioSession会帮助你记录上次录音位置并追加录音</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender 恢复按钮</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)resumeClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span> recordClick:sender];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  点击停止按钮</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender 停止按钮</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)stopClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span>.audioRecorder stop];</span><br><span class="line">    <span class="keyword">self</span>.timer.fireDate=[<span class="built_in">NSDate</span> distantFuture];</span><br><span class="line">    <span class="keyword">self</span>.audioPower.progress=<span class="number">0.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 录音机代理方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  录音完成，录音完成后播放录音</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param recorder 录音机对象</span></span><br><span class="line"><span class="comment"> *  @param flag     是否成功</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)audioRecorderDidFinishRecording:(<span class="built_in">AVAudioRecorder</span> *)recorder successfully:(<span class="built_in">BOOL</span>)flag&#123;</span><br><span class="line">    <span class="keyword">if</span> (![<span class="keyword">self</span>.audioPlayer isPlaying]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.audioPlayer play];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"录音完成!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">运行效果：</span><br><span class="line"><span class="built_in">AVAudioRecorder</span></span><br><span class="line">音频队列服务</span><br><span class="line">大家应该已经注意到了，无论是前面的录音还是音频播放均不支持网络流媒体播放，当然对于录音来说这种需求可能不大，但是对于音频播放来说有时候就很有必要了。<span class="built_in">AVAudioPlayer</span>只能播放本地文件，并且是一次性加载所以音频数据，初始化<span class="built_in">AVAudioPlayer</span>时指定的URL也只能是File URL而不能是HTTP URL。当然，将音频文件下载到本地然后再调用<span class="built_in">AVAudioPlayer</span>来播放也是一种播放网络音频的办法，但是这种方式最大的弊端就是必须等到整个音频播放完成才能播放，而不能使用流式播放，这往往在实际开发中是不切实际的。那么在iOS中如何播放网络流媒体呢？就是使用AudioToolbox框架中的音频队列服务Audio Queue Services。</span><br><span class="line">使用音频队列服务完全可以做到音频播放和录制，首先看一下录音音频服务队列：</span><br><span class="line">recording_architecture_2x</span><br><span class="line">一个音频服务队列Audio Queue有三部分组成：</span><br><span class="line">三个缓冲器Buffers:每个缓冲器都是一个存储音频数据的临时仓库。</span><br><span class="line">一个缓冲队列Buffer Queue:一个包含音频缓冲器的有序队列。</span><br><span class="line">一个回调Callback:一个自定义的队列回调函数。</span><br><span class="line">声音通过输入设备进入缓冲队列中，首先填充第一个缓冲器；当第一个缓冲器填充满之后自动填充下一个缓冲器，同时会调用回调函数；在回调函数中需要将缓冲器中的音频数据写入磁盘，同时将缓冲器放回到缓冲队列中以便重用。下面是Apple官方关于音频队列服务的流程示意图：</span><br><span class="line">recording_callback_function_2x</span><br><span class="line">类似的，看一下音频播放缓冲队列，其组成部分和录音缓冲队列类似。</span><br><span class="line">playback_architecture_2x</span><br><span class="line">但是在音频播放缓冲队列中，回调函数调用的时机不同于音频录制缓冲队列，流程刚好相反。将音频读取到缓冲器中，一旦一个缓冲器填充满之后就放到缓冲队列中，然后继续填充其他缓冲器；当开始播放时，则从第一个缓冲器中读取音频进行播放；一旦播放完之后就会触发回调函数，开始播放下一个缓冲器中的音频，同时填充第一个缓冲器放；填充满之后再次放回到缓冲队列。下面是详细的流程：</span><br><span class="line">playback_callback_function_2x</span><br><span class="line">当然，要明白音频队列服务的原理并不难，问题是如何实现这个自定义的回调函数，这其中我们有大量的工作要做，控制播放状态、处理异常中断、进行音频编码等等。由于牵扯内容过多，而且不是本文目的，如果以后有时间将另开一篇文章重点介绍，目前有很多第三方优秀框架可以直接使用，例如AudioStreamer、FreeStreamer。由于前者当前只有非ARC版本，所以下面不妨使用FreeStreamer来简单演示在线音频播放的过程，当然在使用之前要做如下准备工作：</span><br><span class="line"><span class="number">1.</span>拷贝FreeStreamer中的Reachability.h、Reachability.m和Common、astreamer两个文件夹中的内容到项目中。</span><br><span class="line"><span class="number">2.</span>添加FreeStreamer使用的类库：<span class="built_in">CFNetwork</span>.framework、AudioToolbox.framework、<span class="built_in">AVFoundation</span>.framework</span><br><span class="line">、libxml2.dylib、MediaPlayer.framework。</span><br><span class="line"><span class="number">3.</span>如果引用libxml2.dylib编译不通过，需要在Xcode的Targets-Build Settings-Header Build Path中添加$(SDKROOT)/usr/include/libxml2。</span><br><span class="line"><span class="number">4.</span>将FreeStreamer中的FreeStreamerMobile-Prefix.pch文件添加到项目中并将Targets-Build Settings-Precompile Prefix Header设置为<span class="literal">YES</span>，在Targets-Build Settings-Prefix Header设置为$(SRCROOT)/项目名称/FreeStreamerMobile-Prefix.pch（因为Xcode6默认没有pch文件）</span><br><span class="line">然后就可以编写代码播放网络音频了：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  AudioQueueServices</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/30.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//  使用FreeStreamer实现网络音频播放</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"FSAudioStream.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) FSAudioStream *audioStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span>.audioStream play];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得本地文件路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 文件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSURL</span> *)getFileUrl&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=[[<span class="built_in">NSBundle</span> mainBundle]pathForResource:<span class="string">@"刘若英 - 原来你也在这里.mp3"</span> ofType:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> fileURLWithPath:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="built_in">NSURL</span> *)getNetworkUrl&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=<span class="string">@"http://192.168.1.102/liu.mp3"</span>;</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  创建FSAudioStream对象</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return FSAudioStream对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(FSAudioStream *)audioStream&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_audioStream) &#123;</span><br><span class="line">        <span class="built_in">NSURL</span> *url=[<span class="keyword">self</span> getNetworkUrl];</span><br><span class="line">        <span class="comment">//创建FSAudioStream对象</span></span><br><span class="line">        _audioStream=[[FSAudioStream alloc]initWithUrl:url];</span><br><span class="line">        _audioStream.onFailure=^(FSAudioStreamError error,<span class="built_in">NSString</span> *description)&#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"播放过程中发生错误，错误信息：%@"</span>,description);</span><br><span class="line">        &#125;;</span><br><span class="line">        _audioStream.onCompletion=^()&#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"播放完成!"</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">        [_audioStream setVolume:<span class="number">0.5</span>];<span class="comment">//设置声音</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _audioStream;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">其实FreeStreamer的功能很强大，不仅仅是播放本地、网络音频那么简单，它还支持播放列表、检查包内容、RSS订阅、播放中断等很多强大的功能，甚至还包含了一个音频分析器，有兴趣的朋友可以访问官网查看详细用法</span><br><span class="line">视频</span><br><span class="line"><span class="built_in">MPMoviePlayerController</span></span><br><span class="line">在iOS中播放视频可以使用MediaPlayer.framework种的<span class="built_in">MPMoviePlayerController</span>类来完成，它支持本地视频和网络视频播放。这个类实现了<span class="built_in">MPMediaPlayback</span>协议，因此具备一般的播放器控制功能，例如播放、暂停、停止等。但是<span class="built_in">MPMediaPlayerController</span>自身并不是一个完整的视图控制器，如果要在UI中展示视频需要将view属性添加到界面中。下面列出了<span class="built_in">MPMoviePlayerController</span>的常用属性和方法：</span><br><span class="line">属性	说明</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSURL</span> *contentURL	播放媒体URL，这个URL可以是本地路径，也可以是网络路径</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">UIView</span> *view	播放器视图，如果要显示视频必须将此视图添加到控制器视图中</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">UIView</span> *backgroundView	播放器背景视图</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">MPMoviePlaybackState</span> playbackState	媒体播放状态，枚举类型：</span><br><span class="line"><span class="built_in">MPMoviePlaybackStateStopped</span>：停止播放</span><br><span class="line"><span class="built_in">MPMoviePlaybackStatePlaying</span>：正在播放</span><br><span class="line"><span class="built_in">MPMoviePlaybackStatePaused</span>：暂停</span><br><span class="line"><span class="built_in">MPMoviePlaybackStateInterrupted</span>：中断</span><br><span class="line"><span class="built_in">MPMoviePlaybackStateSeekingForward</span>：向前定位</span><br><span class="line"><span class="built_in">MPMoviePlaybackStateSeekingBackward</span>：向后定位</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">MPMovieLoadState</span> loadState	网络媒体加载状态，枚举类型：</span><br><span class="line"><span class="built_in">MPMovieLoadStateUnknown</span>：位置类型</span><br><span class="line"><span class="built_in">MPMovieLoadStatePlayable</span>：</span><br><span class="line"><span class="built_in">MPMovieLoadStatePlaythroughOK</span>：这种状态如果shouldAutoPlay为<span class="literal">YES</span>将自动播放</span><br><span class="line"><span class="built_in">MPMovieLoadStateStalled</span>：停滞状态</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">MPMovieControlStyle</span> controlStyle	控制面板风格，枚举类型：</span><br><span class="line"><span class="built_in">MPMovieControlStyleNone</span>：无控制面板 </span><br><span class="line"><span class="built_in">MPMovieControlStyleEmbedded</span>：嵌入视频风格 </span><br><span class="line"><span class="built_in">MPMovieControlStyleFullscreen</span>：全屏 </span><br><span class="line"><span class="built_in">MPMovieControlStyleDefault</span>：默认风格</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">MPMovieRepeatMode</span> repeatMode;	重复播放模式，枚举类型:</span><br><span class="line"><span class="built_in">MPMovieRepeatModeNone</span>:不重复，默认值</span><br><span class="line"><span class="built_in">MPMovieRepeatModeOne</span>:重复播放</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> shouldAutoplay	当网络媒体缓存到一定数据时是否自动播放，默认为<span class="literal">YES</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">getter</span>=isFullscreen) <span class="built_in">BOOL</span> fullscreen	是否全屏展示，默认为<span class="literal">NO</span>，注意如果要通过此属性设置全屏必须在视图显示完成后设置，否则无效</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">MPMovieScalingMode</span> scalingMode	视频缩放填充模式，枚举类型：</span><br><span class="line"><span class="built_in">MPMovieScalingModeNone</span>：不进行任何缩放</span><br><span class="line"><span class="built_in">MPMovieScalingModeAspectFit</span>：固定缩放比例并且尽量全部展示视频，不会裁切视频</span><br><span class="line"><span class="built_in">MPMovieScalingModeAspectFill</span>：固定缩放比例并填充满整个视图展示，可能会裁切视频</span><br><span class="line"><span class="built_in">MPMovieScalingModeFill</span>：不固定缩放比例压缩填充整个视图，视频不会被裁切但是比例失衡</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> readyForDisplay	是否有相关媒体被播放</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">MPMovieMediaTypeMask</span> movieMediaTypes	媒体类别，枚举类型：</span><br><span class="line"><span class="built_in">MPMovieMediaTypeMaskNone</span>：未知类型</span><br><span class="line"><span class="built_in">MPMovieMediaTypeMaskVideo</span>：视频</span><br><span class="line"><span class="built_in">MPMovieMediaTypeMaskAudio</span>：音频</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">MPMovieSourceType</span> movieSourceType	媒体源，枚举类型：</span><br><span class="line"><span class="built_in">MPMovieSourceTypeUnknown</span>：未知来源</span><br><span class="line"><span class="built_in">MPMovieSourceTypeFile</span>：本地文件</span><br><span class="line"><span class="built_in">MPMovieSourceTypeStreaming</span>：流媒体（直播或点播）</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">NSTimeInterval</span> duration	媒体时长，如果未知则返回<span class="number">0</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">NSTimeInterval</span> playableDuration	媒体可播放时长，主要用于表示网络媒体已下载视频时长</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">CGSize</span> naturalSize	视频实际尺寸，如果未知则返回<span class="built_in">CGSizeZero</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSTimeInterval</span> initialPlaybackTime	起始播放时间</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSTimeInterval</span> endPlaybackTime	终止播放时间</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> allowsAirPlay	是否允许无线播放，默认为<span class="literal">YES</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">getter</span>=isAirPlayVideoActive) <span class="built_in">BOOL</span> airPlayVideoActive	当前媒体是否正在通过AirPlay播放</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> isPreparedToPlay	是否准备好播放</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">NSTimeInterval</span> currentPlaybackTime	当前播放时间，单位：秒</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="keyword">float</span> currentPlaybackRate	当前播放速度，如果暂停则为<span class="number">0</span>，正常速度为<span class="number">1.0</span>，非<span class="number">0</span>数据表示倍率</span><br><span class="line">对象方法	说明</span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithContentURL:(<span class="built_in">NSURL</span> *)url	使用指定的URL初始化媒体播放控制器对象</span><br><span class="line">- (<span class="keyword">void</span>)setFullscreen:(<span class="built_in">BOOL</span>)fullscreen animated:(<span class="built_in">BOOL</span>)animated	设置视频全屏，注意如果要通过此方法设置全屏则必须在其视图显示之后设置，否则无效</span><br><span class="line">- (<span class="keyword">void</span>)requestThumbnailImagesAtTimes:(<span class="built_in">NSArray</span> *)playbackTimes timeOption:(<span class="built_in">MPMovieTimeOption</span>)option	获取在指定播放时间的视频缩略图，第一个参数是获取缩略图的时间点数组；第二个参数代表时间点精度，枚举类型：</span><br><span class="line"><span class="built_in">MPMovieTimeOptionNearestKeyFrame</span>：时间点附近</span><br><span class="line"><span class="built_in">MPMovieTimeOptionExact</span>：准确时间</span><br><span class="line">- (<span class="keyword">void</span>)cancelAllThumbnailImageRequests	取消所有缩略图获取请求</span><br><span class="line">- (<span class="keyword">void</span>)prepareToPlay	准备播放，加载视频数据到缓存，当调用play方法时如果没有准备好会自动调用此方法</span><br><span class="line">- (<span class="keyword">void</span>)play	开始播放</span><br><span class="line">- (<span class="keyword">void</span>)pause	暂停播放</span><br><span class="line">- (<span class="keyword">void</span>)stop	停止播放</span><br><span class="line">- (<span class="keyword">void</span>)beginSeekingForward	向前定位</span><br><span class="line">- (<span class="keyword">void</span>)beginSeekingBackward	向后定位</span><br><span class="line">- (<span class="keyword">void</span>)endSeeking	停止快进/快退</span><br><span class="line">通知	说明</span><br><span class="line"><span class="built_in">MPMoviePlayerScalingModeDidChangeNotification</span>	视频缩放填充模式发生改变</span><br><span class="line"><span class="built_in">MPMoviePlayerPlaybackDidFinishNotification</span>	媒体播放完成或用户手动退出，具体完成原因可以通过通知userInfo中的key为<span class="built_in">MPMoviePlayerPlaybackDidFinishReasonUserInfoKey</span>的对象获取</span><br><span class="line"><span class="built_in">MPMoviePlayerPlaybackStateDidChangeNotification</span>	播放状态改变，可配合playbakcState属性获取具体状态</span><br><span class="line"><span class="built_in">MPMoviePlayerLoadStateDidChangeNotification</span>	媒体网络加载状态改变</span><br><span class="line"><span class="built_in">MPMoviePlayerNowPlayingMovieDidChangeNotification</span>	当前播放的媒体内容发生改变</span><br><span class="line"><span class="built_in">MPMoviePlayerWillEnterFullscreenNotification</span>	将要进入全屏</span><br><span class="line"><span class="built_in">MPMoviePlayerDidEnterFullscreenNotification</span>	进入全屏后</span><br><span class="line"><span class="built_in">MPMoviePlayerWillExitFullscreenNotification</span>	将要退出全屏</span><br><span class="line"><span class="built_in">MPMoviePlayerDidExitFullscreenNotification</span>	退出全屏后</span><br><span class="line"><span class="built_in">MPMoviePlayerIsAirPlayVideoActiveDidChangeNotification</span>	当媒体开始通过AirPlay播放或者结束AirPlay播放</span><br><span class="line"><span class="built_in">MPMoviePlayerReadyForDisplayDidChangeNotification</span>	视频显示状态改变</span><br><span class="line"><span class="built_in">MPMovieMediaTypesAvailableNotification</span>	确定了媒体可用类型后</span><br><span class="line"><span class="built_in">MPMovieSourceTypeAvailableNotification</span>	确定了媒体来源后</span><br><span class="line"><span class="built_in">MPMovieDurationAvailableNotification</span>	确定了媒体播放时长后</span><br><span class="line"><span class="built_in">MPMovieNaturalSizeAvailableNotification</span>	确定了媒体的实际尺寸后</span><br><span class="line"><span class="built_in">MPMoviePlayerThumbnailImageRequestDidFinishNotification</span>	缩略图请求完成之后</span><br><span class="line"><span class="built_in">MPMediaPlaybackIsPreparedToPlayDidChangeNotification</span>	做好播放准备后</span><br><span class="line">注意<span class="built_in">MPMediaPlayerController</span>的状态等信息并不是通过代理来和外界交互的，而是通过通知中心，因此从上面的列表中可以看到常用的一些通知。由于<span class="built_in">MPMoviePlayerController</span>本身对于媒体播放做了深度的封装，使用起来就相当简单：创建<span class="built_in">MPMoviePlayerController</span>对象，设置frame属性，将<span class="built_in">MPMoviePlayerController</span>的view添加到控制器视图中。下面的示例中将创建一个播放控制器并添加播放状态改变及播放完成的通知：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  MPMoviePlayerController</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/30.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;MediaPlayer/MediaPlayer.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">MPMoviePlayerController</span> *moviePlayer;<span class="comment">//视频播放控制器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 控制器视图方法</span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//播放</span></span><br><span class="line">    [<span class="keyword">self</span>.moviePlayer play];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//添加通知</span></span><br><span class="line">    [<span class="keyword">self</span> addNotification];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)dealloc&#123;</span><br><span class="line">    <span class="comment">//移除所有通知监控</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得本地文件路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 文件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSURL</span> *)getFileUrl&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=[[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"The New Look of OS X Yosemite.mp4"</span> ofType:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> fileURLWithPath:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得网络文件路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 文件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSURL</span> *)getNetworkUrl&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=<span class="string">@"http://192.168.1.161/The New Look of OS X Yosemite.mp4"</span>;</span><br><span class="line">    urlStr=[urlStr stringByAddingPercentEscapesUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  创建媒体播放控制器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 媒体播放控制器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">MPMoviePlayerController</span> *)moviePlayer&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_moviePlayer) &#123;</span><br><span class="line">        <span class="built_in">NSURL</span> *url=[<span class="keyword">self</span> getNetworkUrl];</span><br><span class="line">        _moviePlayer=[[<span class="built_in">MPMoviePlayerController</span> alloc]initWithContentURL:url];</span><br><span class="line">        _moviePlayer.view.frame=<span class="keyword">self</span>.view.bounds;</span><br><span class="line">        _moviePlayer.view.autoresizingMask=<span class="built_in">UIViewAutoresizingFlexibleWidth</span>|<span class="built_in">UIViewAutoresizingFlexibleHeight</span>;</span><br><span class="line">        [<span class="keyword">self</span>.view addSubview:_moviePlayer.view];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _moviePlayer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  添加通知监控媒体播放控制器状态</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addNotification&#123;</span><br><span class="line">    <span class="built_in">NSNotificationCenter</span> *notificationCenter=[<span class="built_in">NSNotificationCenter</span> defaultCenter];</span><br><span class="line">    [notificationCenter addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(mediaPlayerPlaybackStateChange:) name:<span class="built_in">MPMoviePlayerPlaybackStateDidChangeNotification</span> object:<span class="keyword">self</span>.moviePlayer];</span><br><span class="line">    [notificationCenter addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(mediaPlayerPlaybackFinished:) name:<span class="built_in">MPMoviePlayerPlaybackDidFinishNotification</span> object:<span class="keyword">self</span>.moviePlayer];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放状态改变，注意播放完成时的状态是暂停</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param notification 通知对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)mediaPlayerPlaybackStateChange:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">self</span>.moviePlayer.playbackState) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMoviePlaybackStatePlaying</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"正在播放..."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMoviePlaybackStatePaused</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"暂停播放."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMoviePlaybackStateStopped</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"停止播放."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"播放状态:%li"</span>,<span class="keyword">self</span>.moviePlayer.playbackState);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放完成</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param notification 通知对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)mediaPlayerPlaybackFinished:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"播放完成.%li"</span>,<span class="keyword">self</span>.moviePlayer.playbackState);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">运行效果：</span><br><span class="line"><span class="built_in">MPMoviePlayerController</span></span><br><span class="line">从上面的API大家也不难看出其实<span class="built_in">MPMoviePlayerController</span>功能相当强大，日常开发中作为一般的媒体播放器也完全没有问题。<span class="built_in">MPMoviePlayerController</span>除了一般的视频播放和控制外还有一些强大的功能，例如截取视频缩略图。请求视频缩略图时只要调用- (<span class="keyword">void</span>)requestThumbnailImagesAtTimes:(<span class="built_in">NSArray</span> *)playbackTimes timeOption:(<span class="built_in">MPMovieTimeOption</span>)option方法指定获得缩略图的时间点，然后监控<span class="built_in">MPMoviePlayerThumbnailImageRequestDidFinishNotification</span>通知，每个时间点的缩略图请求完成就会调用通知，在通知调用方法中可以通过<span class="built_in">MPMoviePlayerThumbnailImageKey</span>获得<span class="built_in">UIImage</span>对象处理即可。例如下面的程序演示了在程序启动后获得两个时间点的缩略图的过程，截图成功后保存到相册：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  MPMoviePlayerController</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/30.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//  视频截图</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;MediaPlayer/MediaPlayer.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">MPMoviePlayerController</span> *moviePlayer;<span class="comment">//视频播放控制器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 控制器视图方法</span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//播放</span></span><br><span class="line">    [<span class="keyword">self</span>.moviePlayer play];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//添加通知</span></span><br><span class="line">    [<span class="keyword">self</span> addNotification];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//获取缩略图</span></span><br><span class="line">    [<span class="keyword">self</span> thumbnailImageRequest];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)dealloc&#123;</span><br><span class="line">    <span class="comment">//移除所有通知监控</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得本地文件路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 文件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSURL</span> *)getFileUrl&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=[[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"The New Look of OS X Yosemite.mp4"</span> ofType:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> fileURLWithPath:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得网络文件路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 文件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSURL</span> *)getNetworkUrl&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=<span class="string">@"http://192.168.1.161/The New Look of OS X Yosemite.mp4"</span>;</span><br><span class="line">    urlStr=[urlStr stringByAddingPercentEscapesUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  创建媒体播放控制器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 媒体播放控制器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">MPMoviePlayerController</span> *)moviePlayer&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_moviePlayer) &#123;</span><br><span class="line">        <span class="built_in">NSURL</span> *url=[<span class="keyword">self</span> getNetworkUrl];</span><br><span class="line">        _moviePlayer=[[<span class="built_in">MPMoviePlayerController</span> alloc]initWithContentURL:url];</span><br><span class="line">        _moviePlayer.view.frame=<span class="keyword">self</span>.view.bounds;</span><br><span class="line">        _moviePlayer.view.autoresizingMask=<span class="built_in">UIViewAutoresizingFlexibleWidth</span>|<span class="built_in">UIViewAutoresizingFlexibleHeight</span>;</span><br><span class="line">        [<span class="keyword">self</span>.view addSubview:_moviePlayer.view];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _moviePlayer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  获取视频缩略图</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)thumbnailImageRequest&#123;</span><br><span class="line">    <span class="comment">//获取13.0s、21.5s的缩略图</span></span><br><span class="line">    [<span class="keyword">self</span>.moviePlayer requestThumbnailImagesAtTimes:@[@<span class="number">13.0</span>,@<span class="number">21.5</span>] timeOption:<span class="built_in">MPMovieTimeOptionNearestKeyFrame</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 控制器通知</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  添加通知监控媒体播放控制器状态</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addNotification&#123;</span><br><span class="line">    <span class="built_in">NSNotificationCenter</span> *notificationCenter=[<span class="built_in">NSNotificationCenter</span> defaultCenter];</span><br><span class="line">    [notificationCenter addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(mediaPlayerPlaybackStateChange:) name:<span class="built_in">MPMoviePlayerPlaybackStateDidChangeNotification</span> object:<span class="keyword">self</span>.moviePlayer];</span><br><span class="line">    [notificationCenter addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(mediaPlayerPlaybackFinished:) name:<span class="built_in">MPMoviePlayerPlaybackDidFinishNotification</span> object:<span class="keyword">self</span>.moviePlayer];</span><br><span class="line">    [notificationCenter addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(mediaPlayerThumbnailRequestFinished:) name:<span class="built_in">MPMoviePlayerThumbnailImageRequestDidFinishNotification</span> object:<span class="keyword">self</span>.moviePlayer];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放状态改变，注意播放完成时的状态是暂停</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param notification 通知对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)mediaPlayerPlaybackStateChange:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">self</span>.moviePlayer.playbackState) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMoviePlaybackStatePlaying</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"正在播放..."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMoviePlaybackStatePaused</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"暂停播放."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMoviePlaybackStateStopped</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"停止播放."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"播放状态:%li"</span>,<span class="keyword">self</span>.moviePlayer.playbackState);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放完成</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param notification 通知对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)mediaPlayerPlaybackFinished:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"播放完成.%li"</span>,<span class="keyword">self</span>.moviePlayer.playbackState);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  缩略图请求完成,此方法每次截图成功都会调用一次</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param notification 通知对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)mediaPlayerThumbnailRequestFinished:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"视频截图完成."</span>);</span><br><span class="line">    <span class="built_in">UIImage</span> *image=notification.userInfo[<span class="built_in">MPMoviePlayerThumbnailImageKey</span>];</span><br><span class="line">    <span class="comment">//保存图片到相册(首次调用会请求用户获得访问相册权限)</span></span><br><span class="line">    <span class="built_in">UIImageWriteToSavedPhotosAlbum</span>(image, <span class="literal">nil</span>, <span class="literal">nil</span>, <span class="literal">nil</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">截图效果：</span><br><span class="line"><span class="built_in">MPMoviePlayerController_Thumbnail1</span>     <span class="built_in">MPMoviePlayerController_Thumbnail2</span></span><br><span class="line">扩展--使用<span class="built_in">AVFoundation</span>生成缩略图</span><br><span class="line">通过前面的方法大家应该已经看到，使用<span class="built_in">MPMoviePlayerController</span>来生成缩略图足够简单，但是如果仅仅是是为了生成缩略图而不进行视频播放的话，此刻使用<span class="built_in">MPMoviePlayerController</span>就有点大材小用了。其实使用<span class="built_in">AVFundation</span>框架中的<span class="built_in">AVAssetImageGenerator</span>就可以获取视频缩略图。使用<span class="built_in">AVAssetImageGenerator</span>获取缩略图大致分为三个步骤：</span><br><span class="line">创建<span class="built_in">AVURLAsset</span>对象（此类主要用于获取媒体信息，包括视频、声音等）。</span><br><span class="line">根据<span class="built_in">AVURLAsset</span>创建<span class="built_in">AVAssetImageGenerator</span>对象。</span><br><span class="line">使用<span class="built_in">AVAssetImageGenerator</span>的copyCGImageAtTime::方法获得指定时间点的截图。</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  AVAssetImageGenerator</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/30.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//获取第13.0s的缩略图</span></span><br><span class="line">    [<span class="keyword">self</span> thumbnailImageRequest:<span class="number">13.0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得本地文件路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 文件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSURL</span> *)getFileUrl&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=[[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"The New Look of OS X Yosemite.mp4"</span> ofType:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> fileURLWithPath:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得网络文件路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 文件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSURL</span> *)getNetworkUrl&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=<span class="string">@"http://192.168.1.161/The New Look of OS X Yosemite.mp4"</span>;</span><br><span class="line">    urlStr=[urlStr stringByAddingPercentEscapesUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  截取指定时间的视频缩略图</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param timeBySecond 时间点</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)thumbnailImageRequest:(<span class="built_in">CGFloat</span> )timeBySecond&#123;</span><br><span class="line">    <span class="comment">//创建URL</span></span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="keyword">self</span> getNetworkUrl];</span><br><span class="line">    <span class="comment">//根据url创建AVURLAsset</span></span><br><span class="line">    <span class="built_in">AVURLAsset</span> *urlAsset=[<span class="built_in">AVURLAsset</span> assetWithURL:url];</span><br><span class="line">    <span class="comment">//根据AVURLAsset创建AVAssetImageGenerator</span></span><br><span class="line">    <span class="built_in">AVAssetImageGenerator</span> *imageGenerator=[<span class="built_in">AVAssetImageGenerator</span> assetImageGeneratorWithAsset:urlAsset];</span><br><span class="line">    <span class="comment">/*截图</span></span><br><span class="line"><span class="comment">     * requestTime:缩略图创建时间</span></span><br><span class="line"><span class="comment">     * actualTime:缩略图实际生成的时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">NSError</span> *error=<span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">CMTime</span> time=<span class="built_in">CMTimeMakeWithSeconds</span>(timeBySecond, <span class="number">10</span>);<span class="comment">//CMTime是表示电影时间信息的结构体，第一个参数表示是视频第几秒，第二个参数表示每秒帧数.(如果要活的某一秒的第几帧可以使用CMTimeMake方法)</span></span><br><span class="line">    <span class="built_in">CMTime</span> actualTime;</span><br><span class="line">    <span class="built_in">CGImageRef</span> cgImage= [imageGenerator copyCGImageAtTime:time actualTime:&amp;actualTime error:&amp;error];</span><br><span class="line">    <span class="keyword">if</span>(error)&#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"截取视频缩略图时发生错误，错误信息：%@"</span>,error.localizedDescription);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">CMTimeShow</span>(actualTime);</span><br><span class="line">    <span class="built_in">UIImage</span> *image=[<span class="built_in">UIImage</span> imageWithCGImage:cgImage];<span class="comment">//转化为UIImage</span></span><br><span class="line">    <span class="comment">//保存到相册</span></span><br><span class="line">    <span class="built_in">UIImageWriteToSavedPhotosAlbum</span>(image,<span class="literal">nil</span>, <span class="literal">nil</span>, <span class="literal">nil</span>);</span><br><span class="line">    <span class="built_in">CGImageRelease</span>(cgImage);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">生成的缩略图效果：</span><br><span class="line"><span class="built_in">AVAssetImageGenerator_Thumbnail</span></span><br><span class="line"><span class="built_in">MPMoviePlayerViewController</span></span><br><span class="line">其实<span class="built_in">MPMoviePlayerController</span>如果不作为嵌入视频来播放（例如在新闻中嵌入一个视频），通常在播放时都是占满一个屏幕的，特别是在iPhone、iTouch上。因此从iOS3<span class="number">.2</span>以后苹果也在思考既然<span class="built_in">MPMoviePlayerController</span>在使用时通常都是将其视图view添加到另外一个视图控制器中作为子视图，那么何不直接创建一个控制器视图内部创建一个<span class="built_in">MPMoviePlayerController</span>属性并且默认全屏播放，开发者在开发的时候直接使用这个视图控制器。这个内部有一个<span class="built_in">MPMoviePlayerController</span>的视图控制器就是<span class="built_in">MPMoviePlayerViewController</span>，它继承于<span class="built_in">UIViewController</span>。<span class="built_in">MPMoviePlayerViewController</span>内部多了一个moviePlayer属性和一个带有url的初始化方法，同时它内部实现了一些作为模态视图展示所特有的功能，例如默认是全屏模式展示、弹出后自动播放、作为模态窗口展示时如果点击“Done”按钮会自动退出模态窗口等。在下面的示例中就不直接将播放器放到主视图控制器，而是放到一个模态视图控制器中，简单演示<span class="built_in">MPMoviePlayerViewController</span>的使用。</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  MPMoviePlayerViewController</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/30.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//  MPMoviePlayerViewController使用</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;MediaPlayer/MediaPlayer.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//播放器视图控制器</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">MPMoviePlayerViewController</span> *moviePlayerViewController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 控制器视图方法</span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)dealloc&#123;</span><br><span class="line">    <span class="comment">//移除所有通知监控</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得本地文件路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 文件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSURL</span> *)getFileUrl&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=[[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"The New Look of OS X Yosemite.mp4"</span> ofType:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> fileURLWithPath:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  取得网络文件路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 文件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSURL</span> *)getNetworkUrl&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=<span class="string">@"http://192.168.1.161/The New Look of OS X Yosemite.mp4"</span>;</span><br><span class="line">    urlStr=[urlStr stringByAddingPercentEscapesUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">MPMoviePlayerViewController</span> *)moviePlayerViewController&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_moviePlayerViewController) &#123;</span><br><span class="line">        <span class="built_in">NSURL</span> *url=[<span class="keyword">self</span> getNetworkUrl];</span><br><span class="line">        _moviePlayerViewController=[[<span class="built_in">MPMoviePlayerViewController</span> alloc]initWithContentURL:url];</span><br><span class="line">        [<span class="keyword">self</span> addNotification];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _moviePlayerViewController;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UI事件</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)playClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">self</span>.moviePlayerViewController=<span class="literal">nil</span>;<span class="comment">//保证每次点击都重新创建视频播放控制器视图，避免再次点击时由于不播放的问题</span></span><br><span class="line"><span class="comment">//    [self presentViewController:self.moviePlayerViewController animated:YES completion:nil];</span></span><br><span class="line">    <span class="comment">//注意，在MPMoviePlayerViewController.h中对UIViewController扩展两个用于模态展示和关闭MPMoviePlayerViewController的方法，增加了一种下拉展示动画效果</span></span><br><span class="line">    [<span class="keyword">self</span> presentMoviePlayerViewControllerAnimated:<span class="keyword">self</span>.moviePlayerViewController];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 控制器通知</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  添加通知监控媒体播放控制器状态</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addNotification&#123;</span><br><span class="line">    <span class="built_in">NSNotificationCenter</span> *notificationCenter=[<span class="built_in">NSNotificationCenter</span> defaultCenter];</span><br><span class="line">    [notificationCenter addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(mediaPlayerPlaybackStateChange:) name:<span class="built_in">MPMoviePlayerPlaybackStateDidChangeNotification</span> object:<span class="keyword">self</span>.moviePlayerViewController.moviePlayer];</span><br><span class="line">    [notificationCenter addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(mediaPlayerPlaybackFinished:) name:<span class="built_in">MPMoviePlayerPlaybackDidFinishNotification</span> object:<span class="keyword">self</span>.moviePlayerViewController.moviePlayer];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放状态改变，注意播放完成时的状态是暂停</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param notification 通知对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)mediaPlayerPlaybackStateChange:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">self</span>.moviePlayerViewController.moviePlayer.playbackState) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMoviePlaybackStatePlaying</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"正在播放..."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMoviePlaybackStatePaused</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"暂停播放."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">MPMoviePlaybackStateStopped</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"停止播放."</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"播放状态:%li"</span>,<span class="keyword">self</span>.moviePlayerViewController.moviePlayer.playbackState);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放完成</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param notification 通知对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)mediaPlayerPlaybackFinished:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"播放完成.%li"</span>,<span class="keyword">self</span>.moviePlayerViewController.moviePlayer.playbackState);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">运行效果：</span><br><span class="line"><span class="built_in">MPMoviePlayerViewController</span></span><br><span class="line">这里需要强调一下，由于<span class="built_in">MPMoviePlayerViewController</span>的初始化方法做了大量工作（例如设置URL、自动播放、添加点击Done完成的监控等），所以当再次点击播放弹出新的模态窗口的时如果不销毁之前的<span class="built_in">MPMoviePlayerViewController</span>，那么新的对象就无法完成初始化，这样也就不能再次进行播放。</span><br><span class="line"><span class="built_in">AVPlayer</span></span><br><span class="line"><span class="built_in">MPMoviePlayerController</span>足够强大，几乎不用写几行代码就能完成一个播放器，但是正是由于它的高度封装使得要自定义这个播放器变得很复杂，甚至是不可能完成。例如有些时候需要自定义播放器的样式，那么如果要使用<span class="built_in">MPMoviePlayerController</span>就不合适了，如果要对视频有自由的控制则可以使用<span class="built_in">AVPlayer</span>。<span class="built_in">AVPlayer</span>存在于<span class="built_in">AVFoundation</span>中，它更加接近于底层，所以灵活性也更强：</span><br><span class="line"><span class="built_in">AVFoundation_Framework</span></span><br><span class="line"><span class="built_in">AVPlayer</span>本身并不能显示视频，而且它也不像<span class="built_in">MPMoviePlayerController</span>有一个view属性。如果<span class="built_in">AVPlayer</span>要显示必须创建一个播放器层<span class="built_in">AVPlayerLayer</span>用于展示，播放器层继承于<span class="built_in">CALayer</span>，有了<span class="built_in">AVPlayerLayer</span>之添加到控制器视图的layer中即可。要使用<span class="built_in">AVPlayer</span>首先了解一下几个常用的类：</span><br><span class="line"><span class="built_in">AVAsset</span>：主要用于获取多媒体信息，是一个抽象类，不能直接使用。</span><br><span class="line"><span class="built_in">AVURLAsset</span>：<span class="built_in">AVAsset</span>的子类，可以根据一个URL路径创建一个包含媒体信息的<span class="built_in">AVURLAsset</span>对象。</span><br><span class="line"><span class="built_in">AVPlayerItem</span>：一个媒体资源管理对象，管理者视频的一些基本信息和状态，一个<span class="built_in">AVPlayerItem</span>对应着一个视频资源。</span><br><span class="line">下面简单通过一个播放器来演示<span class="built_in">AVPlayer</span>的使用，播放器的效果如下：</span><br><span class="line"><span class="built_in">AVPlayer_Thumbnail</span></span><br><span class="line">在这个自定义的播放器中实现了视频播放、暂停、进度展示和视频列表功能，下面将对这些功能一一介绍。</span><br><span class="line">首先说一下视频的播放、暂停功能，这也是最基本的功能，<span class="built_in">AVPlayer</span>对应着两个方法play、pause来实现。但是关键问题是如何判断当前视频是否在播放，在前面的内容中无论是音频播放器还是视频播放器都有对应的状态来判断，但是<span class="built_in">AVPlayer</span>却没有这样的状态属性，通常情况下可以通过判断播放器的播放速度来获得播放状态。如果rate为<span class="number">0</span>说明是停止状态，<span class="number">1</span>是则是正常播放状态。</span><br><span class="line">其次要展示播放进度就没有其他播放器那么简单了。在前面的播放器中通常是使用通知来获得播放器的状态，媒体加载状态等，但是无论是<span class="built_in">AVPlayer</span>还是<span class="built_in">AVPlayerItem</span>（<span class="built_in">AVPlayer</span>有一个属性currentItem是<span class="built_in">AVPlayerItem</span>类型，表示当前播放的视频对象）都无法获得这些信息。当然<span class="built_in">AVPlayerItem</span>是有通知的，但是对于获得播放状态和加载状态有用的通知只有一个：播放完成通知<span class="built_in">AVPlayerItemDidPlayToEndTimeNotification</span>。在播放视频时，特别是播放网络视频往往需要知道视频加载情况、缓冲情况、播放情况，这些信息可以通过KVO监控<span class="built_in">AVPlayerItem</span>的status、loadedTimeRanges属性来获得。当<span class="built_in">AVPlayerItem</span>的status属性为<span class="built_in">AVPlayerStatusReadyToPlay</span>是说明正在播放，只有处于这个状态时才能获得视频时长等信息；当loadedTimeRanges的改变时（每缓冲一部分数据就会更新此属性）可以获得本次缓冲加载的视频范围（包含起始时间、本次加载时长），这样一来就可以实时获得缓冲情况。然后就是依靠<span class="built_in">AVPlayer</span>的- (<span class="keyword">id</span>)addPeriodicTimeObserverForInterval:(<span class="built_in">CMTime</span>)interval queue:(<span class="built_in">dispatch_queue_t</span>)queue usingBlock:(<span class="keyword">void</span> (^)(<span class="built_in">CMTime</span> time))block方法获得播放进度，这个方法会在设定的时间间隔内定时更新播放进度，通过time参数通知客户端。相信有了这些视频信息播放进度就不成问题了，事实上通过这些信息就算是平时看到的其他播放器的缓冲进度显示以及拖动播放的功能也可以顺利的实现。</span><br><span class="line">最后就是视频切换的功能，在前面介绍的所有播放器中每个播放器对象一次只能播放一个视频，如果要切换视频只能重新创建一个对象，但是<span class="built_in">AVPlayer</span>却提供了- (<span class="keyword">void</span>)replaceCurrentItemWithPlayerItem:(<span class="built_in">AVPlayerItem</span> *)item方法用于在不同的视频之间切换（事实上在<span class="built_in">AVFoundation</span>内部还有一个<span class="built_in">AVQueuePlayer</span>专门处理播放列表切换，有兴趣的朋友可以自行研究，这里不再赘述）。</span><br><span class="line">下面附上代码：</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  AVPlayer</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/30.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 cmjstudio. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">AVPlayer</span> *player;<span class="comment">//播放器对象</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIView</span> *container; <span class="comment">//播放器容器</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIButton</span> *playOrPause; <span class="comment">//播放/暂停按钮</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIProgressView</span> *progress;<span class="comment">//播放进度</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 控制器视图方法</span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    [<span class="keyword">self</span> setupUI];</span><br><span class="line">    [<span class="keyword">self</span>.player play];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)dealloc&#123;</span><br><span class="line">    [<span class="keyword">self</span> removeObserverFromPlayerItem:<span class="keyword">self</span>.player.currentItem];</span><br><span class="line">    [<span class="keyword">self</span> removeNotification];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line">-(<span class="keyword">void</span>)setupUI&#123;</span><br><span class="line">    <span class="comment">//创建播放器层</span></span><br><span class="line">    <span class="built_in">AVPlayerLayer</span> *playerLayer=[<span class="built_in">AVPlayerLayer</span> playerLayerWithPlayer:<span class="keyword">self</span>.player];</span><br><span class="line">    playerLayer.frame=<span class="keyword">self</span>.container.frame;</span><br><span class="line">    <span class="comment">//playerLayer.videoGravity=AVLayerVideoGravityResizeAspect;//视频填充模式</span></span><br><span class="line">    [<span class="keyword">self</span>.container.layer addSublayer:playerLayer];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  截取指定时间的视频缩略图</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param timeBySecond 时间点</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  初始化播放器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 播放器对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">AVPlayer</span> *)player&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_player) &#123;</span><br><span class="line">        <span class="built_in">AVPlayerItem</span> *playerItem=[<span class="keyword">self</span> getPlayItem:<span class="number">0</span>];</span><br><span class="line">        _player=[<span class="built_in">AVPlayer</span> playerWithPlayerItem:playerItem];</span><br><span class="line">        [<span class="keyword">self</span> addProgressObserver];</span><br><span class="line">        [<span class="keyword">self</span> addObserverToPlayerItem:playerItem];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _player;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  根据视频索引取得AVPlayerItem对象</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param videoIndex 视频顺序索引</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return AVPlayerItem对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">AVPlayerItem</span> *)getPlayItem:(<span class="keyword">int</span>)videoIndex&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"http://192.168.1.161/%i.mp4"</span>,videoIndex];</span><br><span class="line">    urlStr =[urlStr stringByAddingPercentEscapesUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line">    <span class="built_in">AVPlayerItem</span> *playerItem=[<span class="built_in">AVPlayerItem</span> playerItemWithURL:url];</span><br><span class="line">    <span class="keyword">return</span> playerItem;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 通知</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  添加播放器通知</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addNotification&#123;</span><br><span class="line">    <span class="comment">//给AVPlayerItem添加播放完成通知</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(playbackFinished:) name:<span class="built_in">AVPlayerItemDidPlayToEndTimeNotification</span> object:<span class="keyword">self</span>.player.currentItem];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)removeNotification&#123;</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  播放完成通知</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param notification 通知对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)playbackFinished:(<span class="built_in">NSNotification</span> *)notification&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"视频播放完成."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 监控</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  给播放器添加进度更新</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addProgressObserver&#123;</span><br><span class="line">    <span class="built_in">AVPlayerItem</span> *playerItem=<span class="keyword">self</span>.player.currentItem;</span><br><span class="line">    <span class="built_in">UIProgressView</span> *progress=<span class="keyword">self</span>.progress;</span><br><span class="line">    <span class="comment">//这里设置每秒执行一次</span></span><br><span class="line">    [<span class="keyword">self</span>.player addPeriodicTimeObserverForInterval:<span class="built_in">CMTimeMake</span>(<span class="number">1.0</span>, <span class="number">1.0</span>) queue:dispatch_get_main_queue() usingBlock:^(<span class="built_in">CMTime</span> time) &#123;</span><br><span class="line">        <span class="keyword">float</span> current=<span class="built_in">CMTimeGetSeconds</span>(time);</span><br><span class="line">        <span class="keyword">float</span> total=<span class="built_in">CMTimeGetSeconds</span>([playerItem duration]);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"当前已经播放%.2fs."</span>,current);</span><br><span class="line">        <span class="keyword">if</span> (current) &#123;</span><br><span class="line">            [progress setProgress:(current/total) animated:<span class="literal">YES</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  给AVPlayerItem添加监控</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param playerItem AVPlayerItem对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addObserverToPlayerItem:(<span class="built_in">AVPlayerItem</span> *)playerItem&#123;</span><br><span class="line">    <span class="comment">//监控状态属性，注意AVPlayer也有一个status属性，通过监控它的status也可以获得播放状态</span></span><br><span class="line">    [playerItem addObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"status"</span> options:<span class="built_in">NSKeyValueObservingOptionNew</span> context:<span class="literal">nil</span>];</span><br><span class="line">    <span class="comment">//监控网络加载情况属性</span></span><br><span class="line">    [playerItem addObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"loadedTimeRanges"</span> options:<span class="built_in">NSKeyValueObservingOptionNew</span> context:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)removeObserverFromPlayerItem:(<span class="built_in">AVPlayerItem</span> *)playerItem&#123;</span><br><span class="line">    [playerItem removeObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"status"</span>];</span><br><span class="line">    [playerItem removeObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"loadedTimeRanges"</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  通过KVO监控播放器状态</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param keyPath 监控属性</span></span><br><span class="line"><span class="comment"> *  @param object  监视器</span></span><br><span class="line"><span class="comment"> *  @param change  状态改变</span></span><br><span class="line"><span class="comment"> *  @param context 上下文</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)observeValueForKeyPath:(<span class="built_in">NSString</span> *)keyPath ofObject:(<span class="keyword">id</span>)object change:(<span class="built_in">NSDictionary</span> *)change context:(<span class="keyword">void</span> *)context&#123;</span><br><span class="line">    <span class="built_in">AVPlayerItem</span> *playerItem=object;</span><br><span class="line">    <span class="keyword">if</span> ([keyPath isEqualToString:<span class="string">@"status"</span>]) &#123;</span><br><span class="line">        <span class="built_in">AVPlayerStatus</span> status= [[change objectForKey:<span class="string">@"new"</span>] intValue];</span><br><span class="line">        <span class="keyword">if</span>(status==<span class="built_in">AVPlayerStatusReadyToPlay</span>)&#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"正在播放...，视频总长度:%.2f"</span>,<span class="built_in">CMTimeGetSeconds</span>(playerItem.duration));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>([keyPath isEqualToString:<span class="string">@"loadedTimeRanges"</span>])&#123;</span><br><span class="line">        <span class="built_in">NSArray</span> *array=playerItem.loadedTimeRanges;</span><br><span class="line">        <span class="built_in">CMTimeRange</span> timeRange = [array.firstObject <span class="built_in">CMTimeRangeValue</span>];<span class="comment">//本次缓冲时间范围</span></span><br><span class="line">        <span class="keyword">float</span> startSeconds = <span class="built_in">CMTimeGetSeconds</span>(timeRange.start);</span><br><span class="line">        <span class="keyword">float</span> durationSeconds = <span class="built_in">CMTimeGetSeconds</span>(timeRange.duration);</span><br><span class="line">        <span class="built_in">NSTimeInterval</span> totalBuffer = startSeconds + durationSeconds;<span class="comment">//缓冲总长度</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"共缓冲：%.2f"</span>,totalBuffer);</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UI事件</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  点击播放/暂停按钮</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender 播放/暂停按钮</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)playClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line"><span class="comment">//    AVPlayerItemDidPlayToEndTimeNotification</span></span><br><span class="line">    <span class="comment">//AVPlayerItem *playerItem= self.player.currentItem;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">self</span>.player.rate==<span class="number">0</span>)&#123; <span class="comment">//说明时暂停</span></span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_pause"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">        [<span class="keyword">self</span>.player play];</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">self</span>.player.rate==<span class="number">1</span>)&#123;<span class="comment">//正在播放</span></span><br><span class="line">        [<span class="keyword">self</span>.player pause];</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_play"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  切换选集，这里使用按钮的tag代表视频名称</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender 点击按钮对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)navigationButtonClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span> removeNotification];</span><br><span class="line">    [<span class="keyword">self</span> removeObserverFromPlayerItem:<span class="keyword">self</span>.player.currentItem];</span><br><span class="line">    <span class="built_in">AVPlayerItem</span> *playerItem=[<span class="keyword">self</span> getPlayItem:sender.tag];</span><br><span class="line">    [<span class="keyword">self</span> addObserverToPlayerItem:playerItem];</span><br><span class="line">    <span class="comment">//切换视频</span></span><br><span class="line">    [<span class="keyword">self</span>.player replaceCurrentItemWithPlayerItem:playerItem];</span><br><span class="line">    [<span class="keyword">self</span> addNotification];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">运行效果：</span><br><span class="line"><span class="built_in">AVPlayer</span></span><br><span class="line">到目前为止无论是<span class="built_in">MPMoviePlayerController</span>还是<span class="built_in">AVPlayer</span>来播放视频都相当强大，但是它也存在着一些不可回避的问题，那就是支持的视频编码格式很有限：H<span class="number">.264</span>、<span class="built_in">MPEG</span><span class="number">-4</span>，扩展名（压缩格式）：.mp4、.mov、.m4v、.m2v、<span class="number">.3</span>gp、<span class="number">.3</span>g2等。但是无论是<span class="built_in">MPMoviePlayerController</span>还是<span class="built_in">AVPlayer</span>它们都支持绝大多数音频编码，所以大家如果纯粹是为了播放音乐的话也可以考虑使用这两个播放器。那么如何支持更多视频编码格式呢？目前来说主要还是依靠第三方框架，在iOS上常用的视频编码、解码框架有：VLC、ffmpeg， 具体使用方式今天就不再做详细介绍。</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[swift类型]]></title>
      <url>https://shirly-yan.github.io/2016/07/20/swift/swift%E7%B1%BB%E5%9E%8B/</url>
      <content type="html"><![CDATA[<p>swift类型<br><a id="more"></a></p>
<h2>int</h2>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Int</span>.<span class="built_in">max</span></span><br><span class="line"><span class="type">Int</span>.<span class="built_in">min</span></span><br><span class="line"><span class="type">UInt</span>.<span class="built_in">max</span></span><br><span class="line"><span class="type">UInt</span>.<span class="built_in">min</span></span><br><span class="line"><span class="type">Int8</span>.<span class="built_in">max</span></span><br><span class="line"><span class="type">Int8</span>.<span class="built_in">min</span></span><br><span class="line"><span class="type">UInt8</span>.<span class="built_in">max</span></span><br><span class="line"><span class="type">UInt8</span>.<span class="built_in">min</span></span><br><span class="line"><span class="type">Int16</span>.<span class="built_in">max</span></span><br><span class="line"><span class="type">Int16</span>.<span class="built_in">min</span></span><br><span class="line"><span class="type">UInt16</span>.<span class="built_in">max</span></span><br><span class="line"><span class="type">UInt16</span>.<span class="built_in">min</span></span><br><span class="line"><span class="type">Int32</span>.<span class="built_in">max</span></span><br><span class="line"><span class="type">Int32</span>.<span class="built_in">min</span></span><br><span class="line"><span class="type">UInt32</span>.<span class="built_in">max</span></span><br><span class="line"><span class="type">UInt32</span>.<span class="built_in">min</span></span><br><span class="line"><span class="type">Int64</span>.<span class="built_in">max</span></span><br><span class="line"><span class="type">Int64</span>.<span class="built_in">min</span></span><br><span class="line"><span class="type">UInt64</span>.<span class="built_in">max</span></span><br><span class="line"><span class="type">UInt64</span>.<span class="built_in">min</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> swift </category>
            
        </categories>
        
        
        <tags>
            
            <tag> swift </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[git]]></title>
      <url>https://shirly-yan.github.io/2016/06/01/system/git/</url>
      <content type="html"><![CDATA[<p>git<br><a id="more"></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">"Your Name"</span></span><br><span class="line">$ git config --global user.email your.email@example.com</span><br></pre></td></tr></table></figure>
<h3>初始化一个新仓库，init命令</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git init</span><br></pre></td></tr></table></figure><br><br><h3>把项目中的文件放到仓库中，add命令</h3><br>-A 旗标的意思是所有文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git add -A</span><br></pre></td></tr></table></figure><br><br><h3>查看暂存区中有哪些文件，status命令</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br></pre></td></tr></table></figure><br><br><h3>保存这些改动，commit命令</h3><br>-m 旗标的意思是为这次提交添加一个说明<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">"Initialize repository"</span></span><br></pre></td></tr></table></figure><br><br><h3>查看提交历史，log命令</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span></span><br></pre></td></tr></table></figure><br><br><h3>设置远程仓库地址</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git remote add origin git@bitbucket.org:&lt;username&gt;/hello_app.git</span><br></pre></td></tr></table></figure><br><br><h3>推送</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push -u origin --all</span><br></pre></td></tr></table></figure><br><br><h2>分支</h2><br><br><h3>列出所有本地分支</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch</span><br></pre></td></tr></table></figure><br><br><h3>命令先创建一个新分支，然后再切换到这个新分支</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b branch_name</span><br></pre></td></tr></table></figure><br><br><h3>提交现有文件中的全部改动</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git commit -a -m <span class="string">"Improve the README file"</span></span><br></pre></td></tr></table></figure><br><br><h3>删除分支: git branch -d branch_name</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -d modify-README</span><br></pre></td></tr></table></figure><br><br><h3>放弃主题分支中的改动: git branch -D branch_name</h3>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b topic-branch</span><br><span class="line">$ &lt;really screw up the branch&gt;</span><br><span class="line">$ git add -A</span><br><span class="line">$ git commit -a -m <span class="string">"Make major mistake"</span></span><br><span class="line">$ git checkout master</span><br><span class="line">$ git branch -D topic-branch</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> software </category>
            
        </categories>
        
        
        <tags>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ruby常用命令]]></title>
      <url>https://shirly-yan.github.io/2016/04/17/ruby/ruby%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      <content type="html"><![CDATA[<p>ruby常用命令<br><a id="more"></a></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ruby调试]]></title>
      <url>https://shirly-yan.github.io/2016/04/14/ruby/ruby%E8%B0%83%E8%AF%95/</url>
      <content type="html"><![CDATA[<p>ruby调试<br><a id="more"></a><br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">引入调试</span><br><span class="line">ruby -r debug filename </span><br><span class="line"></span><br><span class="line">下一行 </span><br><span class="line">n</span><br></pre></td></tr></table></figure></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ruby类]]></title>
      <url>https://shirly-yan.github.io/2016/04/11/ruby/ruby%E7%B1%BB/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p></p><h2>常用命令</h2><br>irb中引入ruby文件<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load <span class="string">'point.rb'</span></span><br></pre></td></tr></table></figure><p></p>
<p>获得一个对象的类<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p<span class="class">.<span class="keyword">class</span></span></span><br></pre></td></tr></table></figure></p>
<p>获得一个对象的所有方法<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.methods</span><br></pre></td></tr></table></figure></p>
<p>获得一个对象的所有方法,不显示从祖先继承的方法<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.methods(<span class="literal">false</span>)</span><br></pre></td></tr></table></figure></p>
<p>显示一个类的祖先<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Point.ancestors</span><br></pre></td></tr></table></figure></p>
<p></p><h2></h2><p></p>
<p></p><h3>创建类</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>默认执行的初始化方法,构造方法</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span></span></span><br><span class="line">    puts <span class="keyword">self</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>带参数的构造方法</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x, y)</span></span></span><br><span class="line">    @x, @y = x, y</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p><font color="#FF6666">方法有几个参数必须传入几个参数，除非设置了默认值的参数可以不传</font><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x, y=<span class="number">2</span>)</span></span></span><br><span class="line">    @x, @y = x, y</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x=<span class="number">0</span>, y=<span class="number">0</span>)</span></span></span><br><span class="line">    @x, @y = x, y</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p></p><h3>变量的类型</h3><p></p>
<p></p><h4>实例变量 instance variable</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@x</span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>类变量 class variable</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@@x</span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>全局变量 global variable</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$x</span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>局部变量 local variable</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>getter setter方法</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:x</span> <span class="comment"># getter setter</span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:y</span> <span class="comment"># getter</span></span><br><span class="line">  <span class="keyword">attr_writer</span> <span class="symbol">:x</span> <span class="comment">#setter</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="number">0</span>)</span></span></span><br><span class="line">    @x, @y, @z = x, y, z</span><br><span class="line">    puts x, y, z</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>符号方法</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:x</span>, <span class="symbol">:y</span>, <span class="symbol">:z</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="number">0</span>)</span></span></span><br><span class="line">    @x, @y, @z = x, y, z</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">+</span><span class="params">(p2)</span></span></span><br><span class="line">    Point.new(@x + p2.x, @y + p2.y, @z + p2.z)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>类方法</h3><p></p>
<p></p><h4>在方法前加 self.</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:x</span>, <span class="symbol">:y</span>, <span class="symbol">:z</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="number">0</span>)</span></span></span><br><span class="line">    @x, @y, @z = x, y, z</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">first_quadrant?</span><span class="params">(point)</span></span></span><br><span class="line">    point.class == Point &amp;&amp; point.x &gt; 0 &amp;&amp; point.y &gt; 0</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ActiveRecord(四)]]></title>
      <url>https://shirly-yan.github.io/2016/04/06/ruby/ActiveRecord(%E5%9B%9B)/</url>
      <content type="html"><![CDATA[<p>关联<br><a id="more"></a></p>
<p></p><h2>关联</h2><p></p>
<ul>
<li>belongs_to</li>
<li>has_one</li>
<li>has_many</li>
<li>has_and_belongs_to_many/habtm</li>
</ul>
<p></p><h2>belongs_to</h2><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> rails </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ActiveRecord(三)]]></title>
      <url>https://shirly-yan.github.io/2016/04/05/ruby/ActiveRecord(%E4%B8%89)/</url>
      <content type="html"><![CDATA[<p>查询<br><a id="more"></a></p>
<p></p><h2>从数据库中获取数据</h2><p></p>
<ul>
<li>find</li>
<li>first</li>
<li>take</li>
<li>last</li>
<li><p>find_each</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User.find_each(<span class="symbol">batch_size:</span> <span class="number">3</span>) <span class="keyword">do</span> <span class="params">|user|</span></span><br><span class="line">  puts user.id</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>find_in_batches</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User.find_in_batches(<span class="symbol">batch_size:</span> <span class="number">3</span>) <span class="keyword">do</span> <span class="params">|users|</span></span><br><span class="line">  puts users.count</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p></p><h2>条件查询</h2><p></p>
<p></p><h3>&gt;where</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">User.where(<span class="string">"name = 'mazi'"</span>)</span><br><span class="line"></span><br><span class="line">User.where(<span class="string">"name = 'mazi' AND id = 39"</span>)</span><br><span class="line"></span><br><span class="line">str = <span class="string">'maizi'</span></span><br><span class="line">User.where(<span class="string">"name = ?"</span>, str)</span><br><span class="line"></span><br><span class="line">User.where(<span class="string">"id &gt; 52"</span>)</span><br><span class="line"></span><br><span class="line">num = <span class="number">55</span></span><br><span class="line">User.where(<span class="string">"id &lt; ?"</span>, num)</span><br><span class="line"></span><br><span class="line">User.where(<span class="string">"id &lt; ? AND name = ?"</span>, num, str)</span><br><span class="line"></span><br><span class="line">User.where(<span class="symbol">:name</span> =&gt; <span class="string">'maizi'</span>, <span class="symbol">:id</span> =&gt; <span class="number">55</span>)</span><br><span class="line"></span><br><span class="line">User.where.<span class="keyword">not</span>(<span class="symbol">:name</span> =&gt; <span class="string">'maizi'</span>, <span class="symbol">:id</span> =&gt; <span class="number">55</span>)</span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>排序</h2><br>升序<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.where.<span class="keyword">not</span>(<span class="symbol">:name</span> =&gt; <span class="string">'maizi'</span>, <span class="symbol">:id</span> =&gt; <span class="number">55</span>).order(<span class="symbol">:created_at</span> =&gt; <span class="symbol">:ASC</span>)</span><br></pre></td></tr></table></figure><p></p>
<p>降序<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.where.<span class="keyword">not</span>(<span class="symbol">:name</span> =&gt; <span class="string">'maizi'</span>, <span class="symbol">:id</span> =&gt; <span class="number">55</span>).order(<span class="symbol">:created_at</span> =&gt; <span class="symbol">:DESC</span>)</span><br></pre></td></tr></table></figure></p>
<p></p><h2>查询指定字段</h2><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.where.<span class="keyword">not</span>(<span class="symbol">:name</span> =&gt; <span class="string">'maizi'</span>, <span class="symbol">:id</span> =&gt; <span class="number">55</span>).order(<span class="symbol">:created_at</span> =&gt; <span class="symbol">:DESC</span>).select(<span class="symbol">:name</span>)</span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>分页查询</h2><p></p>
<ul>
<li>limit</li>
<li>offset</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.where.<span class="keyword">not</span>(<span class="symbol">:name</span> =&gt; <span class="string">'maizi'</span>).order(<span class="symbol">:created_at</span> =&gt; <span class="symbol">:DESC</span>).select(<span class="symbol">:name</span>, <span class="symbol">:created_at</span>).limit(<span class="number">1</span>).offset(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">time = <span class="number">0</span></span><br><span class="line">User.where.<span class="keyword">not</span>(<span class="symbol">:name</span> =&gt; <span class="string">'maizi'</span>).order(<span class="symbol">:created_at</span> =&gt; <span class="symbol">:DESC</span>).select(<span class="symbol">:name</span>, <span class="symbol">:created_at</span>).limit(<span class="number">10</span>).offset(time)</span><br><span class="line"></span><br><span class="line">time = <span class="number">1</span></span><br><span class="line">User.where.<span class="keyword">not</span>(<span class="symbol">:name</span> =&gt; <span class="string">'maizi'</span>).order(<span class="symbol">:created_at</span> =&gt; <span class="symbol">:DESC</span>).select(<span class="symbol">:name</span>, <span class="symbol">:created_at</span>).limit(<span class="number">10</span>).offset(time)</span><br><span class="line"></span><br><span class="line">time = <span class="number">2</span></span><br><span class="line">User.where.<span class="keyword">not</span>(<span class="symbol">:name</span> =&gt; <span class="string">'maizi'</span>).order(<span class="symbol">:created_at</span> =&gt; <span class="symbol">:DESC</span>).select(<span class="symbol">:name</span>, <span class="symbol">:created_at</span>).limit(<span class="number">10</span>).offset(time)</span><br></pre></td></tr></table></figure>
<p></p><h2>分组查询</h2><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line">User.find_each <span class="keyword">do</span> <span class="params">|user|</span></span><br><span class="line">  <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span></span><br><span class="line">    user.gender = <span class="string">'女'</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    user.gender = <span class="string">'男'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  user.money = i+<span class="number">20</span></span><br><span class="line">  user.save</span><br><span class="line">  i += <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">result = User.select(<span class="string">"gender"</span>, <span class="string">"sum(money) as total_money"</span>).group(<span class="string">"gender"</span>)</span><br><span class="line"></span><br><span class="line">result.first</span><br><span class="line"></span><br><span class="line">result.first.total_money</span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">result = User.select(<span class="string">"gender"</span>, <span class="string">"sum(money) as total_money"</span>).group(<span class="string">"gender"</span>)</span><br><span class="line"></span><br><span class="line">result.first</span><br><span class="line"></span><br><span class="line">result.first.total_money</span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = User.select(<span class="string">"gender"</span>, <span class="string">"sum(money) as total_money"</span>).group(<span class="string">"gender"</span>).having(<span class="string">"sum(money) &gt; ?"</span>, <span class="number">120</span>)</span><br></pre></td></tr></table></figure>
<p></p><h2>条件覆盖</h2><p></p>
<ul>
<li>unscope</li>
<li>only</li>
<li>reorder</li>
<li>reverse_order</li>
<li>rewhere<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">User.select(<span class="string">"id"</span>, <span class="string">"created_at"</span>).limit(<span class="number">5</span>).unscope(<span class="symbol">:limit</span>)</span><br><span class="line"></span><br><span class="line">User.select(<span class="string">"id"</span>).limit(<span class="number">5</span>).offset(<span class="number">2</span>).only(<span class="symbol">:limit</span>, <span class="symbol">:offset</span>)</span><br><span class="line"></span><br><span class="line">User.select(<span class="string">"id"</span>).order(<span class="symbol">:id</span> =&gt; <span class="symbol">:DESC</span>)</span><br><span class="line"></span><br><span class="line">User.select(<span class="string">"id"</span>).order(<span class="symbol">:id</span> =&gt; <span class="symbol">:DESC</span>).reorder(<span class="symbol">:id</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">User.select(<span class="string">"id"</span>).order(<span class="symbol">:id</span> =&gt; <span class="symbol">:DESC</span>).reorder(<span class="symbol">:id</span>)</span><br><span class="line"></span><br><span class="line">User.select(<span class="string">"id"</span>).order(<span class="symbol">:id</span> =&gt; <span class="symbol">:DESC</span>).reverse_order</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p></p><h2>只读对象</h2><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.readonly.first</span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> rails </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ActiveRecord(二)]]></title>
      <url>https://shirly-yan.github.io/2016/04/04/ruby/ActiveRecord(%E4%BA%8C)/</url>
      <content type="html"><![CDATA[<p>ActiveRecord 回调<br><a id="more"></a></p>
<h2>回调</h2>

<h3>创建对象顺序</h3>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; ApplicationRecord</span></span><br><span class="line">  before_validation <span class="symbol">:beforeValidation</span></span><br><span class="line">  after_validation <span class="symbol">:afterValidation</span></span><br><span class="line">  before_save <span class="symbol">:beforeSave</span></span><br><span class="line">  before_create <span class="symbol">:beforeCreate</span></span><br><span class="line">  after_create <span class="symbol">:afterCreate</span></span><br><span class="line">  after_save <span class="symbol">:afterSave</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">beforeValidation</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">afterValidation</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">beforeSave</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">beforeCreate</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">afterCreate</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">afterSave</span></span></span><br><span class="line">    </span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3>更新对象顺序</h3>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; ApplicationRecord</span></span><br><span class="line">  before_validation <span class="symbol">:beforeValidation</span></span><br><span class="line">  after_validation <span class="symbol">:afterValidation</span></span><br><span class="line">  before_save <span class="symbol">:beforeSave</span></span><br><span class="line">  before_update <span class="symbol">:beforeUpdate</span></span><br><span class="line">  after_update <span class="symbol">:afterUpdate</span></span><br><span class="line">  after_save <span class="symbol">:afterSave</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">beforeValidation</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">afterValidation</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">beforeSave</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">beforeUpdate</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">afterUpdate</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">afterSave</span></span></span><br><span class="line">    </span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3>销毁对象顺序</h3>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; ApplicationRecord</span></span><br><span class="line">  before_destroy <span class="symbol">:beforeDestroy</span></span><br><span class="line">  after_destroy <span class="symbol">:afterDestroy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">beforeDestroy</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">afterDestroy</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> rails </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ActiveRecord(一)]]></title>
      <url>https://shirly-yan.github.io/2016/04/01/ruby/ActiveRecord(%E4%B8%80)/</url>
      <content type="html"><![CDATA[<p>ActiveRecord(一)<br><a id="more"></a></p>
<p><img src="/images/42.png" width="800" height="680"></p>
<h1>命名和模式约定</h1>

<p></p><h3>命名约定</h3><br><img src="/images/43.png" width="800" height="680"><p></p>
<p></p><h3>模式约定</h3><br><img src="/images/44.png" width="800" height="680"><p></p>
<p></p><h3>不使用约定</h3><br>指定表名<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.table_name</span><br></pre></td></tr></table></figure><p></p>
<p>指定主键<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.primary_key</span><br></pre></td></tr></table></figure></p>
<h1>基本操作</h1>

<p></p><h3>创建</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User.create(<span class="symbol">:name</span> =&gt; <span class="string">'xiaowang'</span>, <span class="symbol">:email</span> =&gt; <span class="string">'xiaowang@gmail.com'</span>)</span><br><span class="line"></span><br><span class="line">@user = User.new(<span class="symbol">:name</span> =&gt; <span class="string">'xiaowang'</span>, <span class="symbol">:email</span> =&gt; <span class="string">'xiaowang@gmail.com'</span>)</span><br><span class="line">@user.save</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>读取</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User.all</span><br><span class="line"></span><br><span class="line">User.find  <span class="comment">#（主键）</span></span><br><span class="line"></span><br><span class="line">User.find_by(<span class="symbol">:name</span> =&gt; <span class="string">'xiaowang'</span>) <span class="comment">#第一个符合条件的</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>更新</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@user.update(<span class="symbol">:name</span> =&gt; <span class="string">'xiaowang'</span>, <span class="symbol">:email</span> =&gt; <span class="string">'xiaowang@gmail.com'</span>)</span><br><span class="line"></span><br><span class="line">User.update_all(<span class="symbol">:name</span> =&gt; <span class="string">'nima'</span>)</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>删除</h3><br>删除一个数据<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@user.destroy</span><br></pre></td></tr></table></figure><p></p>
<p>删除表中所有数据<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.destroy_all</span><br></pre></td></tr></table></figure></p>
<h1>数据迁移</h1>

<p>迁移<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake <span class="symbol">db:</span>migrate</span><br></pre></td></tr></table></figure></p>
<p>回滚<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake <span class="symbol">db:</span>rollback</span><br></pre></td></tr></table></figure></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake <span class="symbol">db:</span>rollback STEP=<span class="number">2</span></span><br></pre></td></tr></table></figure>
<p></p><h2>单独创建迁移</h2><p></p>
<p></p><h3>Creatxxx</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g migration CreateWallets</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>AddxxxToyyy</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g migration AddLocationToUser <span class="symbol">location:</span>string</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>RemovexxxFromyyy</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g migration RemoveLocationFromUser <span class="symbol">location:</span>string</span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>change方法</h2><p></p>
<p></p><h3>table</h3><p></p>
<h4>create_table</h4>

<h4>rename_table</h4>

<h4>drop_table</h4>

<p></p><h3>join_table</h3><p></p>
<h4>create_join_table</h4>

<h4>drop_join_table</h4>

<p></p><h3>column</h3><p></p>
<h4>add_column</h4>

<h4>rename_column</h4>

<h4>remove_column</h4>

<p></p><h3>index</h3><p></p>
<h4>add_index</h4>

<h4>rename_index</h4>

<h4>remove_index</h4>

<p></p><h3>reference</h3><p></p>
<h4>add_reference</h4>

<h4>remove_reference</h4>

<p></p><h3>timestamps</h3><p></p>
<h4>add_timestamps</h4>

<h4>remove_timestamps</h4>

<p></p><h2>up和down方法</h2><p></p>
<p></p><h2>revert方法</h2><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">require_relative <span class="string">"20161202100202_create_uesrs"</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RevertCreateUsers</span> &lt; ActiveRecord::Migration</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">change</span></span></span><br><span class="line">    revert CreateUsers</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>种子数据</h2><br>db/seed.rb<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">15</span>.times <span class="keyword">do</span> <span class="params">|n|</span></span><br><span class="line">  User.create(<span class="symbol">:name</span> =&gt; <span class="string">'male_user_<span class="subst">#&#123;n&#125;</span>'</span>, <span class="symbol">:phone_number</span> =&gt; <span class="string">'13012312311'</span>, <span class="symbol">:gender</span> =&gt; <span class="string">'male'</span> )</span><br><span class="line">  User.create(<span class="symbol">:name</span> =&gt; <span class="string">'female_user_<span class="subst">#&#123;n&#125;</span>'</span>, <span class="symbol">:phone_number</span> =&gt; <span class="string">'13012312311'</span>, <span class="symbol">:gender</span> =&gt; <span class="string">'female'</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p>搭建数据库<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake <span class="symbol">db:</span>setup</span><br></pre></td></tr></table></figure></p>
<p>填充种子数据<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake <span class="symbol">db:</span>seed</span><br></pre></td></tr></table></figure></p>
<p>重建数据库<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake <span class="symbol">db:</span>reset</span><br></pre></td></tr></table></figure></p>
<p>设置环境<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RAILS_ENV=test</span><br></pre></td></tr></table></figure></p>
<p>导出数据库<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake <span class="symbol">db:</span><span class="symbol">schema:</span>load</span><br></pre></td></tr></table></figure></p>
<p></p><h2>数据验证</h2><p></p>
<p></p><h3>跳过数据验证</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@user.save(<span class="symbol">validate:</span><span class="literal">false</span>)</span><br></pre></td></tr></table></figure><p></p>
<p><img src="/images/45.png" width="800" height="763"></p>
<p></p><h3>是否合法</h3><br>valid？<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@user.valid？</span><br></pre></td></tr></table></figure><p></p>
<p>invalid？<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@user.invalid？</span><br></pre></td></tr></table></figure></p>
<p></p><h3>错误信息</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@user.errors.messages</span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@user.errors[<span class="symbol">:name</span>]</span><br></pre></td></tr></table></figure>
<p></p><h3>presence</h3><br>不为空<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; ApplicationRecord</span></span><br><span class="line"></span><br><span class="line">  validates <span class="symbol">:name</span>, <span class="symbol">presence:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>absence</h3><br>为空<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:name</span>, <span class="symbol">absence:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>length</h3><br>长度<p></p>
<ul>
<li>minimum</li>
<li>maximum</li>
<li>in</li>
<li>is<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:name</span>, <span class="symbol">length:</span> &#123;<span class="symbol">maximum:</span> <span class="number">3</span>&#125;</span><br><span class="line">validates <span class="symbol">:name</span>, <span class="symbol">length:</span> &#123;<span class="symbol">in:</span> <span class="number">3</span>..<span class="number">20</span>&#125;</span><br><span class="line">validates <span class="symbol">:name</span>, <span class="symbol">length:</span> &#123;<span class="symbol">is:</span> <span class="number">6</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p></p><h3>confirmation</h3><br>确认<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:password</span>, <span class="symbol">confirmation:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>inclusion/exclusion</h3><br>范围<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:province</span>, <span class="symbol">inclusion:</span> &#123;<span class="symbol">in:</span> [<span class="string">'北京'</span>, <span class="string">'上海'</span>]&#125;</span><br><span class="line">validates <span class="symbol">:age</span>, <span class="symbol">exclusion:</span> &#123;<span class="symbol">in:</span> <span class="number">0</span>..<span class="number">18</span>&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>format</h3><br>格式<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:phone_number</span>, <span class="symbol">format:</span> &#123;<span class="symbol">with:</span> /<span class="number">1</span>[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">10</span>&#125;\z/ &#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>uniqueness</h3><br>唯一<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:name</span>, <span class="symbol">uniqueness:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p></p>
<p>不区分大小写<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:name</span>, <span class="symbol">uniqueness:</span> &#123;<span class="symbol">case_sensitive:</span> <span class="literal">false</span>&#125;</span><br></pre></td></tr></table></figure></p>
<p></p><h3>常用验证选项</h3><p></p>
<ul>
<li>allow_nil</li>
<li>allow_blank</li>
<li>message</li>
<li>on<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:password</span>, <span class="symbol">confirmation:</span> <span class="literal">true</span></span><br><span class="line">validates <span class="symbol">:password</span>, <span class="symbol">:password_confirmation</span>, <span class="symbol">presence:</span> &#123;<span class="symbol">on:</span> <span class="symbol">:create</span>, <span class="symbol">message:</span> <span class="string">'密码和确认密码不能为空'</span>&#125;</span><br><span class="line">validates <span class="symbol">:password</span>, <span class="symbol">length:</span> &#123;<span class="symbol">minimum:</span> <span class="number">6</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> validates <span class="symbol">:name</span>, <span class="symbol">uniqueness:</span> &#123;<span class="symbol">allow_nil:</span> <span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p></p><h3>条件验证</h3><br>指定symbol<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:name</span>, <span class="symbol">uniqueness:</span> <span class="literal">true</span>, <span class="symbol">:if</span> =&gt; <span class="symbol">:test?</span></span><br><span class="line"> </span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">test?</span></span></span><br><span class="line">   <span class="literal">false</span></span><br><span class="line"> <span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p>指定字符串<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:phone_number</span>, <span class="symbol">uniqueness:</span> <span class="literal">true</span>, <span class="symbol">:if</span> =&gt; <span class="string">'name.nil'</span></span><br></pre></td></tr></table></figure></p>
<p>指定proc<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validates <span class="symbol">:phone_number</span>, <span class="symbol">uniqueness:</span> <span class="literal">true</span>, <span class="symbol">:if</span> =&gt; Proc.new &#123;name.<span class="literal">nil</span>?&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">with_options <span class="symbol">if:</span> <span class="symbol">:test?</span> <span class="keyword">do</span></span><br><span class="line">  validates <span class="symbol">:name</span>, <span class="symbol">uniqueness:</span> <span class="literal">true</span></span><br><span class="line">  validates <span class="symbol">:name</span>, <span class="symbol">uniqueness:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test?</span></span></span><br><span class="line">  (<span class="number">1</span>+<span class="number">1</span> == <span class="number">2</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>联合条件<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">with_options <span class="symbol">if:</span> <span class="symbol">:test?</span>, <span class="symbol">unless:</span> <span class="symbol">:test2?</span> <span class="keyword">do</span></span><br><span class="line">  validates <span class="symbol">:name</span>, <span class="symbol">uniqueness:</span> <span class="literal">true</span></span><br><span class="line">  validates <span class="symbol">:name</span>, <span class="symbol">uniqueness:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test?</span></span></span><br><span class="line">  (<span class="number">1</span>+<span class="number">1</span> == <span class="number">2</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test2?</span></span></span><br><span class="line">    (<span class="number">1</span>+<span class="number">1</span> == <span class="number">2</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<p></p><h3>自定义验证方法</h3><p></p>
<ul>
<li>validates_with</li>
<li>validates_each<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyValidator</span> &lt; ActiveModel::Validator</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">validate</span><span class="params">(record)</span></span></span><br><span class="line">    <span class="keyword">if</span> record.name.<span class="literal">nil</span>?</span><br><span class="line">      record.errors[<span class="symbol">:name</span>] &lt;&lt; <span class="string">'用户名不能为空'</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> record.phone_number.<span class="literal">nil</span>?</span><br><span class="line">      record.errors[<span class="symbol">:phone_number</span>] &lt;&lt; <span class="string">'手机号码不能为空'</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; ApplicationRecord</span></span><br><span class="line"></span><br><span class="line">  validates_with MyValidator</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; ApplicationRecord</span></span><br><span class="line"></span><br><span class="line">  validate <span class="symbol">:my_validator</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">my_validator</span></span></span><br><span class="line">    <span class="keyword">if</span> name.<span class="literal">nil</span>?</span><br><span class="line">      errors[<span class="symbol">:name</span>] &lt;&lt; <span class="string">'用户名不能为空'</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p></p><h3>验证错误</h3><p></p>
<ul>
<li>errors</li>
<li>errors[:attribute]</li>
<li>errors.add</li>
<li>errors.size</li>
</ul>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> rails </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ruby基本语法3]]></title>
      <url>https://shirly-yan.github.io/2016/03/17/ruby/ruby%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%953/</url>
      <content type="html"><![CDATA[<p>ruby基本语法3<br><a id="more"></a></p>
<h3>类的定义</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:x</span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:y</span></span><br><span class="line">  </span><br><span class="line">  @@origin = <span class="number">0</span></span><br><span class="line">  ORIGIN = <span class="number">2</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x = <span class="number">0</span>, y = <span class="number">0</span>)</span></span></span><br><span class="line">    @x, @y = x, y</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">another_method</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">first_quarant?</span></span></span><br><span class="line">    x &gt; <span class="number">0</span> &amp;&amp; y &gt; <span class="number">0</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">+</span><span class="params">(p2)</span></span></span><br><span class="line">    Point.new(x + p2.x, y + p2.y)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">second_quarant?</span><span class="params">(x, y)</span></span></span><br><span class="line">      x &lt; <span class="number">0</span> &amp;&amp; y &gt; <span class="number">0</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line">  <span class="class"><span class="keyword">class</span> &lt;&lt; self</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span></span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span></span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wat</span></span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br><br><h3>类的继承</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point3D</span> &lt; Point</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="number">0</span>)</span></span></span><br><span class="line">    @x, @y, @z = x, y, z</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="number">0</span>)</span></span></span><br><span class="line">    <span class="keyword">super</span>(x, y)</span><br><span class="line">    @z = z</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="number">0</span>)</span></span></span><br><span class="line">    <span class="keyword">super</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br><br><h3>模块</h3><br>+ include:mixin module instance methods as class’ instance methods<br>+ extend:mixin module instance methods as class’ class methods<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">Helper</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line">  <span class="keyword">include</span> Helper</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line">  extend Helper</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">Helper</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">shfit_right</span><span class="params">(x, y, z = <span class="number">0</span>)</span></span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">ClassMethods</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">distance</span><span class="params">(obj1, obj2)</span></span></span><br><span class="line">      Math.sqrt((obj1.x - obj2.x)**<span class="number">2</span> + (obj1.y - obj2.y)**<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">included</span><span class="params">(klass)</span></span></span><br><span class="line">    klass.extend ClassMethods</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">Lib</span></span></span><br><span class="line">  BUCKETS = [<span class="number">0</span>, <span class="number">1000</span>, <span class="number">10_000</span>, <span class="number">50_000</span>, <span class="number">100_000</span>]</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">annual_fee</span></span></span><br><span class="line">    <span class="keyword">case</span> balance</span><br><span class="line">      <span class="keyword">when</span> BUCKETS[<span class="number">0</span>]...BUCKETS[<span class="number">1</span>]</span><br><span class="line">        <span class="number">10</span></span><br><span class="line">      <span class="keyword">when</span> BUCKETS[<span class="number">1</span>]...BUCKETS[<span class="number">2</span>]</span><br><span class="line">        <span class="number">5</span></span><br><span class="line">      <span class="keyword">when</span> BUCKETS[<span class="number">2</span>]...BUCKETS[<span class="number">3</span>]</span><br><span class="line">        <span class="number">3</span></span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br><br><h3>exception</h3>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorial</span><span class="params">(n)</span></span></span><br><span class="line">  raise TypeError <span class="keyword">unless</span> n.is_a? Integer</span><br><span class="line">  raise ArgumentError <span class="keyword">if</span> n &lt; <span class="number">1</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span> <span class="keyword">if</span> n == <span class="number">1</span></span><br><span class="line">  n * factorial(n-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  x = factorial(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">rescue</span> ArgumentError =&gt; e</span><br><span class="line">  puts <span class="string">'try again with a value &gt;= 1'</span></span><br><span class="line"><span class="keyword">rescue</span> TypeError =&gt; e</span><br><span class="line">  puts <span class="string">'try again with an integer'</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  puts x</span><br><span class="line"><span class="keyword">ensure</span></span><br><span class="line">  puts <span class="string">'the process of factorial calculation is completed'</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ruby正则]]></title>
      <url>https://shirly-yan.github.io/2016/03/14/ruby/ruby%E6%AD%A3%E5%88%99/</url>
      <content type="html"><![CDATA[<p>ruby正则<br><a id="more"></a></p>
<p></p><h2>新建正则</h2><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = Regexp.new(<span class="string">'abcd'</span>) </span><br><span class="line">b = <span class="regexp">/abcd/</span></span><br><span class="line">c = <span class="regexp">%r&#123;abcd&#125;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>匹配正则</h2><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a =~ <span class="string">"abcdefg"</span></span><br><span class="line"></span><br><span class="line">a =~ <span class="string">"abcdefg"</span> <span class="comment">#0</span></span><br><span class="line">a.match <span class="string">"abcdefg"</span> <span class="comment">#&lt;MatchData "abcd"&gt;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>正则修饰符</h2><br>用于控制匹配结果的特殊字符<p></p>
<ul>
<li>i 忽略大小写</li>
<li>m 匹配多行</li>
<li>x 多行编辑+注释模式</li>
<li>u e s n 控制编码</li>
</ul>
<p><a href="http://regexr.com" target="_blank" rel="noopener">http://regexr.com</a></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
            <tag> rails </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ruby基本语法2]]></title>
      <url>https://shirly-yan.github.io/2016/03/13/ruby/ruby%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%952/</url>
      <content type="html"><![CDATA[<p>ruby基本语法2<br><a id="more"></a></p>
<p></p><h2>哈希</h2><br>哈希是一种类似字典的集合，集合中包含了唯一的键和键所对应的值<p></p>
<p></p><h3>新建哈希</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hsh = &#123;<span class="string">"a"</span> =&gt; <span class="number">10</span>, <span class="string">"b"</span> =&gt; <span class="number">6</span>&#125;</span><br><span class="line">hsh = &#123;<span class="symbol">a:</span><span class="number">10</span>, <span class="symbol">b:</span><span class="number">6</span>&#125;</span><br><span class="line">hsh = Hash.new</span><br><span class="line"></span><br><span class="line">hsh = Hash.new(<span class="number">0</span>)  <span class="comment">#设置默认值</span></span><br><span class="line">hsh[<span class="symbol">:key_not_exit</span>] <span class="comment">#0</span></span><br><span class="line">hsh.default        <span class="comment">#0</span></span><br><span class="line"></span><br><span class="line">hsh = Hash.new&#123;<span class="params">|hash, key|</span> hash[key] = <span class="string">"我是hash<span class="subst">#&#123;key&#125;</span>"</span>&#125;</span><br><span class="line">hsh[<span class="symbol">:key_not_exit</span>] <span class="comment">#我是hash key_not_exit</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>获取哈希信息</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">hsh = &#123;<span class="symbol">key1:</span><span class="number">1</span>, <span class="symbol">key2:</span><span class="number">2</span>&#125;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">#获取哈希的默认初始值</span></span><br><span class="line">hsh.default <span class="comment">#nil</span></span><br><span class="line"> <span class="comment">#判断哈希是否包含键值对</span></span><br><span class="line">hsh.empty?  <span class="comment">#false</span></span><br><span class="line"> <span class="comment">#判断哈希是否相等</span></span><br><span class="line">hsh.eql?(&#123;&#125;) <span class="comment">#false</span></span><br><span class="line"> <span class="comment">#获取哈希的键值对个数</span></span><br><span class="line">hsh.length <span class="comment">#2</span></span><br><span class="line"> <span class="comment">#获取哈希的键值对个数</span></span><br><span class="line">hsh.size   <span class="comment">#2</span></span><br><span class="line"> <span class="comment">#清除全部键值对</span></span><br><span class="line">hsh.clear  <span class="comment">#&#123;&#125;</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>访问哈希中的键值对</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">hsh = &#123;<span class="symbol">key1:</span><span class="number">1</span>, <span class="symbol">key2:</span><span class="number">2</span>&#125;</span><br><span class="line"></span><br><span class="line">hsh[<span class="symbol">:key1</span>]  <span class="comment">#1</span></span><br><span class="line">hsh[<span class="symbol">:key3</span>]  <span class="comment">#nil</span></span><br><span class="line">hsh.fetch(<span class="symbol">:key1</span>)  <span class="comment">#1</span></span><br><span class="line">hsh.fetch(<span class="symbol">:key_not_exit</span>)  <span class="comment">#raise key error</span></span><br><span class="line"> <span class="comment">#判断哈希中是否存在键值对</span></span><br><span class="line">hsh.has_key?(<span class="symbol">:key1</span>)   <span class="comment">#true</span></span><br><span class="line"> <span class="comment">#查询值所对应的键</span></span><br><span class="line">hsh.key(<span class="number">2</span>) <span class="comment">#:key2</span></span><br><span class="line"> <span class="comment">#查询所有的键</span></span><br><span class="line">hsh.keys <span class="comment">#[:key1,:key2]</span></span><br><span class="line"> <span class="comment">#查询所有的值</span></span><br><span class="line">hsh.values <span class="comment">#[1,2]</span></span><br><span class="line"></span><br><span class="line">hsh.assoc(<span class="symbol">:key1</span>) <span class="comment">#[:key1,1]</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>增加哈希中的键值对</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hsh = &#123;<span class="symbol">key1:</span><span class="number">1</span>, <span class="symbol">key2:</span><span class="number">2</span>&#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">#增加键值对</span></span><br><span class="line">hsh[<span class="symbol">:key3</span>] = <span class="number">3</span> <span class="comment">#3</span></span><br><span class="line">hsh.store(<span class="symbol">:key3</span>, <span class="number">3</span>) <span class="comment">#&#123;key1:1, key2:2, key3:3&#125;</span></span><br><span class="line"> <span class="comment">#合并2个哈希，后面的值会覆盖前面的值 merge不修改本身 merge!需改本身</span></span><br><span class="line">hsh.merge(&#123;<span class="symbol">key3:</span><span class="number">3</span>&#125;) <span class="comment">#&#123;key1:1, key2:2, key3:3&#125;</span></span><br><span class="line">hsh.update</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>删除哈希中的键值对</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hsh = &#123;<span class="symbol">key1:</span><span class="number">1</span>, <span class="symbol">key2:</span><span class="number">2</span>&#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">#删除对应的键值对</span></span><br><span class="line">hsh.delete(<span class="symbol">:key2</span>) <span class="comment">#2</span></span><br><span class="line"> <span class="comment">#删除满足条件的键值对</span></span><br><span class="line">hsh.delete_if&#123;<span class="params">|key, value|</span> value &gt; <span class="number">1</span>&#125; <span class="comment">#&#123;&#125;</span></span><br><span class="line"> <span class="comment">#保留满足条件的键值对</span></span><br><span class="line">hsh.keep_if</span><br><span class="line"> <span class="comment">#删除第一个键值对</span></span><br><span class="line">hsh.shift</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>遍历哈希中的键值对</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hsh = &#123;<span class="symbol">key1:</span><span class="number">1</span>, <span class="symbol">key2:</span><span class="number">2</span>&#125;</span><br><span class="line"></span><br><span class="line">hsh.each</span><br><span class="line">hsh.each_pair</span><br><span class="line">hsh.each_key</span><br><span class="line">hsh.each_value</span><br><span class="line">hsh.select</span><br><span class="line">hsh.reject</span><br><span class="line"></span><br><span class="line">hsh.each_key&#123;<span class="params">|key|</span> puts key&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h2>方法</h2><p></p>
<ul>
<li>方法名应该以小写字母或者下划线开头</li>
<li>方法名可以以？、！、或者=号结尾</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span> <span class="params">(arg1, arg2)</span></span></span><br><span class="line">  puts arg1, arg2</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span> <span class="params">(arg1 = <span class="string">"arg1"</span>, arg2 = <span class="string">"arg2"</span>)</span></span></span><br><span class="line">  puts arg1, arg2</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my_method           <span class="comment"># "arg1, arg2"</span></span><br><span class="line">my_method(<span class="string">"hi"</span>)          <span class="comment"># "hi, arg2"</span></span><br><span class="line">my_method(<span class="string">"hi"</span>, <span class="string">"world"</span>) <span class="comment"># "hi, world"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span> <span class="params">(arg1, *rest)</span></span></span><br><span class="line">  puts <span class="string">"arg1 = <span class="subst">#&#123;arg1&#125;</span>, rest = <span class="subst">#&#123;rest.inspect&#125;</span>"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span> <span class="params">(first, *, last)</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span> <span class="params">(params)</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my_method(<span class="symbol">:arg1</span> =&gt; <span class="string">"arg1"</span>, <span class="symbol">:arg2</span> =&gt; <span class="string">"arg2"</span>)</span><br><span class="line">my_method(&#123;<span class="symbol">:arg1</span> =&gt; <span class="string">"arg1"</span>, <span class="symbol">:arg2</span> =&gt; <span class="string">"arg2"</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span> <span class="params">(arg)</span></span></span><br><span class="line">  <span class="keyword">if</span> block_given?</span><br><span class="line">    <span class="keyword">yield</span>(arg)</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    puts <span class="string">"no block given"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span> <span class="params">(arg, &amp;block)</span></span></span><br><span class="line">  block.call(arg)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my_method(<span class="string">"hi"</span>)&#123;<span class="params">|a|</span> p a&#125;</span><br></pre></td></tr></table></figure>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ruby基本语法1]]></title>
      <url>https://shirly-yan.github.io/2016/03/11/ruby/ruby%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%951/</url>
      <content type="html"><![CDATA[<p>ruby基本语法1<br><a id="more"></a></p>
<p></p><h2>运行ruby的方式</h2><p></p>
<ul>
<li>交互式</li>
</ul>
<p>1、使用ruby命令<br>irb<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shirlydeMacBook-Pro:~ shirly$ irb</span><br><span class="line">2.3.0 :001 &gt; puts &quot;hello world&quot;</span><br><span class="line">hello world</span><br><span class="line"> =&gt; nil</span><br></pre></td></tr></table></figure></p>
<ul>
<li>编写程序文件</li>
</ul>
<p>1、将程序保存在文件中，使用ruby命令运行</p>
<p></p><h2>ruby文档系统</h2><br>RDoc:ruby文档生成工具,通过分析ruby的代码，为ruby的对象和方法生成结构化的页面<br>ri:命令行工具，方便的在控制台中查询API<p></p>
<p>生成本地文档网站<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ri --server</span><br></pre></td></tr></table></figure></p>
<p></p><h2>ruby常用命令</h2><p></p>
<ul>
<li><p>运行ruby文件 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby filename</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取对象id的方法 object_id</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2.3.0 :001 &gt; &quot;hello world&quot;.object_id</span><br><span class="line"> =&gt; 70123608252540</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p></p><h2>ruby面向对象</h2><p></p>
<ul>
<li>ruby中的一切都是对象（字符串，布尔值等都是对象）</li>
<li>每一个对象都有唯一的id（使用object_id方法获得）</li>
</ul>
<p></p><h3>定义类</h3><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span></span><br><span class="line">  <span class="comment">#其余代码</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>局部变量，实例变量，全局变量和类变量</h3><p></p>
<ul>
<li>局部变量必须以小写字母或者下划线开头</li>
<li>实例变量以@开头</li>
<li>类变量以@@开头</li>
<li>全局变量以$开头</li>
</ul>
<p></p><h3>类方法，实例方法</h3><p></p>
<ul>
<li>类方法 </li>
<li>实例方法</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#全局变量</span></span><br><span class="line">$prefix = <span class="string">"hello:"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span></span><br><span class="line">  <span class="comment">#类变量</span></span><br><span class="line">  @@count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(firstName, lastName)</span></span></span><br><span class="line">    <span class="comment">#实例变量</span></span><br><span class="line">    @firstName = firstName</span><br><span class="line">    @lastName = lastName</span><br><span class="line">    @@count = @@count + <span class="number">1</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#类方法</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">get_name_count</span></span></span><br><span class="line">    @@count</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#实例方法</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">lastName</span></span></span><br><span class="line">    @lastName</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">firstName</span></span></span><br><span class="line">    @firstName</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name_with_prefix</span></span></span><br><span class="line">    $prefix + fullName</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">fullName</span></span></span><br><span class="line">    <span class="comment">#局部变量</span></span><br><span class="line">    name = @firstName + <span class="string">" "</span> + @lastName</span><br><span class="line">    <span class="comment">#返回局部变量</span></span><br><span class="line">    name</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p></p><h2>ruby中的基本类型</h2><br>通常所说的基本类型是不可实例化的，可以直接初始化、赋值、运算，不可调用方法的类型<p></p>
<p></p><h3>符号 Symbol</h3><br>一个相同的符号有唯一确定的object_id<p></p>
<p>通过</p>
<ul>
<li>:name</li>
<li>:”string”</li>
<li>:to_sym<br>方法生成</li>
</ul>
<p></p><h3>布尔值 TrueClass FalseClass</h3><p></p>
<ul>
<li>与(&amp;) 全真为真</li>
<li>或(|) 一真为真</li>
<li>异或(^) 一样false不一样true</li>
</ul>
<p></p><h3>字符串</h3><br>输出字符串<p></p>
<ul>
<li>p</li>
<li>puts</li>
<li>print<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p <span class="string">"我是字符串"</span> <span class="comment">#我是字符串</span></span><br><span class="line">p <span class="string">"我是字符串"</span> * <span class="number">2</span> <span class="comment">#我是字符串我是字符串</span></span><br><span class="line">p <span class="string">"我是"</span> + <span class="string">"字符串"</span> <span class="comment">#我是字符串</span></span><br><span class="line"><span class="string">"a"</span>.ord <span class="comment">#97</span></span><br><span class="line"><span class="string">"a"</span> &lt; <span class="string">"b"</span> <span class="comment">#true</span></span><br><span class="line"><span class="string">"a"</span> =~ <span class="regexp">/a/</span> <span class="comment">#true</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p></p><h3>数字</h3><p></p>
<ul>
<li>Numeric 所有数字的父类</li>
<li>Fixnum  一个原生的机器字节(32位或64位)所能存储的最大的整形值</li>
<li>Bignum</li>
<li>Float</li>
<li>BigDeimal</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'bigdecimal'</span></span><br><span class="line"></span><br><span class="line">a = BigDecimal.new(<span class="string">"0.07"</span>)</span><br><span class="line">b = a * <span class="number">100</span></span><br><span class="line">b.to_i</span><br></pre></td></tr></table></figure>
<p></p><h4>迭代</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>.times &#123;</span><br><span class="line">  puts <span class="string">"hehe"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>.times &#123; </span><br><span class="line"><span class="params">|number|</span> </span><br><span class="line">puts number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>.upto(<span class="number">10</span>) &#123;</span><br><span class="line"><span class="params">|number|</span> </span><br><span class="line">puts <span class="string">"<span class="subst">#&#123;number&#125;</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>.downto(<span class="number">1</span>) &#123;</span><br><span class="line"><span class="params">|x|</span> </span><br><span class="line">puts x</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>.step(<span class="number">50</span>,<span class="number">5</span>)&#123;</span><br><span class="line">  <span class="params">|x|</span></span><br><span class="line">  puts x</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3>数组</h3><br>数组是有序的，基于整数索引的任意对象的集合<p></p>
<p></p><h4>索引</h4><p></p>
<ul>
<li>索引的起始为0</li>
<li>索引为负数时,从末尾开始查找，如索引为-1代表数组最后一个元素，索引为-2代表数组倒数第二个元素</li>
</ul>
<p></p><h4>创建数组</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">1</span>,<span class="string">"two"</span>,<span class="number">3.0</span>] <span class="comment">#[1,"two",3.0]</span></span><br><span class="line"></span><br><span class="line">arr = Array.new    <span class="comment">#[]</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>获取数组元素</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>] </span><br><span class="line"></span><br><span class="line"> <span class="comment">#获取某个元素</span></span><br><span class="line">arr[<span class="number">2</span>] <span class="comment">#3</span></span><br><span class="line">arr[<span class="number">100</span>] <span class="comment">#nil</span></span><br><span class="line">arr[-<span class="number">3</span>] <span class="comment">#4</span></span><br><span class="line">arr.at(<span class="number">0</span>) <span class="comment">#1</span></span><br><span class="line">arr.fetch(<span class="number">1</span>) <span class="comment">#2</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">#获取摸个范围的元素</span></span><br><span class="line">arr[<span class="number">2</span>,<span class="number">3</span>] <span class="comment">#[3,4,5]</span></span><br><span class="line">arr[<span class="number">1</span>..<span class="number">4</span>] <span class="comment">#[2,3,4,5]</span></span><br><span class="line">arr[<span class="number">1</span>..-<span class="number">3</span>] <span class="comment">#[2,3,4]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">#获取前n个元素</span></span><br><span class="line">arr.take(<span class="number">3</span>) <span class="comment">#[1,2,3] </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#排除前n个元素</span></span><br><span class="line">arr.drop(<span class="number">3</span>) <span class="comment">#[1,2,3]</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>获取数组信息</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>] </span><br><span class="line"></span><br><span class="line">arr.length  <span class="comment">#6</span></span><br><span class="line">arr.count   <span class="comment">#6</span></span><br><span class="line">arr.empty?  <span class="comment">#false</span></span><br><span class="line">arr.<span class="keyword">include</span>?(<span class="number">6</span>) <span class="comment">#true</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>修改数组</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"> <span class="comment">#插入元素</span></span><br><span class="line"> </span><br><span class="line"> <span class="comment">#在末尾插入元素</span></span><br><span class="line">arr.push(<span class="number">5</span>)    <span class="comment">#[1,2,3,4,5] </span></span><br><span class="line">arr&lt;&lt;<span class="number">6</span>         <span class="comment">#[1,2,3,4,5,6]</span></span><br><span class="line"> <span class="comment">#在开头插入元素</span></span><br><span class="line">arr.unshift(<span class="number">0</span>) <span class="comment">#[0,1,2,3,4,5]</span></span><br><span class="line"> <span class="comment">#在特定位置插入元素</span></span><br><span class="line">arr.insert(<span class="number">3</span>,<span class="string">'apple'</span>)  <span class="comment">#[0,1,2,'apple',3,4,5]</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">#删减元素</span></span><br><span class="line">arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>] </span><br><span class="line"></span><br><span class="line"> <span class="comment">#删除最后一个元素</span></span><br><span class="line">arr.pop     <span class="comment">#6 [1,2,3,4,5] </span></span><br><span class="line"> <span class="comment">#删除第一个元素</span></span><br><span class="line">arr.shift   <span class="comment">#1 [2,3,4,5] </span></span><br><span class="line"> <span class="comment">#删除特定位置元素</span></span><br><span class="line">arr.delete_at(<span class="number">2</span>)  <span class="comment">#4 [2,3,5] </span></span><br><span class="line"> <span class="comment">#删除特定元素</span></span><br><span class="line">arr.delete(<span class="number">2</span>)  <span class="comment">#2 [3,5] </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="literal">nil</span>]</span><br><span class="line"> <span class="comment">#删除重复元素</span></span><br><span class="line">arr.uniq  <span class="comment">#[1,2,3,nil]</span></span><br><span class="line"> <span class="comment">#删除空元素</span></span><br><span class="line">arr.compact <span class="comment">#[1,1,2,3,3,3]</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>遍历数组</h4><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>] </span><br><span class="line"></span><br><span class="line"> <span class="comment">#遍历</span></span><br><span class="line">arr.each</span><br><span class="line"> <span class="comment">#反向遍历</span></span><br><span class="line">arr.reverse_each</span><br><span class="line"> <span class="comment">#对数组元素做处理后返回完整的数组 不修改arr自己</span></span><br><span class="line">arr.map</span><br><span class="line"> <span class="comment">#选出特定的元素组成新的数组 不修改arr自己</span></span><br><span class="line">arr.select</span><br><span class="line"> <span class="comment">#剔除选择的元素后的数组 不修改arr自己</span></span><br><span class="line">arr.reject</span><br><span class="line"> <span class="comment">#抛弃满足条件的元素前面的元素 不修改arr自己</span></span><br><span class="line">arr.drop_while</span><br><span class="line"> <span class="comment">#删除满足条件的元素 修改arr自己</span></span><br><span class="line">arr.delete_if</span><br><span class="line"> <span class="comment">#保留满足条件的元素 修改arr自己</span></span><br><span class="line">arr.keep_if</span><br></pre></td></tr></table></figure><p></p>
<!--<img src="/images/6.png" width="800" height="263" />-->
<!--<font color=#FF6666></font>-->
]]></content>
      
        <categories>
            
            <category> ruby </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ruby </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS之 CoreMotion 框架]]></title>
      <url>https://shirly-yan.github.io/2015/10/08/oc/iOS%E4%B9%8B%20CoreMotion%20%E6%A1%86%E6%9E%B6/</url>
      <content type="html"><![CDATA[<p> 在项目中经常会使用到重力加速度，陀螺仪，最近在一个项目中使用到了CoreMotion 框架，需求是：上下摇摆手机控制智能椅子的角度调节，该项目是使用蓝牙4.0进行通讯的，在iOS内已经封装好了CoreBluetooth 框架，不过需要iPHone4s 以上的手机，和iPadmin以上的平板电脑才有蓝牙4.0.今天在这里先记录一下CoreMotion 框架的使用.<br><a id="more"></a></p>
<p>主要的类：CMMotionManager , NSOperationQueue.<br>下面是一个被我封装过的一个类。<br>项目需要导入CoreMotion.Framework<br>在.h 文件需要#import &lt;CoreMotion/CoreMotion.h&gt;.h文件代码:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;CoreMotion/CoreMotion.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> _MotionDirection &#123;UNKNOWDIRECTION=<span class="number">0</span>,UP,DOWN&#125;MotionDirection;</span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">iCtrlCMManager</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">retain</span>) <span class="built_in">CMMotionManager</span> * ictrlCMManager;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) MotionDirection motionDirection;</span><br><span class="line">+(<span class="keyword">id</span>)sharedInstance;</span><br><span class="line">-(<span class="keyword">void</span>)startMotion;</span><br><span class="line">-(<span class="keyword">void</span>)stopMotion;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">.m文件代码:</span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"iCtrlCMManager.h"</span></span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">iCtrlCMManager</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark -</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark life cycle</span></span><br><span class="line">+(<span class="keyword">id</span>)sharedInstance</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> iCtrlCMManager *<span class="keyword">this</span> = <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">this</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span> = [[iCtrlCMManager alloc] init];</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">-(<span class="keyword">id</span>)init</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">self</span>)</span><br><span class="line">    &#123;</span><br><span class="line"> </span><br><span class="line">        _ictrlCMManager = [[<span class="built_in">CMMotionManager</span> alloc] init];</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">-(<span class="keyword">void</span>)dealloc</span><br><span class="line">&#123;</span><br><span class="line">    [_ictrlCMManager release];</span><br><span class="line">    [<span class="keyword">super</span> dealloc];</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark instance methods</span></span><br><span class="line">-(<span class="keyword">void</span>)startMotion</span><br><span class="line">&#123;</span><br><span class="line">    _motionDirection = UNKNOWDIRECTION;</span><br><span class="line">    <span class="keyword">if</span>(_ictrlCMManager.accelerometerAvailable)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSOperationQueue</span> *queue = [[[<span class="built_in">NSOperationQueue</span> alloc] init] autorelease];</span><br><span class="line">        _ictrlCMManager.accelerometerUpdateInterval = <span class="number">1.0</span>/<span class="number">60.0</span>;</span><br><span class="line"> </span><br><span class="line">        __block <span class="keyword">float</span> y = <span class="number">0.0</span>;</span><br><span class="line">        __block <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        [_ictrlCMManager startAccelerometerUpdatesToQueue:queue withHandler:^(<span class="built_in">CMAccelerometerData</span> *accelerometerData, <span class="built_in">NSError</span> *error) &#123;</span><br><span class="line">            <span class="keyword">if</span> (error)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"CoreMotion Error : %@"</span>,error);</span><br><span class="line">                [_ictrlCMManager stopAccelerometerUpdates];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                y = accelerometerData.acceleration.y;</span><br><span class="line">                 </span><br><span class="line">            &#125;</span><br><span class="line">             </span><br><span class="line">             </span><br><span class="line">            i++;</span><br><span class="line">            <span class="keyword">if</span>(fabs(y - accelerometerData.acceleration.y) &gt; <span class="number">0.4</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                </span><br><span class="line">  </span><br><span class="line">                <span class="keyword">if</span>(y &gt; accelerometerData.acceleration.y)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">NSLog</span>(<span class="string">@"UP"</span>);</span><br><span class="line">                    _motionDirection = UP;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">NSLog</span>(<span class="string">@"Down"</span>);</span><br><span class="line">                    _motionDirection = DOWN;</span><br><span class="line">                &#125;</span><br><span class="line">                 </span><br><span class="line">                y = accelerometerData.acceleration.y;</span><br><span class="line">        </span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">             </span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"The accelerometer is unavailable"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">-(<span class="keyword">void</span>)stopMotion</span><br><span class="line">&#123;</span><br><span class="line">    _motionDirection = UNKNOWDIRECTION;</span><br><span class="line">    [_ictrlCMManager stopAccelerometerUpdates];</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[推送通知]]></title>
      <url>https://shirly-yan.github.io/2015/09/08/oc/%E6%8E%A8%E9%80%81%E9%80%9A%E7%9F%A5/</url>
      <content type="html"><![CDATA[<a id="more"></a>
<p>和本地通知不同，推送通知是由应用服务提供商发起的，通过苹果的APNs（Apple Push Notification Server）发送到应用客户端。下面是苹果官方关于推送通知的过程示意图：</p>
<p>推送通知的过程可以分为以下几步：</p>
<p>应用服务提供商从服务器端把要发送的消息和设备令牌（device token）发送给苹果的消息推送服务器APNs。<br>APNs根据设备令牌在已注册的设备（iPhone、iPad、iTouch、mac等）查找对应的设备，将消息发送给相应的设备。<br>客户端设备接将接收到的消息传递给相应的应用程序，应用程序根据用户设置弹出通知消息。<br>当然，这只是一个简单的流程，有了这个流程我们还无从下手编写程序，将上面的流程细化可以得到如下流程图（图片来自互联网），在这个过程中会也会提到如何在程序中完成这些步骤：</p>
<p>1.应用程序注册APNs推送消息。</p>
<p>说明：</p>
<p>a.只有注册过的应用才有可能接收到消息，程序中通常通过UIApplication的registerUserNotificationSettings:方法注册，iOS8中通知注册的方法发生了改变，如果是iOS7及之前版本的iOS请参考其他代码。</p>
<p>b.注册之前有两个前提条件必须准备好：开发配置文件（provisioning profile，也就是.mobileprovision后缀的文件）的App ID不能使用通配ID必须使用指定APP ID并且生成配置文件中选择Push Notifications服务，一般的开发配置文件无法完成注册；应用程序的Bundle Identifier必须和生成配置文件使用的APP ID完全一致。</p>
<p>2.iOS从APNs接收device token，在应用程序获取device token。</p>
<p>说明：</p>
<p>a.在UIApplication的-(void)application:(UIApplication <em>)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData </em>)deviceToken代理方法中获取令牌，此方法发生在注册之后。</p>
<p>b.如果无法正确获得device token可以在UIApplication的-(void)application:(UIApplication <em>)application didFailToRegisterForRemoteNotificationsWithError:(NSError </em>)error代理方法中查看详细错误信息，此方法发生在获取device token失败之后。</p>
<p>c.必须真机调试，模拟器无法获取device token。</p>
<p>3.iOS应用将device token发送给应用程序提供商，告诉服务器端当前设备允许接收消息。</p>
<p>说明：</p>
<p>a.device token的生成算法只有Apple掌握，为了确保算法发生变化后仍然能够正常接收服务器端发送的通知，每次应用程序启动都重新获得device token（注意：device token的获取不会造成性能问题，苹果官方已经做过优化）。</p>
<p>b.通常可以创建一个网络连接发送给应用程序提供商的服务器端， 在这个过程中最好将上一次获得的device token存储起来，避免重复发送，一旦发现device token发生了变化最好将原有的device token一块发送给服务器端，服务器端删除原有令牌存储新令牌避免服务器端发送无效消息。</p>
<p>4.应用程序提供商在服务器端根据前面发送过来的device token组织信息发送给APNs。</p>
<p>说明：</p>
<p>a.发送时指定device token和消息内容，并且完全按照苹果官方的消息格式组织消息内容，通常情况下可以借助其他第三方消息推送框架来完成。</p>
<p>5.APNs根据消息中的device token查找已注册的设备推送消息。</p>
<p>说明：</p>
<p>a.正常情况下可以根据device token将消息成功推送到客户端设备中，但是也不排除用户卸载程序的情况，此时推送消息失败，APNs会将这个错误消息通知服务器端以避免资源浪费（服 务器端此时可以根据错误删除已经存储的device token，下次不再发送）。</p>
<p>下面将简单演示一下推送通知的简单流程:</p>
<p>首先，看一下iOS客户端代码：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  AppDelegate.m</span></span><br><span class="line"><span class="comment">//  pushnotification</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Kenshin Cui on 14/03/27.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 Kenshin Cui. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"AppDelegate.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"KCMainViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AppDelegate</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AppDelegate</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 应用程序代理方法</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 应用程序启动之后</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions &#123;</span><br><span class="line">    </span><br><span class="line">    _window=[[<span class="built_in">UIWindow</span> alloc]initWithFrame:[<span class="built_in">UIScreen</span> mainScreen].bounds];</span><br><span class="line">    </span><br><span class="line">    _window.backgroundColor =[<span class="built_in">UIColor</span> colorWithRed:<span class="number">249</span>/<span class="number">255.0</span> green:<span class="number">249</span>/<span class="number">255.0</span> blue:<span class="number">249</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置全局导航条风格和颜色</span></span><br><span class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setBarTintColor:[<span class="built_in">UIColor</span> colorWithRed:<span class="number">23</span>/<span class="number">255.0</span> green:<span class="number">180</span>/<span class="number">255.0</span> blue:<span class="number">237</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>]];</span><br><span class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setBarStyle:<span class="built_in">UIBarStyleBlack</span>];</span><br><span class="line">    </span><br><span class="line">    KCMainViewController *mainController=[[KCMainViewController alloc]init];</span><br><span class="line">    _window.rootViewController=mainController;</span><br><span class="line">    </span><br><span class="line">    [_window makeKeyAndVisible];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//注册推送通知（注意iOS8注册方法发生了变化）</span></span><br><span class="line">    [application registerUserNotificationSettings:[<span class="built_in">UIUserNotificationSettings</span> settingsForTypes:<span class="built_in">UIUserNotificationTypeAlert</span>|<span class="built_in">UIUserNotificationTypeBadge</span>|<span class="built_in">UIUserNotificationTypeSound</span> categories:<span class="literal">nil</span>]];</span><br><span class="line">    [application registerForRemoteNotifications];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 注册推送通知之后</span></span><br><span class="line"><span class="comment">//在此接收设备令牌</span></span><br><span class="line">-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didRegisterForRemoteNotificationsWithDeviceToken:(<span class="built_in">NSData</span> *)deviceToken&#123;</span><br><span class="line">    [<span class="keyword">self</span> addDeviceToken:deviceToken];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"device token:%@"</span>,deviceToken);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 获取device token失败后</span></span><br><span class="line">-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didFailToRegisterForRemoteNotificationsWithError:(<span class="built_in">NSError</span> *)error&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"didFailToRegisterForRemoteNotificationsWithError:%@"</span>,error.localizedDescription);</span><br><span class="line">    [<span class="keyword">self</span> addDeviceToken:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark 接收到推送通知之后</span></span><br><span class="line">-(<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didReceiveRemoteNotification:(<span class="built_in">NSDictionary</span> *)userInfo&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"receiveRemoteNotification,userInfo is %@"</span>,userInfo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - 私有方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  添加设备令牌到服务器端</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param deviceToken 设备令牌</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">void</span>)addDeviceToken:(<span class="built_in">NSData</span> *)deviceToken&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *key=<span class="string">@"DeviceToken"</span>;</span><br><span class="line">    <span class="built_in">NSData</span> *oldToken= [[<span class="built_in">NSUserDefaults</span> standardUserDefaults]objectForKey:key];</span><br><span class="line">    <span class="comment">//如果偏好设置中的已存储设备令牌和新获取的令牌不同则存储新令牌并且发送给服务器端</span></span><br><span class="line">    <span class="keyword">if</span> (![oldToken isEqualToData:deviceToken]) &#123;</span><br><span class="line">        [[<span class="built_in">NSUserDefaults</span> standardUserDefaults] setObject:deviceToken forKey:key];</span><br><span class="line">        [<span class="keyword">self</span> sendDeviceTokenWidthOldDeviceToken:oldToken newDeviceToken:deviceToken];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)sendDeviceTokenWidthOldDeviceToken:(<span class="built_in">NSData</span> *)oldToken newDeviceToken:(<span class="built_in">NSData</span> *)newToken&#123;</span><br><span class="line">    <span class="comment">//注意一定确保真机可以正常访问下面的地址</span></span><br><span class="line">    <span class="built_in">NSString</span> *urlStr=<span class="string">@"http://192.168.1.101/RegisterDeviceToken.aspx"</span>;</span><br><span class="line">    urlStr=[urlStr stringByAddingPercentEscapesUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSURL</span> *url=[<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line">    <span class="built_in">NSMutableURLRequest</span> *requestM=[<span class="built_in">NSMutableURLRequest</span> requestWithURL:url cachePolicy:<span class="number">0</span> timeoutInterval:<span class="number">10.0</span>];</span><br><span class="line">    [requestM setHTTPMethod:<span class="string">@"POST"</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *bodyStr=[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"oldToken=%@&amp;newToken=%@"</span>,oldToken,newToken];</span><br><span class="line">    <span class="built_in">NSData</span> *body=[bodyStr dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    [requestM setHTTPBody:body];</span><br><span class="line">    <span class="built_in">NSURLSession</span> *session=[<span class="built_in">NSURLSession</span> sharedSession];</span><br><span class="line">    <span class="built_in">NSURLSessionDataTask</span> *dataTask= [session dataTaskWithRequest:requestM completionHandler:^(<span class="built_in">NSData</span> *data, <span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSError</span> *error) &#123;</span><br><span class="line">        <span class="keyword">if</span> (error) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Send failure,error is :%@"</span>,error.localizedDescription);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Send Success!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">    [dataTask resume];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>iOS客户端代码的代码比较简单，注册推送通知，获取device token存储到偏好设置中，并且如果新获取的device token不同于偏好设置中存储的数据则发送给服务器端，更新服务器端device token列表。</p>
<p>其次，由于device token需要发送给服务器端，这里使用一个Web应用作为服务器端接收device token，这里使用了ASP.NET程序来处理令牌接收注册工作，当然你使用其他技术同样没有问题。下面是对应的后台代码：</p>
<p>using System;<br>using System.Collections.Generic;<br>using System.Web;<br>using System.Web.UI;<br>using System.Web.UI.WebControls;<br>using CMJ.Framework.Data;</p>
<p>namespace WebServer<br>{<br>    public partial class RegisterDeviceToken : System.Web.UI.Page<br>    {<br>        private string _appID = @”com.cmjstudio.pushnotification”;<br>        private SqlHelper _helper = new SqlHelper();<br>        protected void Page_Load(object sender, EventArgs e)<br>        {<br>            try<br>            {<br>                string oldToken = Request[“oldToken”] + “”;<br>                string newToken = Request[“newToken”] + “”;<br>                string sql = “”;<br>                //如果传递旧的设备令牌则删除旧令牌添加新令牌<br>                if (oldToken != “”)<br>                {<br>                    sql = string.Format(“DELETE FROM dbo.Device WHERE AppID=’{0}’ AND DeviceToken=’{1}’;”, _appID, oldToken);<br>                }<br>                sql += string.Format(@”IF NOT EXISTS (SELECT ID FROM dbo.Device WHERE AppID=’{0}’ AND DeviceToken=’{1}’)<br>                                        INSERT INTO dbo.Device ( AppID, DeviceToken ) VALUES ( N’{0}’, N’{1}’);”, _appID, newToken);<br>                _helper.ExecuteNonQuery(sql);<br>                Response.Write(“注册成功！”);<br>            }<br>            catch(Exception ex)<br>            {<br>                Response.Write(“注册失败，错误详情：”+ex.ToString());<br>            }<br>        }<br>    }<br>}<br>这个过程主要就是保存device token到数据库中，当然如果同时传递旧的设备令牌还需要先删除就的设备令牌，这里简单的在数据库中创建了一张Device表来保存设备令牌，其中记录了应用程序Id和设备令牌。</p>
<p>第三步就是服务器端发送消息，如果要给APNs发送消息就必须按照Apple的标准消息格式组织消息内容。但是好在目前已经有很多开源的第三方类库供我们使用，具体消息如何包装完全不用自己组织，这里使用一个开源的类库Push Sharp来 给APNs发送消息 ,除了可以给Apple设备推送消息，Push Sharp还支持Android、Windows Phone等多种设备，更多详细内容大家可以参照官方说明。前面说过如果要开发消息推送应用不能使用一般的开发配置文件，这里还需要注意：如果服务器端要 给APNs发送消息其秘钥也必须是通过APNs Development iOS类型的证书来导出的，一般的iOS Development 类型的证书导出的秘钥无法用作服务器端发送秘钥。下面通过在一个简单的WinForm程序中调用Push Sharp给APNs发送消息，这里读取之前Device表中的所有设备令牌循环发送消息：</p>
<p>using System;<br>using System.IO;<br>using System.Collections.Generic;<br>using System.ComponentModel;<br>using System.Data;<br>using System.Drawing;<br>using System.Text;<br>using System.Windows.Forms;<br>using PushSharp;<br>using PushSharp.Apple;<br>using CMJ.Framework.Data;<br>using CMJ.Framework.Logging;<br>using CMJ.Framework.Windows.Forms;</p>
<p>namespace PushNotificationServer<br>{<br>    public partial class frmMain : PersonalizeForm<br>    {<br>        private string _appID = @”com.cmjstudio.pushnotification”;<br>        private SqlHelper _helper = new SqlHelper();<br>        public frmMain()<br>        {<br>            InitializeComponent();<br>        }</p>
<pre><code>    private void btnClose_Click(object sender, EventArgs e)
    {
        this.Close();
    }

    private void btnSend_Click(object sender, EventArgs e)
    {
        List&lt;string&gt; deviceTokens = GetDeviceToken();
        SendMessage(deviceTokens, tbMessage.Text);
    }

    #region 发送消息
    /// &lt;summary&gt;
    /// 取得所有设备令牌
    /// &lt;/summary&gt;
    /// &lt;returns&gt;设备令牌&lt;/returns&gt;
    private List&lt;string&gt; GetDeviceToken()
    {
        List&lt;string&gt; deviceTokens = new List&lt;string&gt;();
        string sql = string.Format(&quot;SELECT DeviceToken FROM dbo.Device WHERE AppID=&apos;{0}&apos;&quot;,_appID);
        DataTable dt = _helper.GetDataTable(sql);
        if(dt.Rows.Count&gt;0)
        {
            foreach(DataRow dr in dt.Rows)
            {
                deviceTokens.Add((dr[&quot;DeviceToken&quot;]+&quot;&quot;).TrimStart(&apos;&lt;&apos;).TrimEnd(&apos;&gt;&apos;).Replace(&quot; &quot;,&quot;&quot;));
            }
        }
        return deviceTokens;
    }

    /// &lt;summary&gt;
    /// 发送消息
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;deviceToken&quot;&gt;设备令牌&lt;/param&gt;
    /// &lt;param name=&quot;message&quot;&gt;消息内容&lt;/param&gt;
    private void SendMessage(List&lt;string&gt; deviceToken, string message)
    {
        //创建推送对象
        var pusher = new PushBroker();
        pusher.OnNotificationSent += pusher_OnNotificationSent;//发送成功事件
        pusher.OnNotificationFailed += pusher_OnNotificationFailed;//发送失败事件
        pusher.OnChannelCreated += pusher_OnChannelCreated;
        pusher.OnChannelDestroyed += pusher_OnChannelDestroyed;
        pusher.OnChannelException += pusher_OnChannelException;
        pusher.OnDeviceSubscriptionChanged += pusher_OnDeviceSubscriptionChanged;
        pusher.OnDeviceSubscriptionExpired += pusher_OnDeviceSubscriptionExpired;
        pusher.OnNotificationRequeue += pusher_OnNotificationRequeue;
        pusher.OnServiceException += pusher_OnServiceException;
        //注册推送服务
        byte[] certificateData = File.ReadAllBytes(@&quot;E:\KenshinCui_Push.p12&quot;);
        pusher.RegisterAppleService(new ApplePushChannelSettings(certificateData, &quot;123&quot;));
        foreach (string token in deviceToken)
        {
            //给指定设备发送消息
            pusher.QueueNotification(new AppleNotification()
                .ForDeviceToken(token)
                .WithAlert(message) 
                .WithBadge(1)
                .WithSound(&quot;default&quot;));
        }
    }

    void pusher_OnServiceException(object sender, Exception error)
    {
        Console.WriteLine(&quot;消息发送失败，错误详情：&quot; + error.ToString());
        PersonalizeMessageBox.Show(this, &quot;消息发送失败，错误详情：&quot; + error.ToString(), &quot;系统提示&quot;);
    }

    void pusher_OnNotificationRequeue(object sender, PushSharp.Core.NotificationRequeueEventArgs e)
    {
        Console.WriteLine(&quot;pusher_OnNotificationRequeue&quot;);
    }

    void pusher_OnDeviceSubscriptionExpired(object sender, string expiredSubscriptionId, DateTime expirationDateUtc, PushSharp.Core.INotification notification)
    {
        Console.WriteLine(&quot;pusher_OnDeviceSubscriptionChanged&quot;);
    }

    void pusher_OnDeviceSubscriptionChanged(object sender, string oldSubscriptionId, string newSubscriptionId, PushSharp.Core.INotification notification)
    {
        Console.WriteLine(&quot;pusher_OnDeviceSubscriptionChanged&quot;);
    }

    void pusher_OnChannelException(object sender, PushSharp.Core.IPushChannel pushChannel, Exception error)
    {
        Console.WriteLine(&quot;消息发送失败，错误详情：&quot; + error.ToString());
        PersonalizeMessageBox.Show(this, &quot;消息发送失败，错误详情：&quot; + error.ToString(), &quot;系统提示&quot;);
    }

    void pusher_OnChannelDestroyed(object sender)
    {
        Console.WriteLine(&quot;pusher_OnChannelDestroyed&quot;);
    }

    void pusher_OnChannelCreated(object sender, PushSharp.Core.IPushChannel pushChannel)
    {
        Console.WriteLine(&quot;pusher_OnChannelCreated&quot;);
    }

    void pusher_OnNotificationFailed(object sender, PushSharp.Core.INotification notification, Exception error)
    {
        Console.WriteLine(&quot;消息发送失败，错误详情：&quot; + error.ToString());
        PersonalizeMessageBox.Show(this, &quot;消息发送失败，错误详情：&quot;+error.ToString(), &quot;系统提示&quot;);
    }

    void pusher_OnNotificationSent(object sender, PushSharp.Core.INotification notification)
    {
        Console.WriteLine(&quot;消息发送成功！&quot;);
        PersonalizeMessageBox.Show(this, &quot;消息发送成功！&quot;, &quot;系统提示&quot;);
    }
    #endregion
}
</code></pre><p>}<br>服务器端消息发送应用运行效果：</p>
<p>iOS客户端接收的消息的效果：</p>
<p>到目前为止通过服务器端应用可以顺利发送消息给APNs并且iOS应用已经成功接收推送消息。</p>
<p>补充–iOS开发证书、秘钥</p>
<p>iOS开发过程中如果需要进行真机调试、发布需要注册申请很多证书，对于初学者往往迷惑不解，再加上今天的文章中会牵扯到一些特殊配置，这里就简单的对iOS开发的常用证书和秘钥等做一说明。</p>
<p>证书</p>
<p>iOS常用的证书包括开发证书和发布证书，无论是真机调试还是最终发布应用到App Store这两个证书都是必须的，它是iOS开发的基本证书。</p>
<p>a.开发证书：开发证书又分为普通开发证书和推送证书，如果仅仅是一般的应用则前者即可满足，但是如果开发推送应用则必须使用推送证书。</p>
<p>b.发布证书：发布证书又可以分为普通发布证书、推送证书、Pass Type ID证书、站点发布证书、VoIP服务证书、苹果支付证书。同样的，对于需要使用特殊服务的应用则必须选择对应的证书。</p>
<p>应用标识</p>
<p>App ID,应用程序的唯一标识，对应iOS应用的Bundle Identifier，App ID在苹果开发者中心中分为通配应用ID和明确的应用ID,前者一般用于普通应用开发，一个ID可以适用于多个不同标识的应用；但是对于使用消息推送、 Passbook、站点发布、iCloud等服务的应用必须配置明确的应用ID。</p>
<p>设备标识</p>
<p>UDID,用于标识每一台硬件设备的标示符。注意它不是device token，device token是根据UDID使用一个只有Apple自己才知道的算法生成的一组标示符。</p>
<p>配置简介</p>
<p>Provisioning Profiles,平时又称为PP文件。将UDID、App ID、开发证书打包在一起的配置文件，同样分为开发和发布两类配置文件。</p>
<p>秘钥</p>
<p>在申请开发证书时必须要首先提交一个秘钥请求文件，对于生成秘钥请求文件的mac，如果要做开发则只需要下载证书和配置简介即可开发。但是如果要想 在其他机器上做开发则必须将证书中的秘钥导出（导出之后是一个.p12文件），然后导入其他机器。同时对于类似于推送服务器端应用如果要给APNs发送消 息，同样需要使用.p12秘钥文件，并且这个秘钥文件需要是推送证书导出的对应秘钥。</p>
]]></content>
      
        <categories>
            
            <category> objective-c </category>
            
        </categories>
        
        
    </entry>
    
  
  
</search>
